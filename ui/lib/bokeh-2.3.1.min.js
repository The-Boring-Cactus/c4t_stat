/*!
 * Copyright (c) 2012 - 2021, Anaconda, Inc., and Bokeh Contributors
 * All rights reserved.
 * 
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 
 * Redistributions of source code must retain the above copyright notice,
 * this list of conditions and the following disclaimer.
 * 
 * Redistributions in binary form must reproduce the above copyright notice,
 * this list of conditions and the following disclaimer in the documentation
 * and/or other materials provided with the distribution.
 * 
 * Neither the name of Anaconda nor the names of any contributors
 * may be used to endorse or promote products derived from this software
 * without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 * THE POSSIBILITY OF SUCH DAMAGE.
 */
(function(t,e){const i=e();i.__bokeh__=!0,"undefined"!==typeof t.Bokeh&&"undefined"!==typeof t.Bokeh.__bokeh__||(t.Bokeh=i);const s=t.Bokeh;s[i.version]=i})(this,(function(){var t,e="function"===typeof require&&require;return function(t,i,s,n){void 0===s&&(s={}),void 0===n&&(n={});var o={},r=function(t){if("number"===typeof t)return t;if("bokehjs"===t)return i;if(!n[t]){var e="@bokehjs/";t.slice(0,e.length)===e&&(t=t.slice(e.length))}var o=s[t];if(null!=o)return o;var r=t.length>0&&"/"===t[t.lenght-1],a=s[t+(r?"":"/")+"index"];return null!=a?a:t},a=function(i){var s=o[i];if(!s){var l=r(i);if(s=o[l],s)o[i]=s;else{if(!t[l]){if(!1===n[l]||1==n[l]&&e)try{return s={exports:n[l]?e(l):{}},o[l]=o[i]=s,s.exports}catch(d){}var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}function h(){Object.defineProperty(s.exports,"__esModule",{value:!0})}function _(t,e){Object.defineProperty(s.exports,t,{enumerable:!0,get:function(){return e}})}s={exports:{}},o[l]=o[i]=s,t[l].call(s.exports,a,s,s.exports,h,_)}}return s.exports};a.resolve=function(t){return""};var l=a(i);return l.require=a,"undefined"!==typeof Proxy&&(l.loader=new Proxy({},{get:function(t,e){return a(e)}})),l.register_plugin=function(e,i,o,r){for(var c in void 0===o&&(o={}),void 0===r&&(r={}),e)t[c]=e[c];for(var c in o)s[c]=o[c];for(var c in r)n[c]=r[c];var h=a(i);for(var c in h)l[c]=h[c];return h},l}([function(t,e,i,s,n){s(),t(1).__exportStar(t(2),i)},function(t,e,i,s,n){s();var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)};function r(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],s=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function a(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var s,n,o=i.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(s=o.next()).done;)r.push(s.value)}catch(t){n={error:t}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return r}function l(t){return this instanceof l?(this.v=t,this):new l(t)}i.__extends=function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},i.__assign=function(){return i.__assign=Object.assign||function(t){for(var e,i=1,s=arguments.length;i<s;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},i.__assign.apply(this,arguments)},i.__rest=function(t,e){var i={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(i[s]=t[s]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(i[s[n]]=t[s[n]])}return i},i.__decorate=function(t,e,i,s){var n,o=arguments.length,r=o<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,i,r):n(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r},i.__param=function(t,e){return function(i,s){e(i,s,t)}},i.__metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},i.__awaiter=function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function r(t){try{l(s.next(t))}catch(t){o(t)}}function a(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,a)}l((s=s.apply(t,e||[])).next())}))},i.__generator=function(t,e){var i,s,n,o,r={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,s&&(n=2&o[0]?s.return:o[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,o[1])).done)return n;switch(s=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,s=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(n=r.trys,!((n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){r.label=o[1];break}if(6===o[0]&&r.label<n[1]){r.label=n[1],n=o;break}if(n&&r.label<n[2]){r.label=n[2],r.ops.push(o);break}n[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],s=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},i.__createBinding=Object.create?function(t,e,i,s){void 0===s&&(s=i),Object.defineProperty(t,s,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]},i.__exportStar=function(t,e){for(var s in t)"default"===s||Object.prototype.hasOwnProperty.call(e,s)||i.__createBinding(e,t,s)},i.__values=r,i.__read=a,i.__spread=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(a(arguments[e]));return t},i.__spreadArrays=function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var s=Array(t),n=0;for(e=0;e<i;e++)for(var o=arguments[e],r=0,a=o.length;r<a;r++,n++)s[n]=o[r];return s},i.__await=l,i.__asyncGenerator=function(t,e,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,n=i.apply(t,e||[]),o=[];return s={},r("next"),r("throw"),r("return"),s[Symbol.asyncIterator]=function(){return this},s;function r(t){n[t]&&(s[t]=function(e){return new Promise((function(i,s){o.push([t,e,i,s])>1||a(t,e)}))})}function a(t,e){try{(i=n[t](e)).value instanceof l?Promise.resolve(i.value.v).then(c,h):_(o[0][2],i)}catch(t){_(o[0][3],t)}var i}function c(t){a("next",t)}function h(t){a("throw",t)}function _(t,e){t(e),o.shift(),o.length&&a(o[0][0],o[0][1])}},i.__asyncDelegator=function(t){var e,i;return e={},s("next"),s("throw",(function(t){throw t})),s("return"),e[Symbol.iterator]=function(){return this},e;function s(s,n){e[s]=t[s]?function(e){return(i=!i)?{value:l(t[s](e)),done:"return"===s}:n?n(e):e}:n}},i.__asyncValues=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,i=t[Symbol.asyncIterator];return i?i.call(t):(t=r(t),e={},s("next"),s("throw"),s("return"),e[Symbol.asyncIterator]=function(){return this},e);function s(i){e[i]=t[i]&&function(e){return new Promise((function(s,n){(function(t,e,i,s){Promise.resolve(s).then((function(e){t({value:e,done:i})}),e)})(s,n,(e=t[i](e)).done,e.value)}))}}},i.__makeTemplateObject=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t};var c=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};i.__importStar=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var s in t)"default"!==s&&Object.prototype.hasOwnProperty.call(t,s)&&i.__createBinding(e,t,s);return c(e,t),e},i.__importDefault=function(t){return t&&t.__esModule?t:{default:t}},i.__classPrivateFieldGet=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},i.__classPrivateFieldSet=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i}},function(t,e,i,s,n){s();const o=t(1);n("version",t(3).version),n("index",t(4).index),i.embed=o.__importStar(t(4)),i.protocol=o.__importStar(t(404)),i._testing=o.__importStar(t(405));var r=t(19);n("logger",r.logger),n("set_log_level",r.set_log_level),n("settings",t(28).settings),n("Models",t(7).Models),n("documents",t(5).documents),n("safely",t(406).safely)},function(t,e,i,s,n){s(),i.version="2.3.1"},function(t,e,i,s,n){s();const o=t(5),r=t(19),a=t(34),l=t(13),c=t(8),h=t(16),_=t(395),d=t(397),u=t(396);var p=t(395);n("add_document_standalone",p.add_document_standalone),n("index",p.index),n("add_document_from_session",t(397).add_document_from_session);var m=t(402);async function g(t,e,i,s){c.isString(t)&&(t=JSON.parse(a.unescape(t)));const n={};for(const[r,a]of l.entries(t))n[r]=o.Document.from_json(a);const h=[];for(const o of e){const e=u._resolve_element(o),a=u._resolve_root_elements(o);if(null!=o.docid)h.push(await _.add_document_standalone(n[o.docid],e,a,o.use_for_title));else{if(null==o.token)throw new Error("Error rendering Bokeh items: either 'docid' or 'token' was expected.");{const n=d._get_ws_url(i,s);r.logger.debug(`embed: computed ws url: ${n}`);try{h.push(await d.add_document_from_session(n,o.token,e,a,o.use_for_title)),console.log("Bokeh items were rendered successfully")}catch(t){console.log("Error rendering Bokeh items:",t)}}}}return h}n("embed_items_notebook",m.embed_items_notebook),n("kernels",m.kernels),n("BOKEH_ROOT",t(396).BOKEH_ROOT),i.embed_item=async function(t,e){const i={},s=a.uuid4();i[s]=t.doc,null==e&&(e=t.target_id);const n=document.getElementById(e);null!=n&&n.classList.add(u.BOKEH_ROOT);const o={roots:{[t.root_id]:e},root_ids:[t.root_id],docid:s};await h.defer();const[r]=await g(i,[o]);return r},i.embed_items=async function(t,e,i,s){return await h.defer(),g(t,e,i,s)}},function(t,e,i,s,n){s();const o=t(1);o.__exportStar(t(6),i),o.__exportStar(t(35),i)},function(t,e,i,s,n){s();const o=t(1),r=t(7),a=t(3),l=t(19),c=t(264),h=t(14),_=t(30),d=t(15),u=t(17),p=t(31),m=t(9),g=t(13),f=o.__importStar(t(132)),b=t(26),v=t(8),y=t(319),x=t(130),w=t(53),A=t(394),k=t(35);class S{constructor(t){this.document=t,this.session=null,this.subscribed_models=new Set}send_event(t){const e=new k.MessageSentEvent(this.document,"bokeh_event",t.to_json());this.document._trigger_on_change(e)}trigger(t){for(const e of this.subscribed_models)null!=t.origin&&t.origin!=e||e._process_event(t)}}i.EventManager=S,S.__name__="EventManager",i.documents=[],i.DEFAULT_TITLE="Bokeh Application";class T{constructor(t){var e;i.documents.push(this),this._init_timestamp=Date.now(),this._resolver=null!==(e=null==t?void 0:t.resolver)&&void 0!==e?e:new r.ModelResolver,this._title=i.DEFAULT_TITLE,this._roots=[],this._all_models=new Map,this._all_models_freeze_count=0,this._callbacks=new Map,this._message_callbacks=new Map,this.event_manager=new S(this),this.idle=new d.Signal0(this,"idle"),this._idle_roots=new WeakMap,this._interactive_timestamp=null,this._interactive_plot=null}get layoutables(){return this._roots.filter((t=>t instanceof y.LayoutDOM))}get is_idle(){for(const t of this.layoutables)if(!this._idle_roots.has(t))return!1;return!0}notify_idle(t){this._idle_roots.set(t,!0),this.is_idle&&(l.logger.info(`document idle at ${Date.now()-this._init_timestamp} ms`),this.event_manager.send_event(new c.DocumentReady),this.idle.emit())}clear(){this._push_all_models_freeze();try{for(;this._roots.length>0;)this.remove_root(this._roots[0])}finally{this._pop_all_models_freeze()}}interactive_start(t){null==this._interactive_plot&&(this._interactive_plot=t,this._interactive_plot.trigger_event(new c.LODStart)),this._interactive_timestamp=Date.now()}interactive_stop(){null!=this._interactive_plot&&this._interactive_plot.trigger_event(new c.LODEnd),this._interactive_plot=null,this._interactive_timestamp=null}interactive_duration(){return null==this._interactive_timestamp?-1:Date.now()-this._interactive_timestamp}destructively_move(t){if(t===this)throw new Error("Attempted to overwrite a document with itself");t.clear();const e=m.copy(this._roots);this.clear();for(const i of e)if(null!=i.document)throw new Error(`Somehow we didn't detach ${i}`);if(0!=this._all_models.size)throw new Error(`this._all_models still had stuff in it: ${this._all_models}`);for(const i of e)t.add_root(i);t.set_title(this._title)}_push_all_models_freeze(){this._all_models_freeze_count+=1}_pop_all_models_freeze(){this._all_models_freeze_count-=1,0===this._all_models_freeze_count&&this._recompute_all_models()}_invalidate_all_models(){l.logger.debug("invalidating document models"),0===this._all_models_freeze_count&&this._recompute_all_models()}_recompute_all_models(){let t=new Set;for(const o of this._roots)t=f.union(t,o.references());const e=new Set(this._all_models.values()),i=f.difference(e,t),s=f.difference(t,e),n=new Map;for(const o of t)n.set(o.id,o);for(const o of i)o.detach_document();for(const o of s)o.attach_document(this);this._all_models=n}roots(){return this._roots}add_root(t,e){if(l.logger.debug(`Adding root: ${t}`),!m.includes(this._roots,t)){this._push_all_models_freeze();try{this._roots.push(t)}finally{this._pop_all_models_freeze()}this._trigger_on_change(new k.RootAddedEvent(this,t,e))}}remove_root(t,e){const i=this._roots.indexOf(t);if(!(i<0)){this._push_all_models_freeze();try{this._roots.splice(i,1)}finally{this._pop_all_models_freeze()}this._trigger_on_change(new k.RootRemovedEvent(this,t,e))}}title(){return this._title}set_title(t,e){t!==this._title&&(this._title=t,this._trigger_on_change(new k.TitleChangedEvent(this,t,e)))}get_model_by_id(t){var e;return null!==(e=this._all_models.get(t))&&void 0!==e?e:null}get_model_by_name(t){const e=[];for(const i of this._all_models.values())i instanceof w.Model&&i.name==t&&e.push(i);switch(e.length){case 0:return null;case 1:return e[0];default:throw new Error(`Multiple models are named '${t}'`)}}on_message(t,e){const i=this._message_callbacks.get(t);null==i?this._message_callbacks.set(t,new Set([e])):i.add(e)}remove_on_message(t,e){var i;null===(i=this._message_callbacks.get(t))||void 0===i||i.delete(e)}_trigger_on_message(t,e){const i=this._message_callbacks.get(t);if(null!=i)for(const s of i)s(e)}on_change(t,e=!1){this._callbacks.has(t)||this._callbacks.set(t,e)}remove_on_change(t){this._callbacks.delete(t)}_trigger_on_change(t){for(const[e,i]of this._callbacks)if(!i&&t instanceof k.DocumentEventBatch)for(const s of t.events)e(s);else e(t)}_notify_change(t,e,i,s,n){this._trigger_on_change(new k.ModelChangedEvent(this,t,e,i,s,null==n?void 0:n.setter_id,null==n?void 0:n.hint))}static _instantiate_object(t,e,i,s){const n=Object.assign(Object.assign({},i),{id:t,__deferred__:!0});return new(s.get(e))(n)}static _instantiate_references_json(t,e,i){var s;const n=new Map;for(const o of t){const t=o.id,r=o.type,a=null!==(s=o.attributes)&&void 0!==s?s:{};let l=e.get(t);null==l&&(l=T._instantiate_object(t,r,a,i),null!=o.subtype&&l.set_subtype(o.subtype)),n.set(l.id,l)}return n}static _resolve_refs(t,e,i,s){function n(t){var o;if(u.is_ref(t)){const s=null!==(o=e.get(t.id))&&void 0!==o?o:i.get(t.id);if(null!=s)return s;throw new Error(`reference ${JSON.stringify(t)} isn't known (not in Document?)`)}return p.is_NDArray_ref(t)?p.decode_NDArray(t,s):v.isArray(t)?function(t){const e=[];for(const i of t)e.push(n(i));return e}(t):v.isPlainObject(t)?function(t){const e={};for(const[i,s]of g.entries(t))e[i]=n(s);return e}(t):t}return n(t)}static _initialize_references_json(t,e,i,s){const n=new Map;for(const{id:l,attributes:c}of t){const t=!e.has(l),o=t?i.get(l):e.get(l),r=T._resolve_refs(c,e,i,s);o.setv(r,{silent:!0}),n.set(l,{instance:o,is_new:t})}const o=[],r=new Set;function a(t){if(t instanceof h.HasProps){if(n.has(t.id)&&!r.has(t.id)){r.add(t.id);const{instance:e,is_new:i}=n.get(t.id),{attributes:s}=e;for(const t of g.values(s))a(t);i&&(e.finalize(),o.push(e))}}else if(v.isArray(t))for(const e of t)a(e);else if(v.isPlainObject(t))for(const e of g.values(t))a(e)}for(const l of n.values())a(l.instance);for(const l of o)l.connect_signals()}static _event_for_attribute_change(t,e,i,s,n){if(s.get_model_by_id(t.id).property(e).syncable){const o={kind:"ModelChanged",model:{id:t.id},attr:e,new:i};return h.HasProps._json_record_references(s,i,n,{recursive:!0}),o}return null}static _events_to_sync_objects(t,e,i,s){const n=Object.keys(t.attributes),o=Object.keys(e.attributes),r=m.difference(n,o),a=m.difference(o,n),c=m.intersection(n,o),h=[];for(const _ of r)l.logger.warn(`Server sent key ${_} but we don't seem to have it in our JSON`);for(const l of a){const n=e.attributes[l];h.push(T._event_for_attribute_change(t,l,n,i,s))}for(const l of c){const n=t.attributes[l],o=e.attributes[l];null==n&&null==o||(null==n||null==o?h.push(T._event_for_attribute_change(t,l,o,i,s)):b.is_equal(n,o)||h.push(T._event_for_attribute_change(t,l,o,i,s)))}return h.filter((t=>null!=t))}static _compute_patch_since_json(t,e){const i=e.to_json(!1);function s(t){const e=new Map;for(const i of t.roots.references)e.set(i.id,i);return e}const n=s(t),o=new Map,r=[];for(const _ of t.roots.root_ids)o.set(_,n.get(_)),r.push(_);const a=s(i),l=new Map,c=[];for(const _ of i.roots.root_ids)l.set(_,a.get(_)),c.push(_);if(r.sort(),c.sort(),m.difference(r,c).length>0||m.difference(c,r).length>0)throw new Error("Not implemented: computing add/remove of document roots");const h=new Set;let d=[];for(const _ of e._all_models.keys())if(n.has(_)){const t=T._events_to_sync_objects(n.get(_),a.get(_),e,h);d=d.concat(t)}const u=new _.Serializer({include_defaults:!1});return u.to_serializable([...h]),{references:[...u.definitions],events:d}}to_json_string(t=!0){return JSON.stringify(this.to_json(t))}to_json(t=!0){const e=new _.Serializer({include_defaults:t}),i=e.to_serializable(this._roots);return{version:a.version,title:this._title,roots:{root_ids:i.map((t=>t.id)),references:[...e.definitions]}}}static from_json_string(t){const e=JSON.parse(t);return T.from_json(e)}static from_json(t){l.logger.debug("Creating Document from JSON");const e=t.version,i=-1!==e.indexOf("+")||-1!==e.indexOf("-"),s=`Library versions: JS (${a.version}) / Python (${e})`;i||a.version.replace(/-(dev|rc)\./,"$1")==e?l.logger.debug(s):(l.logger.warn("JS/Python version mismatch"),l.logger.warn(s));const n=new r.ModelResolver;null!=t.defs&&A.resolve_defs(t.defs,n);const o=t.roots,c=o.root_ids,h=o.references,_=T._instantiate_references_json(h,new Map,n);T._initialize_references_json(h,new Map,_,new Map);const d=new T({resolver:n});for(const r of c){const t=_.get(r);null!=t&&d.add_root(t)}return d.set_title(t.title),d}replace_with_json(t){T.from_json(t).destructively_move(this)}create_json_patch_string(t){return JSON.stringify(this.create_json_patch(t))}create_json_patch(t){for(const s of t)if(s.document!=this)throw new Error("Cannot create a patch using events from a different document");const e=new _.Serializer,i=e.to_serializable(t);for(const s of this._all_models.values())e.remove_def(s);return{events:i,references:[...e.definitions]}}apply_json_patch(t,e=new Map,i){const s=t.references,n=t.events,o=T._instantiate_references_json(s,this._all_models,this._resolver);e instanceof Map||(e=new Map(e));for(const c of n)switch(c.kind){case"RootAdded":case"RootRemoved":case"ModelChanged":{const t=c.model.id,e=this._all_models.get(t);if(null!=e)o.set(t,e);else if(!o.has(t))throw l.logger.warn(`Got an event for unknown model ${c.model}"`),new Error("event model wasn't known");break}}const r=new Map(this._all_models),a=new Map;for(const[l,c]of o)r.has(l)||a.set(l,c);T._initialize_references_json(s,r,a,e);for(const l of n)switch(l.kind){case"MessageSent":{const{msg_type:t,msg_data:i}=l;let s;if(void 0===i){if(1!=e.size)throw new Error("expected exactly one buffer");{const[[,t]]=e;s=t}}else s=T._resolve_refs(i,r,a,e);this._trigger_on_message(t,s);break}case"ModelChanged":{const t=l.model.id,s=this._all_models.get(t);if(null==s)throw new Error(`Cannot apply patch to ${t} which is not in the document`);const n=l.attr,o=T._resolve_refs(l.new,r,a,e);s.setv({[n]:o},{setter_id:i});break}case"ColumnDataChanged":{const t=l.column_source.id,s=this._all_models.get(t);if(null==s)throw new Error(`Cannot stream to ${t} which is not in the document`);const n=T._resolve_refs(l.new,new Map,new Map,e);if(null!=l.cols)for(const e in s.data)e in n||(n[e]=s.data[e]);s.setv({data:n},{setter_id:i,check_eq:!1});break}case"ColumnsStreamed":{const t=l.column_source.id,e=this._all_models.get(t);if(null==e)throw new Error(`Cannot stream to ${t} which is not in the document`);if(!(e instanceof x.ColumnDataSource))throw new Error("Cannot stream to non-ColumnDataSource");const s=l.data,n=l.rollover;e.stream(s,n,i);break}case"ColumnsPatched":{const t=l.column_source.id,e=this._all_models.get(t);if(null==e)throw new Error(`Cannot patch ${t} which is not in the document`);if(!(e instanceof x.ColumnDataSource))throw new Error("Cannot patch non-ColumnDataSource");const s=l.patches;e.patch(s,i);break}case"RootAdded":{const t=l.model.id,e=o.get(t);this.add_root(e,i);break}case"RootRemoved":{const t=l.model.id,e=o.get(t);this.remove_root(e,i);break}case"TitleChanged":this.set_title(l.title,i);break;default:throw new Error("Unknown patch event "+JSON.stringify(l))}}}i.Document=T,T.__name__="Document"},function(t,e,i,s,n){s();const o=t(1),r=t(8),a=t(13),l=t(14);i.overrides={};const c=new Map;i.Models=t=>{const e=i.Models.get(t);if(null!=e)return e;throw new Error(`Model '${t}' does not exist. This could be due to a widget or a custom model not being registered before first usage.`)},i.Models.get=t=>{var e;return null!==(e=i.overrides[t])&&void 0!==e?e:c.get(t)},i.Models.register=(t,e)=>{i.overrides[t]=e},i.Models.unregister=t=>{delete i.overrides[t]},i.Models.register_models=(t,e=!1,i)=>{var s;if(null!=t)for(const n of r.isArray(t)?t:a.values(t))if(s=n,r.isObject(s)&&s.prototype instanceof l.HasProps){const t=n.__qualified__;e||!c.has(t)?c.set(t,n):null!=i?i(t):console.warn(`Model '${t}' was already registered`)}},i.register_models=i.Models.register_models,i.Models.registered_names=()=>[...c.keys()];class h{constructor(){this._known_models=new Map}get(t,e){var s;const n=null!==(s=i.Models.get(t))&&void 0!==s?s:this._known_models.get(t);if(null!=n)return n;if(void 0!==e)return e;throw new Error(`Model '${t}' does not exist. This could be due to a widget or a custom model not being registered before first usage.`)}register(t){const e=t.__qualified__;null==this.get(e,null)?this._known_models.set(e,t):console.warn(`Model '${e}' was already registered with this resolver`)}}i.ModelResolver=h,h.__name__="ModelResolver";const _=o.__importStar(t(38));i.register_models(_)},function(t,e,i,s,n){s();const o=t(9),r=Object.prototype.toString;function a(t){return!0===t||!1===t||"[object Boolean]"===r.call(t)}function l(t){return"[object Number]"===r.call(t)}function c(t){return"[object String]"===r.call(t)}function h(t){const e=typeof t;return"function"===e||"object"===e&&!!t}function _(t){return h(t)&&void 0!==t[Symbol.iterator]}i.isBoolean=a,i.isNumber=l,i.isInteger=function(t){return l(t)&&Number.isInteger(t)},i.isString=c,i.isPrimitive=function(t){return null===t||a(t)||l(t)||c(t)},i.isFunction=function(t){return"[object Function]"===r.call(t)},i.isArray=function(t){return Array.isArray(t)},i.isArrayOf=function(t,e){return o.every(t,e)},i.isArrayableOf=function(t,e){for(let i=0,s=t.length;i<s;i++)if(!e(t[i]))return!1;return!0},i.isTypedArray=function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},i.isObject=h,i.isPlainObject=function(t){return h(t)&&(null==t.constructor||t.constructor===Object)},i.isIterable=_,i.isArrayable=function(t){return _(t)&&"length"in t}},function(t,e,i,s,n){s();const o=t(10),r=t(11),a=t(12);n("map",a.map),n("reduce",a.reduce),n("min",a.min),n("min_by",a.min_by),n("max",a.max),n("max_by",a.max_by),n("sum",a.sum),n("cumsum",a.cumsum),n("every",a.every),n("some",a.some),n("find",a.find),n("find_last",a.find_last),n("find_index",a.find_index),n("find_last_index",a.find_last_index),n("sorted_index",a.sorted_index),n("is_empty",a.is_empty);const l=Array.prototype.slice;function c(t){return l.call(t)}function h(t){return[].concat(...t)}function _(t,e){return-1!==t.indexOf(e)}function d(t,e,i=1){r.assert(i>0,"'step' must be a positive number"),null==e&&(e=t,t=0);const{max:s,ceil:n,abs:o}=Math,a=t<=e?i:-i,l=s(n(o(e-t)/i),0),c=new Array(l);for(let r=0;r<l;r++,t+=a)c[r]=t;return c}i.head=function(t){return t[0]},i.tail=function(t){return t[t.length-1]},i.last=function(t){return t[t.length-1]},i.copy=c,i.concat=h,i.includes=_,i.contains=_,i.nth=function(t,e){return t[e>=0?e:t.length+e]},i.zip=function(...t){if(0==t.length)return[];const e=a.min(t.map((t=>t.length))),i=t.length,s=new Array(e);for(let n=0;n<e;n++){s[n]=new Array(i);for(let e=0;e<i;e++)s[n][e]=t[e][n]}return s},i.unzip=function(t){const e=t.length,i=a.min(t.map((t=>t.length))),s=Array(i);for(let n=0;n<i;n++)s[n]=new Array(e);for(let n=0;n<e;n++)for(let e=0;e<i;e++)s[e][n]=t[n][e];return s},i.range=d,i.linspace=function(t,e,i=100){const s=(e-t)/(i-1),n=new Array(i);for(let o=0;o<i;o++)n[o]=t+s*o;return n},i.transpose=function(t){const e=t.length,i=t[0].length,s=[];for(let n=0;n<i;n++){s[n]=[];for(let i=0;i<e;i++)s[n][i]=t[i][n]}return s},i.argmin=function(t){return a.min_by(d(t.length),(e=>t[e]))},i.argmax=function(t){return a.max_by(d(t.length),(e=>t[e]))},i.sort_by=function(t,e){const i=t.map(((t,i)=>({value:t,index:i,key:e(t)})));return i.sort(((t,e)=>{const i=t.key,s=e.key;if(i!==s){if(i>s||void 0===i)return 1;if(i<s||void 0===s)return-1}return t.index-e.index})),i.map((t=>t.value))},i.uniq=function(t){const e=new Set;for(const i of t)e.add(i);return[...e]},i.uniq_by=function(t,e){const i=[],s=[];for(const n of t){const t=e(n);_(s,t)||(s.push(t),i.push(n))}return i},i.union=function(...t){const e=new Set;for(const i of t)for(const t of i)e.add(t);return[...e]},i.intersection=function(t,...e){const i=[];t:for(const s of t)if(!_(i,s)){for(const t of e)if(!_(t,s))continue t;i.push(s)}return i},i.difference=function(t,...e){const i=h(e);return t.filter((t=>!_(i,t)))},i.remove_at=function(t,e){const i=c(t);return i.splice(e,1),i},i.remove_by=function(t,e){for(let i=0;i<t.length;)e(t[i])?t.splice(i,1):i++},i.shuffle=function(t){const e=t.length,i=new Array(e);for(let s=0;s<e;s++){const e=o.randomIn(0,s);e!==s&&(i[s]=i[e]),i[e]=t[s]}return i},i.pairwise=function(t,e){const i=t.length,s=new Array(i-1);for(let n=0;n<i-1;n++)s[n]=e(t[n],t[n+1]);return s},i.reversed=function(t){const e=t.length,i=new Array(e);for(let s=0;s<e;s++)i[e-s-1]=t[s];return i},i.repeat=function(t,e){const i=new Array(e);for(let s=0;s<e;s++)i[s]=t;return i}},function(t,e,i,s,n){s();const{PI:o}=Math;function r(t){if(0==t)return 0;for(;t<=0;)t+=2*o;for(;t>2*o;)t-=2*o;return t}function a(t,e){return r(t-e)}function l(){return Math.random()}function c(t){switch(t){case"deg":return o/180;case"rad":return 1;case"grad":return o/200;case"turn":return 2*o}}i.angle_norm=r,i.angle_dist=a,i.angle_between=function(t,e,i,s=!1){const n=a(e,i);if(0==n)return!1;if(n==2*o)return!0;const l=r(t),c=a(e,l)<=n&&a(l,i)<=n;return s?!c:c},i.random=l,i.randomIn=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},i.atan2=function(t,e){return Math.atan2(e[1]-t[1],e[0]-t[0])},i.radians=function(t){return t*(o/180)},i.degrees=function(t){return t/(o/180)},i.resolve_angle=function(t,e){return-c(e)*t},i.to_radians_coeff=c,i.rnorm=function(t,e){let i,s;for(;i=l(),s=l(),s=(2*s-1)*Math.sqrt(1/Math.E*2),!(-4*i*i*Math.log(i)>=s*s););let n=s/i;return n=t+e*n,n},i.clamp=function(t,e,i){return t<e?e:t>i?i:t},i.log=function(t,e=Math.E){return Math.log(t)/Math.log(e)}},function(t,e,i,s,n){s();class o extends Error{}i.AssertionError=o,o.__name__="AssertionError",i.assert=function(t,e){if(!(!0===t||!1!==t&&t()))throw new o(null!=e?e:"Assertion failed")},i.unreachable=function(){throw new Error("unreachable code")}},function(t,e,i,s,n){s();const o=t(10);function r(t,e,i,...s){const n=t.length;e<0&&(e+=n),e<0?e=0:e>n&&(e=n),null==i||i>n-e?i=n-e:i<0&&(i=0);const o=n-i+s.length,r=new t.constructor(o);let a=0;for(;a<e;a++)r[a]=t[a];for(const l of s)r[a++]=l;for(let l=e+i;l<n;l++)r[a++]=t[l];return r}function a(t,e){return r(t,e,t.length-e)}function l(t,e){const i=t.length,s=new t.constructor(i);for(let n=0;n<i;n++)s[n]=e(t[n],n,t);return s}function c(t,e,i){const s=t.length;if(void 0===i&&0==s)throw new Error("can't reduce an empty array without an initial value");let n,o;for(void 0===i?(n=t[0],o=1):(n=i,o=0);o<s;o++)n=e(n,t[o],o,t);return n}function h(t){return function(e,i){const s=e.length;let n=t>0?0:s-1;for(;n>=0&&n<s;n+=t)if(i(e[n]))return n;return-1}}function _(t,e){let i=0,s=t.length;for(;i<s;){const n=Math.floor((i+s)/2);t[n]<e?i=n+1:s=n}return i}function d(t,e,i,s,n){const o=(n-i)/(s-e);let r=o*(t-e)+i;return isFinite(r)||(r=o*(t-s)+n,isFinite(r)||i!=n||(r=i)),r}function u(t,e){if(t<e[0])return-1;if(t>e[e.length-1])return e.length;let i=0,s=e.length-1;for(;s-i!=1;){const n=i+Math.floor((s-i)/2);t>=e[n]?i=n:s=n}return i}i.is_empty=function(t){return 0==t.length},i.copy=function(t){return Array.isArray(t)?t.slice():new t.constructor(t)},i.splice=r,i.head=a,i.insert=function(t,e,i){return r(t,i,0,e)},i.append=function(t,e){return r(t,t.length,0,e)},i.prepend=function(t,e){return r(t,0,0,e)},i.indexOf=function(t,e){for(let i=0,s=t.length;i<s;i++)if(t[i]===e)return i;return-1},i.subselect=function(t,e){const i=e.length,s=new t.constructor(i);for(let n=0;n<i;n++)s[n]=t[e[n]];return s},i.mul=function(t,e,i){const s=t.length,n=null!=i?i:new t.constructor(s);for(let o=0;o<s;o++)n[o]=t[o]*e;return n},i.map=l,i.inplace_map=function(t,e,i){const s=t.length,n=null!=i?i:t;for(let o=0;o<s;o++)n[o]=e(t[o],o)},i.filter=function(t,e){const i=t.length,s=new t.constructor(i);let n=0;for(let o=0;o<i;o++){const i=t[o];e(i,o,t)&&(s[n++]=i)}return a(s,n)},i.reduce=c,i.min=function(t){let e,i=1/0;for(let s=0,n=t.length;s<n;s++)e=t[s],!isNaN(e)&&e<i&&(i=e);return i},i.max=function(t){let e,i=-1/0;for(let s=0,n=t.length;s<n;s++)e=t[s],!isNaN(e)&&e>i&&(i=e);return i},i.minmax=function(t){let e,i=1/0,s=-1/0;for(let n=0,o=t.length;n<o;n++)e=t[n],isNaN(e)||(e<i&&(i=e),e>s&&(s=e));return[i,s]},i.min_by=function(t,e){if(0==t.length)throw new Error("min_by() called with an empty array");let i=t[0],s=e(i);for(let n=1,o=t.length;n<o;n++){const o=t[n],r=e(o);r<s&&(i=o,s=r)}return i},i.max_by=function(t,e){if(0==t.length)throw new Error("max_by() called with an empty array");let i=t[0],s=e(i);for(let n=1,o=t.length;n<o;n++){const o=t[n],r=e(o);r>s&&(i=o,s=r)}return i},i.sum=function(t){let e=0;for(let i=0,s=t.length;i<s;i++)e+=t[i];return e},i.cumsum=function(t){const e=new t.constructor(t.length);return c(t,((t,i,s)=>e[s]=t+i),0),e},i.every=function(t,e){for(let i=0,s=t.length;i<s;i++)if(!e(t[i]))return!1;return!0},i.some=function(t,e){for(let i=0,s=t.length;i<s;i++)if(e(t[i]))return!0;return!1},i.index_of=function(t,e){for(let i=0,s=t.length;i<s;i++)if(t[i]===e)return i;return-1},i.find_index=h(1),i.find_last_index=h(-1),i.find=function(t,e){const s=i.find_index(t,e);return-1==s?void 0:t[s]},i.find_last=function(t,e){const s=i.find_last_index(t,e);return-1==s?void 0:t[s]},i.sorted_index=_,i.bin_counts=function(t,e){const i=e.length-1,s=Array(i).fill(0);for(let n=0;n<t.length;n++){const r=_(e,t[n]);s[o.clamp(r-1,0,i-1)]+=1}return s},i.interpolate=function(t,e,i){const s=t.length,n=new Array(s);for(let o=0;o<s;o++){const s=t[o];if(isNaN(s)){n[o]=s;continue}const r=u(s,e);if(-1==r)n[o]=i[0];else if(r==e.length)n[o]=i[i.length-1];else if(r==e.length-1||e[r]==s)n[o]=i[r];else{const t=e[r],a=i[r],l=e[r+1],c=i[r+1];n[o]=d(s,t,a,l,c)}}return n},i.left_edge_index=u,i.norm=function(t,e,i){const s=i-e;return l(t,(t=>(t-e)/s))}},function(t,e,i,s,n){s();const o=t(9),{hasOwnProperty:r}=Object.prototype;function a(t){return Object.keys(t).length}i.keys=Object.keys,i.values=Object.values,i.entries=Object.entries,i.extend=Object.assign,i.clone=function(t){return Object.assign({},t)},i.merge=function(t,e){const i=Object.create(Object.prototype),s=o.concat([Object.keys(t),Object.keys(e)]);for(const n of s){const s=r.call(t,n)?t[n]:[],a=r.call(e,n)?e[n]:[];i[n]=o.union(s,a)}return i},i.size=a,i.isEmpty=function(t){return 0==a(t)},i.to_object=function(t){const e={};for(const[i,s]of t)e[i]=s;return e}},function(t,e,i,s,n){s();const o=t(1),r=t(15),a=t(17),l=o.__importStar(t(18)),c=o.__importStar(t(21)),h=t(34),_=t(13),d=t(8),u=t(26),p=t(30),m=t(35),g=t(26),f=t(36),b=t(37),v=o.__importStar(t(21));class y extends(r.Signalable()){constructor(t={}){var e,i;super(),this._subtype=void 0,this.document=null,this.destroyed=new r.Signal0(this,"destroyed"),this.change=new r.Signal0(this,"change"),this.transformchange=new r.Signal0(this,"transformchange"),this.exprchange=new r.Signal0(this,"exprchange"),this.properties={},this._pending=!1,this._changing=!1;const s=t instanceof Map?t.get.bind(t):e=>t[e];this.id=null!==(e=s("id"))&&void 0!==e?e:h.uniqueId();for(const[n,{type:o,default_value:r,options:a}]of _.entries(this._props)){let t;o instanceof l.PropertyAlias?Object.defineProperty(this.properties,n,{get:()=>this.properties[o.attr],configurable:!1,enumerable:!1}):(t=o instanceof c.Kind?new l.PrimitiveProperty(this,n,o,r,s(n),a):new o(this,n,c.Any,r,s(n),a),this.properties[n]=t)}null!==(i=s("__deferred__"))&&void 0!==i&&i||(this.finalize(),this.connect_signals())}get is_syncable(){return!0}set type(t){console.warn("prototype.type = 'ModelName' is deprecated, use static __name__ instead"),this.constructor.__name__=t}get type(){return this.constructor.__qualified__}static get __qualified__(){const{__module__:t,__name__:e}=this;return null!=t?`${t}.${e}`:e}static get[Symbol.toStringTag](){return this.__name__}static init_HasProps(){this.prototype._props={},this.prototype._mixins=[]}static _fix_default(t,e){if(void 0===t||d.isFunction(t))return t;if(d.isPrimitive(t))return()=>t;{const e=new b.Cloner;return()=>e.clone(t)}}static define(t){for(const[e,i]of _.entries(d.isFunction(t)?t(v):t)){if(null!=this.prototype._props[e])throw new Error(`attempted to redefine property '${this.prototype.type}.${e}'`);if(null!=this.prototype[e])throw new Error(`attempted to redefine attribute '${this.prototype.type}.${e}'`);Object.defineProperty(this.prototype,e,{get(){return this.properties[e].get_value()},set(t){return this.setv({[e]:t}),this},configurable:!1,enumerable:!0});const[t,s,n={}]=i,o={type:t,default_value:this._fix_default(s,e),options:n},r=Object.assign({},this.prototype._props);r[e]=o,this.prototype._props=r}}static internal(t){const e={};for(const[i,s]of _.entries(d.isFunction(t)?t(v):t)){const[t,n,o={}]=s;e[i]=[t,n,Object.assign(Object.assign({},o),{internal:!0})]}this.define(e)}static mixins(t){function e(t,e){const i={};for(const[s,n]of _.entries(e))i[t+s]=n;return i}const i={},s=[];for(const n of d.isArray(t)?t:[t])if(d.isArray(n)){const[t,o]=n;_.extend(i,e(t,o)),s.push([t,o])}else{const t=n;_.extend(i,t),s.push(["",t])}this.define(i),this.prototype._mixins=[...this.prototype._mixins,...s]}static override(t){for(const[e,i]of _.entries(t)){const t=this._fix_default(i,e),s=this.prototype._props[e];if(null==s)throw new Error(`attempted to override nonexistent '${this.prototype.type}.${e}'`);const n=Object.assign({},this.prototype._props);n[e]=Object.assign(Object.assign({},s),{default_value:t}),this.prototype._props=n}}toString(){return`${this.type}(${this.id})`}property(t){const e=this.properties[t];if(null!=e)return e;throw new Error(`unknown property ${this.type}.${t}`)}get attributes(){const t={};for(const e of this)t[e.attr]=e.get_value();return t}[b.clone](t){const e=new Map;for(const i of this)i.dirty&&e.set(i.attr,t.clone(i.get_value()));return new this.constructor(e)}[g.equals](t,e){for(const i of this){const s=t.property(i.attr);if(e.eq(i.get_value(),s.get_value()))return!1}return!0}[f.pretty](t){const e=t.token,i=[];for(const s of this)if(s.dirty){const n=s.get_value();i.push(`${s.attr}${e(":")} ${t.to_string(n)}`)}return`${this.constructor.__qualified__}${e("(")}${e("{")}${i.join(`${e(",")} `)}${e("}")}${e(")")}`}[p.serialize](t){const e=this.ref();t.add_ref(this,e);const i=this.struct();for(const s of this)s.syncable&&(t.include_defaults||s.dirty)&&(i.attributes[s.attr]=t.to_serializable(s.get_value()));return t.add_def(this,i),e}finalize(){for(const t of this){if(!(t instanceof l.VectorSpec||t instanceof l.ScalarSpec))continue;const e=t.get_value();if(null!=e){const{transform:t,expr:i}=e;null!=t&&this.connect(t.change,(()=>this.transformchange.emit())),null!=i&&this.connect(i.change,(()=>this.exprchange.emit()))}}this.initialize()}initialize(){}connect_signals(){}disconnect_signals(){r.Signal.disconnectReceiver(this)}destroy(){this.disconnect_signals(),this.destroyed.emit()}clone(){return(new b.Cloner).clone(this)}_setv(t,e){const i=e.check_eq,s=[],n=this._changing;this._changing=!0;for(const[o,r]of t)!1!==i&&u.is_equal(o.get_value(),r)||(o.set_value(r),s.push(o));s.length>0&&(this._pending=!0);for(const o of s)o.change.emit();if(!n){if(!e.no_change)for(;this._pending;)this._pending=!1,this.change.emit();this._pending=!1,this._changing=!1}}setv(t,e={}){const i=_.entries(t);if(0==i.length)return;if(!0===e.silent){for(const[t,e]of i)this.properties[t].set_value(e);return}const s=new Map,n=new Map;for(const[r,a]of i){const t=this.properties[r];s.set(t,a),n.set(t,t.get_value())}this._setv(s,e);const{document:o}=this;if(null!=o){const t=[];for(const[e,i]of n)t.push([e,i,e.get_value()]);for(const[,e,i]of t)if(this._needs_invalidate(e,i)){o._invalidate_all_models();break}this._push_changes(t,e)}}getv(t){return this.property(t).get_value()}ref(){return{id:this.id}}struct(){const t={type:this.type,id:this.id,attributes:{}};return null!=this._subtype&&(t.subtype=this._subtype),t}set_subtype(t){this._subtype=t}*[Symbol.iterator](){yield*_.values(this.properties)}*syncable_properties(){for(const t of this)t.syncable&&(yield t)}serializable_attributes(){const t={};for(const e of this.syncable_properties())t[e.attr]=e.get_value();return t}static _json_record_references(t,e,i,s){const{recursive:n}=s;if(a.is_ref(e)){const s=t.get_model_by_id(e.id);null==s||i.has(s)||y._value_record_references(s,i,{recursive:n})}else if(d.isArray(e))for(const o of e)y._json_record_references(t,o,i,{recursive:n});else if(d.isPlainObject(e))for(const o of _.values(e))y._json_record_references(t,o,i,{recursive:n})}static _value_record_references(t,e,i){const{recursive:s}=i;if(t instanceof y){if(!e.has(t)&&(e.add(t),s))for(const n of t.syncable_properties()){const t=n.get_value();y._value_record_references(t,e,{recursive:s})}}else if(d.isArray(t))for(const n of t)y._value_record_references(n,e,{recursive:s});else if(d.isPlainObject(t))for(const n of _.values(t))y._value_record_references(n,e,{recursive:s})}references(){const t=new Set;return y._value_record_references(this,t,{recursive:!0}),t}_doc_attached(){}_doc_detached(){}attach_document(t){if(null!=this.document&&this.document!=t)throw new Error("models must be owned by only a single document");this.document=t,this._doc_attached()}detach_document(){this._doc_detached(),this.document=null}_needs_invalidate(t,e){const i=new Set;y._value_record_references(e,i,{recursive:!1});const s=new Set;y._value_record_references(t,s,{recursive:!1});for(const n of i)if(!s.has(n))return!0;for(const n of s)if(!i.has(n))return!0;return!1}_push_changes(t,e={}){if(!this.is_syncable)return;const{document:i}=this;if(null==i)return;const{setter_id:s}=e,n=[];for(const[o,r,a]of t)o.syncable&&n.push(new m.ModelChangedEvent(i,this,o.attr,r,a,s));if(0!=n.length){let t;1==n.length?[t]=n:t=new m.DocumentEventBatch(i,n,s),i._trigger_on_change(t)}}on_change(t,e){for(const i of d.isArray(t)?t:[t])this.connect(i.change,e)}}i.HasProps=y,y.init_HasProps()},function(t,e,i,s,n){s();const o=t(16),r=t(9);class a{constructor(t,e){this.sender=t,this.name=e}connect(t,e=null){c.has(this.sender)||c.set(this.sender,[]);const i=c.get(this.sender);if(null!=_(i,this,t,e))return!1;const s=null!=e?e:t;h.has(s)||h.set(s,[]);const n=h.get(s),o={signal:this,slot:t,context:e};return i.push(o),n.push(o),!0}disconnect(t,e=null){const i=c.get(this.sender);if(null==i||0===i.length)return!1;const s=_(i,this,t,e);if(null==s)return!1;const n=null!=e?e:t,o=h.get(n);return s.signal=null,u(i),u(o),!0}emit(t){var e;const i=null!==(e=c.get(this.sender))&&void 0!==e?e:[];for(const{signal:s,slot:n,context:o}of i)s===this&&n.call(o,t,this.sender)}}i.Signal=a,a.__name__="Signal";class l extends a{emit(){super.emit(void 0)}}i.Signal0=l,l.__name__="Signal0",function(t){function e(t,e){const i=c.get(t);if(null==i||0===i.length)return;const s=h.get(e);if(null!=s&&0!==s.length){for(const e of s){if(null==e.signal)return;e.signal.sender===t&&(e.signal=null)}u(i),u(s)}}function i(t){var e;const i=c.get(t);if(null!=i&&0!==i.length){for(const t of i){if(null==t.signal)return;const i=null!==(e=t.context)&&void 0!==e?e:t.slot;t.signal=null,u(h.get(i))}u(i)}}function s(t,e,i){const s=h.get(t);if(null!=s&&0!==s.length){for(const t of s){if(null==t.signal)return;if(null!=e&&t.slot!=e)continue;const s=t.signal.sender;null!=i&&i.has(s)||(t.signal=null,u(c.get(s)))}u(s)}}function n(t){const e=c.get(t);if(null!=e&&0!==e.length){for(const t of e)t.signal=null;u(e)}const i=h.get(t);if(null!=i&&0!==i.length){for(const t of i)t.signal=null;u(i)}}t.disconnect_between=e,t.disconnect_sender=i,t.disconnect_receiver=s,t.disconnect_all=n,t.disconnectBetween=e,t.disconnectSender=i,t.disconnectReceiver=s,t.disconnectAll=n}(a||(i.Signal=a={})),i.Signalable=function(){return class{connect(t,e){return t.connect(e,this)}disconnect(t,e){return t.disconnect(e,this)}}};const c=new WeakMap,h=new WeakMap;function _(t,e,i,s){return r.find(t,(t=>t.signal===e&&t.slot===i&&t.context===s))}const d=new Set;function u(t){0===d.size&&(async()=>{await o.defer(),function(){for(const t of d)r.remove_by(t,(t=>null==t.signal));d.clear()}()})(),d.add(t)}},function(t,e,i,s,n){s();const o=new MessageChannel,r=new Map;o.port1.onmessage=t=>{const e=t.data,i=r.get(e);if(null!=i)try{i()}finally{r.delete(e)}};let a=1;i.defer=function(){return new Promise((t=>{const e=a++;r.set(e,t),o.port2.postMessage(e)}))}},function(t,e,i,s,n){s();const o=t(8),r=t(13);i.is_ref=function(t){if(o.isPlainObject(t)){const e=r.keys(t);return 1==e.length&&"id"==e[0]}return!1}},function(t,e,i,s,n){s(),i.YCoordinateSeqSeqSeqSpec=i.XCoordinateSeqSeqSeqSpec=i.YCoordinateSeqSpec=i.XCoordinateSeqSpec=i.YCoordinateSpec=i.XCoordinateSpec=i.CoordinateSeqSeqSeqSpec=i.CoordinateSeqSpec=i.CoordinateSpec=i.BaseCoordinateSpec=i.NumberUnitsSpec=i.UnitsSpec=i.DataSpec=i.VectorSpec=i.TextBaselineScalar=i.TextAlignScalar=i.FontStyleScalar=i.FontSizeScalar=i.FontScalar=i.LineDashScalar=i.LineCapScalar=i.LineJoinScalar=i.ArrayScalar=i.NullStringScalar=i.StringScalar=i.NumberScalar=i.ColorScalar=i.AnyScalar=i.ScalarSpec=i.VerticalAlign=i.UpdateMode=i.TooltipAttachment=i.TickLabelOrientation=i.TextureRepetition=i.TextBaseline=i.TextAlign=i.TapBehavior=i.StepMode=i.StartEnd=i.SpatialUnits=i.Sort=i.SizingMode=i.Side=i.RoundingFunction=i.ResetPolicy=i.RenderMode=i.RenderLevel=i.RadiusDimension=i.PointPolicy=i.Place=void 0,i.TextBaselineSpec=i.TextAlignSpec=i.FontStyleSpec=i.FontSizeSpec=i.FontSpec=i.LineDashSpec=i.LineCapSpec=i.LineJoinSpec=i.MarkerSpec=i.ArraySpec=i.NullStringSpec=i.StringSpec=i.AnySpec=i.NDArraySpec=i.ColorSpec=i.NumberSpec=i.BooleanSpec=i.ScreenDistanceSpec=i.NullDistanceSpec=i.DistanceSpec=i.AngleSpec=void 0;const o=t(1),r=t(15),a=t(19),l=o.__importStar(t(20)),c=t(24),h=t(9),_=t(12),d=t(10),u=t(22),p=t(27),m=t(8),g=t(28),f=t(29),b=t(33);function v(t){try{return JSON.stringify(t)}catch(e){return t.toString()}}function y(t){return m.isPlainObject(t)&&(void 0===t.value?0:1)+(void 0===t.field?0:1)+(void 0===t.expr?0:1)==1}n("Uniform",b.Uniform),n("UniformScalar",b.UniformScalar),n("UniformVector",b.UniformVector),i.isSpec=y;class x{constructor(t,e,i,s,n,o={}){var a;let l;if(this.obj=t,this.attr=e,this.kind=i,this.default_value=s,this._dirty=!1,this.change=new r.Signal0(this.obj,"change"),this.internal=null!==(a=o.internal)&&void 0!==a&&a,this.on_update=o.on_update,void 0!==n)l=n,this._dirty=!0;else{const e=this._default_override();if(void 0!==e)l=e;else{if(void 0===s)return void(this.spec={value:null});l=s(t)}}this._update(l)}get is_value(){return void 0!==this.spec.value}get syncable(){return!this.internal}get_value(){return this.spec.value}set_value(t){this._update(t),this._dirty=!0}_default_override(){}get dirty(){return this._dirty}_update(t){var e;this.validate(t),this.spec={value:t},null===(e=this.on_update)||void 0===e||e.call(this,t,this.obj)}toString(){return`Prop(${this.obj}.${this.attr}, spec: ${v(this.spec)})`}normalize(t){return t}validate(t){if(!this.valid(t))throw new Error(`${this.obj}.${this.attr} given invalid value: ${v(t)}`)}valid(t){return this.kind.valid(t)}_value(t=!0){if(!this.is_value)throw new Error("attempted to retrieve property value for property without value specification");let e=this.normalize([this.spec.value])[0];return null!=this.spec.transform&&t&&(e=this.spec.transform.compute(e)),e}}i.Property=x,x.__name__="Property";class w{constructor(t){this.attr=t}}i.PropertyAlias=w,w.__name__="PropertyAlias",i.Alias=function(t){return new w(t)};class A extends x{}i.PrimitiveProperty=A,A.__name__="PrimitiveProperty";class k extends x{}i.Any=k,k.__name__="Any";class S extends x{valid(t){return m.isArray(t)||m.isTypedArray(t)}}i.Array=S,S.__name__="Array";class T extends x{valid(t){return m.isBoolean(t)}}i.Boolean=T,T.__name__="Boolean";class C extends x{valid(t){return u.is_Color(t)}}i.Color=C,C.__name__="Color";class M extends x{}i.Instance=M,M.__name__="Instance";class E extends x{valid(t){return m.isNumber(t)}}i.Number=E,E.__name__="Number";class z extends E{valid(t){return m.isNumber(t)&&(0|t)==t}}i.Int=z,z.__name__="Int";class R extends E{}i.Angle=R,R.__name__="Angle";class B extends E{valid(t){return m.isNumber(t)&&0<=t&&t<=1}}i.Percent=B,B.__name__="Percent";class P extends x{valid(t){return m.isString(t)}}i.String=P,P.__name__="String";class N extends x{valid(t){return null===t||m.isString(t)}}i.NullString=N,N.__name__="NullString";class I extends P{}i.FontSize=I,I.__name__="FontSize";class D extends P{_default_override(){return g.settings.dev?"Bokeh":void 0}}i.Font=D,D.__name__="Font";class O extends x{valid(t){return m.isString(t)&&h.includes(this.enum_values,t)}}function L(t){return class extends O{get enum_values(){return[...t]}}}i.EnumProperty=O,O.__name__="EnumProperty",i.Enum=L;class V extends O{get enum_values(){return[...l.Direction]}normalize(t){const e=new Uint8Array(t.length);for(let i=0;i<t.length;i++)switch(t[i]){case"clock":e[i]=0;break;case"anticlock":e[i]=1}return e}}i.Direction=V,V.__name__="Direction",i.Anchor=L(l.Anchor),i.AngleUnits=L(l.AngleUnits),i.BoxOrigin=L(l.BoxOrigin),i.ButtonType=L(l.ButtonType),i.CalendarPosition=L(l.CalendarPosition),i.Dimension=L(l.Dimension),i.Dimensions=L(l.Dimensions),i.Distribution=L(l.Distribution),i.FontStyle=L(l.FontStyle),i.HatchPatternType=L(l.HatchPatternType),i.HTTPMethod=L(l.HTTPMethod),i.HexTileOrientation=L(l.HexTileOrientation),i.HoverMode=L(l.HoverMode),i.LatLon=L(l.LatLon),i.LegendClickPolicy=L(l.LegendClickPolicy),i.LegendLocation=L(l.LegendLocation),i.LineCap=L(l.LineCap),i.LineJoin=L(l.LineJoin),i.LinePolicy=L(l.LinePolicy),i.Location=L(l.Location),i.Logo=L(l.Logo),i.MarkerType=L(l.MarkerType),i.MutedPolicy=L(l.MutedPolicy),i.Orientation=L(l.Orientation),i.OutputBackend=L(l.OutputBackend),i.PaddingUnits=L(l.PaddingUnits),i.Place=L(l.Place),i.PointPolicy=L(l.PointPolicy),i.RadiusDimension=L(l.RadiusDimension),i.RenderLevel=L(l.RenderLevel),i.RenderMode=L(l.RenderMode),i.ResetPolicy=L(l.ResetPolicy),i.RoundingFunction=L(l.RoundingFunction),i.Side=L(l.Side),i.SizingMode=L(l.SizingMode),i.Sort=L(l.Sort),i.SpatialUnits=L(l.SpatialUnits),i.StartEnd=L(l.StartEnd),i.StepMode=L(l.StepMode),i.TapBehavior=L(l.TapBehavior),i.TextAlign=L(l.TextAlign),i.TextBaseline=L(l.TextBaseline),i.TextureRepetition=L(l.TextureRepetition),i.TickLabelOrientation=L(l.TickLabelOrientation),i.TooltipAttachment=L(l.TooltipAttachment),i.UpdateMode=L(l.UpdateMode),i.VerticalAlign=L(l.VerticalAlign);class j extends x{get_value(){const{value:t,expr:e,transform:i}=this.spec;return null!=e||null!=i?this.spec:t}_update(t){y(t)?this.spec=t:this.spec={value:t},null!=this.spec.value&&this.validate(this.spec.value)}materialize(t){return t}scalar(t,e){return new b.UniformScalar(t,e)}uniform(t){var e;const{expr:i,value:s,transform:n}=this.spec,o=null!==(e=t.get_length())&&void 0!==e?e:1;if(null!=i){let e=i.compute(t);return null!=n&&(e=n.compute(e)),e=this.materialize(e),this.scalar(e,o)}{let t=s;return null!=n&&(t=n.compute(t)),t=this.materialize(t),this.scalar(t,o)}}}i.ScalarSpec=j,j.__name__="ScalarSpec";class U extends j{}i.AnyScalar=U,U.__name__="AnyScalar";class F extends j{}i.ColorScalar=F,F.__name__="ColorScalar";class G extends j{}i.NumberScalar=G,G.__name__="NumberScalar";class H extends j{}i.StringScalar=H,H.__name__="StringScalar";class q extends j{}i.NullStringScalar=q,q.__name__="NullStringScalar";class Y extends j{}i.ArrayScalar=Y,Y.__name__="ArrayScalar";class J extends j{}i.LineJoinScalar=J,J.__name__="LineJoinScalar";class W extends j{}i.LineCapScalar=W,W.__name__="LineCapScalar";class X extends j{}i.LineDashScalar=X,X.__name__="LineDashScalar";class Q extends j{_default_override(){return g.settings.dev?"Bokeh":void 0}}i.FontScalar=Q,Q.__name__="FontScalar";class Z extends j{}i.FontSizeScalar=Z,Z.__name__="FontSizeScalar";class K extends j{}i.FontStyleScalar=K,K.__name__="FontStyleScalar";class $ extends j{}i.TextAlignScalar=$,$.__name__="TextAlignScalar";class tt extends j{}i.TextBaselineScalar=tt,tt.__name__="TextBaselineScalar";class et extends x{get_value(){return null===this.spec.value?null:this.spec}_update(t){y(t)?this.spec=t:this.spec={value:t},null!=this.spec.value&&this.validate(this.spec.value)}materialize(t){return t}v_materialize(t){return t}scalar(t,e){return new b.UniformScalar(t,e)}vector(t){return new b.UniformVector(t)}uniform(t){var e;const{field:i,expr:s,value:n,transform:o}=this.spec,r=null!==(e=t.get_length())&&void 0!==e?e:1;if(null!=i){let e=t.get_column(i);return null!=e?(null!=o&&(e=o.v_compute(e)),e=this.v_materialize(e),this.vector(e)):(a.logger.warn(`attempted to retrieve property array for nonexistent field '${i}'`),this.scalar(null,r))}if(null!=s){let e=s.v_compute(t);return null!=o&&(e=o.v_compute(e)),e=this.v_materialize(e),this.vector(e)}{let t=n;return null!=o&&(t=o.compute(t)),t=this.materialize(t),this.scalar(t,r)}}array(t){var e;let i;const s=null!==(e=t.get_length())&&void 0!==e?e:1;if(null!=this.spec.field){const e=t.get_column(this.spec.field);if(null!=e)i=this.normalize(e);else{a.logger.warn(`attempted to retrieve property array for nonexistent field '${this.spec.field}'`);const t=new Float64Array(s);t.fill(NaN),i=t}}else if(null!=this.spec.expr)i=this.normalize(this.spec.expr.v_compute(t));else{const t=this._value(!1);if(m.isNumber(t)){const e=new Float64Array(s);e.fill(t),i=e}else i=h.repeat(t,s)}return null!=this.spec.transform&&(i=this.spec.transform.v_compute(i)),i}}i.VectorSpec=et,et.__name__="VectorSpec";class it extends et{}i.DataSpec=it,it.__name__="DataSpec";class st extends et{_update(t){super._update(t);const{units:e}=this.spec;if(null!=e&&!h.includes(this.valid_units,e))throw new Error(`units must be one of ${this.valid_units.join(", ")}; got: ${e}`)}get units(){var t;return null!==(t=this.spec.units)&&void 0!==t?t:this.default_units}set units(t){t!=this.default_units?this.spec.units=t:delete this.spec.units}}i.UnitsSpec=st,st.__name__="UnitsSpec";class nt extends st{array(t){return new Float64Array(super.array(t))}}i.NumberUnitsSpec=nt,nt.__name__="NumberUnitsSpec";class ot extends it{}i.BaseCoordinateSpec=ot,ot.__name__="BaseCoordinateSpec";class rt extends ot{}i.CoordinateSpec=rt,rt.__name__="CoordinateSpec";class at extends ot{}i.CoordinateSeqSpec=at,at.__name__="CoordinateSeqSpec";class lt extends ot{}i.CoordinateSeqSeqSeqSpec=lt,lt.__name__="CoordinateSeqSeqSeqSpec";class ct extends rt{constructor(){super(...arguments),this.dimension="x"}}i.XCoordinateSpec=ct,ct.__name__="XCoordinateSpec";class ht extends rt{constructor(){super(...arguments),this.dimension="y"}}i.YCoordinateSpec=ht,ht.__name__="YCoordinateSpec";class _t extends at{constructor(){super(...arguments),this.dimension="x"}}i.XCoordinateSeqSpec=_t,_t.__name__="XCoordinateSeqSpec";class dt extends at{constructor(){super(...arguments),this.dimension="y"}}i.YCoordinateSeqSpec=dt,dt.__name__="YCoordinateSeqSpec";class ut extends lt{constructor(){super(...arguments),this.dimension="x"}}i.XCoordinateSeqSeqSeqSpec=ut,ut.__name__="XCoordinateSeqSeqSeqSpec";class pt extends lt{constructor(){super(...arguments),this.dimension="y"}}i.YCoordinateSeqSeqSeqSpec=pt,pt.__name__="YCoordinateSeqSeqSeqSpec";class mt extends nt{get default_units(){return"rad"}get valid_units(){return[...l.AngleUnits]}materialize(t){return t*-d.to_radians_coeff(this.units)}v_materialize(t){const e=-d.to_radians_coeff(this.units),i=new Float32Array(t.length);return _.mul(t,e,i),i}array(t){throw new Error("not supported")}}i.AngleSpec=mt,mt.__name__="AngleSpec";class gt extends nt{get default_units(){return"data"}get valid_units(){return[...l.SpatialUnits]}}i.DistanceSpec=gt,gt.__name__="DistanceSpec";class ft extends gt{materialize(t){return null!=t?t:NaN}}i.NullDistanceSpec=ft,ft.__name__="NullDistanceSpec";class bt extends gt{get default_units(){return"screen"}}i.ScreenDistanceSpec=bt,bt.__name__="ScreenDistanceSpec";class vt extends it{v_materialize(t){return new Uint8Array(t)}array(t){return new Uint8Array(super.array(t))}}i.BooleanSpec=vt,vt.__name__="BooleanSpec";class yt extends it{v_materialize(t){return m.isTypedArray(t)?t:new Float64Array(t)}array(t){return new Float64Array(super.array(t))}}i.NumberSpec=yt,yt.__name__="NumberSpec";class xt extends it{materialize(t){return u.encode_rgba(u.color2rgba(t))}v_materialize(t){if(!f.is_NDArray(t)){const e=t.length,i=new c.RGBAArray(4*e);let s=0;for(const n of t){const[t,e,o,r]=u.color2rgba(n);i[s++]=t,i[s++]=e,i[s++]=o,i[s++]=r}return new c.ColorArray(i.buffer)}if("uint32"==t.dtype&&1==t.dimension)return p.to_big_endian(t);if("uint8"==t.dtype&&1==t.dimension){const[e]=t.shape,i=new c.RGBAArray(4*e);let s=0;for(const n of t)i[s++]=n,i[s++]=n,i[s++]=n,i[s++]=255;return new c.ColorArray(i.buffer)}if("uint8"==t.dtype&&2==t.dimension){const[e,i]=t.shape;if(4==i)return new c.ColorArray(t.buffer);if(3==i){const s=new c.RGBAArray(4*e);for(let n=0,o=0;n<i*e;)s[o++]=t[n++],s[o++]=t[n++],s[o++]=t[n++],s[o++]=255;return new c.ColorArray(s.buffer)}}else if(("float32"==t.dtype||"float64"==t.dtype)&&2==t.dimension){const[e,i]=t.shape;if(3==i||4==i){const s=new c.RGBAArray(4*e);for(let n=0,o=0;n<i*e;)s[o++]=255*t[n++],s[o++]=255*t[n++],s[o++]=255*t[n++],s[o++]=255*(3==i?1:t[n++]);return new c.ColorArray(s.buffer)}}throw new Error("invalid color array")}vector(t){return new b.ColorUniformVector(t)}}i.ColorSpec=xt,xt.__name__="ColorSpec";class wt extends it{}i.NDArraySpec=wt,wt.__name__="NDArraySpec";class At extends it{}i.AnySpec=At,At.__name__="AnySpec";class kt extends it{}i.StringSpec=kt,kt.__name__="StringSpec";class St extends it{}i.NullStringSpec=St,St.__name__="NullStringSpec";class Tt extends it{}i.ArraySpec=Tt,Tt.__name__="ArraySpec";class Ct extends it{}i.MarkerSpec=Ct,Ct.__name__="MarkerSpec";class Mt extends it{}i.LineJoinSpec=Mt,Mt.__name__="LineJoinSpec";class Et extends it{}i.LineCapSpec=Et,Et.__name__="LineCapSpec";class zt extends it{}i.LineDashSpec=zt,zt.__name__="LineDashSpec";class Rt extends it{_default_override(){return g.settings.dev?"Bokeh":void 0}}i.FontSpec=Rt,Rt.__name__="FontSpec";class Bt extends it{}i.FontSizeSpec=Bt,Bt.__name__="FontSizeSpec";class Pt extends it{}i.FontStyleSpec=Pt,Pt.__name__="FontStyleSpec";class Nt extends it{}i.TextAlignSpec=Nt,Nt.__name__="TextAlignSpec";class It extends it{}i.TextBaselineSpec=It,It.__name__="TextBaselineSpec"},function(t,e,i,s,n){s();const o=t(8),r=t(13),a={};class l{constructor(t,e){this.name=t,this.level=e}}i.LogLevel=l,l.__name__="LogLevel";class c{constructor(t,e=c.INFO){this._name=t,this.set_level(e)}static get levels(){return Object.keys(c.log_levels)}static get(t,e=c.INFO){if(t.length>0){let i=a[t];return null==i&&(a[t]=i=new c(t,e)),i}throw new TypeError("Logger.get() expects a non-empty string name and an optional log-level")}get level(){return this.get_level()}get_level(){return this._log_level}set_level(t){if(t instanceof l)this._log_level=t;else{if(!o.isString(t)||null==c.log_levels[t])throw new Error("Logger.set_level() expects a log-level object or a string name of a log-level");this._log_level=c.log_levels[t]}const e=`[${this._name}]`;for(const[i,s]of r.entries(c.log_levels))s.level<this._log_level.level||this._log_level.level===c.OFF.level?this[i]=function(){}:this[i]=h(i,e)}trace(...t){}debug(...t){}info(...t){}warn(...t){}error(...t){}}function h(t,e){return null!=console[t]?console[t].bind(console,e):null!=console.log?console.log.bind(console,e):function(){}}function _(t){const e=i.logger.level;return o.isString(t)&&null==c.log_levels[t]?(console.log(`[bokeh] unrecognized logging level '${t}' passed to Bokeh.set_log_level(), ignoring`),console.log(`[bokeh] valid log levels are: ${c.levels.join(", ")}`)):(console.log(`[bokeh] setting log level to: '${o.isString(t)?t:t.level}'`),i.logger.set_level(t)),e}i.Logger=c,c.__name__="Logger",c.TRACE=new l("trace",0),c.DEBUG=new l("debug",1),c.INFO=new l("info",2),c.WARN=new l("warn",6),c.ERROR=new l("error",7),c.FATAL=new l("fatal",8),c.OFF=new l("off",9),c.log_levels={trace:c.TRACE,debug:c.DEBUG,info:c.INFO,warn:c.WARN,error:c.ERROR,fatal:c.FATAL,off:c.OFF},i.logger=c.get("bokeh"),i.set_log_level=_,i.with_log_level=function(t,e){const i=_(t);try{e()}finally{_(i)}}},function(t,e,i,s,n){s(),i.VerticalAlign=void 0;const o=t(21);i.Align=o.Enum("start","center","end"),i.Anchor=o.Enum("top_left","top_center","top_right","center_left","center_center","center_right","bottom_left","bottom_center","bottom_right","top","left","center","right","bottom"),i.AngleUnits=o.Enum("deg","rad","grad","turn"),i.BoxOrigin=o.Enum("corner","center"),i.ButtonType=o.Enum("default","primary","success","warning","danger","light"),i.CalendarPosition=o.Enum("auto","above","below"),i.Dimension=o.Enum("width","height"),i.Dimensions=o.Enum("width","height","both"),i.Direction=o.Enum("clock","anticlock"),i.Distribution=o.Enum("uniform","normal"),i.FontStyle=o.Enum("normal","italic","bold","bold italic"),i.HatchPatternType=o.Enum("blank","dot","ring","horizontal_line","vertical_line","cross","horizontal_dash","vertical_dash","spiral","right_diagonal_line","left_diagonal_line","diagonal_cross","right_diagonal_dash","left_diagonal_dash","horizontal_wave","vertical_wave","criss_cross"," ",".","o","-","|","+",'"',":","@","/","\\","x",",","`","v",">","*"),i.HTTPMethod=o.Enum("POST","GET"),i.HexTileOrientation=o.Enum("pointytop","flattop"),i.HoverMode=o.Enum("mouse","hline","vline"),i.LatLon=o.Enum("lat","lon"),i.LegendClickPolicy=o.Enum("none","hide","mute"),i.LegendLocation=i.Anchor,i.LineCap=o.Enum("butt","round","square"),i.LineJoin=o.Enum("miter","round","bevel"),i.LineDash=o.Enum("solid","dashed","dotted","dotdash","dashdot"),i.LinePolicy=o.Enum("prev","next","nearest","interp","none"),i.Location=o.Enum("above","below","left","right"),i.Logo=o.Enum("normal","grey"),i.MarkerType=o.Enum("asterisk","circle","circle_cross","circle_dot","circle_x","circle_y","cross","dash","diamond","diamond_cross","diamond_dot","dot","hex","hex_dot","inverted_triangle","plus","square","square_cross","square_dot","square_pin","square_x","star","star_dot","triangle","triangle_dot","triangle_pin","x","y"),i.MutedPolicy=o.Enum("show","ignore"),i.Orientation=o.Enum("vertical","horizontal"),i.OutputBackend=o.Enum("canvas","svg","webgl"),i.PaddingUnits=o.Enum("percent","absolute"),i.Place=o.Enum("above","below","left","right","center"),i.PointPolicy=o.Enum("snap_to_data","follow_mouse","none"),i.RadiusDimension=o.Enum("x","y","max","min"),i.RenderLevel=o.Enum("image","underlay","glyph","guide","annotation","overlay"),i.RenderMode=o.Enum("canvas","css"),i.ResetPolicy=o.Enum("standard","event_only"),i.RoundingFunction=o.Enum("round","nearest","floor","rounddown","ceil","roundup"),i.SelectionMode=o.Enum("replace","append","intersect","subtract"),i.Side=o.Enum("above","below","left","right"),i.SizingMode=o.Enum("stretch_width","stretch_height","stretch_both","scale_width","scale_height","scale_both","fixed"),i.Sort=o.Enum("ascending","descending"),i.SpatialUnits=o.Enum("screen","data"),i.StartEnd=o.Enum("start","end"),i.StepMode=o.Enum("after","before","center"),i.TapBehavior=o.Enum("select","inspect"),i.TextAlign=o.Enum("left","right","center"),i.TextBaseline=o.Enum("top","middle","bottom","alphabetic","hanging","ideographic"),i.TextureRepetition=o.Enum("repeat","repeat_x","repeat_y","no_repeat"),i.TickLabelOrientation=o.Enum("vertical","horizontal","parallel","normal"),i.TooltipAttachment=o.Enum("horizontal","vertical","left","right","above","below"),i.UpdateMode=o.Enum("replace","append"),i.VerticalAlign=o.Enum("top","middle","bottom")},function(t,e,i,s,n){s();const o=t(1).__importStar(t(8)),r=t(22),a=t(13),l=window.Map,{hasOwnProperty:c}=Object.prototype;class h{}i.Kind=h,h.__name__="Kind",function(t){class e extends h{valid(t){return!0}}e.__name__="Any",t.Any=e;class i extends h{valid(t){return!0}}i.__name__="Unknown",t.Unknown=i;class s extends h{valid(t){return o.isBoolean(t)}}s.__name__="Boolean",t.Boolean=s;class n extends h{constructor(t){super(),this.obj_type=t}valid(t){return!0}}n.__name__="Ref",t.Ref=n;class _ extends h{valid(t){return!0}}_.__name__="AnyRef",t.AnyRef=_;class d extends h{valid(t){return o.isNumber(t)}}d.__name__="Number",t.Number=d;class u extends d{valid(t){return super.valid(t)&&o.isInteger(t)}}u.__name__="Int",t.Int=u;class p extends d{valid(t){return super.valid(t)&&0<=t&&t<=1}}p.__name__="Percent",t.Percent=p;class m extends h{constructor(t){super(),this.types=t,this.types=t}valid(t){return this.types.some((e=>e.valid(t)))}}m.__name__="Or",t.Or=m;class g extends h{constructor(t){super(),this.types=t,this.types=t}valid(t){if(!o.isArray(t))return!1;for(let e=0;e<this.types.length;e++){const i=this.types[e],s=t[e];if(!i.valid(s))return!1}return!0}}g.__name__="Tuple",t.Tuple=g;class f extends h{constructor(t){super(),this.struct_type=t}valid(t){if(!o.isPlainObject(t))return!1;const{struct_type:e}=this;if(a.size(e)!=a.size(t))return!1;for(const i in e)if(c.call(e,i)){if(!c.call(t,i))return!1;const s=e[i],n=t[i];if(!s.valid(n))return!1}return!0}}f.__name__="Struct",t.Struct=f;class b extends h{valid(t){return o.isArray(t)||o.isTypedArray(t)}}b.__name__="Arrayable",t.Arrayable=b;class v extends h{constructor(t){super(),this.item_type=t}valid(t){return o.isArray(t)&&t.every((t=>this.item_type.valid(t)))}}v.__name__="Array",t.Array=v;class y extends h{valid(t){return null===t}}y.__name__="Null",t.Null=y;class x extends h{constructor(t){super(),this.base_type=t}valid(t){return null===t||this.base_type.valid(t)}}x.__name__="Nullable",t.Nullable=x;class w extends h{constructor(t){super(),this.base_type=t}valid(t){return void 0===t||this.base_type.valid(t)}}w.__name__="Opt",t.Opt=w;class A extends h{valid(t){return o.isString(t)}}A.__name__="String",t.String=A;class k extends h{constructor(t){super(),this.values=new Set(t)}valid(t){return this.values.has(t)}*[Symbol.iterator](){yield*this.values}}k.__name__="Enum",t.Enum=k;class S extends h{constructor(t){super(),this.item_type=t}valid(t){if(!o.isPlainObject(t))return!1;for(const e in t)if(c.call(t,e)){const i=t[e];if(!this.item_type.valid(i))return!1}return!0}}S.__name__="Dict",t.Dict=S;class T extends h{constructor(t,e){super(),this.key_type=t,this.item_type=e}valid(t){if(!(t instanceof l))return!1;for(const[e,i]of t.entries())if(!this.key_type.valid(e)||!this.item_type.valid(i))return!1;return!0}}T.__name__="Map",t.Map=T;class C extends h{valid(t){return r.is_Color(t)}}C.__name__="Color",t.Color=C;class M extends h{valid(t){return o.isFunction(t)}}M.__name__="Function",t.Function=M}(i.Kinds||(i.Kinds={})),i.Any=new i.Kinds.Any,i.Unknown=new i.Kinds.Unknown,i.Boolean=new i.Kinds.Boolean,i.Number=new i.Kinds.Number,i.Int=new i.Kinds.Int,i.String=new i.Kinds.String,i.Null=new i.Kinds.Null,i.Nullable=t=>new i.Kinds.Nullable(t),i.Opt=t=>new i.Kinds.Opt(t),i.Or=(...t)=>new i.Kinds.Or(t),i.Tuple=(...t)=>new i.Kinds.Tuple(t),i.Struct=t=>new i.Kinds.Struct(t),i.Arrayable=new i.Kinds.Arrayable,i.Array=t=>new i.Kinds.Array(t),i.Dict=t=>new i.Kinds.Dict(t),i.Map=(t,e)=>new i.Kinds.Map(t,e),i.Enum=(...t)=>new i.Kinds.Enum(t),i.Ref=t=>new i.Kinds.Ref(t),i.AnyRef=()=>new i.Kinds.AnyRef,i.Function=()=>new i.Kinds.Function,i.Percent=new i.Kinds.Percent,i.Alpha=i.Percent,i.Color=new i.Kinds.Color,i.Auto=i.Enum("auto"),i.FontSize=i.String,i.Font=i.String,i.Angle=i.Number},function(t,e,i,s,n){s();const o=t(23),r=t(10),a=t(8),{round:l}=Math;function c(t){return r.clamp(l(t),0,255)}function h(){return[0,0,0,0]}function _(t){return[t>>24&255,t>>16&255,t>>8&255,255&t]}function d(t,e){var i;let s,n,o,r;return null==t?[s,n,o,r]=[0,0,0,0]:a.isInteger(t)?[s,n,o,r]=_(t):a.isString(t)?[s,n,o,r]=null!==(i=b(t))&&void 0!==i?i:[0,0,0,0]:([s,n,o,r=1]=t,r=c(255*r)),255==r&&null!=e&&(r=c(255*e)),[s,n,o,r]}i.transparent=h,i.encode_rgba=function([t,e,i,s]){return t<<24|e<<16|i<<8|s},i.decode_rgba=_,i.compose_alpha=function(t,e){return 255==(255&t)?4294967040&t|c(255*e):t},i.color2rgba=d;const u={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"a",11:"b",12:"c",13:"d",14:"e",15:"f"};function p(t){return u[t>>4]+u[15&t]}i.color2css=function(t,e){const[i,s,n,o]=d(t,e);return`rgba(${i}, ${s}, ${n}, ${o/255})`},i.color2hex=function(t,e){const[i,s,n,o]=d(t,e),r=`#${p(i)}${p(s)}${p(n)}`;return 255==o?r:`${r}${p(o)}`},i.color2hexrgb=function(t){const[e,i,s]=d(t);return`#${p(e)}${p(i)}${p(s)}`};const m=/^rgba?\(\s*([^\s,]+?)\s+([^\s,]+?)\s+([^\s,]+?)(?:\s*\/\s*([^\s,]+?))?\s*\)$/,g=/^rgba?\(\s*([^\s,]+?)\s*,\s*([^\s,]+?)\s*,\s*([^\s,]+?)(?:\s*,\s*([^\s,]+?))?\s*\)$/,f=(()=>{const t=document.createElement("canvas");t.width=1,t.height=1;const e=t.getContext("2d"),i=e.createLinearGradient(0,0,1,1);return t=>{e.fillStyle=i,e.fillStyle=t;const s=e.fillStyle;return s!=i?s:null}})();function b(t){var e;if(!(t=t.trim().toLowerCase()))return null;if("transparent"==t)return[0,0,0,0];if(o.is_named_color(t))return _(o.named_colors[t]);if("#"==t[0]){const e=Number("0x"+t.substr(1));if(isNaN(e))return null;switch(t.length-1){case 3:{const t=e>>8&15,i=e>>4&15,s=e>>0&15;return[t<<4|t,i<<4|i,s<<4|s,255]}case 4:{const t=e>>12&15,i=e>>8&15,s=e>>4&15,n=e>>0&15;return[t<<4|t,i<<4|i,s<<4|s,n<<4|n]}case 6:return[e>>16&255,e>>8&255,e>>0&255,255];case 8:return[e>>24&255,e>>16&255,e>>8&255,e>>0&255]}}else if(t.startsWith("rgb")){const i=null!==(e=t.match(m))&&void 0!==e?e:t.match(g);if(null!=i){let[,t,e,s,n="1"]=i;const o=t.endsWith("%"),r=e.endsWith("%"),a=s.endsWith("%"),l=n.endsWith("%");if(!(o&&r&&a)&&(o||r||a))return null;o&&(t=t.slice(0,-1)),r&&(e=e.slice(0,-1)),a&&(s=s.slice(0,-1)),l&&(n=n.slice(0,-1));let h=Number(t),_=Number(e),d=Number(s),u=Number(n);return isNaN(h+_+d+u)?null:(o&&(h=h/100*255),r&&(_=_/100*255),a&&(d=d/100*255),u=255*(l?u/100:u),h=c(h),_=c(_),d=c(d),u=c(u),[h,_,d,u])}}else{const e=f(t);if(null!=e)return b(e)}return null}i.css4_parse=b,i.is_Color=function(t){return!!a.isInteger(t)||!(!a.isString(t)||null==b(t))||!(!a.isArray(t)||3!=t.length&&4!=t.length)},i.is_dark=function([t,e,i]){return 1-(.299*t+.587*e+.114*i)/255>=.6}},function(t,e,i,s,n){s(),i.named_colors={aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},i.is_named_color=function(t){return t in i.named_colors}},function(t,e,i,s,n){s(),i.GeneratorFunction=Object.getPrototypeOf((function*(){})).constructor,i.ColorArray=Uint32Array,i.RGBAArray=Uint8ClampedArray,i.infer_type=function(t,e){return t instanceof Float64Array||t instanceof Array||e instanceof Float64Array||e instanceof Array?Float64Array:Float32Array},i.ScreenArray=Float32Array,i.to_screen=function(t){return t instanceof Float32Array?t:new Float32Array(t)},n("Indices",t(25).BitSet)},function(t,e,i,s,n){s();const o=t(26),r=t(11);class a{constructor(t,e=0){this.size=t,this[Symbol.toStringTag]="BitSet",this._count=null,this._nwords=Math.ceil(t/32),0==e||1==e?(this._array=new Uint32Array(this._nwords),1==e&&this._array.fill(4294967295)):(r.assert(e.length==this._nwords,"Initializer size mismatch"),this._array=e)}clone(){return new a(this.size,new Uint32Array(this._array))}[o.equals](t,e){if(!e.eq(this.size,t.size))return!1;const{_nwords:i}=this,s=this.size%i,n=0==s?i:i-1;for(let o=0;o<n;o++)if(this._array[o]!=t._array[o])return!1;if(0==s)return!0;{const e=1<<s-1,i=e-1^e;return(this._array[n]&i)==(t._array[n]&i)}}static all_set(t){return new a(t,1)}static all_unset(t){return new a(t,0)}static from_indices(t,e){const i=new a(t);for(const s of e)i.set(s);return i}static from_booleans(t,e){const i=new a(t),s=Math.min(t,e.length);for(let n=0;n<s;n++)e[n]&&i.set(n);return i}_check_bounds(t){r.assert(0<=t&&t<this.size,`Out of bounds: 0 <= ${t} < ${this.size}`)}get(t){this._check_bounds(t);const e=t>>>5,i=31&t;return!!(this._array[e]>>i&1)}set(t,e=!0){this._check_bounds(t),this._count=null;const i=t>>>5,s=31&t;e?this._array[i]|=1<<s:this._array[i]&=~(1<<s)}unset(t){this.set(t,!1)}*[Symbol.iterator](){yield*this.ones()}get count(){let t=this._count;return null==t&&(this._count=t=this._get_count()),t}_get_count(){const{_array:t,_nwords:e,size:i}=this;let s=0;for(let n=0,o=0;o<e;o++){const e=t[o];if(0==e)n+=32;else for(let t=0;t<32&&n<i;t++,n++)e>>>t&1&&(s+=1)}return s}*ones(){const{_array:t,_nwords:e,size:i}=this;for(let s=0,n=0;n<e;n++){const e=t[n];if(0!=e)for(let t=0;t<32&&s<i;t++,s++)e>>>t&1&&(yield s);else s+=32}}*zeros(){const{_array:t,_nwords:e,size:i}=this;for(let s=0,n=0;n<e;n++){const e=t[n];if(4294967295!=e)for(let t=0;t<32&&s<i;t++,s++)e>>>t&1||(yield s);else s+=32}}_check_size(t){r.assert(this.size==t.size,"Size mismatch")}add(t){this._check_size(t);for(let e=0;e<this._nwords;e++)this._array[e]|=t._array[e]}intersect(t){this._check_size(t);for(let e=0;e<this._nwords;e++)this._array[e]&=t._array[e]}subtract(t){this._check_size(t);for(let e=0;e<this._nwords;e++){const i=this._array[e],s=t._array[e];this._array[e]=(i^s)&i}}union(t){this._check_size(t);const e=this.clone();for(let i=0;i<this._nwords;i++)e._array[i]|=t._array[i];return e}intersection(t){this._check_size(t);const e=this.clone();for(let i=0;i<this._nwords;i++)e._array[i]&=t._array[i];return e}difference(t){this._check_size(t);const e=this.clone();for(let i=0;i<this._nwords;i++){const s=this._array[i],n=t._array[i];e._array[i]=(s^n)&s}return e}select(t){r.assert(this.size<=t.length,"Size mismatch");const e=this.count,i=new t.constructor(e);let s=0;for(const n of this)i[s++]=t[n];return i}}i.BitSet=a,a.__name__="BitSet"},function(t,e,i,s,n){s();const o=t(8),{hasOwnProperty:r}=Object.prototype;function a(t){return o.isObject(t)&&void 0!==t[i.equals]}i.equals=Symbol("equals"),i.wildcard=Symbol("wildcard");const l=Object.prototype.toString;class c{constructor(){this.a_stack=[],this.b_stack=[]}eq(t,e){if(Object.is(t,e))return!0;if(t===i.wildcard||e===i.wildcard)return!0;if(null==t||null==e)return t===e;const s=l.call(t);if(s!=l.call(e))return!1;switch(s){case"[object Number]":return this.numbers(t,e);case"[object RegExp]":case"[object String]":return`${t}`==`${e}`;case"[object Date]":case"[object Boolean]":return+t==+e}const{a_stack:n,b_stack:o}=this;let r=n.length;for(;r--;)if(n[r]===t)return o[r]===e;n.push(t),o.push(e);const c=(()=>{if(a(t)&&a(e))return t[i.equals](e,this);switch(s){case"[object Array]":case"[object Uint8Array]":case"[object Int8Array]":case"[object Uint16Array]":case"[object Int16Array]":case"[object Uint32Array]":case"[object Int32Array]":case"[object Float32Array]":case"[object Float64Array]":return this.arrays(t,e);case"[object Map]":return this.maps(t,e);case"[object Set]":return this.sets(t,e);case"[object Object]":if(t.constructor==e.constructor&&(null==t.constructor||t.constructor===Object))return this.objects(t,e);case"[object Function]":if(t.constructor==e.constructor&&t.constructor===Function)return this.eq(`${t}`,`${e}`)}if(t instanceof Node)return this.nodes(t,e);throw Error(`can't compare objects of type ${s}`)})();return n.pop(),o.pop(),c}numbers(t,e){return Object.is(t,e)}arrays(t,e){const{length:i}=t;if(i!=e.length)return!1;for(let s=0;s<i;s++)if(!this.eq(t[s],e[s]))return!1;return!0}iterables(t,e){const i=t[Symbol.iterator](),s=e[Symbol.iterator]();for(;;){const t=i.next(),e=s.next();if(t.done&&e.done)return!0;if(t.done||e.done)return!1;if(!this.eq(t.value,e.value))return!1}}maps(t,e){if(t.size!=e.size)return!1;for(const[i,s]of t)if(!e.has(i)||!this.eq(s,e.get(i)))return!1;return!0}sets(t,e){if(t.size!=e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0}objects(t,e){const i=Object.keys(t);if(i.length!=Object.keys(e).length)return!1;for(const s of i)if(!r.call(e,s)||!this.eq(t[s],e[s]))return!1;return!0}nodes(t,e){return t.nodeType==e.nodeType&&t.textContent==e.textContent&&!!this.iterables(t.childNodes,e.childNodes)}}i.Comparator=c,c.__name__="Comparator";const{abs:h}=Math;class _ extends c{constructor(t=1e-4){super(),this.tolerance=t}numbers(t,e){return super.numbers(t,e)||h(t-e)<this.tolerance}}function d(t,e){return(new c).eq(t,e)}i.SimilarComparator=_,_.__name__="SimilarComparator",i.is_equal=d,i.is_similar=function(t,e,i){return new _(i).eq(t,e)},i.isEqual=d},function(t,e,i,s,n){s(),i.is_windows=navigator.appVersion.includes("Windows"),i.is_ie=(()=>{const t=navigator.userAgent;return t.includes("MSIE")||t.includes("Trident")||t.includes("Edge")})(),i.is_mobile="undefined"!=typeof window&&("ontouchstart"in window||navigator.maxTouchPoints>0),i.is_little_endian=(()=>{const t=new ArrayBuffer(4),e=new Uint8Array(t);new Uint32Array(t)[1]=168496141;let i=!0;return 10==e[4]&&11==e[5]&&12==e[6]&&13==e[7]&&(i=!1),i})(),i.BYTE_ORDER=i.is_little_endian?"little":"big",i.to_big_endian=function(t){if(i.is_little_endian){const e=new Uint32Array(t.length),i=new DataView(e.buffer);let s=0;for(const n of t)i.setUint32(s,n),s+=4;return e}return t}},function(t,e,i,s,n){s();class o{constructor(){this._dev=!1,this._wireframe=!1}set dev(t){this._dev=t}get dev(){return this._dev}set wireframe(t){this._wireframe=t}get wireframe(){return this._wireframe}}i.Settings=o,o.__name__="Settings",i.settings=new o},function(t,e,i,s,n){var o,r,a,l,c,h,_,d;s();const u=t(8),p=t(11),m=t(26),g=t(30),f=t(31),b=Symbol("__ndarray__");class v extends Uint8Array{constructor(t,e){super(t),this[o]=!0,this.dtype="uint8",this.shape=null!=e?e:C(t)?t.shape:[this.length],this.dimension=this.shape.length}[(o=b,m.equals)](t,e){return e.eq(this.shape,t.shape)&&e.arrays(this,t)}[g.serialize](t){return f.encode_NDArray(this)}}i.Uint8NDArray=v,v.__name__="Uint8NDArray";class y extends Int8Array{constructor(t,e){super(t),this[r]=!0,this.dtype="int8",this.shape=null!=e?e:C(t)?t.shape:[this.length],this.dimension=this.shape.length}[(r=b,m.equals)](t,e){return e.eq(this.shape,t.shape)&&e.arrays(this,t)}[g.serialize](t){return f.encode_NDArray(this)}}i.Int8NDArray=y,y.__name__="Int8NDArray";class x extends Uint16Array{constructor(t,e){super(t),this[a]=!0,this.dtype="uint16",this.shape=null!=e?e:C(t)?t.shape:[this.length],this.dimension=this.shape.length}[(a=b,m.equals)](t,e){return e.eq(this.shape,t.shape)&&e.arrays(this,t)}[g.serialize](t){return f.encode_NDArray(this)}}i.Uint16NDArray=x,x.__name__="Uint16NDArray";class w extends Int16Array{constructor(t,e){super(t),this[l]=!0,this.dtype="int16",this.shape=null!=e?e:C(t)?t.shape:[this.length],this.dimension=this.shape.length}[(l=b,m.equals)](t,e){return e.eq(this.shape,t.shape)&&e.arrays(this,t)}[g.serialize](t){return f.encode_NDArray(this)}}i.Int16NDArray=w,w.__name__="Int16NDArray";class A extends Uint32Array{constructor(t,e){super(t),this[c]=!0,this.dtype="uint32",this.shape=null!=e?e:C(t)?t.shape:[this.length],this.dimension=this.shape.length}[(c=b,m.equals)](t,e){return e.eq(this.shape,t.shape)&&e.arrays(this,t)}[g.serialize](t){return f.encode_NDArray(this)}}i.Uint32NDArray=A,A.__name__="Uint32NDArray";class k extends Int32Array{constructor(t,e){super(t),this[h]=!0,this.dtype="int32",this.shape=null!=e?e:C(t)?t.shape:[this.length],this.dimension=this.shape.length}[(h=b,m.equals)](t,e){return e.eq(this.shape,t.shape)&&e.arrays(this,t)}[g.serialize](t){return f.encode_NDArray(this)}}i.Int32NDArray=k,k.__name__="Int32NDArray";class S extends Float32Array{constructor(t,e){super(t),this[_]=!0,this.dtype="float32",this.shape=null!=e?e:C(t)?t.shape:[this.length],this.dimension=this.shape.length}[(_=b,m.equals)](t,e){return e.eq(this.shape,t.shape)&&e.arrays(this,t)}[g.serialize](t){return f.encode_NDArray(this)}}i.Float32NDArray=S,S.__name__="Float32NDArray";class T extends Float64Array{constructor(t,e){super(t),this[d]=!0,this.dtype="float64",this.shape=null!=e?e:C(t)?t.shape:[this.length],this.dimension=this.shape.length}[(d=b,m.equals)](t,e){return e.eq(this.shape,t.shape)&&e.arrays(this,t)}[g.serialize](t){return f.encode_NDArray(this)}}function C(t){return u.isObject(t)&&void 0!==t[b]}i.Float64NDArray=T,T.__name__="Float64NDArray",i.is_NDArray=C,i.ndarray=function(t,e={}){let{dtype:i}=e;null==i&&(i=t instanceof ArrayBuffer||u.isArray(t)?"float64":(()=>{switch(!0){case t instanceof Uint8Array:return"uint8";case t instanceof Int8Array:return"int8";case t instanceof Uint16Array:return"uint16";case t instanceof Int16Array:return"int16";case t instanceof Uint32Array:return"uint32";case t instanceof Int32Array:return"int32";case t instanceof Float32Array:return"float32";case t instanceof Float64Array:return"float64";default:p.unreachable()}})());const{shape:s}=e;switch(i){case"uint8":return new v(t,s);case"int8":return new y(t,s);case"uint16":return new x(t,s);case"int16":return new w(t,s);case"uint32":return new A(t,s);case"int32":return new k(t,s);case"float32":return new S(t,s);case"float64":return new T(t,s)}}},function(t,e,i,s,n){s();const o=t(11),r=t(13),a=t(8);i.serialize=Symbol("serialize");class l extends Error{}i.SerializationError=l,l.__name__="SerializationError";class c{constructor(t){var e;this._references=new Map,this._definitions=new Map,this._refmap=new Map,this.include_defaults=null===(e=null==t?void 0:t.include_defaults)||void 0===e||e}get_ref(t){return this._references.get(t)}add_ref(t,e){o.assert(!this._references.has(t)),this._references.set(t,e)}add_def(t,e){const i=this.get_ref(t);o.assert(null!=i),this._definitions.set(t,e),this._refmap.set(i,e)}get objects(){return new Set(this._references.keys())}get references(){return new Set(this._references.values())}get definitions(){return new Set(this._definitions.values())}resolve_ref(t){return this._refmap.get(t)}remove_ref(t){return this._references.delete(t)}remove_def(t){return this._definitions.delete(t)}to_serializable(t){const e=this.get_ref(t);if(null!=e)return e;if(function(t){return a.isObject(t)&&void 0!==t[i.serialize]}(t))return t[i.serialize](this);if(a.isArray(t)||a.isTypedArray(t)){const e=t.length,i=new Array(e);for(let s=0;s<e;s++){const e=t[s];i[s]=this.to_serializable(e)}return i}if(a.isPlainObject(t)){const e={};for(const[i,s]of r.entries(t))e[i]=this.to_serializable(s);return e}if(null===t||a.isBoolean(t)||a.isNumber(t)||a.isString(t))return t;throw new l(`${Object.prototype.toString.call(t)} is not serializable`)}}i.Serializer=c,c.__name__="Serializer"},function(t,e,i,s,n){s();const o=t(1),r=t(8),a=o.__importStar(t(29)),l=t(27),c=t(32);i.is_NDArray_ref=function(t){return r.isPlainObject(t)&&("__buffer__"in t||"__ndarray__"in t)},i.decode_NDArray=function(t,e){const{shape:i,dtype:s,order:n}=t;let o;if("__buffer__"in t){const i=e.get(t.__buffer__);if(null==i)throw new Error(`buffer for ${t.__buffer__} not found`);o=i}else o=c.base64_to_buffer(t.__ndarray__);const r=(()=>{switch(s){case"uint8":return new a.Uint8NDArray(o,i);case"int8":return new a.Int8NDArray(o,i);case"uint16":return new a.Uint16NDArray(o,i);case"int16":return new a.Int16NDArray(o,i);case"uint32":return new a.Uint32NDArray(o,i);case"int32":return new a.Int32NDArray(o,i);case"float32":return new a.Float32NDArray(o,i);case"float64":return new a.Float64NDArray(o,i)}})();return n!==l.BYTE_ORDER&&c.swap(r),r},i.encode_NDArray=function(t,e){const i={order:l.BYTE_ORDER,dtype:t.dtype,shape:t.shape};if(null!=e){const s=`${e.size}`;return e.set(s,t.buffer),Object.assign({__buffer__:s},i)}{const e=c.buffer_to_base64(t.buffer);return Object.assign({__ndarray__:e},i)}}},function(t,e,i,s,n){s(),i.buffer_to_base64=function(t){const e=new Uint8Array(t),i=Array.from(e).map((t=>String.fromCharCode(t)));return btoa(i.join(""))},i.base64_to_buffer=function(t){const e=atob(t),i=e.length,s=new Uint8Array(i);for(let n=0,o=i;n<o;n++)s[n]=e.charCodeAt(n);return s.buffer},i.swap=function(t){switch(t.BYTES_PER_ELEMENT){case 2:!function(t){const e=new Uint8Array(t.buffer,t.byteOffset,2*t.length);for(let i=0,s=e.length;i<s;i+=2){const t=e[i];e[i]=e[i+1],e[i+1]=t}}(t);break;case 4:!function(t){const e=new Uint8Array(t.buffer,t.byteOffset,4*t.length);for(let i=0,s=e.length;i<s;i+=4){let t=e[i];e[i]=e[i+3],e[i+3]=t,t=e[i+1],e[i+1]=e[i+2],e[i+2]=t}}(t);break;case 8:!function(t){const e=new Uint8Array(t.buffer,t.byteOffset,8*t.length);for(let i=0,s=e.length;i<s;i+=8){let t=e[i];e[i]=e[i+7],e[i+7]=t,t=e[i+1],e[i+1]=e[i+6],e[i+6]=t,t=e[i+2],e[i+2]=e[i+5],e[i+5]=t,t=e[i+3],e[i+3]=e[i+4],e[i+4]=t}}(t)}}},function(t,e,i,s,n){s();const o=t(26);class r{is_Scalar(){return this.is_scalar}is_Vector(){return!this.is_scalar}}i.Uniform=r,r.__name__="Uniform";class a extends r{constructor(t,e){super(),this.value=t,this.length=e,this.is_scalar=!0}get(t){return this.value}*[Symbol.iterator](){const{length:t,value:e}=this;for(let i=0;i<t;i++)yield e}select(t){return new a(this.value,t.count)}[o.equals](t,e){return e.eq(this.length,t.length)&&e.eq(this.value,t.value)}}i.UniformScalar=a,a.__name__="UniformScalar";class l extends r{constructor(t){super(),this.array=t,this.is_scalar=!1,this.length=this.array.length}get(t){return this.array[t]}*[Symbol.iterator](){yield*this.array}select(t){const e=t.select(this.array);return new this.constructor(e)}[o.equals](t,e){return e.eq(this.length,t.length)&&e.eq(this.array,t.array)}}i.UniformVector=l,l.__name__="UniformVector";class c extends l{constructor(t){super(t),this.array=t,this._view=new DataView(t.buffer)}get(t){return this._view.getUint32(4*t)}*[Symbol.iterator](){const t=this.length;for(let e=0;e<t;e++)yield this.get(e)}}i.ColorUniformVector=c,c.__name__="ColorUniformVector"},function(t,e,i,s,n){s();const o=t(28);function r(){const t=new Array(32),e="0123456789ABCDEF";for(let i=0;i<32;i++)t[i]=e.substr(Math.floor(16*Math.random()),1);return t[12]="4",t[16]=e.substr(3&t[16].charCodeAt(0)|8,1),t.join("")}i.startsWith=function(t,e,i=0){return t.substr(i,e.length)==e},i.uuid4=r;let a=1e3;i.uniqueId=function(t){const e=o.settings.dev?"j"+a++:r();return null!=t?`${t}-${e}`:e},i.escape=function(t){return t.replace(/(?:[&<>"'`])/g,(t=>{switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&#x27;";case"`":return"&#x60;";default:return t}}))},i.unescape=function(t){return t.replace(/&(amp|lt|gt|quot|#x27|#x60);/g,((t,e)=>{switch(e){case"amp":return"&";case"lt":return"<";case"gt":return">";case"quot":return'"';case"#x27":return"'";case"#x60":return"`";default:return e}}))},i.use_strict=function(t){return`'use strict';\n${t}`},i.to_fixed=function(t,e){return t.toFixed(e).replace(/(\.[0-9]*?)0+$/,"$1").replace(/\.$/,"")}},function(t,e,i,s,n){s();const o=t(30);class r{constructor(t){this.document=t}}i.DocumentEvent=r,r.__name__="DocumentEvent";class a extends r{constructor(t,e,i){super(t),this.events=e,this.setter_id=i}}i.DocumentEventBatch=a,a.__name__="DocumentEventBatch";class l extends r{}i.DocumentChangedEvent=l,l.__name__="DocumentChangedEvent";class c extends l{constructor(t,e,i){super(t),this.msg_type=e,this.msg_data=i}[o.serialize](t){const e=this.msg_data,i=t.to_serializable(e);return{kind:"MessageSent",msg_type:this.msg_type,msg_data:i}}}i.MessageSentEvent=c,c.__name__="MessageSentEvent";class h extends l{constructor(t,e,i,s,n,o,r){super(t),this.model=e,this.attr=i,this.old=s,this.new_=n,this.setter_id=o,this.hint=r}[o.serialize](t){if(null!=this.hint)return t.to_serializable(this.hint);const e=this.new_,i=t.to_serializable(e);return this.model!=e&&t.remove_def(this.model),{kind:"ModelChanged",model:this.model.ref(),attr:this.attr,new:i}}}i.ModelChangedEvent=h,h.__name__="ModelChangedEvent";class _ extends l{constructor(t,e,i){super(t),this.column_source=e,this.patches=i}[o.serialize](t){return{kind:"ColumnsPatched",column_source:this.column_source,patches:this.patches}}}i.ColumnsPatchedEvent=_,_.__name__="ColumnsPatchedEvent";class d extends l{constructor(t,e,i,s){super(t),this.column_source=e,this.data=i,this.rollover=s}[o.serialize](t){return{kind:"ColumnsStreamed",column_source:this.column_source,data:this.data,rollover:this.rollover}}}i.ColumnsStreamedEvent=d,d.__name__="ColumnsStreamedEvent";class u extends l{constructor(t,e,i){super(t),this.title=e,this.setter_id=i}[o.serialize](t){return{kind:"TitleChanged",title:this.title}}}i.TitleChangedEvent=u,u.__name__="TitleChangedEvent";class p extends l{constructor(t,e,i){super(t),this.model=e,this.setter_id=i}[o.serialize](t){return{kind:"RootAdded",model:t.to_serializable(this.model)}}}i.RootAddedEvent=p,p.__name__="RootAddedEvent";class m extends l{constructor(t,e,i){super(t),this.model=e,this.setter_id=i}[o.serialize](t){return{kind:"RootRemoved",model:this.model.ref()}}}i.RootRemovedEvent=m,m.__name__="RootRemovedEvent"},function(t,e,i,s,n){s();const o=t(8),r=t(13);i.pretty=Symbol("pretty");class a{constructor(t){this.precision=null==t?void 0:t.precision}to_string(t){return function(t){return o.isObject(t)&&void 0!==t[i.pretty]}(t)?t[i.pretty](this):o.isBoolean(t)?this.boolean(t):o.isNumber(t)?this.number(t):o.isString(t)?this.string(t):o.isArray(t)?this.array(t):o.isIterable(t)?this.iterable(t):o.isPlainObject(t)?this.object(t):`${t}`}token(t){return t}boolean(t){return`${t}`}number(t){return null!=this.precision?t.toFixed(this.precision):`${t}`}string(t){return`"${t.replace(/'/g,"\\'")}"`}array(t){const e=this.token,i=[];for(const s of t)i.push(this.to_string(s));return`${e("[")}${i.join(`${e(",")} `)}${e("]")}`}iterable(t){var e;const i=this.token,s=null!==(e=Object(t)[Symbol.toStringTag])&&void 0!==e?e:"Object",n=this.array(t);return`${s}${i("(")}${n}${i(")")}`}object(t){const e=this.token,i=[];for(const[s,n]of r.entries(t))i.push(`${s}${e(":")} ${this.to_string(n)}`);return`${e("{")}${i.join(`${e(",")} `)}${e("}")}`}}i.Printer=a,a.__name__="Printer",i.to_string=function(t,e){return new a(e).to_string(t)}},function(t,e,i,s,n){s();const o=t(13),r=t(8);function a(t){return r.isObject(t)&&void 0!==t[i.clone]}i.clone=Symbol("clone"),i.is_Cloneable=a;class l extends Error{}i.CloningError=l,l.__name__="CloningError";class c{constructor(){}clone(t){if(a(t))return t[i.clone](this);if(r.isArray(t)){const e=t.length,i=new Array(e);for(let s=0;s<e;s++){const e=t[s];i[s]=this.clone(e)}return i}if(r.isPlainObject(t)){const e={};for(const[i,s]of o.entries(t))e[i]=this.clone(s);return e}if(null===t||r.isBoolean(t)||r.isNumber(t)||r.isString(t))return t;throw new l(`${Object.prototype.toString.call(t)} is not cloneable`)}}i.Cloner=c,c.__name__="Cloner"},function(t,e,i,s,n){s();const o=t(1);o.__exportStar(t(39),i),o.__exportStar(t(162),i),o.__exportStar(t(257),i),o.__exportStar(t(261),i),o.__exportStar(t(266),i),o.__exportStar(t(272),i),o.__exportStar(t(205),i),o.__exportStar(t(277),i),o.__exportStar(t(313),i),o.__exportStar(t(315),i),o.__exportStar(t(317),i),o.__exportStar(t(209),i),o.__exportStar(t(147),i),o.__exportStar(t(330),i),o.__exportStar(t(338),i),o.__exportStar(t(220),i),o.__exportStar(t(339),i),o.__exportStar(t(217),i),o.__exportStar(t(340),i),o.__exportStar(t(341),i),o.__exportStar(t(198),i),o.__exportStar(t(346),i),o.__exportStar(t(356),i),o.__exportStar(t(360),i)},function(t,e,i,s,n){s(),n("Annotation",t(40).Annotation),n("Arrow",t(55).Arrow),n("ArrowHead",t(133).ArrowHead),n("OpenHead",t(133).OpenHead),n("NormalHead",t(133).NormalHead),n("TeeHead",t(133).TeeHead),n("VeeHead",t(133).VeeHead),n("Band",t(134).Band),n("BoxAnnotation",t(136).BoxAnnotation),n("ColorBar",t(137).ColorBar),n("Label",t(226).Label),n("LabelSet",t(227).LabelSet),n("Legend",t(228).Legend),n("LegendItem",t(229).LegendItem),n("PolyAnnotation",t(231).PolyAnnotation),n("Slope",t(232).Slope),n("Span",t(233).Span),n("TextAnnotation",t(139).TextAnnotation),n("Title",t(138).Title),n("ToolbarPanel",t(234).ToolbarPanel),n("Tooltip",t(254).Tooltip),n("Whisker",t(256).Whisker)},function(t,e,i,s,n){s();const o=t(41);class r extends o.RendererView{get_size(){if(this.model.visible){const{width:t,height:e}=this._get_size();return{width:Math.round(t),height:Math.round(e)}}return{width:0,height:0}}_get_size(){throw new Error("not implemented")}connect_signals(){super.connect_signals();const t=this.model.properties;this.on_change(t.visible,(()=>{null!=this.layout&&(this.layout.visible=this.model.visible,this.plot_view.request_layout())}))}get needs_clip(){return null==this.layout}serializable_state(){const t=super.serializable_state();return null==this.layout?t:Object.assign(Object.assign({},t),{bbox:this.layout.bbox.box})}}i.AnnotationView=r,r.__name__="AnnotationView";class a extends o.Renderer{constructor(t){super(t)}static init_Annotation(){this.override({level:"annotation"})}}i.Annotation=a,a.__name__="Annotation",a.init_Annotation()},function(t,e,i,s,n){s();const o=t(1),r=t(42),a=o.__importStar(t(45)),l=t(20),c=t(53),h=t(54);class _ extends r.View{get coordinates(){const{_coordinates:t}=this;return null!=t?t:this._coordinates=this._initialize_coordinates()}initialize(){super.initialize(),this.visuals=new a.Visuals(this),this.needs_webgl_blit=!1}connect_signals(){super.connect_signals();const{x_range_name:t,y_range_name:e}=this.model.properties;this.on_change([t,e],(()=>this._initialize_coordinates()))}_initialize_coordinates(){const{x_range_name:t,y_range_name:e}=this.model,{frame:i}=this.plot_view,s=i.x_scales.get(t),n=i.y_scales.get(e);return new h.CoordinateTransform(s,n)}get plot_view(){return this.parent}get plot_model(){return this.parent.model}get layer(){const{overlays:t,primary:e}=this.canvas;return"overlay"==this.model.level?t:e}get canvas(){return this.plot_view.canvas_view}request_render(){this.request_paint()}request_paint(){this.plot_view.request_paint(this)}notify_finished(){this.plot_view.notify_finished()}get needs_clip(){return!1}get has_webgl(){return!1}render(){this.model.visible&&this._render(),this._has_finished=!0}renderer_view(t){}}i.RendererView=_,_.__name__="RendererView";class d extends c.Model{constructor(t){super(t)}static init_Renderer(){this.define((({Boolean:t,String:e})=>({level:[l.RenderLevel,"image"],visible:[t,!0],x_range_name:[e,"default"],y_range_name:[e,"default"]})))}}i.Renderer=d,d.__name__="Renderer",d.init_Renderer()},function(t,e,i,s,n){s();const o=t(1),r=t(15),a=t(43),l=t(8),c=o.__importDefault(t(44));class h{constructor(t){this.removed=new r.Signal0(this,"removed"),this._ready=Promise.resolve(void 0),this._slots=new WeakMap;const{model:e,parent:i}=t;this.model=e,this.parent=i,this.root=null==i?this:i.root,this.removed.emit()}get ready(){return this._ready}connect(t,e){let i=this._slots.get(e);return null==i&&(i=(t,i)=>{const s=Promise.resolve(e.call(this,t,i));this._ready=this._ready.then((()=>s))},this._slots.set(e,i)),t.connect(i,this)}disconnect(t,e){return t.disconnect(e,this)}initialize(){this._has_finished=!1,this.is_root&&(this._stylesheet=a.stylesheet);for(const t of this.styles())this.stylesheet.append(t)}async lazy_initialize(){}remove(){this.disconnect_signals(),this.removed.emit()}toString(){return`${this.model.type}View(${this.model.id})`}serializable_state(){return{type:this.model.type}}get is_root(){return null==this.parent}assert_root(){if(!this.is_root)throw new Error(`${this.toString()} is not a root layout`)}has_finished(){return this._has_finished}get is_idle(){return this.has_finished()}connect_signals(){}disconnect_signals(){r.Signal.disconnect_receiver(this)}on_change(t,e){for(const i of l.isArray(t)?t:[t])this.connect(i.change,e)}cursor(t,e){return null}get stylesheet(){return this.is_root?this._stylesheet:this.root.stylesheet}styles(){return[c.default]}}i.View=h,h.__name__="View"},function(t,e,i,s,n){s();const o=t(8),r=t(13),a=t=>(e={},...i)=>{const s=document.createElement(t);s.classList.add("bk");for(let[t,a]of r.entries(e))if(null!=a&&(!o.isBoolean(a)||a))if("class"===t&&(o.isString(a)&&(a=a.split(/\s+/)),o.isArray(a)))for(const e of a)null!=e&&s.classList.add(e);else if("style"===t&&o.isPlainObject(a))for(const[e,i]of r.entries(a))s.style[e]=i;else if("data"===t&&o.isPlainObject(a))for(const[e,i]of r.entries(a))s.dataset[e]=i;else s.setAttribute(t,a);function n(t){if(o.isString(t))s.appendChild(document.createTextNode(t));else if(t instanceof Node)s.appendChild(t);else if(t instanceof NodeList||t instanceof HTMLCollection)for(const e of t)s.appendChild(e);else if(null!=t&&!1!==t)throw new Error(`expected a DOM element, string, false or null, got ${JSON.stringify(t)}`)}for(const t of i)if(o.isArray(t))for(const e of t)n(e);else n(t);return s};function l(t){const e=t.parentNode;null!=e&&e.removeChild(t)}function c(t,...e){const i=t.firstChild;for(const s of e)t.insertBefore(s,i)}function h(t,e){var i,s,n;const o=Element.prototype;return(null!==(n=null!==(s=null!==(i=o.matches)&&void 0!==i?i:o.webkitMatchesSelector)&&void 0!==s?s:o.mozMatchesSelector)&&void 0!==n?n:o.msMatchesSelector).call(t,e)}function _(t){return parseFloat(t)||0}function d(t){const e=getComputedStyle(t);return{border:{top:_(e.borderTopWidth),bottom:_(e.borderBottomWidth),left:_(e.borderLeftWidth),right:_(e.borderRightWidth)},margin:{top:_(e.marginTop),bottom:_(e.marginBottom),left:_(e.marginLeft),right:_(e.marginRight)},padding:{top:_(e.paddingTop),bottom:_(e.paddingBottom),left:_(e.paddingLeft),right:_(e.paddingRight)}}}function u(t){const e=t.getBoundingClientRect();return{width:Math.ceil(e.width),height:Math.ceil(e.height)}}i.createElement=function(t,e,...i){return a(t)(e,...i)},i.div=a("div"),i.span=a("span"),i.canvas=a("canvas"),i.link=a("link"),i.style=a("style"),i.a=a("a"),i.p=a("p"),i.i=a("i"),i.pre=a("pre"),i.button=a("button"),i.label=a("label"),i.input=a("input"),i.select=a("select"),i.option=a("option"),i.optgroup=a("optgroup"),i.textarea=a("textarea"),i.nbsp=function(){return document.createTextNode(" ")},i.append=function(t,...e){for(const i of e)t.appendChild(i)},i.remove=l,i.removeElement=l,i.replaceWith=function(t,e){const i=t.parentNode;null!=i&&i.replaceChild(e,t)},i.prepend=c,i.empty=function(t,e=!1){let i;for(;i=t.firstChild;)t.removeChild(i);if(e&&t instanceof Element)for(const s of t.attributes)t.removeAttributeNode(s)},i.display=function(t){t.style.display=""},i.undisplay=function(t){t.style.display="none"},i.show=function(t){t.style.visibility=""},i.hide=function(t){t.style.visibility="hidden"},i.offset=function(t){const e=t.getBoundingClientRect();return{top:e.top+window.pageYOffset-document.documentElement.clientTop,left:e.left+window.pageXOffset-document.documentElement.clientLeft}},i.matches=h,i.parent=function(t,e){let i=t;for(;i=i.parentElement;)if(h(i,e))return i;return null},i.extents=d,i.size=u,i.scroll_size=function(t){return{width:Math.ceil(t.scrollWidth),height:Math.ceil(t.scrollHeight)}},i.outer_size=function(t){const{margin:{left:e,right:i,top:s,bottom:n}}=d(t),{width:o,height:r}=u(t);return{width:Math.ceil(o+e+i),height:Math.ceil(r+s+n)}},i.content_size=function(t){const{left:e,top:i}=t.getBoundingClientRect(),{padding:s}=d(t);let n=0,o=0;for(const r of t.children){const t=r.getBoundingClientRect();n=Math.max(n,Math.ceil(t.left-e-s.left+t.width)),o=Math.max(o,Math.ceil(t.top-i-s.top+t.height))}return{width:n,height:o}},i.position=function(t,e,i){const{style:s}=t;if(s.left=`${e.x}px`,s.top=`${e.y}px`,s.width=`${e.width}px`,s.height=`${e.height}px`,null==i)s.margin="";else{const{top:t,right:e,bottom:n,left:o}=i;s.margin=`${t}px ${e}px ${n}px ${o}px`}},i.children=function(t){return Array.from(t.children)};class p{constructor(t){this.el=t,this.classList=t.classList}get values(){const t=[];for(let e=0;e<this.classList.length;e++){const i=this.classList.item(e);null!=i&&t.push(i)}return t}has(t){return this.classList.contains(t)}add(...t){for(const e of t)this.classList.add(e);return this}remove(...t){for(const e of t)this.classList.remove(e);return this}clear(){for(const t of this.values)"bk"!=t&&this.classList.remove(t);return this}toggle(t,e){return(null!=e?e:!this.has(t))?this.add(t):this.remove(t),this}}var m;function g(t,e,i){const{width:s,height:n,position:o,display:r}=t.style;t.style.position="absolute",t.style.display="",t.style.width=null!=e.width&&e.width!=1/0?`${e.width}px`:"auto",t.style.height=null!=e.height&&e.height!=1/0?`${e.height}px`:"auto";try{return i()}finally{t.style.position=o,t.style.display=r,t.style.width=s,t.style.height=n}}i.ClassList=p,p.__name__="ClassList",i.classes=function(t){return new p(t)},i.toggle_attribute=function(t,e,i){null==i&&(i=!t.hasAttribute(e)),i?t.setAttribute(e,"true"):t.removeAttribute(e)},(m=i.Keys||(i.Keys={}))[m.Backspace=8]="Backspace",m[m.Tab=9]="Tab",m[m.Enter=13]="Enter",m[m.Esc=27]="Esc",m[m.PageUp=33]="PageUp",m[m.PageDown=34]="PageDown",m[m.Left=37]="Left",m[m.Up=38]="Up",m[m.Right=39]="Right",m[m.Down=40]="Down",m[m.Delete=46]="Delete",i.undisplayed=function(t,e){const{display:i}=t.style;t.style.display="none";try{return e()}finally{t.style.display=i}},i.unsized=function(t,e){return g(t,{},e)},i.sized=g;class f{constructor(t){this.root=t,this.known=new Set,this.style=i.style({type:"text/css"}),c(t,this.style)}append(t){this.known.has(t)||(this.style.appendChild(document.createTextNode(t)),this.known.add(t))}}i.StyleSheet=f,f.__name__="StyleSheet",i.stylesheet=new f(document.head),i.dom_ready=async function(){if("loading"==document.readyState)return new Promise(((t,e)=>{document.addEventListener("DOMContentLoaded",(()=>t()),{once:!0})}))}},function(t,e,i,s,n){s(),i.root="bk-root",i.default=".bk-root{position:relative;width:auto;height:auto;z-index:0;box-sizing:border-box;font-family:Helvetica, Arial, sans-serif;font-size:13px;}.bk-root .bk,.bk-root .bk:before,.bk-root .bk:after{box-sizing:inherit;margin:0;border:0;padding:0;background-image:none;font-family:inherit;font-size:100%;line-height:1.42857143;}.bk-root pre.bk{font-family:Courier, monospace;}"},function(t,e,i,s,n){s();const o=t(1),r=t(46);n("Line",r.Line),n("LineScalar",r.LineScalar),n("LineVector",r.LineVector);const a=t(49);n("Fill",a.Fill),n("FillScalar",a.FillScalar),n("FillVector",a.FillVector);const l=t(50);n("Text",l.Text),n("TextScalar",l.TextScalar),n("TextVector",l.TextVector);const c=t(51);n("Hatch",c.Hatch),n("HatchScalar",c.HatchScalar),n("HatchVector",c.HatchVector);const h=o.__importStar(t(48)),_=t(47);n("VisualProperties",_.VisualProperties),n("VisualUniforms",_.VisualUniforms);class d{constructor(t){this._visuals=[];for(const[e,i]of t.model._mixins){const s=(()=>{switch(i){case h.Line:return new r.Line(t,e);case h.LineScalar:return new r.LineScalar(t,e);case h.LineVector:return new r.LineVector(t,e);case h.Fill:return new a.Fill(t,e);case h.FillScalar:return new a.FillScalar(t,e);case h.FillVector:return new a.FillVector(t,e);case h.Text:return new l.Text(t,e);case h.TextScalar:return new l.TextScalar(t,e);case h.TextVector:return new l.TextVector(t,e);case h.Hatch:return new c.Hatch(t,e);case h.HatchScalar:return new c.HatchScalar(t,e);case h.HatchVector:return new c.HatchVector(t,e);default:throw new Error("unknown visual")}})();this._visuals.push(s),Object.defineProperty(this,e+s.type,{get:()=>s,configurable:!1,enumerable:!0})}}*[Symbol.iterator](){yield*this._visuals}}i.Visuals=d,d.__name__="Visuals"},function(t,e,i,s,n){s();const o=t(1),r=t(47),a=o.__importStar(t(48)),l=t(22),c=t(8);function h(t){if(c.isArray(t))return t;switch(t){case"solid":return[];case"dashed":return[6];case"dotted":return[2,4];case"dotdash":return[2,4,6,4];case"dashdot":return[6,4,2,4];default:return t.split(" ").map(Number).filter(c.isInteger)}}i.resolve_line_dash=h;class _ extends r.VisualProperties{get doit(){const t=this.line_color.get_value(),e=this.line_alpha.get_value(),i=this.line_width.get_value();return!(null==t||0==e||0==i)}set_value(t){const e=this.line_color.get_value(),i=this.line_alpha.get_value();t.strokeStyle=l.color2css(e,i),t.lineWidth=this.line_width.get_value(),t.lineJoin=this.line_join.get_value(),t.lineCap=this.line_cap.get_value(),t.lineDash=h(this.line_dash.get_value()),t.lineDashOffset=this.line_dash_offset.get_value()}}i.Line=_,_.__name__="Line";class d extends r.VisualUniforms{get doit(){const t=this.line_color.value,e=this.line_alpha.value,i=this.line_width.value;return!(0==t||0==e||0==i)}set_value(t){const e=this.line_color.value,i=this.line_alpha.value;t.strokeStyle=l.color2css(e,i),t.lineWidth=this.line_width.value,t.lineJoin=this.line_join.value,t.lineCap=this.line_cap.value,t.lineDash=h(this.line_dash.value),t.lineDashOffset=this.line_dash_offset.value}}i.LineScalar=d,d.__name__="LineScalar";class u extends r.VisualUniforms{get doit(){const{line_color:t}=this;if(t.is_Scalar()&&0==t.value)return!1;const{line_alpha:e}=this;if(e.is_Scalar()&&0==e.value)return!1;const{line_width:i}=this;return!i.is_Scalar()||0!=i.value}set_vectorize(t,e){const i=this.line_color.get(e),s=this.line_alpha.get(e),n=this.line_width.get(e),o=this.line_join.get(e),r=this.line_cap.get(e),a=this.line_dash.get(e),c=this.line_dash_offset.get(e);t.strokeStyle=l.color2css(i,s),t.lineWidth=n,t.lineJoin=o,t.lineCap=r,t.lineDash=h(a),t.lineDashOffset=c}}i.LineVector=u,u.__name__="LineVector",_.prototype.type="line",_.prototype.attrs=Object.keys(a.Line),d.prototype.type="line",d.prototype.attrs=Object.keys(a.LineScalar),u.prototype.type="line",u.prototype.attrs=Object.keys(a.LineVector)},function(t,e,i,s,n){s();class o{constructor(t,e=""){this.obj=t,this.prefix=e;const i=this;this._props=[];for(const s of this.attrs){const n=t.model.properties[e+s];n.change.connect((()=>this.update())),i[s]=n,this._props.push(n)}this.update()}*[Symbol.iterator](){yield*this._props}update(){}}i.VisualProperties=o,o.__name__="VisualProperties";class r{constructor(t,e=""){this.obj=t,this.prefix=e;for(const i of this.attrs)Object.defineProperty(this,i,{get:()=>t[e+i]})}*[Symbol.iterator](){for(const t of this.attrs)yield this.obj.model.properties[this.prefix+t]}update(){}}i.VisualUniforms=r,r.__name__="VisualUniforms"},function(t,e,i,s,n){s();const o=t(1),r=o.__importStar(t(18)),a=t(20),l=o.__importStar(t(21)),c=t(13);i.Line={line_color:[l.Nullable(l.Color),"black"],line_alpha:[l.Alpha,1],line_width:[l.Number,1],line_join:[a.LineJoin,"bevel"],line_cap:[a.LineCap,"butt"],line_dash:[l.Or(a.LineDash,l.Array(l.Number)),[]],line_dash_offset:[l.Number,0]},i.Fill={fill_color:[l.Nullable(l.Color),"gray"],fill_alpha:[l.Alpha,1]},i.Hatch={hatch_color:[l.Nullable(l.Color),"black"],hatch_alpha:[l.Alpha,1],hatch_scale:[l.Number,12],hatch_pattern:[l.Nullable(l.Or(a.HatchPatternType,l.String)),null],hatch_weight:[l.Number,1],hatch_extra:[l.Dict(l.AnyRef()),{}]},i.Text={text_color:[l.Nullable(l.Color),"#444444"],text_alpha:[l.Alpha,1],text_font:[r.Font,"helvetica"],text_font_size:[l.FontSize,"16px"],text_font_style:[a.FontStyle,"normal"],text_align:[a.TextAlign,"left"],text_baseline:[a.TextBaseline,"bottom"],text_line_height:[l.Number,1.2]},i.LineScalar={line_color:[r.ColorScalar,"black"],line_alpha:[r.NumberScalar,1],line_width:[r.NumberScalar,1],line_join:[r.LineJoinScalar,"bevel"],line_cap:[r.LineCapScalar,"butt"],line_dash:[r.LineDashScalar,[]],line_dash_offset:[r.NumberScalar,0]},i.FillScalar={fill_color:[r.ColorScalar,"gray"],fill_alpha:[r.NumberScalar,1]},i.HatchScalar={hatch_color:[r.ColorScalar,"black"],hatch_alpha:[r.NumberScalar,1],hatch_scale:[r.NumberScalar,12],hatch_pattern:[r.NullStringScalar,null],hatch_weight:[r.NumberScalar,1],hatch_extra:[r.AnyScalar,{}]},i.TextScalar={text_color:[r.ColorScalar,"#444444"],text_alpha:[r.NumberScalar,1],text_font:[r.FontScalar,"helvetica"],text_font_size:[r.FontSizeScalar,"16px"],text_font_style:[r.FontStyleScalar,"normal"],text_align:[r.TextAlignScalar,"left"],text_baseline:[r.TextBaselineScalar,"bottom"],text_line_height:[r.NumberScalar,1.2]},i.LineVector={line_color:[r.ColorSpec,"black"],line_alpha:[r.NumberSpec,1],line_width:[r.NumberSpec,1],line_join:[r.LineJoinSpec,"bevel"],line_cap:[r.LineCapSpec,"butt"],line_dash:[r.LineDashSpec,[]],line_dash_offset:[r.NumberSpec,0]},i.FillVector={fill_color:[r.ColorSpec,"gray"],fill_alpha:[r.NumberSpec,1]},i.HatchVector={hatch_color:[r.ColorSpec,"black"],hatch_alpha:[r.NumberSpec,1],hatch_scale:[r.NumberSpec,12],hatch_pattern:[r.NullStringSpec,null],hatch_weight:[r.NumberSpec,1],hatch_extra:[r.AnyScalar,{}]},i.TextVector={text_color:[r.ColorSpec,"#444444"],text_alpha:[r.NumberSpec,1],text_font:[r.FontSpec,"helvetica"],text_font_size:[r.FontSizeSpec,"16px"],text_font_style:[r.FontStyleSpec,"normal"],text_align:[r.TextAlignSpec,"left"],text_baseline:[r.TextBaselineSpec,"bottom"],text_line_height:[r.NumberSpec,1.2]},i.attrs_of=function(t,e,i,s=!1){const n={};for(const o of c.keys(i)){const i=`${e}${o}`,r=t[i];n[s?i:o]=r}return n}},function(t,e,i,s,n){s();const o=t(1),r=t(47),a=o.__importStar(t(48)),l=t(22);class c extends r.VisualProperties{get doit(){const t=this.fill_color.get_value(),e=this.fill_alpha.get_value();return!(null==t||0==e)}set_value(t){const e=this.fill_color.get_value(),i=this.fill_alpha.get_value();t.fillStyle=l.color2css(e,i)}}i.Fill=c,c.__name__="Fill";class h extends r.VisualUniforms{get doit(){const t=this.fill_color.value,e=this.fill_alpha.value;return!(0==t||0==e)}set_value(t){const e=this.fill_color.value,i=this.fill_alpha.value;t.fillStyle=l.color2css(e,i)}}i.FillScalar=h,h.__name__="FillScalar";class _ extends r.VisualUniforms{get doit(){const{fill_color:t}=this;if(t.is_Scalar()&&0==t.value)return!1;const{fill_alpha:e}=this;return!e.is_Scalar()||0!=e.value}set_vectorize(t,e){const i=this.fill_color.get(e),s=this.fill_alpha.get(e);t.fillStyle=l.color2css(i,s)}}i.FillVector=_,_.__name__="FillVector",c.prototype.type="fill",c.prototype.attrs=Object.keys(a.Fill),h.prototype.type="fill",h.prototype.attrs=Object.keys(a.FillScalar),_.prototype.type="fill",_.prototype.attrs=Object.keys(a.FillVector)},function(t,e,i,s,n){s();const o=t(1),r=t(47),a=o.__importStar(t(48)),l=t(22);class c extends r.VisualProperties{get doit(){const t=this.text_color.get_value(),e=this.text_alpha.get_value();return!(null==t||0==e)}set_value(t){const e=this.text_color.get_value(),i=this.text_alpha.get_value();t.fillStyle=l.color2css(e,i),t.font=this.font_value(),t.textAlign=this.text_align.get_value(),t.textBaseline=this.text_baseline.get_value()}font_value(){return`${this.text_font_style.get_value()} ${this.text_font_size.get_value()} ${this.text_font.get_value()}`}}i.Text=c,c.__name__="Text";class h extends r.VisualUniforms{get doit(){const t=this.text_color.value,e=this.text_alpha.value;return!(0==t||0==e)}set_value(t){const e=this.text_color.value,i=this.text_alpha.value,s=this.font_value(),n=this.text_align.value,o=this.text_baseline.value;t.fillStyle=l.color2css(e,i),t.font=s,t.textAlign=n,t.textBaseline=o}font_value(){return`${this.text_font_style.value} ${this.text_font_size.value} ${this.text_font.value}`}}i.TextScalar=h,h.__name__="TextScalar";class _ extends r.VisualUniforms{get doit(){const{text_color:t}=this;if(t.is_Scalar()&&0==t.value)return!1;const{text_alpha:e}=this;return!e.is_Scalar()||0!=e.value}set_vectorize(t,e){const i=this.text_color.get(e),s=this.text_alpha.get(e),n=this.font_value(e),o=this.text_align.get(e),r=this.text_baseline.get(e);t.fillStyle=l.color2css(i,s),t.font=n,t.textAlign=o,t.textBaseline=r}font_value(t){return`${this.text_font_style.get(t)} ${this.text_font_size.get(t)} ${this.text_font.get(t)}`}}i.TextVector=_,_.__name__="TextVector",c.prototype.type="text",c.prototype.attrs=Object.keys(a.Text),h.prototype.type="text",h.prototype.attrs=Object.keys(a.TextScalar),_.prototype.type="text",_.prototype.attrs=Object.keys(a.TextVector)},function(t,e,i,s,n){s();const o=t(1),r=t(47),a=t(52),l=o.__importStar(t(18)),c=o.__importStar(t(48));class h extends r.VisualProperties{constructor(){super(...arguments),this._update_iteration=0}update(){if(this._update_iteration++,this._hatch_image=null,!this.doit)return;const t=this.hatch_color.get_value(),e=this.hatch_alpha.get_value(),i=this.hatch_scale.get_value(),s=this.hatch_pattern.get_value(),n=this.hatch_weight.get_value(),o=t=>{this._hatch_image=t},r=this.hatch_extra.get_value()[s];if(null!=r){const s=r.get_pattern(t,e,i,n);if(s instanceof Promise){const{_update_iteration:t}=this;s.then((e=>{this._update_iteration==t&&(o(e),this.obj.request_render())}))}else o(s)}else{const r=this.obj.canvas.create_layer(),l=a.get_pattern(r,s,t,e,i,n);o(l)}}get doit(){const t=this.hatch_color.get_value(),e=this.hatch_alpha.get_value(),i=this.hatch_pattern.get_value();return!(null==t||0==e||" "==i||"blank"==i||null==i)}set_value(t){const e=this.pattern(t);t.fillStyle=null!=e?e:"transparent"}pattern(t){const e=this._hatch_image;return null==e?null:t.createPattern(e,this.repetition())}repetition(){const t=this.hatch_pattern.get_value(),e=this.hatch_extra.get_value()[t];if(null==e)return"repeat";switch(e.repetition){case"repeat":return"repeat";case"repeat_x":return"repeat-x";case"repeat_y":return"repeat-y";case"no_repeat":return"no-repeat"}}}i.Hatch=h,h.__name__="Hatch";class _ extends r.VisualUniforms{constructor(){super(...arguments),this._static_doit=!1,this._update_iteration=0}_compute_static_doit(){const t=this.hatch_color.value,e=this.hatch_alpha.value,i=this.hatch_pattern.value;return!(null==t||0==e||" "==i||"blank"==i||null==i)}update(){this._update_iteration++;const t=this.hatch_color.length;if(this._hatch_image=new l.UniformScalar(null,t),this._static_doit=this._compute_static_doit(),!this._static_doit)return;const e=this.hatch_color.value,i=this.hatch_alpha.value,s=this.hatch_scale.value,n=this.hatch_pattern.value,o=this.hatch_weight.value,r=e=>{this._hatch_image=new l.UniformScalar(e,t)},c=this.hatch_extra.value[n];if(null!=c){const t=c.get_pattern(e,i,s,o);if(t instanceof Promise){const{_update_iteration:e}=this;t.then((t=>{this._update_iteration==e&&(r(t),this.obj.request_render())}))}else r(t)}else{const t=this.obj.canvas.create_layer(),l=a.get_pattern(t,n,e,i,s,o);r(l)}}get doit(){return this._static_doit}set_value(t){var e;t.fillStyle=null!==(e=this.pattern(t))&&void 0!==e?e:"transparent"}pattern(t){const e=this._hatch_image.value;return null==e?null:t.createPattern(e,this.repetition())}repetition(){const t=this.hatch_pattern.value,e=this.hatch_extra.value[t];if(null==e)return"repeat";switch(e.repetition){case"repeat":return"repeat";case"repeat_x":return"repeat-x";case"repeat_y":return"repeat-y";case"no_repeat":return"no-repeat"}}}i.HatchScalar=_,_.__name__="HatchScalar";class d extends r.VisualUniforms{constructor(){super(...arguments),this._static_doit=!1,this._update_iteration=0}_compute_static_doit(){const{hatch_color:t}=this;if(t.is_Scalar()&&0==t.value)return!1;const{hatch_alpha:e}=this;if(e.is_Scalar()&&0==e.value)return!1;const{hatch_pattern:i}=this;if(i.is_Scalar()){const t=i.value;if(" "==t||"blank"==t||null==t)return!1}return!0}update(){this._update_iteration++;const t=this.hatch_color.length;if(this._hatch_image=new l.UniformScalar(null,t),this._static_doit=this._compute_static_doit(),!this._static_doit)return;const e=(t,e,i,s,n,o)=>{const r=this.hatch_extra.value[t];if(null!=r){const t=r.get_pattern(e,i,s,n);if(t instanceof Promise){const{_update_iteration:e}=this;t.then((t=>{this._update_iteration==e&&(o(t),this.obj.request_render())}))}else o(t)}else{const r=this.obj.canvas.create_layer(),l=a.get_pattern(r,t,e,i,s,n);o(l)}};if(this.hatch_color.is_Scalar()&&this.hatch_alpha.is_Scalar()&&this.hatch_scale.is_Scalar()&&this.hatch_pattern.is_Scalar()&&this.hatch_weight.is_Scalar()){const i=this.hatch_color.value,s=this.hatch_alpha.value,n=this.hatch_scale.value;e(this.hatch_pattern.value,i,s,n,this.hatch_weight.value,(e=>{this._hatch_image=new l.UniformScalar(e,t)}))}else{const i=new Array(t);i.fill(null),this._hatch_image=new l.UniformVector(i);for(let s=0;s<t;s++){const t=this.hatch_color.get(s),n=this.hatch_alpha.get(s),o=this.hatch_scale.get(s);e(this.hatch_pattern.get(s),t,n,o,this.hatch_weight.get(s),(t=>{i[s]=t}))}}}get doit(){return this._static_doit}set_vectorize(t,e){var i;t.fillStyle=null!==(i=this.pattern(t,e))&&void 0!==i?i:"transparent"}pattern(t,e){const i=this._hatch_image.get(e);return null==i?null:t.createPattern(i,this.repetition(e))}repetition(t){const e=this.hatch_pattern.get(t),i=this.hatch_extra.value[e];if(null==i)return"repeat";switch(i.repetition){case"repeat":return"repeat";case"repeat_x":return"repeat-x";case"repeat_y":return"repeat-y";case"no_repeat":return"no-repeat"}}}i.HatchVector=d,d.__name__="HatchVector",h.prototype.type="hatch",h.prototype.attrs=Object.keys(c.Hatch),_.prototype.type="hatch",_.prototype.attrs=Object.keys(c.HatchScalar),d.prototype.type="hatch",d.prototype.attrs=Object.keys(c.HatchVector)},function(t,e,i,s,n){s();const o=t(22);function r(t,e,i){t.moveTo(0,i+.5),t.lineTo(e,i+.5),t.stroke()}function a(t,e,i){t.moveTo(i+.5,0),t.lineTo(i+.5,e),t.stroke()}function l(t,e){t.moveTo(0,e),t.lineTo(e,0),t.stroke(),t.moveTo(0,0),t.lineTo(e,e),t.stroke()}i.hatch_aliases={" ":"blank",".":"dot",o:"ring","-":"horizontal_line","|":"vertical_line","+":"cross",'"':"horizontal_dash",":":"vertical_dash","@":"spiral","/":"right_diagonal_line","\\":"left_diagonal_line",x:"diagonal_cross",",":"right_diagonal_dash","`":"left_diagonal_dash",v:"horizontal_wave",">":"vertical_wave","*":"criss_cross"},i.get_pattern=function(t,e,s,n,c,h){return t.resize(c,c),t.prepare(),function(t,e,s,n,c,h){var _;const d=c,u=d/2,p=u/2,m=o.color2css(s,n);switch(t.strokeStyle=m,t.fillStyle=m,t.lineCap="square",t.lineWidth=h,null!==(_=i.hatch_aliases[e])&&void 0!==_?_:e){case"blank":break;case"dot":t.arc(u,u,u/2,0,2*Math.PI,!0),t.fill();break;case"ring":t.arc(u,u,u/2,0,2*Math.PI,!0),t.stroke();break;case"horizontal_line":r(t,d,u);break;case"vertical_line":a(t,d,u);break;case"cross":r(t,d,u),a(t,d,u);break;case"horizontal_dash":r(t,u,u);break;case"vertical_dash":a(t,u,u);break;case"spiral":{const e=d/30;t.moveTo(u,u);for(let i=0;i<360;i++){const s=.1*i,n=u+e*s*Math.cos(s),o=u+e*s*Math.sin(s);t.lineTo(n,o)}t.stroke();break}case"right_diagonal_line":t.moveTo(.5-p,d),t.lineTo(p+.5,0),t.stroke(),t.moveTo(p+.5,d),t.lineTo(3*p+.5,0),t.stroke(),t.moveTo(3*p+.5,d),t.lineTo(5*p+.5,0),t.stroke(),t.stroke();break;case"left_diagonal_line":t.moveTo(p+.5,d),t.lineTo(.5-p,0),t.stroke(),t.moveTo(3*p+.5,d),t.lineTo(p+.5,0),t.stroke(),t.moveTo(5*p+.5,d),t.lineTo(3*p+.5,0),t.stroke(),t.stroke();break;case"diagonal_cross":l(t,d);break;case"right_diagonal_dash":t.moveTo(p+.5,3*p+.5),t.lineTo(3*p+.5,p+.5),t.stroke();break;case"left_diagonal_dash":t.moveTo(p+.5,p+.5),t.lineTo(3*p+.5,3*p+.5),t.stroke();break;case"horizontal_wave":t.moveTo(0,p),t.lineTo(u,3*p),t.lineTo(d,p),t.stroke();break;case"vertical_wave":t.moveTo(p,0),t.lineTo(3*p,u),t.lineTo(p,d),t.stroke();break;case"criss_cross":l(t,d),r(t,d,u),a(t,d,u)}}(t.ctx,e,s,n,c,h),t.canvas}},function(t,e,i,s,n){s();const o=t(14),r=t(8),a=t(13),l=t(19);class c extends o.HasProps{constructor(t){super(t)}get is_syncable(){return this.syncable}static init_Model(){this.define((({Any:t,Unknown:e,Boolean:i,String:s,Array:n,Dict:o,Nullable:r})=>({tags:[n(e),[]],name:[r(s),null],js_property_callbacks:[o(n(t)),{}],js_event_callbacks:[o(n(t)),{}],subscribed_events:[n(s),[]],syncable:[i,!0]})))}initialize(){super.initialize(),this._js_callbacks=new Map}connect_signals(){super.connect_signals(),this._update_property_callbacks(),this.connect(this.properties.js_property_callbacks.change,(()=>this._update_property_callbacks())),this.connect(this.properties.js_event_callbacks.change,(()=>this._update_event_callbacks())),this.connect(this.properties.subscribed_events.change,(()=>this._update_event_callbacks()))}_process_event(t){var e;for(const i of null!==(e=this.js_event_callbacks[t.event_name])&&void 0!==e?e:[])i.execute(t);null!=this.document&&this.subscribed_events.some((e=>e==t.event_name))&&this.document.event_manager.send_event(t)}trigger_event(t){null!=this.document&&(t.origin=this,this.document.event_manager.trigger(t))}_update_event_callbacks(){null!=this.document?this.document.event_manager.subscribed_models.add(this):l.logger.warn("WARNING: Document not defined for updating event callbacks")}_update_property_callbacks(){const t=t=>{const[e,i=null]=t.split(":");return null!=i?this.properties[i][e]:this[e]};for(const[e,i]of this._js_callbacks){const s=t(e);for(const t of i)this.disconnect(s,t)}this._js_callbacks.clear();for(const[e,i]of a.entries(this.js_property_callbacks)){const s=i.map((t=>()=>t.execute(this)));this._js_callbacks.set(e,s);const n=t(e);for(const t of s)this.connect(n,t)}}_doc_attached(){a.isEmpty(this.js_event_callbacks)&&0==this.subscribed_events.length||this._update_event_callbacks()}_doc_detached(){this.document.event_manager.subscribed_models.delete(this)}select(t){if(r.isString(t))return[...this.references()].filter((e=>e instanceof c&&e.name===t));if(t.prototype instanceof o.HasProps)return[...this.references()].filter((e=>e instanceof t));throw new Error("invalid selector")}select_one(t){const e=this.select(t);switch(e.length){case 0:return null;case 1:return e[0];default:throw new Error("found more than one object matching given selector")}}}i.Model=c,c.__name__="Model",c.init_Model()},function(t,e,i,s,n){s();class o{constructor(t,e){this.x_scale=t,this.y_scale=e,this.x_range=this.x_scale.source_range,this.y_range=this.y_scale.source_range,this.ranges=[this.x_range,this.y_range],this.scales=[this.x_scale,this.y_scale]}map_to_screen(t,e){return[this.x_scale.v_compute(t),this.y_scale.v_compute(e)]}map_from_screen(t,e){return[this.x_scale.v_invert(t),this.y_scale.v_invert(e)]}}i.CoordinateTransform=o,o.__name__="CoordinateTransform"},function(t,e,i,s,n){s();const o=t(1),r=t(56),a=t(133),l=t(48),c=t(20),h=t(24),_=t(122),d=o.__importStar(t(18)),u=t(10);class p extends r.DataAnnotationView{async lazy_initialize(){await super.lazy_initialize();const{start:t,end:e}=this.model;null!=t&&(this.start=await _.build_view(t,{parent:this})),null!=e&&(this.end=await _.build_view(e,{parent:this}))}set_data(t){var e,i;super.set_data(t),null===(e=this.start)||void 0===e||e.set_data(t),null===(i=this.end)||void 0===i||i.set_data(t)}remove(){var t,e;null===(t=this.start)||void 0===t||t.remove(),null===(e=this.end)||void 0===e||e.remove(),super.remove()}map_data(){const{frame:t}=this.plot_view;"data"==this.model.start_units?(this._sx_start=this.coordinates.x_scale.v_compute(this._x_start),this._sy_start=this.coordinates.y_scale.v_compute(this._y_start)):(this._sx_start=t.bbox.xview.v_compute(this._x_start),this._sy_start=t.bbox.yview.v_compute(this._y_start)),"data"==this.model.end_units?(this._sx_end=this.coordinates.x_scale.v_compute(this._x_end),this._sy_end=this.coordinates.y_scale.v_compute(this._y_end)):(this._sx_end=t.bbox.xview.v_compute(this._x_end),this._sy_end=t.bbox.yview.v_compute(this._y_end));const{_sx_start:e,_sy_start:i,_sx_end:s,_sy_end:n}=this,o=e.length,r=this._angles=new h.ScreenArray(o);for(let a=0;a<o;a++)r[a]=Math.PI/2+u.atan2([e[a],i[a]],[s[a],n[a]])}paint(t){const{start:e,end:i}=this,{_sx_start:s,_sy_start:n,_sx_end:o,_sy_end:r,_angles:a}=this,{x:l,y:c,width:h,height:_}=this.plot_view.frame.bbox;for(let d=0,u=s.length;d<u;d++)null!=i&&(t.save(),t.translate(o[d],r[d]),t.rotate(a[d]),i.render(t,d),t.restore()),null!=e&&(t.save(),t.translate(s[d],n[d]),t.rotate(a[d]+Math.PI),e.render(t,d),t.restore()),this.visuals.line.doit&&(t.save(),null==e&&null==i||(t.beginPath(),t.rect(l,c,h,_),null!=i&&(t.save(),t.translate(o[d],r[d]),t.rotate(a[d]),i.clip(t,d),t.restore()),null!=e&&(t.save(),t.translate(s[d],n[d]),t.rotate(a[d]+Math.PI),e.clip(t,d),t.restore()),t.closePath(),t.clip()),this.visuals.line.set_vectorize(t,d),t.beginPath(),t.moveTo(s[d],n[d]),t.lineTo(o[d],r[d]),t.stroke(),t.restore())}}i.ArrowView=p,p.__name__="ArrowView";class m extends r.DataAnnotation{constructor(t){super(t)}static init_Arrow(){this.prototype.default_view=p,this.mixins(l.LineVector),this.define((({Ref:t,Nullable:e})=>({x_start:[d.XCoordinateSpec,{field:"x_start"}],y_start:[d.YCoordinateSpec,{field:"y_start"}],start_units:[c.SpatialUnits,"data"],start:[e(t(a.ArrowHead)),null],x_end:[d.XCoordinateSpec,{field:"x_end"}],y_end:[d.YCoordinateSpec,{field:"y_end"}],end_units:[c.SpatialUnits,"data"],end:[e(t(a.ArrowHead)),()=>new a.OpenHead]})))}}i.Arrow=m,m.__name__="Arrow",m.init_Arrow()},function(t,e,i,s,n){s();const o=t(1),r=t(40),a=t(57),l=t(130),c=t(65),h=o.__importStar(t(18));class _ extends r.AnnotationView{constructor(){super(...arguments),this._initial_set_data=!1}connect_signals(){super.connect_signals();const t=()=>{this.set_data(this.model.source),this.request_render()};this.connect(this.model.change,t),this.connect(this.model.source.streaming,t),this.connect(this.model.source.patching,t),this.connect(this.model.source.change,t)}set_data(t){const e=this;for(const i of this.model)if(i instanceof h.VectorSpec||i instanceof h.ScalarSpec)if(i instanceof h.BaseCoordinateSpec){const s=i.array(t);e[`_${i.attr}`]=s}else{const s=i.uniform(t);e[`${i.attr}`]=s}this.plot_model.use_map&&(null!=e._x&&c.inplace.project_xy(e._x,e._y),null!=e._xs&&c.inplace.project_xsys(e._xs,e._ys));for(const i of this.visuals)i.update()}_render(){this._initial_set_data||(this.set_data(this.model.source),this._initial_set_data=!0),this.map_data(),this.paint(this.layer.ctx)}}i.DataAnnotationView=_,_.__name__="DataAnnotationView";class d extends r.Annotation{constructor(t){super(t)}static init_DataAnnotation(){this.define((({Ref:t})=>({source:[t(a.ColumnarDataSource),()=>new l.ColumnDataSource]})))}}i.DataAnnotation=d,d.__name__="DataAnnotation",d.init_DataAnnotation()},function(t,e,i,s,n){s();const o=t(58),r=t(15),a=t(19),l=t(60),c=t(8),h=t(9),_=t(13),d=t(59),u=t(129),p=t(29);class m extends o.DataSource{constructor(t){super(t)}get_array(t){let e=this.data[t];return null==e?this.data[t]=e=[]:c.isArray(e)||(this.data[t]=e=Array.from(e)),e}static init_ColumnarDataSource(){this.define((({Ref:t})=>({selection_policy:[t(u.SelectionPolicy),()=>new u.UnionRenderers]}))),this.internal((({AnyRef:t})=>({selection_manager:[t(),t=>new l.SelectionManager({source:t})],inspected:[t(),()=>new d.Selection]})))}initialize(){super.initialize(),this._select=new r.Signal0(this,"select"),this.inspect=new r.Signal(this,"inspect"),this.streaming=new r.Signal0(this,"streaming"),this.patching=new r.Signal(this,"patching")}get_column(t){const e=this.data[t];return null!=e?e:null}columns(){return _.keys(this.data)}get_length(t=!0){const e=h.uniq(_.values(this.data).map((t=>p.is_NDArray(t)?t.shape[0]:t.length)));switch(e.length){case 0:return null;case 1:return e[0];default:{const i="data source has columns of inconsistent lengths";if(t)return a.logger.warn(i),e.sort()[0];throw new Error(i)}}}get length(){var t;return null!==(t=this.get_length())&&void 0!==t?t:0}clear(){const t={};for(const e of this.columns())t[e]=new this.data[e].constructor(0);this.data=t}}i.ColumnarDataSource=m,m.__name__="ColumnarDataSource",m.init_ColumnarDataSource()},function(t,e,i,s,n){s();const o=t(53),r=t(59);class a extends o.Model{constructor(t){super(t)}static init_DataSource(){this.define((({Ref:t})=>({selected:[t(r.Selection),()=>new r.Selection]})))}}i.DataSource=a,a.__name__="DataSource",a.init_DataSource()},function(t,e,i,s,n){s();const o=t(53),r=t(9),a=t(13);class l extends o.Model{constructor(t){super(t)}get_view(){return this.view}static init_Selection(){this.define((({Int:t,Array:e,Dict:i})=>({indices:[e(t),[]],line_indices:[e(t),[]],multiline_indices:[i(e(t)),{}]}))),this.internal((({Int:t,Array:e,AnyRef:i,Struct:s,Nullable:n})=>({selected_glyphs:[e(i()),[]],view:[n(i()),null],image_indices:[e(s({index:t,dim1:t,dim2:t,flat_index:t})),[]]})))}get selected_glyph(){return this.selected_glyphs.length>0?this.selected_glyphs[0]:null}add_to_selected_glyphs(t){this.selected_glyphs.push(t)}update(t,e=!0,i="replace"){switch(i){case"replace":this.indices=t.indices,this.line_indices=t.line_indices,this.selected_glyphs=t.selected_glyphs,this.view=t.view,this.multiline_indices=t.multiline_indices,this.image_indices=t.image_indices;break;case"append":this.update_through_union(t);break;case"intersect":this.update_through_intersection(t);break;case"subtract":this.update_through_subtraction(t)}}clear(){this.indices=[],this.line_indices=[],this.multiline_indices={},this.view=null,this.selected_glyphs=[]}is_empty(){return 0==this.indices.length&&0==this.line_indices.length&&0==this.image_indices.length}update_through_union(t){this.indices=r.union(this.indices,t.indices),this.selected_glyphs=r.union(t.selected_glyphs,this.selected_glyphs),this.line_indices=r.union(t.line_indices,this.line_indices),this.view=t.view,this.multiline_indices=a.merge(t.multiline_indices,this.multiline_indices)}update_through_intersection(t){this.indices=r.intersection(this.indices,t.indices),this.selected_glyphs=r.union(t.selected_glyphs,this.selected_glyphs),this.line_indices=r.union(t.line_indices,this.line_indices),this.view=t.view,this.multiline_indices=a.merge(t.multiline_indices,this.multiline_indices)}update_through_subtraction(t){this.indices=r.difference(this.indices,t.indices),this.selected_glyphs=r.union(t.selected_glyphs,this.selected_glyphs),this.line_indices=r.union(t.line_indices,this.line_indices),this.view=t.view,this.multiline_indices=a.merge(t.multiline_indices,this.multiline_indices)}}i.Selection=l,l.__name__="Selection",l.init_Selection()},function(t,e,i,s,n){s();const o=t(14),r=t(59),a=t(61),l=t(123);class c extends o.HasProps{constructor(t){super(t),this.inspectors=new Map}static init_SelectionManager(){this.internal((({AnyRef:t})=>({source:[t()]})))}select(t,e,i,s="replace"){const n=[],o=[];for(const c of t)c instanceof a.GlyphRendererView?n.push(c):c instanceof l.GraphRendererView&&o.push(c);let r=!1;for(const a of o){const t=a.model.selection_policy.hit_test(e,a);r=r||a.model.selection_policy.do_selection(t,a.model,i,s)}if(n.length>0){const t=this.source.selection_policy.hit_test(e,n);r=r||this.source.selection_policy.do_selection(t,this.source,i,s)}return r}inspect(t,e){let i=!1;if(t instanceof a.GlyphRendererView){const s=t.hit_test(e);if(null!=s){i=!s.is_empty();const n=this.get_or_create_inspector(t.model);n.update(s,!0,"replace"),this.source.setv({inspected:n},{silent:!0}),this.source.inspect.emit([t.model,{geometry:e}])}}else if(t instanceof l.GraphRendererView){const s=t.model.inspection_policy.hit_test(e,t);i=i||t.model.inspection_policy.do_inspection(s,e,t,!1,"replace")}return i}clear(t){this.source.selected.clear(),null!=t&&this.get_or_create_inspector(t.model).clear()}get_or_create_inspector(t){let e=this.inspectors.get(t);return null==e&&(e=new r.Selection,this.inspectors.set(t,e)),e}}i.SelectionManager=c,c.__name__="SelectionManager",c.init_SelectionManager()},function(t,e,i,s,n){s();const o=t(62),r=t(63),a=t(116),l=t(117),c=t(119),h=t(98),_=t(57),d=t(120),u=t(24),p=t(12),m=t(9),g=t(13),f=t(122),b=t(104),v={fill:{},line:{}},y={fill:{fill_alpha:.3,fill_color:"grey"},line:{line_alpha:.3,line_color:"grey"}},x={fill:{fill_alpha:.2},line:{}};class w extends o.DataRendererView{get glyph_view(){return this.glyph}async lazy_initialize(){var t,e;await super.lazy_initialize();const i=this.model.glyph;this.glyph=await this.build_glyph_view(i);const s="fill"in this.glyph.visuals,n="line"in this.glyph.visuals,o=Object.assign({},i.attributes);function r(t){const e=g.clone(o);return s&&g.extend(e,t.fill),n&&g.extend(e,t.line),new i.constructor(e)}delete o.id;let{selection_glyph:a}=this.model;null==a?a=r({fill:{},line:{}}):"auto"==a&&(a=r(v)),this.selection_glyph=await this.build_glyph_view(a);let{nonselection_glyph:l}=this.model;null==l?l=r({fill:{},line:{}}):"auto"==l&&(l=r(x)),this.nonselection_glyph=await this.build_glyph_view(l);const{hover_glyph:c}=this.model;null!=c&&(this.hover_glyph=await this.build_glyph_view(c));const{muted_glyph:h}=this.model;null!=h&&(this.muted_glyph=await this.build_glyph_view(h));const _=r(y);this.decimated_glyph=await this.build_glyph_view(_),this.selection_glyph.set_base(this.glyph),this.nonselection_glyph.set_base(this.glyph),null===(t=this.hover_glyph)||void 0===t||t.set_base(this.glyph),null===(e=this.muted_glyph)||void 0===e||e.set_base(this.glyph),this.decimated_glyph.set_base(this.glyph),this.set_data()}async build_glyph_view(t){return f.build_view(t,{parent:this})}remove(){var t,e;this.glyph.remove(),this.selection_glyph.remove(),this.nonselection_glyph.remove(),null===(t=this.hover_glyph)||void 0===t||t.remove(),null===(e=this.muted_glyph)||void 0===e||e.remove(),this.decimated_glyph.remove(),super.remove()}connect_signals(){super.connect_signals();const t=()=>this.request_render(),e=()=>this.update_data();this.connect(this.model.change,t),this.connect(this.glyph.model.change,e),this.connect(this.selection_glyph.model.change,e),this.connect(this.nonselection_glyph.model.change,e),null!=this.hover_glyph&&this.connect(this.hover_glyph.model.change,e),null!=this.muted_glyph&&this.connect(this.muted_glyph.model.change,e),this.connect(this.decimated_glyph.model.change,e),this.connect(this.model.data_source.change,e),this.connect(this.model.data_source.streaming,e),this.connect(this.model.data_source.patching,(t=>this.update_data(t))),this.connect(this.model.data_source.selected.change,t),this.connect(this.model.data_source._select,t),null!=this.hover_glyph&&this.connect(this.model.data_source.inspect,t),this.connect(this.model.properties.view.change,e),this.connect(this.model.view.properties.indices.change,e),this.connect(this.model.view.properties.masked.change,(()=>this.set_visuals())),this.connect(this.model.properties.visible.change,(()=>this.plot_view.invalidate_dataranges=!0));const{x_ranges:i,y_ranges:s}=this.plot_view.frame;for(const[,r]of i)r instanceof b.FactorRange&&this.connect(r.change,e);for(const[,r]of s)r instanceof b.FactorRange&&this.connect(r.change,e);const{transformchange:n,exprchange:o}=this.model.glyph;this.connect(n,e),this.connect(o,e)}_update_masked_indices(){const t=this.glyph.mask_data();return this.model.view.masked=t,t}update_data(t){this.set_data(t),this.request_render()}set_data(t){const e=this.model.data_source;this.all_indices=this.model.view.indices;const{all_indices:i}=this;this.glyph.set_data(e,i,t),this.set_visuals(),this._update_masked_indices();const{lod_factor:s}=this.plot_model,n=this.all_indices.count;this.decimated=new u.Indices(n);for(let o=0;o<n;o+=s)this.decimated.set(o);this.plot_view.invalidate_dataranges=!0}set_visuals(){var t,e,i,s;const n=this.model.data_source,{all_indices:o}=this;this.glyph.set_visuals(n,o),this.decimated_glyph.set_visuals(n,o),null===(t=this.selection_glyph)||void 0===t||t.set_visuals(n,o),null===(e=this.nonselection_glyph)||void 0===e||e.set_visuals(n,o),null===(i=this.hover_glyph)||void 0===i||i.set_visuals(n,o),null===(s=this.muted_glyph)||void 0===s||s.set_visuals(n,o)}get has_webgl(){return this.glyph.has_webgl}_render(){const t=this.has_webgl;this.glyph.map_data();const e=[...this.all_indices];let i=[...this._update_masked_indices()];const{ctx:s}=this.layer;s.save();const{selected:n}=this.model.data_source;let o;o=!n||n.is_empty()?[]:this.glyph instanceof r.LineView&&n.selected_glyph===this.glyph.model?this.model.view.convert_indices_from_subset(i):n.indices;const{inspected:h}=this.model.data_source,_=new Set((()=>!h||h.is_empty()?[]:h.selected_glyph?this.model.view.convert_indices_from_subset(i):h.indices.length>0?h.indices:Object.keys(h.multiline_indices).map((t=>parseInt(t))))()),d=p.filter(i,(t=>_.has(e[t]))),{lod_threshold:u}=this.plot_model;let g,f,b;if(null!=this.model.document&&this.model.document.interactive_duration()>0&&!t&&null!=u&&e.length>u?(i=[...this.decimated],g=this.decimated_glyph,f=this.decimated_glyph,b=this.selection_glyph):(g=this.model.muted&&null!=this.muted_glyph?this.muted_glyph:this.glyph,f=this.nonselection_glyph,b=this.selection_glyph),null!=this.hover_glyph&&d.length&&(i=m.difference(i,d)),o.length){const t={};for(const e of o)t[e]=!0;const n=new Array,a=new Array;if(this.glyph instanceof r.LineView)for(const i of e)null!=t[i]?n.push(i):a.push(i);else for(const s of i)null!=t[e[s]]?n.push(s):a.push(s);f.render(s,a),b.render(s,n),null!=this.hover_glyph&&(this.glyph instanceof r.LineView?this.hover_glyph.render(s,this.model.view.convert_indices_from_subset(d)):this.hover_glyph.render(s,d))}else if(this.glyph instanceof r.LineView)this.hover_glyph&&d.length?this.hover_glyph.render(s,this.model.view.convert_indices_from_subset(d)):g.render(s,e);else if(this.glyph instanceof a.PatchView||this.glyph instanceof l.HAreaView||this.glyph instanceof c.VAreaView)if(0==h.selected_glyphs.length||null==this.hover_glyph)g.render(s,e);else for(const r of h.selected_glyphs)r==this.glyph.model&&this.hover_glyph.render(s,e);else g.render(s,i),this.hover_glyph&&d.length&&this.hover_glyph.render(s,d);s.restore()}draw_legend(t,e,i,s,n,o,r,a){0!=this.glyph.data_size&&(null==a&&(a=this.model.get_reference_point(o,r)),this.glyph.draw_legend_for_index(t,{x0:e,x1:i,y0:s,y1:n},a))}hit_test(t){if(!this.model.visible)return null;const e=this.glyph.hit_test(t);return null==e?null:this.model.view.convert_selection_from_subset(e)}}i.GlyphRendererView=w,w.__name__="GlyphRendererView";class A extends o.DataRenderer{constructor(t){super(t)}static init_GlyphRenderer(){this.prototype.default_view=w,this.define((({Boolean:t,Auto:e,Or:i,Ref:s,Null:n,Nullable:o})=>({data_source:[s(_.ColumnarDataSource)],view:[s(d.CDSView),t=>new d.CDSView({source:t.data_source})],glyph:[s(h.Glyph)],hover_glyph:[o(s(h.Glyph)),null],nonselection_glyph:[i(s(h.Glyph),e,n),"auto"],selection_glyph:[i(s(h.Glyph),e,n),"auto"],muted_glyph:[o(s(h.Glyph)),null],muted:[t,!1]})))}initialize(){super.initialize(),this.view.source!=this.data_source&&(this.view.source=this.data_source,this.view.compute_indices())}get_reference_point(t,e){if(null!=t){const i=this.data_source.get_column(t);if(null!=i)for(const[t,s]of Object.entries(this.view.indices_map))if(i[parseInt(t)]==e)return s}return 0}get_selection_manager(){return this.data_source.selection_manager}}i.GlyphRenderer=A,A.__name__="GlyphRenderer",A.init_GlyphRenderer()},function(t,e,i,s,n){s();const o=t(41);class r extends o.RendererView{get xscale(){return this.coordinates.x_scale}get yscale(){return this.coordinates.y_scale}}i.DataRendererView=r,r.__name__="DataRendererView";class a extends o.Renderer{constructor(t){super(t)}static init_DataRenderer(){this.override({level:"glyph"})}get selection_manager(){return this.get_selection_manager()}}i.DataRenderer=a,a.__name__="DataRenderer",a.init_DataRenderer()},function(t,e,i,s,n){s();const o=t(1),r=t(64),a=t(106),l=t(108),c=o.__importStar(t(48)),h=o.__importStar(t(107)),_=t(59);class d extends r.XYGlyphView{initialize(){super.initialize();const{webgl:t}=this.renderer.plot_view.canvas_view;null!=t&&(this.glglyph=new l.LineGL(t.gl,this))}_render(t,e,i){const{sx:s,sy:n}=null!=i?i:this;let o=!0;t.beginPath();for(const r of e){const e=s[r],i=n[r];isFinite(e+i)?o?(t.moveTo(e,i),o=!1):t.lineTo(e,i):o=!0}this.visuals.line.set_value(t),t.stroke()}_hit_point(t){const e=new _.Selection,i={x:t.sx,y:t.sy};let s=9999;const n=Math.max(2,this.line_width.value/2);for(let o=0,r=this.sx.length-1;o<r;o++){const t={x:this.sx[o],y:this.sy[o]},r={x:this.sx[o+1],y:this.sy[o+1]},a=h.dist_to_segment(i,t,r);a<n&&a<s&&(s=a,e.add_to_selected_glyphs(this.model),e.view=this,e.line_indices=[o])}return e}_hit_span(t){const{sx:e,sy:i}=t,s=new _.Selection;let n,o;"v"==t.direction?(n=this.renderer.yscale.invert(i),o=this._y):(n=this.renderer.xscale.invert(e),o=this._x);for(let r=0,a=o.length-1;r<a;r++)(o[r]<=n&&n<=o[r+1]||o[r+1]<=n&&n<=o[r])&&(s.add_to_selected_glyphs(this.model),s.view=this,s.line_indices.push(r));return s}get_interpolation_hit(t,e){const[i,s,n,o]=[this._x[t],this._y[t],this._x[t+1],this._y[t+1]];return a.line_interpolation(this.renderer,e,i,s,n,o)}draw_legend_for_index(t,e,i){a.generic_line_scalar_legend(this.visuals,t,e)}}i.LineView=d,d.__name__="LineView";class u extends r.XYGlyph{constructor(t){super(t)}static init_Line(){this.prototype.default_view=d,this.mixins(c.LineScalar)}}i.Line=u,u.__name__="Line",u.init_Line()},function(t,e,i,s,n){s();const o=t(1),r=t(65),a=o.__importStar(t(18)),l=t(98);class c extends l.GlyphView{_project_data(){r.inplace.project_xy(this._x,this._y)}_index_data(t){const{_x:e,_y:i,data_size:s}=this;for(let n=0;n<s;n++){const s=e[n],o=i[n];isNaN(s+o)||!isFinite(s+o)?t.add_empty():t.add(s,o,s,o)}}scenterxy(t){return[this.sx[t],this.sy[t]]}}i.XYGlyphView=c,c.__name__="XYGlyphView";class h extends l.Glyph{constructor(t){super(t)}static init_XYGlyph(){this.define((({})=>({x:[a.XCoordinateSpec,{field:"x"}],y:[a.YCoordinateSpec,{field:"y"}]})))}}i.XYGlyph=h,h.__name__="XYGlyph",h.init_XYGlyph()},function(t,e,i,s,n){s();const o=t(1),r=o.__importDefault(t(66)),a=o.__importDefault(t(67)),l=t(24),c=new a.default("GOOGLE"),h=new a.default("WGS84"),_=r.default(h,c);i.wgs84_mercator={compute:(t,e)=>isFinite(t)&&isFinite(e)?_.forward([t,e]):[NaN,NaN],invert:(t,e)=>isFinite(t)&&isFinite(e)?_.inverse([t,e]):[NaN,NaN]};const d={lon:[-20026376.39,20026376.39],lat:[-20048966.1,20048966.1]},u={lon:[-180,180],lat:[-85.06,85.06]},{min:p,max:m}=Math;function g(t,e){const s=p(t.length,e.length),n=l.infer_type(t,e),o=new n(s),r=new n(s);return i.inplace.project_xy(t,e,o,r),[o,r]}i.clip_mercator=function(t,e,i){const[s,n]=d[i];return[m(t,s),p(e,n)]},i.in_bounds=function(t,e){const[i,s]=u[e];return i<t&&t<s},function(t){function e(t,e,s,n){const o=p(t.length,e.length);s=null!=s?s:t,n=null!=n?n:e;for(let r=0;r<o;r++){const o=t[r],a=e[r],[l,c]=i.wgs84_mercator.compute(o,a);s[r]=l,n[r]=c}}t.project_xy=e,t.project_xsys=function(t,i,s,n){const o=p(t.length,i.length);s=null!=s?s:t,n=null!=n?n:i;for(let r=0;r<o;r++)e(t[r],i[r],s[r],n[r])}}(i.inplace||(i.inplace={})),i.project_xy=g,i.project_xsys=function(t,e){const i=p(t.length,e.length),s=new Array(i),n=new Array(i);for(let o=0;o<i;o++){const[i,r]=g(t[o],e[o]);s[o]=i,n[o]=r}return[s,n]}},function(t,e,i,s,n){s();const o=t(1),r=o.__importDefault(t(67)),a=o.__importDefault(t(92));var l=r.default("WGS84");function c(t,e,i){var s,n,o;return Array.isArray(i)?(s=a.default(t,e,i)||{x:NaN,y:NaN},i.length>2?void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name?"number"==typeof s.z?[s.x,s.y,s.z].concat(i.splice(3)):[s.x,s.y,i[2]].concat(i.splice(3)):[s.x,s.y].concat(i.splice(2)):[s.x,s.y]):(n=a.default(t,e,i),2===(o=Object.keys(i)).length||o.forEach((function(s){if(void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name){if("x"===s||"y"===s||"z"===s)return}else if("x"===s||"y"===s)return;n[s]=i[s]})),n)}function h(t){return t instanceof r.default?t:t.oProj?t.oProj:r.default(t)}i.default=function(t,e,i){t=h(t);var s,n=!1;return void 0===e?(e=t,t=l,n=!0):(void 0!==e.x||Array.isArray(e))&&(i=e,e=t,t=l,n=!0),e=h(e),i?c(t,e,i):(s={forward:function(i){return c(t,e,i)},inverse:function(i){return c(e,t,i)}},n&&(s.oProj=e),s)}},function(t,e,i,s,n){s();const o=t(1),r=o.__importDefault(t(68)),a=o.__importDefault(t(79)),l=o.__importDefault(t(80)),c=t(88),h=o.__importDefault(t(90)),_=o.__importDefault(t(91)),d=o.__importDefault(t(75));function u(t,e){if(!(this instanceof u))return new u(t);e=e||function(t){if(t)throw t};var i=r.default(t);if("object"==typeof i){var s=u.projections.get(i.projName);if(s){if(i.datumCode&&"none"!==i.datumCode){var n=d.default(h.default,i.datumCode);n&&(i.datum_params=n.towgs84?n.towgs84.split(","):null,i.ellps=n.ellipse,i.datumName=n.datumName?n.datumName:i.datumCode)}i.k0=i.k0||1,i.axis=i.axis||"enu",i.ellps=i.ellps||"wgs84";var o=c.sphere(i.a,i.b,i.rf,i.ellps,i.sphere),l=c.eccentricity(o.a,o.b,o.rf,i.R_A),p=i.datum||_.default(i.datumCode,i.datum_params,o.a,o.b,l.es,l.ep2);a.default(this,i),a.default(this,s),this.a=o.a,this.b=o.b,this.rf=o.rf,this.sphere=o.sphere,this.es=l.es,this.e=l.e,this.ep2=l.ep2,this.datum=p,this.init(),e(null,this)}else e(t)}else e(t)}u.projections=l.default,u.projections.start(),i.default=u},function(t,e,i,s,n){s();const o=t(1),r=o.__importDefault(t(69)),a=o.__importDefault(t(76)),l=o.__importDefault(t(71)),c=o.__importDefault(t(75));var h=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],_=["3857","900913","3785","102113"];i.default=function(t){if(!function(t){return"string"==typeof t}(t))return t;if(function(t){return t in r.default}(t))return r.default[t];if(function(t){return h.some((function(e){return t.indexOf(e)>-1}))}(t)){var e=a.default(t);if(function(t){var e=c.default(t,"authority");if(e){var i=c.default(e,"epsg");return i&&_.indexOf(i)>-1}}(e))return r.default["EPSG:3857"];var i=function(t){var e=c.default(t,"extension");if(e)return c.default(e,"proj4")}(e);return i?l.default(i):e}return function(t){return"+"===t[0]}(t)?l.default(t):void 0}},function(t,e,i,s,n){s();const o=t(1),r=o.__importDefault(t(70)),a=o.__importDefault(t(71)),l=o.__importDefault(t(76));function c(t){var e=this;if(2===arguments.length){var i=arguments[1];"string"==typeof i?"+"===i.charAt(0)?c[t]=a.default(arguments[1]):c[t]=l.default(arguments[1]):c[t]=i}else if(1===arguments.length){if(Array.isArray(t))return t.map((function(t){Array.isArray(t)?c.apply(e,t):c(t)}));if("string"==typeof t){if(t in c)return c[t]}else"EPSG"in t?c["EPSG:"+t.EPSG]=t:"ESRI"in t?c["ESRI:"+t.ESRI]=t:"IAU2000"in t?c["IAU2000:"+t.IAU2000]=t:console.log(t);return}}r.default(c),i.default=c},function(t,e,i,s,n){s(),i.default=function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}},function(t,e,i,s,n){s();const o=t(1),r=t(72),a=o.__importDefault(t(73)),l=o.__importDefault(t(74)),c=o.__importDefault(t(75));i.default=function(t){var e,i,s,n={},o=t.split("+").map((function(t){return t.trim()})).filter((function(t){return t})).reduce((function(t,e){var i=e.split("=");return i.push(!0),t[i[0].toLowerCase()]=i[1],t}),{}),h={proj:"projName",datum:"datumCode",rf:function(t){n.rf=parseFloat(t)},lat_0:function(t){n.lat0=t*r.D2R},lat_1:function(t){n.lat1=t*r.D2R},lat_2:function(t){n.lat2=t*r.D2R},lat_ts:function(t){n.lat_ts=t*r.D2R},lon_0:function(t){n.long0=t*r.D2R},lon_1:function(t){n.long1=t*r.D2R},lon_2:function(t){n.long2=t*r.D2R},alpha:function(t){n.alpha=parseFloat(t)*r.D2R},lonc:function(t){n.longc=t*r.D2R},x_0:function(t){n.x0=parseFloat(t)},y_0:function(t){n.y0=parseFloat(t)},k_0:function(t){n.k0=parseFloat(t)},k:function(t){n.k0=parseFloat(t)},a:function(t){n.a=parseFloat(t)},b:function(t){n.b=parseFloat(t)},r_a:function(){n.R_A=!0},zone:function(t){n.zone=parseInt(t,10)},south:function(){n.utmSouth=!0},towgs84:function(t){n.datum_params=t.split(",").map((function(t){return parseFloat(t)}))},to_meter:function(t){n.to_meter=parseFloat(t)},units:function(t){n.units=t;var e=c.default(l.default,t);e&&(n.to_meter=e.to_meter)},from_greenwich:function(t){n.from_greenwich=t*r.D2R},pm:function(t){var e=c.default(a.default,t);n.from_greenwich=(e||parseFloat(t))*r.D2R},nadgrids:function(t){"@null"===t?n.datumCode="none":n.nadgrids=t},axis:function(t){var e="ewnsud";3===t.length&&-1!==e.indexOf(t.substr(0,1))&&-1!==e.indexOf(t.substr(1,1))&&-1!==e.indexOf(t.substr(2,1))&&(n.axis=t)}};for(e in o)i=o[e],e in h?"function"==typeof(s=h[e])?s(i):n[s]=i:n[e]=i;return"string"==typeof n.datumCode&&"WGS84"!==n.datumCode&&(n.datumCode=n.datumCode.toLowerCase()),n}},function(t,e,i,s,n){s(),i.PJD_3PARAM=1,i.PJD_7PARAM=2,i.PJD_WGS84=4,i.PJD_NODATUM=5,i.SEC_TO_RAD=484813681109536e-20,i.HALF_PI=Math.PI/2,i.SIXTH=.16666666666666666,i.RA4=.04722222222222222,i.RA6=.022156084656084655,i.EPSLN=1e-10,i.D2R=.017453292519943295,i.R2D=57.29577951308232,i.FORTPI=Math.PI/4,i.TWO_PI=2*Math.PI,i.SPI=3.14159265359},function(t,e,i,s,n){s();var o={};i.default=o,o.greenwich=0,o.lisbon=-9.131906111111,o.paris=2.337229166667,o.bogota=-74.080916666667,o.madrid=-3.687938888889,o.rome=12.452333333333,o.bern=7.439583333333,o.jakarta=106.807719444444,o.ferro=-17.666666666667,o.brussels=4.367975,o.stockholm=18.058277777778,o.athens=23.7163375,o.oslo=10.722916666667},function(t,e,i,s,n){s(),i.default={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}}},function(t,e,i,s,n){s();var o=/[\s_\-\/\(\)]/g;i.default=function(t,e){if(t[e])return t[e];for(var i,s=Object.keys(t),n=e.toLowerCase().replace(o,""),r=-1;++r<s.length;)if((i=s[r]).toLowerCase().replace(o,"")===n)return t[i]}},function(t,e,i,s,n){s();const o=t(1),r=o.__importDefault(t(77)),a=t(78);function l(t){return.017453292519943295*t}i.default=function(t){var e=r.default(t),i=e.shift(),s=e.shift();e.unshift(["name",s]),e.unshift(["type",i]);var n={};return a.sExpr(e,n),function(t){if("GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"==typeof t.PROJECTION?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var e="",i=0,s=t.AXIS.length;i<s;++i){var n=t.AXIS[i][0].toLowerCase();-1!==n.indexOf("north")?e+="n":-1!==n.indexOf("south")?e+="s":-1!==n.indexOf("east")?e+="e":-1!==n.indexOf("west")&&(e+="w")}2===e.length&&(e+="u"),3===e.length&&(t.axis=e)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var o=t.GEOGCS;function r(e){return e*(t.to_meter||1)}"GEOGCS"===t.type&&(o=t),o&&(o.DATUM?t.datumCode=o.DATUM.name.toLowerCase():t.datumCode=o.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==t.datumCode&&"new_zealand_1949"!==t.datumCode||(t.datumCode="nzgd49"),"wgs_1984"!==t.datumCode&&"world_geodetic_system_1984"!==t.datumCode||("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),o.DATUM&&o.DATUM.SPHEROID&&(t.ellps=o.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=o.DATUM.SPHEROID.a,t.rf=parseFloat(o.DATUM.SPHEROID.rf,10)),o.DATUM&&o.DATUM.TOWGS84&&(t.datum_params=o.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),"ch1903+"===t.datumCode&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",l],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",l],["x0","false_easting",r],["y0","false_northing",r],["long0","central_meridian",l],["lat0","latitude_of_origin",l],["lat0","standard_parallel_1",l],["lat1","standard_parallel_1",l],["lat2","standard_parallel_2",l],["azimuth","Azimuth"],["alpha","azimuth",l],["srsCode","name"]].forEach((function(e){return i=t,n=(s=e)[0],o=s[1],void(!(n in i)&&o in i&&(i[n]=i[o],3===s.length&&(i[n]=s[2](i[n]))));var i,s,n,o})),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.projName&&"Lambert_Azimuthal_Equal_Area"!==t.projName||(t.long0=t.longc),t.lat_ts||!t.lat1||"Stereographic_South_Pole"!==t.projName&&"Polar Stereographic (variant B)"!==t.projName||(t.lat0=l(t.lat1>0?90:-90),t.lat_ts=t.lat1)}(n),n}},function(t,e,i,s,n){s(),i.default=function(t){return new h(t).output()};var o=/\s/,r=/[A-Za-z]/,a=/[A-Za-z84]/,l=/[,\]]/,c=/[\d\.E\-\+]/;function h(t){if("string"!=typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=1}h.prototype.readCharicter=function(){var t=this.text[this.place++];if(4!==this.state)for(;o.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case 1:return this.neutral(t);case 2:return this.keyword(t);case 4:return this.quoted(t);case 5:return this.afterquote(t);case 3:return this.number(t);case-1:return}},h.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=4);if(l.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},h.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=1)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=1,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},h.prototype.number=function(t){if(!c.test(t)){if(l.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)}this.word+=t},h.prototype.quoted=function(t){'"'!==t?this.word+=t:this.state=5},h.prototype.keyword=function(t){if(a.test(t))this.word+=t;else{if("["===t){var e=[];return e.push(this.word),this.level++,null===this.root?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,void(this.state=1)}if(!l.test(t))throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place);this.afterItem(t)}},h.prototype.neutral=function(t){if(r.test(t))return this.word=t,void(this.state=2);if('"'===t)return this.word="",void(this.state=4);if(c.test(t))return this.word=t,void(this.state=3);if(!l.test(t))throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place);this.afterItem(t)},h.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)}},function(t,e,i,s,n){function o(t,e,i){Array.isArray(e)&&(i.unshift(e),e=null);var s=e?{}:t,n=i.reduce((function(t,e){return r(e,t),t}),s);e&&(t[e]=n)}function r(t,e){if(Array.isArray(t)){var i=t.shift();if("PARAMETER"===i&&(i=t.shift()),1===t.length)return Array.isArray(t[0])?(e[i]={},void r(t[0],e[i])):void(e[i]=t[0]);if(t.length)if("TOWGS84"!==i){if("AXIS"===i)return i in e||(e[i]=[]),void e[i].push(t);var s;switch(Array.isArray(i)||(e[i]={}),i){case"UNIT":case"PRIMEM":case"VERT_DATUM":return e[i]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&r(t[2],e[i]));case"SPHEROID":case"ELLIPSOID":return e[i]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&r(t[3],e[i]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return t[0]=["name",t[0]],void o(e,i,t);default:for(s=-1;++s<t.length;)if(!Array.isArray(t[s]))return r(t,e[i]);return o(e,i,t)}}else e[i]=t;else e[i]=!0}else e[t]=!0}s(),i.sExpr=r},function(t,e,i,s,n){s(),i.default=function(t,e){var i,s;if(t=t||{},!e)return t;for(s in e)void 0!==(i=e[s])&&(t[s]=i);return t}},function(t,e,i,s,n){s();const o=t(1),r=o.__importDefault(t(81)),a=o.__importDefault(t(87));var l=[r.default,a.default],c={},h=[];function _(t,e){var i=h.length;return t.names?(h[i]=t,t.names.forEach((function(t){c[t.toLowerCase()]=i})),this):(console.log(e),!0)}function d(t){if(!t)return!1;var e=t.toLowerCase();return void 0!==c[e]&&h[c[e]]?h[c[e]]:void 0}function u(){l.forEach(_)}i.add=_,i.get=d,i.start=u,i.default={start:u,add:_,get:d}},function(t,e,i,s,n){s();const o=t(1),r=o.__importDefault(t(82)),a=o.__importDefault(t(83)),l=o.__importDefault(t(85)),c=o.__importDefault(t(86)),h=t(72);function _(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=r.default(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function d(t){var e,i,s=t.x,n=t.y;if(n*h.R2D>90&&n*h.R2D<-90&&s*h.R2D>180&&s*h.R2D<-180)return null;if(Math.abs(Math.abs(n)-h.HALF_PI)<=h.EPSLN)return null;if(this.sphere)e=this.x0+this.a*this.k0*a.default(s-this.long0),i=this.y0+this.a*this.k0*Math.log(Math.tan(h.FORTPI+.5*n));else{var o=Math.sin(n),r=l.default(this.e,n,o);e=this.x0+this.a*this.k0*a.default(s-this.long0),i=this.y0-this.a*this.k0*Math.log(r)}return t.x=e,t.y=i,t}function u(t){var e,i,s=t.x-this.x0,n=t.y-this.y0;if(this.sphere)i=h.HALF_PI-2*Math.atan(Math.exp(-n/(this.a*this.k0)));else{var o=Math.exp(-n/(this.a*this.k0));if(-9999===(i=c.default(this.e,o)))return null}return e=a.default(this.long0+s/(this.a*this.k0)),t.x=e,t.y=i,t}i.init=_,i.forward=d,i.inverse=u,i.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"],i.default={init:_,forward:d,inverse:u,names:i.names}},function(t,e,i,s,n){s(),i.default=function(t,e,i){var s=t*e;return i/Math.sqrt(1-s*s)}},function(t,e,i,s,n){s();const o=t(1),r=t(72),a=o.__importDefault(t(84));i.default=function(t){return Math.abs(t)<=r.SPI?t:t-a.default(t)*r.TWO_PI}},function(t,e,i,s,n){s(),i.default=function(t){return t<0?-1:1}},function(t,e,i,s,n){s();const o=t(72);i.default=function(t,e,i){var s=t*i,n=.5*t;return s=Math.pow((1-s)/(1+s),n),Math.tan(.5*(o.HALF_PI-e))/s}},function(t,e,i,s,n){s();const o=t(72);i.default=function(t,e){for(var i,s,n=.5*t,r=o.HALF_PI-2*Math.atan(e),a=0;a<=15;a++)if(i=t*Math.sin(r),r+=s=o.HALF_PI-2*Math.atan(e*Math.pow((1-i)/(1+i),n))-r,Math.abs(s)<=1e-10)return r;return-9999}},function(t,e,i,s,n){function o(){}function r(t){return t}s(),i.init=o,i.forward=r,i.inverse=r,i.names=["longlat","identity"],i.default={init:o,forward:r,inverse:r,names:i.names}},function(t,e,i,s,n){s();const o=t(1),r=t(72),a=o.__importStar(t(89)),l=o.__importDefault(t(75));i.eccentricity=function(t,e,i,s){var n=t*t,o=e*e,a=(n-o)/n,l=0;return s?(n=(t*=1-a*(r.SIXTH+a*(r.RA4+a*r.RA6)))*t,a=0):l=Math.sqrt(a),{es:a,e:l,ep2:(n-o)/o}},i.sphere=function(t,e,i,s,n){if(!t){var o=l.default(a.default,s);o||(o=a.WGS84),t=o.a,e=o.b,i=o.rf}return i&&!e&&(e=(1-1/i)*t),(0===i||Math.abs(t-e)<r.EPSLN)&&(n=!0,e=t),{a:t,b:e,rf:i,sphere:n}}},function(t,e,i,s,n){s();var o={};i.default=o,o.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},o.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},o.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},o.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},o.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},o.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},o.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},o.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},o.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},o.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},o.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},o.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},o.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},o.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},o.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},o.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},o.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},o.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},o.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},o.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},o.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},o.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},o.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},o.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},o.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},o.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},o.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},o.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},o.hough={a:6378270,rf:297,ellipseName:"Hough"},o.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},o.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},o.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},o.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},o.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},o.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},o.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},o.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},o.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"},o.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},o.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},o.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"},i.WGS84=o.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"},o.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},function(t,e,i,s,n){s();var o={};i.default=o,o.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},o.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},o.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},o.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},o.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},o.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},o.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},o.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},o.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},o.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},o.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},o.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},o.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},o.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},o.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},o.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},o.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},function(t,e,i,s,n){s();const o=t(72);i.default=function(t,e,i,s,n,r){var a={};return a.datum_type=void 0===t||"none"===t?o.PJD_NODATUM:o.PJD_WGS84,e&&(a.datum_params=e.map(parseFloat),0===a.datum_params[0]&&0===a.datum_params[1]&&0===a.datum_params[2]||(a.datum_type=o.PJD_3PARAM),a.datum_params.length>3&&(0===a.datum_params[3]&&0===a.datum_params[4]&&0===a.datum_params[5]&&0===a.datum_params[6]||(a.datum_type=o.PJD_7PARAM,a.datum_params[3]*=o.SEC_TO_RAD,a.datum_params[4]*=o.SEC_TO_RAD,a.datum_params[5]*=o.SEC_TO_RAD,a.datum_params[6]=a.datum_params[6]/1e6+1))),a.a=i,a.b=s,a.es=n,a.ep2=r,a}},function(t,e,i,s,n){s();const o=t(1),r=t(72),a=o.__importDefault(t(93)),l=o.__importDefault(t(95)),c=o.__importDefault(t(67)),h=o.__importDefault(t(96)),_=o.__importDefault(t(97));i.default=function t(e,i,s){var n;if(Array.isArray(s)&&(s=h.default(s)),_.default(s),e.datum&&i.datum&&function(t,e){return(t.datum.datum_type===r.PJD_3PARAM||t.datum.datum_type===r.PJD_7PARAM)&&"WGS84"!==e.datumCode||(e.datum.datum_type===r.PJD_3PARAM||e.datum.datum_type===r.PJD_7PARAM)&&"WGS84"!==t.datumCode}(e,i)&&(s=t(e,n=new c.default("WGS84"),s),e=n),"enu"!==e.axis&&(s=l.default(e,!1,s)),"longlat"===e.projName)s={x:s.x*r.D2R,y:s.y*r.D2R,z:s.z||0};else if(e.to_meter&&(s={x:s.x*e.to_meter,y:s.y*e.to_meter,z:s.z||0}),!(s=e.inverse(s)))return;return e.from_greenwich&&(s.x+=e.from_greenwich),s=a.default(e.datum,i.datum,s),i.from_greenwich&&(s={x:s.x-i.from_greenwich,y:s.y,z:s.z||0}),"longlat"===i.projName?s={x:s.x*r.R2D,y:s.y*r.R2D,z:s.z||0}:(s=i.forward(s),i.to_meter&&(s={x:s.x/i.to_meter,y:s.y/i.to_meter,z:s.z||0})),"enu"!==i.axis?l.default(i,!0,s):s}},function(t,e,i,s,n){s();const o=t(72),r=t(94);function a(t){return t===o.PJD_3PARAM||t===o.PJD_7PARAM}i.default=function(t,e,i){return r.compareDatums(t,e)||t.datum_type===o.PJD_NODATUM||e.datum_type===o.PJD_NODATUM?i:t.es!==e.es||t.a!==e.a||a(t.datum_type)||a(e.datum_type)?(i=r.geodeticToGeocentric(i,t.es,t.a),a(t.datum_type)&&(i=r.geocentricToWgs84(i,t.datum_type,t.datum_params)),a(e.datum_type)&&(i=r.geocentricFromWgs84(i,e.datum_type,e.datum_params)),r.geocentricToGeodetic(i,e.es,e.a,e.b)):i}},function(t,e,i,s,n){s();const o=t(72);i.compareDatums=function(t,e){return t.datum_type===e.datum_type&&!(t.a!==e.a||Math.abs(t.es-e.es)>5e-11)&&(t.datum_type===o.PJD_3PARAM?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:t.datum_type!==o.PJD_7PARAM||t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6])},i.geodeticToGeocentric=function(t,e,i){var s,n,r,a,l=t.x,c=t.y,h=t.z?t.z:0;if(c<-o.HALF_PI&&c>-1.001*o.HALF_PI)c=-o.HALF_PI;else if(c>o.HALF_PI&&c<1.001*o.HALF_PI)c=o.HALF_PI;else{if(c<-o.HALF_PI)return{x:-1/0,y:-1/0,z:t.z};if(c>o.HALF_PI)return{x:1/0,y:1/0,z:t.z}}return l>Math.PI&&(l-=2*Math.PI),n=Math.sin(c),a=Math.cos(c),r=n*n,{x:((s=i/Math.sqrt(1-e*r))+h)*a*Math.cos(l),y:(s+h)*a*Math.sin(l),z:(s*(1-e)+h)*n}},i.geocentricToGeodetic=function(t,e,i,s){var n,r,a,l,c,h,_,d,u,p,m,g,f,b,v,y=1e-12,x=t.x,w=t.y,A=t.z?t.z:0;if(n=Math.sqrt(x*x+w*w),r=Math.sqrt(x*x+w*w+A*A),n/i<y){if(b=0,r/i<y)return o.HALF_PI,v=-s,{x:t.x,y:t.y,z:t.z}}else b=Math.atan2(w,x);a=A/r,d=(l=n/r)*(1-e)*(c=1/Math.sqrt(1-e*(2-e)*l*l)),u=a*c,f=0;do{f++,h=e*(_=i/Math.sqrt(1-e*u*u))/(_+(v=n*d+A*u-_*(1-e*u*u))),g=(m=a*(c=1/Math.sqrt(1-h*(2-h)*l*l)))*d-(p=l*(1-h)*c)*u,d=p,u=m}while(g*g>1e-24&&f<30);return{x:b,y:Math.atan(m/Math.abs(p)),z:v}},i.geocentricToWgs84=function(t,e,i){if(e===o.PJD_3PARAM)return{x:t.x+i[0],y:t.y+i[1],z:t.z+i[2]};if(e===o.PJD_7PARAM){var s=i[0],n=i[1],r=i[2],a=i[3],l=i[4],c=i[5],h=i[6];return{x:h*(t.x-c*t.y+l*t.z)+s,y:h*(c*t.x+t.y-a*t.z)+n,z:h*(-l*t.x+a*t.y+t.z)+r}}},i.geocentricFromWgs84=function(t,e,i){if(e===o.PJD_3PARAM)return{x:t.x-i[0],y:t.y-i[1],z:t.z-i[2]};if(e===o.PJD_7PARAM){var s=i[0],n=i[1],r=i[2],a=i[3],l=i[4],c=i[5],h=i[6],_=(t.x-s)/h,d=(t.y-n)/h,u=(t.z-r)/h;return{x:_+c*d-l*u,y:-c*_+d+a*u,z:l*_-a*d+u}}}},function(t,e,i,s,n){s(),i.default=function(t,e,i){var s,n,o,r=i.x,a=i.y,l=i.z||0,c={};for(o=0;o<3;o++)if(!e||2!==o||void 0!==i.z)switch(0===o?(s=r,n=-1!=="ew".indexOf(t.axis[o])?"x":"y"):1===o?(s=a,n=-1!=="ns".indexOf(t.axis[o])?"y":"x"):(s=l,n="z"),t.axis[o]){case"e":c[n]=s;break;case"w":c[n]=-s;break;case"n":c[n]=s;break;case"s":c[n]=-s;break;case"u":void 0!==i[n]&&(c.z=s);break;case"d":void 0!==i[n]&&(c.z=-s);break;default:return null}return c}},function(t,e,i,s,n){s(),i.default=function(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}},function(t,e,i,s,n){function o(t){if("function"==typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof t||t!=t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}s(),i.default=function(t){o(t.x),o(t.y)}},function(t,e,i,s,n){s();const o=t(1),r=o.__importStar(t(18)),a=o.__importStar(t(99)),l=o.__importStar(t(45)),c=t(42),h=t(53),_=t(19),d=t(24),u=t(8),p=t(100),m=t(12),g=t(26),f=t(101),b=t(104),v=t(59),{abs:y,ceil:x}=Math;class w extends c.View{constructor(){super(...arguments),this._index=null,this._data_size=null,this._nohit_warned=new Set}get renderer(){return this.parent}get has_webgl(){return null!=this.glglyph}get index(){const{_index:t}=this;if(null!=t)return t;throw new Error(`${this}.index_data() wasn't called`)}get data_size(){const{_data_size:t}=this;if(null!=t)return t;throw new Error(`${this}.set_data() wasn't called`)}initialize(){super.initialize(),this.visuals=new l.Visuals(this)}request_render(){this.parent.request_render()}get canvas(){return this.renderer.parent.canvas_view}render(t,e,i){var s;null!=this.glglyph&&(this.renderer.needs_webgl_blit=this.glglyph.render(t,e,null!==(s=this.base)&&void 0!==s?s:this),this.renderer.needs_webgl_blit)||(t.beginPath(),this._render(t,e,null!=i?i:this.base))}has_finished(){return!0}notify_finished(){this.renderer.notify_finished()}_bounds(t){return t}bounds(){return this._bounds(this.index.bbox)}log_bounds(){const{x0:t,x1:e}=this.index.bounds(a.positive_x()),{y0:i,y1:s}=this.index.bounds(a.positive_y());return this._bounds({x0:t,y0:i,x1:e,y1:s})}get_anchor_point(t,e,[i,s]){switch(t){case"center":case"center_center":{const[t,n]=this.scenterxy(e,i,s);return{x:t,y:n}}default:return null}}scenterx(t,e,i){return this.scenterxy(t,e,i)[0]}scentery(t,e,i){return this.scenterxy(t,e,i)[1]}sdist(t,e,i,s="edge",n=!1){const o=e.length,r=new d.ScreenArray(o),a=t.s_compute;if("center"==s)for(let l=0;l<o;l++){const t=e[l],s=i.get(l)/2,n=a(t-s),o=a(t+s);r[l]=y(o-n)}else for(let l=0;l<o;l++){const t=e[l],s=a(t),n=a(t+i.get(l));r[l]=y(n-s)}return n&&m.inplace_map(r,(t=>x(t))),r}draw_legend_for_index(t,e,i){}hit_test(t){switch(t.type){case"point":if(null!=this._hit_point)return this._hit_point(t);break;case"span":if(null!=this._hit_span)return this._hit_span(t);break;case"rect":if(null!=this._hit_rect)return this._hit_rect(t);break;case"poly":if(null!=this._hit_poly)return this._hit_poly(t)}return this._nohit_warned.has(t.type)||(_.logger.debug(`'${t.type}' selection not available for ${this.model.type}`),this._nohit_warned.add(t.type)),null}_hit_rect_against_index(t){const{sx0:e,sx1:i,sy0:s,sy1:n}=t,[o,r]=this.renderer.coordinates.x_scale.r_invert(e,i),[a,l]=this.renderer.coordinates.y_scale.r_invert(s,n),c=[...this.index.indices({x0:o,x1:r,y0:a,y1:l})];return new v.Selection({indices:c})}_project_data(){}*_iter_visuals(){for(const t of this.visuals)for(const e of t)(e instanceof r.VectorSpec||e instanceof r.ScalarSpec)&&(yield e)}set_base(t){t!=this&&t instanceof this.constructor&&(this.base=t)}_configure(t,e){Object.defineProperty(this,u.isString(t)?t:t.attr,Object.assign({configurable:!0,enumerable:!0},e))}set_visuals(t,e){var i;for(const s of this._iter_visuals()){const{base:i}=this;if(null!=i){const t=i.model.properties[s.attr];if(null!=t&&g.is_equal(s.get_value(),t.get_value())){this._configure(s,{get:()=>i[`${s.attr}`]});continue}}const n=s.uniform(t).select(e);this._configure(s,{value:n})}for(const s of this.visuals)s.update();null===(i=this.glglyph)||void 0===i||i.set_visuals_changed()}set_data(t,e,i){var s;const{x_range:n,y_range:o}=this.renderer.coordinates,a=new Set(this._iter_visuals());this._data_size=e.count;for(const l of this.model)if((l instanceof r.VectorSpec||l instanceof r.ScalarSpec)&&!a.has(l))if(l instanceof r.BaseCoordinateSpec){const i=l.array(t);let s=e.select(i);const a="x"==l.dimension?n:o;if(a instanceof b.FactorRange)if(l instanceof r.CoordinateSpec)s=a.v_synthetic(s);else if(l instanceof r.CoordinateSeqSpec)for(let t=0;t<s.length;t++)s[t]=a.v_synthetic(s[t]);let c;c=l instanceof r.CoordinateSeqSpec?p.RaggedArray.from(s,Float64Array):s,this._configure(`_${l.attr}`,{value:c})}else{const i=l.uniform(t).select(e);if(this._configure(l,{value:i}),l instanceof r.DistanceSpec){const t=i.is_Scalar()?i.value:m.max(i.array);this._configure(`max_${l.attr}`,{value:t})}}this.renderer.plot_view.model.use_map&&this._project_data(),this._set_data(null!=i?i:null),null===(s=this.glglyph)||void 0===s||s.set_data_changed(),this.index_data()}_set_data(t){}get _index_size(){return this.data_size}index_data(){const t=new f.SpatialIndex(this._index_size);this._index_data(t),t.finish(),this._index=t}mask_data(){return null==this._mask_data?d.Indices.all_set(this.data_size):this._mask_data()}map_data(){var t;const e=this,{x_scale:i,y_scale:s}=this.renderer.coordinates;for(const n of this.model)if(n instanceof r.BaseCoordinateSpec){const t="x"==n.dimension?i:s;let o=e[`_${n.attr}`];if(o instanceof p.RaggedArray){const e=t.v_compute(o.array);o=new p.RaggedArray(o.offsets,e)}else o=t.v_compute(o);this[`s${n.attr}`]=o}this._map_data(),null===(t=this.glglyph)||void 0===t||t.set_data_changed()}_map_data(){}}i.GlyphView=w,w.__name__="GlyphView";class A extends h.Model{constructor(t){super(t)}}i.Glyph=A,A.__name__="Glyph"},function(t,e,i,s,n){s();const o=t(24),r=t(26),{min:a,max:l}=Math;i.empty=function(){return{x0:1/0,y0:1/0,x1:-1/0,y1:-1/0}},i.positive_x=function(){return{x0:Number.MIN_VALUE,y0:-1/0,x1:1/0,y1:1/0}},i.positive_y=function(){return{x0:-1/0,y0:Number.MIN_VALUE,x1:1/0,y1:1/0}},i.union=function(t,e){return{x0:a(t.x0,e.x0),x1:l(t.x1,e.x1),y0:a(t.y0,e.y0),y1:l(t.y1,e.y1)}};class c{constructor(t){if(null==t)this.x0=0,this.y0=0,this.x1=0,this.y1=0;else if("x0"in t){const{x0:e,y0:i,x1:s,y1:n}=t;if(!(e<=s&&i<=n))throw new Error(`invalid bbox {x0: ${e}, y0: ${i}, x1: ${s}, y1: ${n}}`);this.x0=e,this.y0=i,this.x1=s,this.y1=n}else if("x"in t){const{x:e,y:i,width:s,height:n}=t;if(!(s>=0&&n>=0))throw new Error(`invalid bbox {x: ${e}, y: ${i}, width: ${s}, height: ${n}}`);this.x0=e,this.y0=i,this.x1=e+s,this.y1=i+n}else{let e,i,s,n;if("width"in t)if("left"in t)e=t.left,i=e+t.width;else if("right"in t)i=t.right,e=i-t.width;else{const s=t.width/2;e=t.hcenter-s,i=t.hcenter+s}else e=t.left,i=t.right;if("height"in t)if("top"in t)s=t.top,n=s+t.height;else if("bottom"in t)n=t.bottom,s=n-t.height;else{const e=t.height/2;s=t.vcenter-e,n=t.vcenter+e}else s=t.top,n=t.bottom;if(!(e<=i&&s<=n))throw new Error(`invalid bbox {left: ${e}, top: ${s}, right: ${i}, bottom: ${n}}`);this.x0=e,this.y0=s,this.x1=i,this.y1=n}}static from_rect({left:t,right:e,top:i,bottom:s}){return new c({x0:Math.min(t,e),y0:Math.min(i,s),x1:Math.max(t,e),y1:Math.max(i,s)})}equals(t){return this.x0==t.x0&&this.y0==t.y0&&this.x1==t.x1&&this.y1==t.y1}[r.equals](t,e){return e.eq(this.x0,t.x0)&&e.eq(this.y0,t.y0)&&e.eq(this.x1,t.x1)&&e.eq(this.y1,t.y1)}toString(){return`BBox({left: ${this.left}, top: ${this.top}, width: ${this.width}, height: ${this.height}})`}get left(){return this.x0}get top(){return this.y0}get right(){return this.x1}get bottom(){return this.y1}get p0(){return[this.x0,this.y0]}get p1(){return[this.x1,this.y1]}get x(){return this.x0}get y(){return this.y0}get width(){return this.x1-this.x0}get height(){return this.y1-this.y0}get size(){return{width:this.width,height:this.height}}get rect(){const{x0:t,y0:e,x1:i,y1:s}=this;return{p0:{x:t,y:e},p1:{x:i,y:e},p2:{x:i,y:s},p3:{x:t,y:s}}}get box(){const{x:t,y:e,width:i,height:s}=this;return{x:t,y:e,width:i,height:s}}get h_range(){return{start:this.x0,end:this.x1}}get v_range(){return{start:this.y0,end:this.y1}}get ranges(){return[this.h_range,this.v_range]}get aspect(){return this.width/this.height}get hcenter(){return(this.left+this.right)/2}get vcenter(){return(this.top+this.bottom)/2}get area(){return this.width*this.height}relative(){const{width:t,height:e}=this;return new c({x:0,y:0,width:t,height:e})}translate(t,e){const{x:i,y:s,width:n,height:o}=this;return new c({x:t+i,y:e+s,width:n,height:o})}relativize(t,e){return[t-this.x,e-this.y]}contains(t,e){return this.x0<=t&&t<=this.x1&&this.y0<=e&&e<=this.y1}clip(t,e){return t<this.x0?t=this.x0:t>this.x1&&(t=this.x1),e<this.y0?e=this.y0:e>this.y1&&(e=this.y1),[t,e]}grow_by(t){return new c({left:this.left-t,right:this.right+t,top:this.top-t,bottom:this.bottom+t})}shrink_by(t){return new c({left:this.left+t,right:this.right-t,top:this.top+t,bottom:this.bottom-t})}union(t){return new c({x0:a(this.x0,t.x0),y0:a(this.y0,t.y0),x1:l(this.x1,t.x1),y1:l(this.y1,t.y1)})}intersection(t){return this.intersects(t)?new c({x0:l(this.x0,t.x0),y0:l(this.y0,t.y0),x1:a(this.x1,t.x1),y1:a(this.y1,t.y1)}):null}intersects(t){return!(t.x1<this.x0||t.x0>this.x1||t.y1<this.y0||t.y0>this.y1)}get xview(){return{compute:t=>this.left+t,v_compute:t=>{const e=new o.ScreenArray(t.length),i=this.left;for(let s=0;s<t.length;s++)e[s]=i+t[s];return e}}}get yview(){return{compute:t=>this.bottom-t,v_compute:t=>{const e=new o.ScreenArray(t.length),i=this.bottom;for(let s=0;s<t.length;s++)e[s]=i-t[s];return e}}}}i.BBox=c,c.__name__="BBox"},function(t,e,i,s,n){s();const o=t(26),r=t(11);class a{constructor(t,e){this.offsets=t,this.array=e}[o.equals](t,e){return e.arrays(this.offsets,t.offsets)&&e.arrays(this.array,t.array)}get length(){return this.offsets.length}clone(){return new a(this.offsets.slice(),this.array.slice())}static from(t,e){const i=t.length;let s=0;const n=(()=>{const e=new Uint32Array(i);for(let n=0;n<i;n++){const i=t[n].length;e[n]=s,s+=i}return s<256?new Uint8Array(e):s<65536?new Uint16Array(e):e})(),o=new e(s);for(let r=0;r<i;r++)o.set(t[r],n[r]);return new a(n,o)}*[Symbol.iterator](){const{offsets:t,length:e}=this;for(let i=0;i<e;i++)yield this.array.subarray(t[i],t[i+1])}_check_bounds(t){r.assert(0<=t&&t<this.length,`Out of bounds: 0 <= ${t} < ${this.length}`)}get(t){this._check_bounds(t);const{offsets:e}=this;return this.array.subarray(e[t],e[t+1])}set(t,e){this._check_bounds(t),this.array.set(e,this.offsets[t])}}i.RaggedArray=a,a.__name__="RaggedArray",a[Symbol.toStringTag]="RaggedArray"},function(t,e,i,s,n){s();const o=t(1).__importDefault(t(102)),r=t(24),a=t(99);function l(t,e){let i=0,s=e.length-1;for(;i<s;){const n=i+s>>1;e[n]>t?s=n:i=n+1}return e[i]}class c extends o.default{search_indices(t,e,i,s){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let n=this._boxes.length-4;const o=[],a=new r.Indices(this.numItems);for(;void 0!==n;){const r=Math.min(n+4*this.nodeSize,l(n,this._levelBounds));for(let l=n;l<r;l+=4){const r=0|this._indices[l>>2];i<this._boxes[l+0]||s<this._boxes[l+1]||t>this._boxes[l+2]||e>this._boxes[l+3]||(n<4*this.numItems?a.set(r):o.push(r))}n=o.pop()}return a}}c.__name__="_FlatBush";class h{constructor(t){this.index=null,t>0&&(this.index=new c(t))}add(t,e,i,s){var n;null===(n=this.index)||void 0===n||n.add(t,e,i,s)}add_empty(){var t;null===(t=this.index)||void 0===t||t.add(1/0,1/0,-1/0,-1/0)}finish(){var t;null===(t=this.index)||void 0===t||t.finish()}_normalize(t){let{x0:e,y0:i,x1:s,y1:n}=t;return e>s&&([e,s]=[s,e]),i>n&&([i,n]=[n,i]),{x0:e,y0:i,x1:s,y1:n}}get bbox(){if(null==this.index)return a.empty();{const{minX:t,minY:e,maxX:i,maxY:s}=this.index;return{x0:t,y0:e,x1:i,y1:s}}}indices(t){if(null==this.index)return new r.Indices(0);{const{x0:e,y0:i,x1:s,y1:n}=this._normalize(t);return this.index.search_indices(e,i,s,n)}}bounds(t){const e=a.empty();for(const i of this.indices(t)){const t=this.index._boxes,s=t[4*i+0],n=t[4*i+1],o=t[4*i+2],r=t[4*i+3];o<e.x0&&(e.x0=o),s>e.x1&&(e.x1=s),r<e.y0&&(e.y0=r),n>e.y1&&(e.y1=n)}return e}}i.SpatialIndex=h,h.__name__="SpatialIndex"},function(t,e,i,s,n){s();const o=t(1).__importDefault(t(103)),r=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class a{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[e,i]=new Uint8Array(t,0,2);if(251!==e)throw new Error("Data does not appear to be in a Flatbush format.");if(i>>4!=3)throw new Error(`Got v${i>>4} data when expected v3.`);const[s]=new Uint16Array(t,2,1),[n]=new Uint32Array(t,4,1);return new a(n,s,r[15&i],t)}constructor(t,e=16,i=Float64Array,s){if(void 0===t)throw new Error("Missing required argument: numItems.");if(isNaN(t)||t<=0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535);let n=t,a=n;this._levelBounds=[4*n];do{n=Math.ceil(n/this.nodeSize),a+=n,this._levelBounds.push(4*a)}while(1!==n);this.ArrayType=i||Float64Array,this.IndexArrayType=a<16384?Uint16Array:Uint32Array;const l=r.indexOf(this.ArrayType),c=4*a*this.ArrayType.BYTES_PER_ELEMENT;if(l<0)throw new Error(`Unexpected typed array class: ${i}.`);s&&s instanceof ArrayBuffer?(this.data=s,this._boxes=new this.ArrayType(this.data,8,4*a),this._indices=new this.IndexArrayType(this.data,8+c,a),this._pos=4*a,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1]):(this.data=new ArrayBuffer(8+c+a*this.IndexArrayType.BYTES_PER_ELEMENT),this._boxes=new this.ArrayType(this.data,8,4*a),this._indices=new this.IndexArrayType(this.data,8+c,a),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(this.data,0,2).set([251,48+l]),new Uint16Array(this.data,2,1)[0]=e,new Uint32Array(this.data,4,1)[0]=t),this._queue=new o.default}add(t,e,i,s){const n=this._pos>>2;return this._indices[n]=n,this._boxes[this._pos++]=t,this._boxes[this._pos++]=e,this._boxes[this._pos++]=i,this._boxes[this._pos++]=s,t<this.minX&&(this.minX=t),e<this.minY&&(this.minY=e),i>this.maxX&&(this.maxX=i),s>this.maxY&&(this.maxY=s),n}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);if(this.numItems<=this.nodeSize)return this._boxes[this._pos++]=this.minX,this._boxes[this._pos++]=this.minY,this._boxes[this._pos++]=this.maxX,void(this._boxes[this._pos++]=this.maxY);const t=this.maxX-this.minX,e=this.maxY-this.minY,i=new Uint32Array(this.numItems);for(let s=0;s<this.numItems;s++){let n=4*s;const o=this._boxes[n++],r=this._boxes[n++],a=this._boxes[n++],l=this._boxes[n++],c=Math.floor(65535*((o+a)/2-this.minX)/t),h=Math.floor(65535*((r+l)/2-this.minY)/e);i[s]=d(c,h)}h(i,this._boxes,this._indices,0,this.numItems-1,this.nodeSize);for(let s=0,n=0;s<this._levelBounds.length-1;s++){const t=this._levelBounds[s];for(;n<t;){const e=n;let i=1/0,s=1/0,o=-1/0,r=-1/0;for(let a=0;a<this.nodeSize&&n<t;a++)i=Math.min(i,this._boxes[n++]),s=Math.min(s,this._boxes[n++]),o=Math.max(o,this._boxes[n++]),r=Math.max(r,this._boxes[n++]);this._indices[this._pos>>2]=e,this._boxes[this._pos++]=i,this._boxes[this._pos++]=s,this._boxes[this._pos++]=o,this._boxes[this._pos++]=r}}}search(t,e,i,s,n){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let o=this._boxes.length-4;const r=[],a=[];for(;void 0!==o;){const l=Math.min(o+4*this.nodeSize,c(o,this._levelBounds));for(let c=o;c<l;c+=4){const l=0|this._indices[c>>2];i<this._boxes[c]||s<this._boxes[c+1]||t>this._boxes[c+2]||e>this._boxes[c+3]||(o<4*this.numItems?(void 0===n||n(l))&&a.push(l):r.push(l))}o=r.pop()}return a}neighbors(t,e,i=1/0,s=1/0,n){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let o=this._boxes.length-4;const r=this._queue,a=[],h=s*s;for(;void 0!==o;){const s=Math.min(o+4*this.nodeSize,c(o,this._levelBounds));for(let i=o;i<s;i+=4){const s=0|this._indices[i>>2],a=l(t,this._boxes[i],this._boxes[i+2]),c=l(e,this._boxes[i+1],this._boxes[i+3]),h=a*a+c*c;o<4*this.numItems?(void 0===n||n(s))&&r.push(-s-1,h):r.push(s,h)}for(;r.length&&r.peek()<0;){if(r.peekValue()>h)return r.clear(),a;if(a.push(-r.pop()-1),a.length===i)return r.clear(),a}o=r.pop()}return r.clear(),a}}function l(t,e,i){return t<e?e-t:t<=i?0:t-i}function c(t,e){let i=0,s=e.length-1;for(;i<s;){const n=i+s>>1;e[n]>t?s=n:i=n+1}return e[i]}function h(t,e,i,s,n,o){if(Math.floor(s/o)>=Math.floor(n/o))return;const r=t[s+n>>1];let a=s-1,l=n+1;for(;;){do{a++}while(t[a]<r);do{l--}while(t[l]>r);if(a>=l)break;_(t,e,i,a,l)}h(t,e,i,s,l,o),h(t,e,i,l+1,n,o)}function _(t,e,i,s,n){const o=t[s];t[s]=t[n],t[n]=o;const r=4*s,a=4*n,l=e[r],c=e[r+1],h=e[r+2],_=e[r+3];e[r]=e[a],e[r+1]=e[a+1],e[r+2]=e[a+2],e[r+3]=e[a+3],e[a]=l,e[a+1]=c,e[a+2]=h,e[a+3]=_;const d=i[s];i[s]=i[n],i[n]=d}function d(t,e){let i=t^e,s=65535^i,n=65535^(t|e),o=t&(65535^e),r=i|s>>1,a=i>>1^i,l=n>>1^s&o>>1^n,c=i&n>>1^o>>1^o;i=r,s=a,n=l,o=c,r=i&i>>2^s&s>>2,a=i&s>>2^s&(i^s)>>2,l^=i&n>>2^s&o>>2,c^=s&n>>2^(i^s)&o>>2,i=r,s=a,n=l,o=c,r=i&i>>4^s&s>>4,a=i&s>>4^s&(i^s)>>4,l^=i&n>>4^s&o>>4,c^=s&n>>4^(i^s)&o>>4,i=r,s=a,n=l,o=c,l^=i&n>>8^s&o>>8,c^=s&n>>8^(i^s)&o>>8,i=l^l>>1,s=c^c>>1;let h=t^e,_=s|65535^(h|i);return h=16711935&(h|h<<8),h=252645135&(h|h<<4),h=858993459&(h|h<<2),h=1431655765&(h|h<<1),_=16711935&(_|_<<8),_=252645135&(_|_<<4),_=858993459&(_|_<<2),_=1431655765&(_|_<<1),(_<<1|h)>>>0}i.default=a},function(t,e,i,s,n){s(),i.default=class{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(t,e){let i=this.length++;for(this.ids[i]=t,this.values[i]=e;i>0;){const t=i-1>>1,s=this.values[t];if(e>=s)break;this.ids[i]=this.ids[t],this.values[i]=s,i=t}this.ids[i]=t,this.values[i]=e}pop(){if(0===this.length)return;const t=this.ids[0];if(this.length--,this.length>0){const t=this.ids[0]=this.ids[this.length],e=this.values[0]=this.values[this.length],i=this.length>>1;let s=0;for(;s<i;){let t=1+(s<<1);const i=t+1;let n=this.ids[t],o=this.values[t];const r=this.values[i];if(i<this.length&&r<o&&(t=i,n=this.ids[i],o=r),o>=e)break;this.ids[s]=n,this.values[s]=o,s=t}this.ids[s]=t,this.values[s]=e}return t}peek(){if(0!==this.length)return this.ids[0]}peekValue(){if(0!==this.length)return this.values[0]}}},function(t,e,i,s,n){s();const o=t(105),r=t(20),a=t(21),l=t(24),c=t(9),h=t(8),_=t(11);function d(t,e,i=0){const s=new Map;for(let n=0;n<t.length;n++){const o=t[n];if(s.has(o))throw new Error(`duplicate factor or subfactor: ${o}`);s.set(o,{value:.5+n*(1+e)+i})}return[s,(t.length-1)*e]}function u(t,e,i,s=0){var n;const o=new Map,r=new Map;for(const[c,h]of t){const t=null!==(n=r.get(c))&&void 0!==n?n:[];r.set(c,[...t,h])}let a=s,l=0;for(const[h,_]of r){const t=_.length,[s,n]=d(_,i,a);l+=n;const r=c.sum(_.map((t=>s.get(t).value)));o.set(h,{value:r/t,mapping:s}),a+=t+e+n}return[o,(r.size-1)*e+l]}function p(t,e,i,s,n=0){var o;const r=new Map,a=new Map;for(const[c,_,d]of t){const t=null!==(o=a.get(c))&&void 0!==o?o:[];a.set(c,[...t,[_,d]])}let l=n,h=0;for(const[_,d]of a){const t=d.length,[n,o]=u(d,i,s,l);h+=o;const a=c.sum(d.map((([t])=>n.get(t).value)));r.set(_,{value:a/t,mapping:n}),l+=t+e+o}return[r,(a.size-1)*e+h]}i.Factor=a.Or(a.String,a.Tuple(a.String,a.String),a.Tuple(a.String,a.String,a.String)),i.FactorSeq=a.Or(a.Array(a.String),a.Array(a.Tuple(a.String,a.String)),a.Array(a.Tuple(a.String,a.String,a.String))),i.map_one_level=d,i.map_two_levels=u,i.map_three_levels=p;class m extends o.Range{constructor(t){super(t)}static init_FactorRange(){this.define((({Number:t})=>({factors:[i.FactorSeq,[]],factor_padding:[t,0],subgroup_padding:[t,.8],group_padding:[t,1.4],range_padding:[t,0],range_padding_units:[r.PaddingUnits,"percent"],start:[t],end:[t]}))),this.internal((({Number:t,String:e,Array:i,Tuple:s,Nullable:n})=>({levels:[t],mids:[n(i(s(e,e))),null],tops:[n(i(e)),null]})))}get min(){return this.start}get max(){return this.end}initialize(){super.initialize(),this._init(!0)}connect_signals(){super.connect_signals(),this.connect(this.properties.factors.change,(()=>this.reset())),this.connect(this.properties.factor_padding.change,(()=>this.reset())),this.connect(this.properties.group_padding.change,(()=>this.reset())),this.connect(this.properties.subgroup_padding.change,(()=>this.reset())),this.connect(this.properties.range_padding.change,(()=>this.reset())),this.connect(this.properties.range_padding_units.change,(()=>this.reset()))}reset(){this._init(!1),this.change.emit()}_lookup(t){switch(t.length){case 1:{const[e]=t,i=this._mapping.get(e);return null!=i?i.value:NaN}case 2:{const[e,i]=t,s=this._mapping.get(e);if(null!=s){const t=s.mapping.get(i);if(null!=t)return t.value}return NaN}case 3:{const[e,i,s]=t,n=this._mapping.get(e);if(null!=n){const t=n.mapping.get(i);if(null!=t){const e=t.mapping.get(s);if(null!=e)return e.value}}return NaN}default:_.unreachable()}}synthetic(t){if(h.isNumber(t))return t;if(h.isString(t))return this._lookup([t]);let e=0;const i=t[t.length-1];return h.isNumber(i)&&(e=i,t=t.slice(0,-1)),this._lookup(t)+e}v_synthetic(t){const e=t.length,i=new l.ScreenArray(e);for(let s=0;s<e;s++)i[s]=this.synthetic(t[s]);return i}_init(t){const{levels:e,mapping:i,tops:s,mids:n,inside_padding:o}=(()=>{if(c.every(this.factors,h.isString)){const t=this.factors,[e,i]=d(t,this.factor_padding);return{levels:1,mapping:e,tops:null,mids:null,inside_padding:i}}if(c.every(this.factors,(t=>h.isArray(t)&&2==t.length&&h.isString(t[0])&&h.isString(t[1])))){const t=this.factors,[e,i]=u(t,this.group_padding,this.factor_padding),s=[...e.keys()];return{levels:2,mapping:e,tops:s,mids:null,inside_padding:i}}if(c.every(this.factors,(t=>h.isArray(t)&&3==t.length&&h.isString(t[0])&&h.isString(t[1])&&h.isString(t[2])))){const t=this.factors,[e,i]=p(t,this.group_padding,this.subgroup_padding,this.factor_padding),s=[...e.keys()],n=[];for(const[o,r]of e)for(const t of r.mapping.keys())n.push([o,t]);return{levels:3,mapping:e,tops:s,mids:n,inside_padding:i}}_.unreachable()})();this._mapping=i,this.tops=s,this.mids=n;let r=0,a=this.factors.length+o;if("percent"==this.range_padding_units){const t=(a-r)*this.range_padding/2;r-=t,a+=t}else r-=this.range_padding,a+=this.range_padding;this.setv({start:r,end:a,levels:e},{silent:t}),"auto"==this.bounds&&this.setv({bounds:[r,a]},{silent:!0})}}i.FactorRange=m,m.__name__="FactorRange",m.init_FactorRange()},function(t,e,i,s,n){s();const o=t(53);class r extends o.Model{constructor(t){super(t),this.have_updated_interactively=!1}static init_Range(){this.define((({Number:t,Tuple:e,Or:i,Auto:s,Nullable:n})=>({bounds:[n(i(e(n(t),n(t)),s)),null],min_interval:[n(t),null],max_interval:[n(t),null]}))),this.internal((({Array:t,AnyRef:e})=>({plots:[t(e()),[]]})))}get is_reversed(){return this.start>this.end}get is_valid(){return isFinite(this.min)&&isFinite(this.max)}}i.Range=r,r.__name__="Range",r.init_Range()},function(t,e,i,s,n){s();const o=t(1).__importStar(t(107));function r(t,e,{x0:i,x1:s,y0:n,y1:o},r){e.save(),e.beginPath(),e.moveTo(i,(n+o)/2),e.lineTo(s,(n+o)/2),t.line.doit&&(t.line.set_vectorize(e,r),e.stroke()),e.restore()}function a(t,e,{x0:i,x1:s,y0:n,y1:o},r){var a,l;const c=.1*Math.abs(s-i),h=.1*Math.abs(o-n),_=i+c,d=s-c,u=n+h,p=o-h;e.beginPath(),e.rect(_,u,d-_,p-u),t.fill.doit&&(t.fill.set_vectorize(e,r),e.fill()),(null===(a=t.hatch)||void 0===a?void 0:a.doit)&&(t.hatch.set_vectorize(e,r),e.fill()),(null===(l=t.line)||void 0===l?void 0:l.doit)&&(t.line.set_vectorize(e,r),e.stroke())}i.generic_line_scalar_legend=function(t,e,{x0:i,x1:s,y0:n,y1:o}){e.save(),e.beginPath(),e.moveTo(i,(n+o)/2),e.lineTo(s,(n+o)/2),t.line.doit&&(t.line.set_value(e),e.stroke()),e.restore()},i.generic_line_vector_legend=r,i.generic_line_legend=r,i.generic_area_scalar_legend=function(t,e,{x0:i,x1:s,y0:n,y1:o}){var r,a;const l=.1*Math.abs(s-i),c=.1*Math.abs(o-n),h=i+l,_=s-l,d=n+c,u=o-c;e.beginPath(),e.rect(h,d,_-h,u-d),t.fill.doit&&(t.fill.set_value(e),e.fill()),(null===(r=t.hatch)||void 0===r?void 0:r.doit)&&(t.hatch.set_value(e),e.fill()),(null===(a=t.line)||void 0===a?void 0:a.doit)&&(t.line.set_value(e),e.stroke())},i.generic_area_vector_legend=a,i.generic_area_legend=a,i.line_interpolation=function(t,e,i,s,n,r){const{sx:a,sy:l}=e;let c,h,_,d;"point"==e.type?([_,d]=t.yscale.r_invert(l-1,l+1),[c,h]=t.xscale.r_invert(a-1,a+1)):"v"==e.direction?([_,d]=t.yscale.r_invert(l,l),[c,h]=[Math.min(i-1,n-1),Math.max(i+1,n+1)]):([c,h]=t.xscale.r_invert(a,a),[_,d]=[Math.min(s-1,r-1),Math.max(s+1,r+1)]);const{x:u,y:p}=o.check_2_segments_intersect(c,_,h,d,i,s,n,r);return[u,p]}},function(t,e,i,s,n){function o(t,e){return(t.x-e.x)**2+(t.y-e.y)**2}function r(t,e,i){const s=o(e,i);if(0==s)return o(t,e);const n=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/s;return o(t,n<0?e:n>1?i:{x:e.x+n*(i.x-e.x),y:e.y+n*(i.y-e.y)})}s(),i.point_in_poly=function(t,e,i,s){let n=!1,o=i[i.length-1],r=s[s.length-1];for(let a=0;a<i.length;a++){const l=i[a],c=s[a];r<e!=c<e&&o+(e-r)/(c-r)*(l-o)<t&&(n=!n),o=l,r=c}return n},i.point_in_ellipse=function(t,e,i,s,n,o,r){return((Math.cos(i)/n)**2+(Math.sin(i)/s)**2)*(t-o)**2+2*Math.cos(i)*Math.sin(i)*((1/n)**2-(1/s)**2)*(t-o)*(e-r)+((Math.cos(i)/s)**2+(Math.sin(i)/n)**2)*(e-r)**2<=1},i.dist_2_pts=o,i.dist_to_segment_squared=r,i.dist_to_segment=function(t,e,i){return Math.sqrt(r(t,e,i))},i.check_2_segments_intersect=function(t,e,i,s,n,o,r,a){const l=(a-o)*(i-t)-(r-n)*(s-e);if(0==l)return{hit:!1,x:null,y:null};{let c=e-o,h=t-n;const _=(i-t)*c-(s-e)*h;return c=((r-n)*c-(a-o)*h)/l,h=_/l,{hit:c>0&&c<1&&h>0&&h<1,x:t+c*(i-t),y:e+c*(s-e)}}}},function(t,e,i,s,n){s();const o=t(1),r=t(109),a=t(113),l=o.__importDefault(t(114)),c=o.__importDefault(t(115)),h=t(22),_=t(46);class d{constructor(t){this._atlas=new Map,this._width=256,this._height=256,this.tex=new r.Texture2d(t),this.tex.set_wrapping(t.REPEAT,t.REPEAT),this.tex.set_interpolation(t.NEAREST,t.NEAREST),this.tex.set_size([this._width,this._height],t.RGBA),this.tex.set_data([0,0],[this._width,this._height],new Uint8Array(4*this._width*this._height)),this.get_atlas_data([1])}get_atlas_data(t){const e=t.join("-");let i=this._atlas.get(e);if(null==i){const[s,n]=this.make_pattern(t),o=this._atlas.size;this.tex.set_data([0,o],[this._width,1],new Uint8Array(s.map((t=>t+10)))),i=[o/this._height,n],this._atlas.set(e,i)}return i}make_pattern(t){t.length>1&&t.length%2&&(t=t.concat(t));let e=0;for(const r of t)e+=r;const i=[];let s=0;for(let r=0,a=t.length+2;r<a;r+=2){const e=Math.max(1e-4,t[r%t.length]),n=Math.max(1e-4,t[(r+1)%t.length]);i.push(s,s+e),s+=e+n}const n=this._width,o=new Float32Array(4*n);for(let r=0,a=n;r<a;r++){let t,s,a;const l=e*r/(n-1);let c=0,h=1e16;for(let e=0,n=i.length;e<n;e++){const t=Math.abs(i[e]-l);t<h&&(c=e,h=t)}c%2==0?(a=l<=i[c]?1:0,s=i[c],t=i[c+1]):(a=l>i[c]?-1:0,s=i[c-1],t=i[c]),o[4*r+0]=i[c],o[4*r+1]=a,o[4*r+2]=s,o[4*r+3]=t}return[o,e]}}d.__name__="DashAtlas";const u={miter:0,round:1,bevel:2},p={"":0,none:0,".":0,round:1,")":1,"(":1,o:1,"triangle in":2,"<":2,"triangle out":3,">":3,square:4,"[":4,"]":4,"=":4,butt:5,"|":5};class m extends a.BaseGLGlyph{constructor(t,e){super(t,e),this.glyph=e,this._scale_aspect=0;const i=l.default,s=c.default;this.prog=new r.Program(t),this.prog.set_shaders(i,s),this.index_buffer=new r.IndexBuffer(t),this.vbo_position=new r.VertexBuffer(t),this.vbo_tangents=new r.VertexBuffer(t),this.vbo_segment=new r.VertexBuffer(t),this.vbo_angles=new r.VertexBuffer(t),this.vbo_texcoord=new r.VertexBuffer(t),this.dash_atlas=new d(t)}draw(t,e,i){const s=e.glglyph;if(s.data_changed&&(s._set_data(),s.data_changed=!1),this.visuals_changed&&(this._set_visuals(),this.visuals_changed=!1),s._update_scale(1,1),this._scale_aspect=1,this.prog.set_attribute("a_position","vec2",s.vbo_position),this.prog.set_attribute("a_tangents","vec4",s.vbo_tangents),this.prog.set_attribute("a_segment","vec2",s.vbo_segment),this.prog.set_attribute("a_angles","vec2",s.vbo_angles),this.prog.set_attribute("a_texcoord","vec2",s.vbo_texcoord),this.prog.set_uniform("u_length","float",[s.cumsum]),this.prog.set_texture("u_dash_atlas",this.dash_atlas.tex),this.prog.set_uniform("u_pixel_ratio","float",[i.pixel_ratio]),this.prog.set_uniform("u_canvas_size","vec2",[i.width,i.height]),this.prog.set_uniform("u_scale_aspect","vec2",[1,1]),this.prog.set_uniform("u_scale_length","float",[Math.sqrt(2)]),this.I_triangles=s.I_triangles,this.I_triangles.length<65535)this.index_buffer.set_size(2*this.I_triangles.length),this.index_buffer.set_data(0,new Uint16Array(this.I_triangles)),this.prog.draw(this.gl.TRIANGLES,this.index_buffer);else{t=Array.from(this.I_triangles);const e=this.I_triangles.length,i=64008,n=[];for(let t=0,s=Math.ceil(e/i);t<s;t++)n.push([]);for(let s=0,o=t.length;s<o;s++){const e=t[s]%i;n[Math.floor(t[s]/i)].push(e)}for(let t=0,o=n.length;t<o;t++){const e=new Uint16Array(n[t]),o=t*i*4;0!==e.length&&(this.prog.set_attribute("a_position","vec2",s.vbo_position,0,2*o),this.prog.set_attribute("a_tangents","vec4",s.vbo_tangents,0,4*o),this.prog.set_attribute("a_segment","vec2",s.vbo_segment,0,2*o),this.prog.set_attribute("a_angles","vec2",s.vbo_angles,0,2*o),this.prog.set_attribute("a_texcoord","vec2",s.vbo_texcoord,0,2*o),this.index_buffer.set_size(2*e.length),this.index_buffer.set_data(0,e),this.prog.draw(this.gl.TRIANGLES,this.index_buffer))}}}_set_data(){this._bake(),this.vbo_position.set_size(4*this.V_position.length),this.vbo_position.set_data(0,this.V_position),this.vbo_tangents.set_size(4*this.V_tangents.length),this.vbo_tangents.set_data(0,this.V_tangents),this.vbo_angles.set_size(4*this.V_angles.length),this.vbo_angles.set_data(0,this.V_angles),this.vbo_texcoord.set_size(4*this.V_texcoord.length),this.vbo_texcoord.set_data(0,this.V_texcoord)}_set_visuals(){const{line_color:t,line_alpha:e,line_width:i,line_cap:s,line_join:n,line_dash:o,line_dash_offset:r}=this.glyph.visuals.line,[a,l,c,d]=h.color2rgba(t.value,e.value),m=i.value,g=p[s.value],f=u[n.value];this.prog.set_uniform("u_color","vec4",[a/255,l/255,c/255,d/255]),this.prog.set_uniform("u_linewidth","float",[m]),this.prog.set_uniform("u_antialias","float",[.9]),this.prog.set_uniform("u_linecaps","vec2",[g,g]),this.prog.set_uniform("u_linejoin","float",[f]),this.prog.set_uniform("u_miter_limit","float",[10]);const b=_.resolve_line_dash(o.value);let v=0,y=1;b.length&&([v,y]=this.dash_atlas.get_atlas_data(b)),this.prog.set_uniform("u_dash_index","float",[v]),this.prog.set_uniform("u_dash_phase","float",[r.value]),this.prog.set_uniform("u_dash_period","float",[y]),this.prog.set_uniform("u_dash_caps","vec2",[g,g]),this.prog.set_uniform("u_closed","float",[0])}_bake(){let t,e,i,s,n,o,r,a;const l=this.nvertices,c=this.glyph.sx,h=this.glyph.sy,_=r=new Float32Array(2*l),d=new Float32Array(2*l),u=a=new Float32Array(4*l);for(let f=0,b=l;f<b;f++)_[2*f+0]=isFinite(c[f])?c[f]:0,_[2*f+1]=isFinite(h[f])?h[f]:0;this.tangents=e=new Float32Array(2*l-2);for(let f=0,b=l-1;f<b;f++)e[2*f+0]=r[2*(f+1)+0]-r[2*f+0],e[2*f+1]=r[2*(f+1)+1]-r[2*f+1];for(let f=0,b=l-1;f<b;f++)u[4*(f+1)+0]=e[2*f+0],u[4*(f+1)+1]=e[2*f+1],u[4*f+2]=e[2*f+0],u[4*f+3]=e[2*f+1];u[0]=e[0],u[1]=e[1],u[4*(l-1)+2]=e[2*(l-2)+0],u[4*(l-1)+3]=e[2*(l-2)+1];const p=new Float32Array(l);for(let f=0,b=l;f<b;f++)p[f]=Math.atan2(a[4*f+0]*a[4*f+3]-a[4*f+1]*a[4*f+2],a[4*f+0]*a[4*f+2]+a[4*f+1]*a[4*f+3]);for(let f=0,b=l-1;f<b;f++)d[2*f+0]=p[f],d[2*f+1]=p[f+1];for(let f=0,b=l;f<b;f++)isFinite(c[f])||(_[2*f+0]=c[f]),isFinite(h[f])||(_[2*f+1]=h[f]);const m=4*l-4;this.V_position=s=new Float32Array(2*m),this.V_angles=i=new Float32Array(2*m),this.V_tangents=n=new Float32Array(4*m),this.V_texcoord=o=new Float32Array(2*m);for(let f=0,b=l;f<b;f++)for(let t=0;t<4;t++){for(let e=0;e<2;e++)s[2*(4*f+t-2)+e]=_[2*f+e],i[2*(4*f+t)+e]=d[2*f+e];for(let e=0;e<4;e++)n[4*(4*f+t-2)+e]=u[4*f+e]}for(let f=0,b=l;f<b;f++)o[2*(4*f+0)+0]=-1,o[2*(4*f+1)+0]=-1,o[2*(4*f+2)+0]=1,o[2*(4*f+3)+0]=1,o[2*(4*f+0)+1]=-1,o[2*(4*f+1)+1]=1,o[2*(4*f+2)+1]=-1,o[2*(4*f+3)+1]=1;const g=6*(l-1);this.I_triangles=t=new Uint32Array(g);for(let f=0,b=l;f<b;f++)t[6*f+0]=0+4*f,t[6*f+1]=1+4*f,t[6*f+2]=3+4*f,t[6*f+3]=2+4*f,t[6*f+4]=0+4*f,t[6*f+5]=3+4*f}_update_scale(t,e){let i;const s=this.nvertices,n=4*s-4,o=this.tangents,r=new Float32Array(s-1),a=new Float32Array(2*s);this.V_segment=i=new Float32Array(2*n);for(let c=0,h=s-1;c<h;c++)r[c]=Math.sqrt((o[2*c+0]*t)**2+(o[2*c+1]*e)**2);let l=0;for(let c=0,h=s-1;c<h;c++)l+=r[c],a[2*(c+1)+0]=l,a[2*c+1]=l;for(let c=0,h=s;c<h;c++)for(let t=0;t<4;t++)for(let e=0;e<2;e++)i[2*(4*c+t)+e]=a[2*c+e];this.cumsum=l,this.vbo_segment.set_size(4*this.V_segment.length),this.vbo_segment.set_data(0,this.V_segment)}}i.LineGL=m,m.__name__="LineGL"},function(t,e,i,s,n){s(),n("Program",t(110).Program),n("Texture2d",t(112).Texture2d);var o=t(111);n("IndexBuffer",o.IndexBuffer),n("VertexBuffer",o.VertexBuffer)},function(t,e,i,s,n){s();const o=t(111);class r{constructor(t){this.gl=t,this.UTYPEMAP={float:"uniform1fv",vec2:"uniform2fv",vec3:"uniform3fv",vec4:"uniform4fv",int:"uniform1iv",ivec2:"uniform2iv",ivec3:"uniform3iv",ivec4:"uniform4iv",bool:"uniform1iv",bvec2:"uniform2iv",bvec3:"uniform3iv",bvec4:"uniform4iv",mat2:"uniformMatrix2fv",mat3:"uniformMatrix3fv",mat4:"uniformMatrix4fv",sampler1D:"uniform1i",sampler2D:"uniform1i",sampler3D:"uniform1i"},this.ATYPEMAP={float:"vertexAttrib1f",vec2:"vertexAttrib2f",vec3:"vertexAttrib3f",vec4:"vertexAttrib4f"},this.ATYPEINFO={float:[1,5126],vec2:[2,5126],vec3:[3,5126],vec4:[4,5126],vec4_uint8:[4,5121]},this._linked=!1,this._validated=!1,this._unset_variables=new Set,this._known_invalid=new Set,this._locations=new Map,this._samplers=new Map,this._attributes=new Map,this.handle=this.gl.createProgram()}delete(){this.gl.deleteProgram(this.handle)}activate(){this.gl.useProgram(this.handle)}deactivate(){this.gl.useProgram(0)}set_shaders(t,e){const i=this.gl;this._linked=!1;const s=i.createShader(i.VERTEX_SHADER),n=i.createShader(i.FRAGMENT_SHADER),o=[[t,s,"vertex"],[e,n,"fragment"]];for(const[r,a,l]of o)if(i.shaderSource(a,r),i.compileShader(a),!i.getShaderParameter(a,i.COMPILE_STATUS)){const t=i.getShaderInfoLog(a);throw new Error(`errors in ${l} shader:\n${t}`)}if(i.attachShader(this.handle,s),i.attachShader(this.handle,n),i.linkProgram(this.handle),!i.getProgramParameter(this.handle,i.LINK_STATUS)){const t=i.getProgramInfoLog(this.handle);throw new Error(`Program link error:\n${t}`)}this._unset_variables=this._get_active_attributes_and_uniforms(),i.detachShader(this.handle,s),i.detachShader(this.handle,n),i.deleteShader(s),i.deleteShader(n),this._known_invalid.clear(),this._linked=!0}_get_active_attributes_and_uniforms(){const t=this.gl;this._locations.clear();const e=new RegExp("(\\w+)\\s*(\\[(\\d+)\\])\\s*"),i=t.getProgramParameter(this.handle,t.ACTIVE_UNIFORMS),s=[],n=[],o=[[s,t.getProgramParameter(this.handle,t.ACTIVE_ATTRIBUTES),t.getActiveAttrib,t.getAttribLocation],[n,i,t.getActiveUniform,t.getUniformLocation]];for(const[a,l,c,h]of o)for(let i=0;i<l;i+=1){const s=c.call(t,this.handle,i),n=s.name,o=n.match(e);if(null!=o){const t=o[1];for(let e=0;e<s.size;e+=1)a.push([`${t}[${e}]`,s.type])}else a.push([n,s.type]);this._locations.set(n,h.call(t,this.handle,n))}const r=new Set;for(const[a]of s)r.add(a);for(const[a]of n)r.add(a);return r}set_texture(t,e){var i;if(!this._linked)throw new Error("Cannot set uniform when program has no code");const s=null!==(i=this._locations.get(t))&&void 0!==i?i:-1;if(s<0)this._known_invalid.has(t)||(this._known_invalid.add(t),console.log(`"Variable ${t} is not an active texture`));else{this._unset_variables.has(t)&&this._unset_variables.delete(t),this.activate();{let i=this._samplers.size;this._samplers.has(t)&&(i=this._samplers.get(t)[2]),this._samplers.set(t,[e._target,e.handle,i]),this.gl.uniform1i(s,i)}}}set_uniform(t,e,i){var s;if(!this._linked)throw new Error("Cannot set uniform when program has no code");const n=null!==(s=this._locations.get(t))&&void 0!==s?s:-1;if(n<0)return void(this._known_invalid.has(t)||(this._known_invalid.add(t),console.log(`Variable ${t} is not an active uniform`)));this._unset_variables.has(t)&&this._unset_variables.delete(t);let o=1;if(!e.startsWith("mat")){const t="int"==e||"bool"==e?"float":e.replace(/^ib/,"");o=Math.floor(i.length/this.ATYPEINFO[t][0])}if(o>1)for(let a=0;a<o;a+=1)if(this._unset_variables.has(`${t}[${a}]`)){const e=`${t}[${a}]`;this._unset_variables.has(e)&&this._unset_variables.delete(e)}const r=this.UTYPEMAP[e];this.activate(),e.startsWith("mat")?this.gl[r](n,!1,i):this.gl[r](n,i)}set_attribute(t,e,i,s=0,n=0,r=!1){var a;if(!this._linked)throw new Error("Cannot set attribute when program has no code");const l=null!==(a=this._locations.get(t))&&void 0!==a?a:-1;if(l<0)this._known_invalid.has(t)||(this._known_invalid.add(t),i instanceof o.VertexBuffer&&n>0||console.log(`Variable ${t} is not an active attribute`));else if(this._unset_variables.has(t)&&this._unset_variables.delete(t),this.activate(),i instanceof o.VertexBuffer){const[o,a]=this.ATYPEINFO[e],c="vertexAttribPointer",h=[o,a,r,s,n];this._attributes.set(t,[i.handle,l,c,h])}else{const s=this.ATYPEMAP[e];this._attributes.set(t,[null,l,s,i])}}_pre_draw(){this.activate();for(const[t,e,i]of this._samplers.values())this.gl.activeTexture(this.gl.TEXTURE0+i),this.gl.bindTexture(t,e);for(const[t,e,i,s]of this._attributes.values())null!=t?(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),this.gl.enableVertexAttribArray(e),this.gl[i].apply(this.gl,[e,...s])):(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.disableVertexAttribArray(e),this.gl[i].apply(this.gl,[e,...s]));this._validated||(this._validated=!0,this._validate())}_validate(){if(this._unset_variables.size&&console.log(`Program has unset variables: ${this._unset_variables}`),this.gl.validateProgram(this.handle),!this.gl.getProgramParameter(this.handle,this.gl.VALIDATE_STATUS))throw console.log(this.gl.getProgramInfoLog(this.handle)),new Error("Program validation error")}draw(t,e){if(!this._linked)throw new Error("Cannot draw program if code has not been set");if(e instanceof o.IndexBuffer){this._pre_draw(),e.activate();const i=e.buffer_size/2,s=this.gl.UNSIGNED_SHORT;this.gl.drawElements(t,i,s,0),e.deactivate()}else{const[i,s]=e;0!=s&&(this._pre_draw(),this.gl.drawArrays(t,i,s))}}}i.Program=r,r.__name__="Program"},function(t,e,i,s,n){s();class o{constructor(t){this.gl=t,this._usage=35048,this.buffer_size=0,this.handle=this.gl.createBuffer()}delete(){this.gl.deleteBuffer(this.handle)}activate(){this.gl.bindBuffer(this._target,this.handle)}deactivate(){this.gl.bindBuffer(this._target,null)}set_size(t){t!=this.buffer_size&&(this.activate(),this.gl.bufferData(this._target,t,this._usage),this.buffer_size=t)}set_data(t,e){this.activate(),this.gl.bufferSubData(this._target,t,e)}}i.Buffer=o,o.__name__="Buffer";class r extends o{constructor(){super(...arguments),this._target=34962}}i.VertexBuffer=r,r.__name__="VertexBuffer";class a extends o{constructor(){super(...arguments),this._target=34963}}i.IndexBuffer=a,a.__name__="IndexBuffer"},function(t,e,i,s,n){s();const o=t(11);class r{constructor(t){this.gl=t,this._target=3553,this._types={Int8Array:5120,Uint8Array:5121,Int16Array:5122,Uint16Array:5123,Int32Array:5124,Uint32Array:5125,Float32Array:5126},this.handle=this.gl.createTexture()}delete(){this.gl.deleteTexture(this.handle)}activate(){this.gl.bindTexture(this._target,this.handle)}deactivate(){this.gl.bindTexture(this._target,0)}_get_alignment(t){const e=[4,8,2,1];for(const i of e)if(t%i==0)return i;o.unreachable()}set_wrapping(t,e){this.activate(),this.gl.texParameterf(this._target,this.gl.TEXTURE_WRAP_S,t),this.gl.texParameterf(this._target,this.gl.TEXTURE_WRAP_T,e)}set_interpolation(t,e){this.activate(),this.gl.texParameterf(this._target,this.gl.TEXTURE_MIN_FILTER,t),this.gl.texParameterf(this._target,this.gl.TEXTURE_MAG_FILTER,e)}set_size([t,e],i){var s,n,o;t==(null===(s=this._shape_format)||void 0===s?void 0:s.width)&&e==(null===(n=this._shape_format)||void 0===n?void 0:n.height)&&i==(null===(o=this._shape_format)||void 0===o?void 0:o.format)||(this._shape_format={width:t,height:e,format:i},this.activate(),this.gl.texImage2D(this._target,0,i,t,e,0,i,this.gl.UNSIGNED_BYTE,null))}set_data(t,[e,i],s){this.activate();const{format:n}=this._shape_format,[o,r]=t,a=this._types[s.constructor.name];if(null==a)throw new Error(`Type ${s.constructor.name} not allowed for texture`);const l=this._get_alignment(e);4!=l&&this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,l),this.gl.texSubImage2D(this._target,0,o,r,e,i,n,a,s),4!=l&&this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,4)}}i.Texture2d=r,r.__name__="Texture2d"},function(t,e,i,s,n){s();class o{constructor(t,e){this.gl=t,this.glyph=e,this.nvertices=0,this.size_changed=!1,this.data_changed=!1,this.visuals_changed=!1}set_data_changed(){const{data_size:t}=this.glyph;t!=this.nvertices&&(this.nvertices=t,this.size_changed=!0),this.data_changed=!0}set_visuals_changed(){this.visuals_changed=!0}render(t,e,i){if(0==e.length)return!0;const{width:s,height:n}=this.glyph.renderer.plot_view.canvas_view.webgl.canvas,o={pixel_ratio:this.glyph.renderer.plot_view.canvas_view.pixel_ratio,width:s,height:n};return this.draw(e,i,o),!0}}i.BaseGLGlyph=o,o.__name__="BaseGLGlyph"},function(t,e,i,s,n){s(),i.default="\nprecision mediump float;\n\nconst float PI = 3.14159265358979323846264;\nconst float THETA = 15.0 * 3.14159265358979323846264/180.0;\n\nuniform float u_pixel_ratio;\nuniform vec2 u_canvas_size, u_offset;\nuniform vec2 u_scale_aspect;\nuniform float u_scale_length;\n\nuniform vec4 u_color;\nuniform float u_antialias;\nuniform float u_length;\nuniform float u_linewidth;\nuniform float u_dash_index;\nuniform float u_closed;\n\nattribute vec2 a_position;\nattribute vec4 a_tangents;\nattribute vec2 a_segment;\nattribute vec2 a_angles;\nattribute vec2 a_texcoord;\n\nvarying vec4  v_color;\nvarying vec2  v_segment;\nvarying vec2  v_angles;\nvarying vec2  v_texcoord;\nvarying vec2  v_miter;\nvarying float v_length;\nvarying float v_linewidth;\n\nfloat cross(in vec2 v1, in vec2 v2)\n{\n    return v1.x*v2.y - v1.y*v2.x;\n}\n\nfloat signed_distance(in vec2 v1, in vec2 v2, in vec2 v3)\n{\n    return cross(v2-v1,v1-v3) / length(v2-v1);\n}\n\nvoid rotate( in vec2 v, in float alpha, out vec2 result )\n{\n    float c = cos(alpha);\n    float s = sin(alpha);\n    result = vec2( c*v.x - s*v.y,\n                   s*v.x + c*v.y );\n}\n\nvoid main()\n{\n    bool closed = (u_closed > 0.0);\n\n    // Attributes and uniforms to varyings\n    v_color = u_color;\n    v_linewidth = u_linewidth;\n    v_segment = a_segment * u_scale_length;\n    v_length = u_length * u_scale_length;\n\n    // Scale to map to pixel coordinates. The original algorithm from the paper\n    // assumed isotropic scale. We obviously do not have this.\n    vec2 abs_scale_aspect = abs(u_scale_aspect);\n    vec2 abs_scale = u_scale_length * abs_scale_aspect;\n\n    // Correct angles for aspect ratio\n    vec2 av;\n    av = vec2(1.0, tan(a_angles.x)) / abs_scale_aspect;\n    v_angles.x = atan(av.y, av.x);\n    av = vec2(1.0, tan(a_angles.y)) / abs_scale_aspect;\n    v_angles.y = atan(av.y, av.x);\n\n    // Thickness below 1 pixel are represented using a 1 pixel thickness\n    // and a modified alpha\n    v_color.a = min(v_linewidth, v_color.a);\n    v_linewidth = max(v_linewidth, 1.0);\n\n    // If color is fully transparent we just will discard the fragment anyway\n    if( v_color.a <= 0.0 ) {\n        gl_Position = vec4(0.0,0.0,0.0,1.0);\n        return;\n    }\n\n    // This is the actual half width of the line\n    float w = ceil(u_antialias+v_linewidth)/2.0;\n\n    vec2 position = a_position;\n\n    vec2 t1 = normalize(a_tangents.xy * abs_scale_aspect);  // note the scaling for aspect ratio here\n    vec2 t2 = normalize(a_tangents.zw * abs_scale_aspect);\n    float u = a_texcoord.x;\n    float v = a_texcoord.y;\n    vec2 o1 = vec2( +t1.y, -t1.x);\n    vec2 o2 = vec2( +t2.y, -t2.x);\n\n    // This is a join\n    // ----------------------------------------------------------------\n    if( t1 != t2 ) {\n        float angle = atan (t1.x*t2.y-t1.y*t2.x, t1.x*t2.x+t1.y*t2.y);  // Angle needs recalculation for some reason\n        vec2 t  = normalize(t1+t2);\n        vec2 o  = vec2( + t.y, - t.x);\n\n        if ( u_dash_index > 0.0 )\n        {\n            // Broken angle\n            // ----------------------------------------------------------------\n            if( (abs(angle) > THETA) ) {\n                position += v * w * o / cos(angle/2.0);\n                float s = sign(angle);\n                if( angle < 0.0 ) {\n                    if( u == +1.0 ) {\n                        u = v_segment.y + v * w * tan(angle/2.0);\n                        if( v == 1.0 ) {\n                            position -= 2.0 * w * t1 / sin(angle);\n                            u -= 2.0 * w / sin(angle);\n                        }\n                    } else {\n                        u = v_segment.x - v * w * tan(angle/2.0);\n                        if( v == 1.0 ) {\n                            position += 2.0 * w * t2 / sin(angle);\n                            u += 2.0*w / sin(angle);\n                        }\n                    }\n                } else {\n                    if( u == +1.0 ) {\n                        u = v_segment.y + v * w * tan(angle/2.0);\n                        if( v == -1.0 ) {\n                            position += 2.0 * w * t1 / sin(angle);\n                            u += 2.0 * w / sin(angle);\n                        }\n                    } else {\n                        u = v_segment.x - v * w * tan(angle/2.0);\n                        if( v == -1.0 ) {\n                            position -= 2.0 * w * t2 / sin(angle);\n                            u -= 2.0*w / sin(angle);\n                        }\n                    }\n                }\n                // Continuous angle\n                // ------------------------------------------------------------\n            } else {\n                position += v * w * o / cos(angle/2.0);\n                if( u == +1.0 ) u = v_segment.y;\n                else            u = v_segment.x;\n            }\n        }\n\n        // Solid line\n        // --------------------------------------------------------------------\n        else\n        {\n            position.xy += v * w * o / cos(angle/2.0);\n            if( angle < 0.0 ) {\n                if( u == +1.0 ) {\n                    u = v_segment.y + v * w * tan(angle/2.0);\n                } else {\n                    u = v_segment.x - v * w * tan(angle/2.0);\n                }\n            } else {\n                if( u == +1.0 ) {\n                    u = v_segment.y + v * w * tan(angle/2.0);\n                } else {\n                    u = v_segment.x - v * w * tan(angle/2.0);\n                }\n            }\n        }\n\n    // This is a line start or end (t1 == t2)\n    // ------------------------------------------------------------------------\n    } else {\n        position += v * w * o1;\n        if( u == -1.0 ) {\n            u = v_segment.x - w;\n            position -= w * t1;\n        } else {\n            u = v_segment.y + w;\n            position += w * t2;\n        }\n    }\n\n    // Miter distance\n    // ------------------------------------------------------------------------\n    vec2 t;\n    vec2 curr = a_position * abs_scale;\n    if( a_texcoord.x < 0.0 ) {\n        vec2 next = curr + t2*(v_segment.y-v_segment.x);\n\n        rotate( t1, +v_angles.x/2.0, t);\n        v_miter.x = signed_distance(curr, curr+t, position);\n\n        rotate( t2, +v_angles.y/2.0, t);\n        v_miter.y = signed_distance(next, next+t, position);\n    } else {\n        vec2 prev = curr - t1*(v_segment.y-v_segment.x);\n\n        rotate( t1, -v_angles.x/2.0,t);\n        v_miter.x = signed_distance(prev, prev+t, position);\n\n        rotate( t2, -v_angles.y/2.0,t);\n        v_miter.y = signed_distance(curr, curr+t, position);\n    }\n\n    if (!closed && v_segment.x <= 0.0) {\n        v_miter.x = 1e10;\n    }\n    if (!closed && v_segment.y >= v_length)\n    {\n        v_miter.y = 1e10;\n    }\n\n    v_texcoord = vec2( u, v*w );\n\n    // Calculate position in device coordinates. Note that we\n    // already scaled with abs scale above.\n    vec2 normpos = position * sign(u_scale_aspect);\n    normpos += 0.5;  // make up for Bokeh's offset\n    normpos /= u_canvas_size / u_pixel_ratio;  // in 0..1\n    gl_Position = vec4(normpos*2.0-1.0, 0.0, 1.0);\n    gl_Position.y *= -1.0;\n}\n"},function(t,e,i,s,n){s(),i.default="\nprecision mediump float;\n\nconst float PI = 3.14159265358979323846264;\nconst float THETA = 15.0 * 3.14159265358979323846264/180.0;\n\nuniform sampler2D u_dash_atlas;\n\nuniform vec2 u_linecaps;\nuniform float u_miter_limit;\nuniform float u_linejoin;\nuniform float u_antialias;\nuniform float u_dash_phase;\nuniform float u_dash_period;\nuniform float u_dash_index;\nuniform vec2 u_dash_caps;\nuniform float u_closed;\n\nvarying vec4  v_color;\nvarying vec2  v_segment;\nvarying vec2  v_angles;\nvarying vec2  v_texcoord;\nvarying vec2  v_miter;\nvarying float v_length;\nvarying float v_linewidth;\n\n// Compute distance to cap ----------------------------------------------------\nfloat cap( int type, float dx, float dy, float t, float linewidth )\n{\n    float d = 0.0;\n    dx = abs(dx);\n    dy = abs(dy);\n    if      (type == 0)  discard;  // None\n    else if (type == 1)  d = sqrt(dx*dx+dy*dy);  // Round\n    else if (type == 3)  d = (dx+abs(dy));  // Triangle in\n    else if (type == 2)  d = max(abs(dy),(t+dx-abs(dy)));  // Triangle out\n    else if (type == 4)  d = max(dx,dy);  // Square\n    else if (type == 5)  d = max(dx+t,dy);  // Butt\n    return d;\n}\n\n// Compute distance to join -------------------------------------------------\nfloat join( in int type, in float d, in vec2 segment, in vec2 texcoord, in vec2 miter,\n           in float linewidth )\n{\n    // texcoord.x is distance from start\n    // texcoord.y is distance from centerline\n    // segment.x and y indicate the limits (as for texcoord.x) for this segment\n\n    float dx = texcoord.x;\n\n    // Round join\n    if( type == 1 ) {\n        if (dx < segment.x) {\n            d = max(d,length( texcoord - vec2(segment.x,0.0)));\n            //d = length( texcoord - vec2(segment.x,0.0));\n        } else if (dx > segment.y) {\n            d = max(d,length( texcoord - vec2(segment.y,0.0)));\n            //d = length( texcoord - vec2(segment.y,0.0));\n        }\n    }\n    // Bevel join\n    else if ( type == 2 ) {\n        if (dx < segment.x) {\n            vec2 x = texcoord - vec2(segment.x,0.0);\n            d = max(d, max(abs(x.x), abs(x.y)));\n\n        } else if (dx > segment.y) {\n            vec2 x = texcoord - vec2(segment.y,0.0);\n            d = max(d, max(abs(x.x), abs(x.y)));\n        }\n        /*  Original code for bevel which does not work for us\n        if( (dx < segment.x) ||  (dx > segment.y) )\n            d = max(d, min(abs(x.x),abs(x.y)));\n        */\n    }\n\n    return d;\n}\n\nvoid main()\n{\n    // If color is fully transparent we just discard the fragment\n    if( v_color.a <= 0.0 ) {\n        discard;\n    }\n\n    // Test if dash pattern is the solid one (0)\n    bool solid =  (u_dash_index == 0.0);\n\n    // Test if path is closed\n    bool closed = (u_closed > 0.0);\n\n    vec4 color = v_color;\n    float dx = v_texcoord.x;\n    float dy = v_texcoord.y;\n    float t = v_linewidth/2.0-u_antialias;\n    float width = 1.0;  //v_linewidth; original code had dashes scale with line width, we do not\n    float d = 0.0;\n\n    vec2 linecaps = u_linecaps;\n    vec2 dash_caps = u_dash_caps;\n    float line_start = 0.0;\n    float line_stop = v_length;\n\n    // Apply miter limit; fragments too far into the miter are simply discarded\n    if( (dx < v_segment.x) || (dx > v_segment.y) ) {\n        float into_miter = max(v_segment.x - dx, dx - v_segment.y);\n        if (into_miter > u_miter_limit*v_linewidth/2.0)\n          discard;\n    }\n\n    // Solid line --------------------------------------------------------------\n    if( solid ) {\n        d = abs(dy);\n        if( (!closed) && (dx < line_start) ) {\n            d = cap( int(u_linecaps.x), abs(dx), abs(dy), t, v_linewidth );\n        }\n        else if( (!closed) &&  (dx > line_stop) ) {\n            d = cap( int(u_linecaps.y), abs(dx)-line_stop, abs(dy), t, v_linewidth );\n        }\n        else {\n            d = join( int(u_linejoin), abs(dy), v_segment, v_texcoord, v_miter, v_linewidth );\n        }\n\n    // Dash line --------------------------------------------------------------\n    } else {\n        float segment_start = v_segment.x;\n        float segment_stop  = v_segment.y;\n        float segment_center= (segment_start+segment_stop)/2.0;\n        float freq          = u_dash_period*width;\n        float u = mod( dx + u_dash_phase*width, freq);\n        vec4 tex = texture2D(u_dash_atlas, vec2(u/freq, u_dash_index)) * 255.0 -10.0;  // conversion to int-like\n        float dash_center= tex.x * width;\n        float dash_type  = tex.y;\n        float _start = tex.z * width;\n        float _stop  = tex.a * width;\n        float dash_start = dx - u + _start;\n        float dash_stop  = dx - u + _stop;\n\n        // Compute extents of the first dash (the one relative to v_segment.x)\n        // Note: this could be computed in the vertex shader\n        if( (dash_stop < segment_start) && (dash_caps.x != 5.0) ) {\n            float u = mod(segment_start + u_dash_phase*width, freq);\n            vec4 tex = texture2D(u_dash_atlas, vec2(u/freq, u_dash_index)) * 255.0 -10.0;  // conversion to int-like\n            dash_center= tex.x * width;\n            //dash_type  = tex.y;\n            float _start = tex.z * width;\n            float _stop  = tex.a * width;\n            dash_start = segment_start - u + _start;\n            dash_stop = segment_start - u + _stop;\n        }\n\n        // Compute extents of the last dash (the one relatives to v_segment.y)\n        // Note: This could be computed in the vertex shader\n        else if( (dash_start > segment_stop)  && (dash_caps.y != 5.0) ) {\n            float u = mod(segment_stop + u_dash_phase*width, freq);\n            vec4 tex = texture2D(u_dash_atlas, vec2(u/freq, u_dash_index)) * 255.0 -10.0;  // conversion to int-like\n            dash_center= tex.x * width;\n            //dash_type  = tex.y;\n            float _start = tex.z * width;\n            float _stop  = tex.a * width;\n            dash_start = segment_stop - u + _start;\n            dash_stop  = segment_stop - u + _stop;\n        }\n\n        // This test if the we are dealing with a discontinuous angle\n        bool discontinuous = ((dx <  segment_center) && abs(v_angles.x) > THETA) ||\n                             ((dx >= segment_center) && abs(v_angles.y) > THETA);\n        //if( dx < line_start) discontinuous = false;\n        //if( dx > line_stop)  discontinuous = false;\n\n        float d_join = join( int(u_linejoin), abs(dy),\n                            v_segment, v_texcoord, v_miter, v_linewidth );\n\n        // When path is closed, we do not have room for linecaps, so we make room\n        // by shortening the total length\n        if (closed) {\n             line_start += v_linewidth/2.0;\n             line_stop  -= v_linewidth/2.0;\n        }\n\n        // We also need to take antialias area into account\n        //line_start += u_antialias;\n        //line_stop  -= u_antialias;\n\n        // Check is dash stop is before line start\n        if( dash_stop <= line_start ) {\n            discard;\n        }\n        // Check is dash start is beyond line stop\n        if( dash_start >= line_stop ) {\n            discard;\n        }\n\n        // Check if current dash start is beyond segment stop\n        if( discontinuous ) {\n            // Dash start is beyond segment, we discard\n            if( (dash_start > segment_stop) ) {\n                discard;\n                //gl_FragColor = vec4(1.0,0.0,0.0,.25); return;\n            }\n\n            // Dash stop is before segment, we discard\n            if( (dash_stop < segment_start) ) {\n                discard;  //gl_FragColor = vec4(0.0,1.0,0.0,.25); return;\n            }\n\n            // Special case for round caps (nicer with this)\n            if( dash_caps.x == 1.0 ) {\n                if( (u > _stop) && (dash_stop > segment_stop )  && (abs(v_angles.y) < PI/2.0)) {\n                    discard;\n                }\n            }\n\n            // Special case for round caps  (nicer with this)\n            if( dash_caps.y == 1.0 ) {\n                if( (u < _start) && (dash_start < segment_start )  && (abs(v_angles.x) < PI/2.0)) {\n                    discard;\n                }\n            }\n\n            // Special case for triangle caps (in & out) and square\n            // We make sure the cap stop at crossing frontier\n            if( (dash_caps.x != 1.0) && (dash_caps.x != 5.0) ) {\n                if( (dash_start < segment_start )  && (abs(v_angles.x) < PI/2.0) ) {\n                    float a = v_angles.x/2.0;\n                    float x = (segment_start-dx)*cos(a) - dy*sin(a);\n                    float y = (segment_start-dx)*sin(a) + dy*cos(a);\n                    if( x > 0.0 ) discard;\n                    // We transform the cap into square to avoid holes\n                    dash_caps.x = 4.0;\n                }\n            }\n\n            // Special case for triangle caps (in & out) and square\n            // We make sure the cap stop at crossing frontier\n            if( (dash_caps.y != 1.0) && (dash_caps.y != 5.0) ) {\n                if( (dash_stop > segment_stop )  && (abs(v_angles.y) < PI/2.0) ) {\n                    float a = v_angles.y/2.0;\n                    float x = (dx-segment_stop)*cos(a) - dy*sin(a);\n                    float y = (dx-segment_stop)*sin(a) + dy*cos(a);\n                    if( x > 0.0 ) discard;\n                    // We transform the caps into square to avoid holes\n                    dash_caps.y = 4.0;\n                }\n            }\n        }\n\n        // Line cap at start\n        if( (dx < line_start) && (dash_start < line_start) && (dash_stop > line_start) ) {\n            d = cap( int(linecaps.x), dx-line_start, dy, t, v_linewidth);\n        }\n        // Line cap at stop\n        else if( (dx > line_stop) && (dash_stop > line_stop) && (dash_start < line_stop) ) {\n            d = cap( int(linecaps.y), dx-line_stop, dy, t, v_linewidth);\n        }\n        // Dash cap left - dash_type = -1, 0 or 1, but there may be roundoff errors\n        else if( dash_type < -0.5 ) {\n            d = cap( int(dash_caps.y), abs(u-dash_center), dy, t, v_linewidth);\n            if( (dx > line_start) && (dx < line_stop) )\n                d = max(d,d_join);\n        }\n        // Dash cap right\n        else if( dash_type > 0.5 ) {\n            d = cap( int(dash_caps.x), abs(dash_center-u), dy, t, v_linewidth);\n            if( (dx > line_start) && (dx < line_stop) )\n                d = max(d,d_join);\n        }\n        // Dash body (plain)\n        else {// if( dash_type > -0.5 &&  dash_type < 0.5) {\n            d = abs(dy);\n        }\n\n        // Line join\n        if( (dx > line_start) && (dx < line_stop)) {\n            if( (dx <= segment_start) && (dash_start <= segment_start)\n                && (dash_stop >= segment_start) ) {\n                d = d_join;\n                // Antialias at outer border\n                float angle = PI/2.+v_angles.x;\n                float f = abs( (segment_start - dx)*cos(angle) - dy*sin(angle));\n                d = max(f,d);\n            }\n            else if( (dx > segment_stop) && (dash_start <= segment_stop)\n                     && (dash_stop >= segment_stop) ) {\n                d = d_join;\n                // Antialias at outer border\n                float angle = PI/2.+v_angles.y;\n                float f = abs((dx - segment_stop)*cos(angle) - dy*sin(angle));\n                d = max(f,d);\n            }\n            else if( dx < (segment_start - v_linewidth/2.)) {\n                discard;\n            }\n            else if( dx > (segment_stop + v_linewidth/2.)) {\n                discard;\n            }\n        }\n        else if( dx < (segment_start - v_linewidth/2.)) {\n            discard;\n        }\n        else if( dx > (segment_stop + v_linewidth/2.)) {\n            discard;\n        }\n    }\n\n    // Distance to border ------------------------------------------------------\n    d = d - t;\n    if( d < 0.0 ) {\n        gl_FragColor = color;\n    } else {\n        d /= u_antialias;\n        gl_FragColor = vec4(color.rgb, exp(-d*d)*color.a);\n    }\n}\n"},function(t,e,i,s,n){s();const o=t(1),r=t(64),a=t(106),l=o.__importStar(t(107)),c=o.__importStar(t(48)),h=t(59);class _ extends r.XYGlyphView{_inner_loop(t,e,i,s,n){for(const o of e){const e=i[o],r=s[o];0!=o?isNaN(e+r)?(t.closePath(),n.apply(t),t.beginPath()):t.lineTo(e,r):(t.beginPath(),t.moveTo(e,r))}t.closePath(),n.call(t)}_render(t,e,i){const{sx:s,sy:n}=null!=i?i:this;this.visuals.fill.doit&&(this.visuals.fill.set_value(t),this._inner_loop(t,e,s,n,t.fill)),this.visuals.hatch.doit&&(this.visuals.hatch.set_value(t),this._inner_loop(t,e,s,n,t.fill)),this.visuals.line.doit&&(this.visuals.line.set_value(t),this._inner_loop(t,e,s,n,t.stroke))}draw_legend_for_index(t,e,i){a.generic_area_scalar_legend(this.visuals,t,e)}_hit_point(t){const e=new h.Selection;return l.point_in_poly(t.sx,t.sy,this.sx,this.sy)&&(e.add_to_selected_glyphs(this.model),e.view=this),e}}i.PatchView=_,_.__name__="PatchView";class d extends r.XYGlyph{constructor(t){super(t)}static init_Patch(){this.prototype.default_view=_,this.mixins([c.LineScalar,c.FillScalar,c.HatchScalar])}}i.Patch=d,d.__name__="Patch",d.init_Patch()},function(t,e,i,s,n){s();const o=t(1),r=t(24),a=t(118),l=o.__importStar(t(107)),c=o.__importStar(t(18)),h=t(59);class _ extends a.AreaView{_index_data(t){const{min:e,max:i}=Math,{data_size:s}=this;for(let n=0;n<s;n++){const s=this._x1[n],o=this._x2[n],r=this._y[n];isNaN(s+o+r)||!isFinite(s+o+r)?t.add_empty():t.add(e(s,o),r,i(s,o),r)}}_inner(t,e,i,s,n){t.beginPath();for(let o=0,r=e.length;o<r;o++)t.lineTo(e[o],s[o]);for(let o=i.length-1;o>=0;o--)t.lineTo(i[o],s[o]);t.closePath(),n.call(t)}_render(t,e,i){const{sx1:s,sx2:n,sy:o}=null!=i?i:this;this.visuals.fill.doit&&(this.visuals.fill.set_value(t),this._inner(t,s,n,o,t.fill)),this.visuals.hatch.doit&&(this.visuals.hatch.set_value(t),this._inner(t,s,n,o,t.fill))}_hit_point(t){const e=this.sy.length,i=new r.ScreenArray(2*e),s=new r.ScreenArray(2*e);for(let o=0,r=e;o<r;o++)i[o]=this.sx1[o],s[o]=this.sy[o],i[e+o]=this.sx2[e-o-1],s[e+o]=this.sy[e-o-1];const n=new h.Selection;return l.point_in_poly(t.sx,t.sy,i,s)&&(n.add_to_selected_glyphs(this.model),n.view=this),n}scenterxy(t){return[(this.sx1[t]+this.sx2[t])/2,this.sy[t]]}_map_data(){this.sx1=this.renderer.xscale.v_compute(this._x1),this.sx2=this.renderer.xscale.v_compute(this._x2),this.sy=this.renderer.yscale.v_compute(this._y)}}i.HAreaView=_,_.__name__="HAreaView";class d extends a.Area{constructor(t){super(t)}static init_HArea(){this.prototype.default_view=_,this.define((({})=>({x1:[c.XCoordinateSpec,{field:"x1"}],x2:[c.XCoordinateSpec,{field:"x2"}],y:[c.YCoordinateSpec,{field:"y"}]})))}}i.HArea=d,d.__name__="HArea",d.init_HArea()},function(t,e,i,s,n){s();const o=t(1),r=t(98),a=t(106),l=o.__importStar(t(48));class c extends r.GlyphView{draw_legend_for_index(t,e,i){a.generic_area_scalar_legend(this.visuals,t,e)}}i.AreaView=c,c.__name__="AreaView";class h extends r.Glyph{constructor(t){super(t)}static init_Area(){this.mixins([l.FillScalar,l.HatchScalar])}}i.Area=h,h.__name__="Area",h.init_Area()},function(t,e,i,s,n){s();const o=t(1),r=t(24),a=t(118),l=o.__importStar(t(107)),c=o.__importStar(t(18)),h=t(59);class _ extends a.AreaView{_index_data(t){const{min:e,max:i}=Math,{data_size:s}=this;for(let n=0;n<s;n++){const s=this._x[n],o=this._y1[n],r=this._y2[n];isNaN(s+o+r)||!isFinite(s+o+r)?t.add_empty():t.add(s,e(o,r),s,i(o,r))}}_inner(t,e,i,s,n){t.beginPath();for(let o=0,r=i.length;o<r;o++)t.lineTo(e[o],i[o]);for(let o=s.length-1;o>=0;o--)t.lineTo(e[o],s[o]);t.closePath(),n.call(t)}_render(t,e,i){const{sx:s,sy1:n,sy2:o}=null!=i?i:this;this.visuals.fill.doit&&(this.visuals.fill.set_value(t),this._inner(t,s,n,o,t.fill)),this.visuals.hatch.doit&&(this.visuals.hatch.set_value(t),this._inner(t,s,n,o,t.fill))}scenterxy(t){return[this.sx[t],(this.sy1[t]+this.sy2[t])/2]}_hit_point(t){const e=this.sx.length,i=new r.ScreenArray(2*e),s=new r.ScreenArray(2*e);for(let o=0,r=e;o<r;o++)i[o]=this.sx[o],s[o]=this.sy1[o],i[e+o]=this.sx[e-o-1],s[e+o]=this.sy2[e-o-1];const n=new h.Selection;return l.point_in_poly(t.sx,t.sy,i,s)&&(n.add_to_selected_glyphs(this.model),n.view=this),n}_map_data(){this.sx=this.renderer.xscale.v_compute(this._x),this.sy1=this.renderer.yscale.v_compute(this._y1),this.sy2=this.renderer.yscale.v_compute(this._y2)}}i.VAreaView=_,_.__name__="VAreaView";class d extends a.Area{constructor(t){super(t)}static init_VArea(){this.prototype.default_view=_,this.define((({})=>({x:[c.XCoordinateSpec,{field:"x"}],y1:[c.YCoordinateSpec,{field:"y1"}],y2:[c.YCoordinateSpec,{field:"y2"}]})))}}i.VArea=d,d.__name__="VArea",d.init_VArea()},function(t,e,i,s,n){s();const o=t(53),r=t(59),a=t(24),l=t(121),c=t(57);class h extends o.Model{constructor(t){super(t)}static init_CDSView(){this.define((({Array:t,Ref:e})=>({filters:[t(e(l.Filter)),[]],source:[e(c.ColumnarDataSource)]}))),this.internal((({Int:t,Dict:e,Ref:i,Nullable:s})=>({indices:[i(a.Indices)],indices_map:[e(t),{}],masked:[s(i(a.Indices)),null]})))}initialize(){super.initialize(),this.compute_indices()}connect_signals(){super.connect_signals(),this.connect(this.properties.filters.change,(()=>this.compute_indices()));const t=()=>{const t=()=>this.compute_indices();null!=this.source&&(this.connect(this.source.change,t),this.source instanceof c.ColumnarDataSource&&(this.connect(this.source.streaming,t),this.connect(this.source.patching,t)))};let e=null!=this.source;e?t():this.connect(this.properties.source.change,(()=>{e||(t(),e=!0)}))}compute_indices(){var t;const{source:e}=this;if(null==e)return;const i=null!==(t=e.get_length())&&void 0!==t?t:1,s=a.Indices.all_set(i);for(const n of this.filters)s.intersect(n.compute_indices(e));this.indices=s,this._indices=[...s],this.indices_map_to_subset()}indices_map_to_subset(){this.indices_map={};for(let t=0;t<this._indices.length;t++)this.indices_map[this._indices[t]]=t}convert_selection_from_subset(t){const e=t.indices.map((t=>this._indices[t]));return new r.Selection(Object.assign(Object.assign({},t.attributes),{indices:e}))}convert_selection_to_subset(t){const e=t.indices.map((t=>this.indices_map[t]));return new r.Selection(Object.assign(Object.assign({},t.attributes),{indices:e}))}convert_indices_from_subset(t){return t.map((t=>this._indices[t]))}}i.CDSView=h,h.__name__="CDSView",h.init_CDSView()},function(t,e,i,s,n){s();const o=t(53);class r extends o.Model{constructor(t){super(t)}}i.Filter=r,r.__name__="Filter"},function(t,e,i,s,n){s();const o=t(9);async function r(t,e,i){const s=new t(Object.assign(Object.assign({},i),{model:e}));return s.initialize(),await s.lazy_initialize(),s}i.build_view=async function(t,e={parent:null},i=(t=>t.default_view)){const s=await r(i(t),t,e);return s.connect_signals(),s},i.build_views=async function(t,e,i={parent:null},s=(t=>t.default_view)){const n=o.difference([...t.keys()],e);for(const o of n)t.get(o).remove(),t.delete(o);const a=[],l=e.filter((e=>!t.has(e)));for(const o of l){const e=await r(s(o),o,i);t.set(o,e),a.push(e)}for(const o of a)o.connect_signals();return a},i.remove_views=function(t){for(const[e,i]of t)i.remove(),t.delete(e)}},function(t,e,i,s,n){s();const o=t(62),r=t(61),a=t(124),l=t(125),c=t(126),h=t(122),_=t(64),d=t(127),u=t(128),p=t(11);class m extends o.DataRendererView{get glyph_view(){return this.node_view.glyph}async lazy_initialize(){await super.lazy_initialize();const t=this.model;let e=null,i=null;const s=new class extends a.Expression{_v_compute(i){p.assert(null==e);const[s]=e=t.layout_provider.get_edge_coordinates(i);return s}},n=new class extends a.Expression{_v_compute(t){p.assert(null!=e);const[,i]=e;return e=null,i}},o=new class extends a.Expression{_v_compute(e){p.assert(null==i);const[s]=i=t.layout_provider.get_node_coordinates(e);return s}},r=new class extends a.Expression{_v_compute(t){p.assert(null!=i);const[,e]=i;return i=null,e}},{edge_renderer:l,node_renderer:c}=this.model;if(!(l.glyph instanceof d.MultiLine||l.glyph instanceof u.Patches))throw new Error(`${this}.edge_renderer.glyph must be a MultiLine glyph`);if(!(c.glyph instanceof _.XYGlyph))throw new Error(`${this}.node_renderer.glyph must be a XYGlyph glyph`);l.glyph.properties.xs.internal=!0,l.glyph.properties.ys.internal=!0,c.glyph.properties.x.internal=!0,c.glyph.properties.y.internal=!0,l.glyph.xs={expr:s},l.glyph.ys={expr:n},c.glyph.x={expr:o},c.glyph.y={expr:r};const{parent:m}=this;this.edge_view=await h.build_view(l,{parent:m}),this.node_view=await h.build_view(c,{parent:m})}connect_signals(){super.connect_signals(),this.connect(this.model.layout_provider.change,(()=>{this.edge_view.set_data(),this.node_view.set_data(),this.request_render()}))}remove(){this.edge_view.remove(),this.node_view.remove(),super.remove()}_render(){this.edge_view.render(),this.node_view.render()}renderer_view(t){if(t instanceof r.GlyphRenderer){if(t==this.edge_view.model)return this.edge_view;if(t==this.node_view.model)return this.node_view}return super.renderer_view(t)}}i.GraphRendererView=m,m.__name__="GraphRendererView";class g extends o.DataRenderer{constructor(t){super(t)}static init_GraphRenderer(){this.prototype.default_view=m,this.define((({Ref:t})=>({layout_provider:[t(l.LayoutProvider)],node_renderer:[t(r.GlyphRenderer)],edge_renderer:[t(r.GlyphRenderer)],selection_policy:[t(c.GraphHitTestPolicy),()=>new c.NodesOnly],inspection_policy:[t(c.GraphHitTestPolicy),()=>new c.NodesOnly]})))}get_selection_manager(){return this.node_renderer.data_source.selection_manager}}i.GraphRenderer=g,g.__name__="GraphRenderer",g.init_GraphRenderer()},function(t,e,i,s,n){s();const o=t(53);class r extends o.Model{constructor(t){super(t)}initialize(){super.initialize(),this._connected=new Set,this._result=new Map}v_compute(t){this._connected.has(t)||(this.connect(t.change,(()=>this._result.delete(t))),this.connect(t.patching,(()=>this._result.delete(t))),this.connect(t.streaming,(()=>this._result.delete(t))),this._connected.add(t));let e=this._result.get(t);return null==e&&(e=this._v_compute(t),this._result.set(t,e)),e}}i.Expression=r,r.__name__="Expression";class a extends o.Model{constructor(t){super(t)}initialize(){super.initialize(),this._connected=new Set,this._result=new Map}compute(t){this._connected.has(t)||(this.connect(t.change,(()=>this._result.delete(t))),this.connect(t.patching,(()=>this._result.delete(t))),this.connect(t.streaming,(()=>this._result.delete(t))),this._connected.add(t));let e=this._result.get(t);return null==e&&(e=this._compute(t),this._result.set(t,e)),e}}i.ScalarExpression=a,a.__name__="ScalarExpression"},function(t,e,i,s,n){s();const o=t(53);class r extends o.Model{constructor(t){super(t)}}i.LayoutProvider=r,r.__name__="LayoutProvider"},function(t,e,i,s,n){s();const o=t(53),r=t(12),a=t(9),l=t(59);class c extends o.Model{constructor(t){super(t)}_hit_test(t,e,i){if(!e.model.visible)return null;const s=i.glyph.hit_test(t);return null==s?null:i.model.view.convert_selection_from_subset(s)}}i.GraphHitTestPolicy=c,c.__name__="GraphHitTestPolicy";class h extends c{constructor(t){super(t)}hit_test(t,e){return this._hit_test(t,e,e.edge_view)}do_selection(t,e,i,s){if(null==t)return!1;const n=e.edge_renderer.data_source.selected;return n.update(t,i,s),e.edge_renderer.data_source._select.emit(),!n.is_empty()}do_inspection(t,e,i,s,n){if(null==t)return!1;const{edge_renderer:o}=i.model,r=o.get_selection_manager().get_or_create_inspector(i.edge_view.model);return r.update(t,s,n),i.edge_view.model.data_source.setv({inspected:r},{silent:!0}),i.edge_view.model.data_source.inspect.emit([i.edge_view.model,{geometry:e}]),!r.is_empty()}}i.EdgesOnly=h,h.__name__="EdgesOnly";class _ extends c{constructor(t){super(t)}hit_test(t,e){return this._hit_test(t,e,e.node_view)}do_selection(t,e,i,s){if(null==t)return!1;const n=e.node_renderer.data_source.selected;return n.update(t,i,s),e.node_renderer.data_source._select.emit(),!n.is_empty()}do_inspection(t,e,i,s,n){if(null==t)return!1;const{node_renderer:o}=i.model,r=o.get_selection_manager().get_or_create_inspector(i.node_view.model);return r.update(t,s,n),i.node_view.model.data_source.setv({inspected:r},{silent:!0}),i.node_view.model.data_source.inspect.emit([i.node_view.model,{geometry:e}]),!r.is_empty()}}i.NodesOnly=_,_.__name__="NodesOnly";class d extends c{constructor(t){super(t)}hit_test(t,e){return this._hit_test(t,e,e.node_view)}get_linked_edges(t,e,i){let s=[];"selection"==i?s=t.selected.indices.map((e=>t.data.index[e])):"inspection"==i&&(s=t.inspected.indices.map((e=>t.data.index[e])));const n=[];for(let r=0;r<e.data.start.length;r++)(a.contains(s,e.data.start[r])||a.contains(s,e.data.end[r]))&&n.push(r);const o=new l.Selection;for(const r of n)o.multiline_indices[r]=[0];return o.indices=n,o}do_selection(t,e,i,s){if(null==t)return!1;const n=e.node_renderer.data_source.selected;n.update(t,i,s);const o=e.edge_renderer.data_source.selected,r=this.get_linked_edges(e.node_renderer.data_source,e.edge_renderer.data_source,"selection");return o.update(r,i,s),e.node_renderer.data_source._select.emit(),!n.is_empty()}do_inspection(t,e,i,s,n){if(null==t)return!1;const o=i.node_view.model.data_source.selection_manager.get_or_create_inspector(i.node_view.model);o.update(t,s,n),i.node_view.model.data_source.setv({inspected:o},{silent:!0});const r=i.edge_view.model.data_source.selection_manager.get_or_create_inspector(i.edge_view.model),a=this.get_linked_edges(i.node_view.model.data_source,i.edge_view.model.data_source,"inspection");return r.update(a,s,n),i.edge_view.model.data_source.setv({inspected:r},{silent:!0}),i.node_view.model.data_source.inspect.emit([i.node_view.model,{geometry:e}]),!o.is_empty()}}i.NodesAndLinkedEdges=d,d.__name__="NodesAndLinkedEdges";class u extends c{constructor(t){super(t)}hit_test(t,e){return this._hit_test(t,e,e.edge_view)}get_linked_nodes(t,e,i){let s=[];"selection"==i?s=e.selected.indices:"inspection"==i&&(s=e.inspected.indices);const n=[];for(const r of s)n.push(e.data.start[r]),n.push(e.data.end[r]);const o=a.uniq(n).map((e=>r.indexOf(t.data.index,e)));return new l.Selection({indices:o})}do_selection(t,e,i,s){if(null==t)return!1;const n=e.edge_renderer.data_source.selected;n.update(t,i,s);const o=e.node_renderer.data_source.selected,r=this.get_linked_nodes(e.node_renderer.data_source,e.edge_renderer.data_source,"selection");return o.update(r,i,s),e.edge_renderer.data_source._select.emit(),!n.is_empty()}do_inspection(t,e,i,s,n){if(null==t)return!1;const o=i.edge_view.model.data_source.selection_manager.get_or_create_inspector(i.edge_view.model);o.update(t,s,n),i.edge_view.model.data_source.setv({inspected:o},{silent:!0});const r=i.node_view.model.data_source.selection_manager.get_or_create_inspector(i.node_view.model),a=this.get_linked_nodes(i.node_view.model.data_source,i.edge_view.model.data_source,"inspection");return r.update(a,s,n),i.node_view.model.data_source.setv({inspected:r},{silent:!0}),i.edge_view.model.data_source.inspect.emit([i.edge_view.model,{geometry:e}]),!o.is_empty()}}i.EdgesAndLinkedNodes=u,u.__name__="EdgesAndLinkedNodes"},function(t,e,i,s,n){s();const o=t(1),r=t(65),a=t(48),l=o.__importStar(t(107)),c=o.__importStar(t(18)),h=t(12),_=t(13),d=t(98),u=t(106),p=t(59);class m extends d.GlyphView{_project_data(){r.inplace.project_xy(this._xs.array,this._ys.array)}_index_data(t){const{data_size:e}=this;for(let i=0;i<e;i++){const e=this._xs.get(i);if(0==e.length){t.add_empty();continue}const s=this._ys.get(i);if(0==s.length){t.add_empty();continue}const[n,o]=h.minmax(e),[r,a]=h.minmax(s);t.add(n,r,o,a)}}_render(t,e,i){const{sxs:s,sys:n}=null!=i?i:this;for(const o of e){const e=s.get(o),i=n.get(o),r=Math.min(e.length,i.length);let a=!0;t.beginPath();for(let s=0;s<r;s++){const n=e[s],o=i[s];isFinite(n+o)?a?(t.moveTo(n,o),a=!1):t.lineTo(n,o):a=!0}this.visuals.line.set_vectorize(t,o),t.stroke()}}_hit_point(t){const e={x:t.sx,y:t.sy};let i=9999;const s=new Map;for(let n=0,o=this.sxs.length;n<o;n++){const t=Math.max(2,this.line_width.get(n)/2),o=this.sxs.get(n),r=this.sys.get(n);let a=null;for(let s=0,n=o.length-1;s<n;s++){const n={x:o[s],y:r[s]},c={x:o[s+1],y:r[s+1]},h=l.dist_to_segment(e,n,c);h<t&&h<i&&(i=h,a=[s])}null!=a&&s.set(n,a)}return new p.Selection({indices:[...s.keys()],multiline_indices:_.to_object(s)})}_hit_span(t){const{sx:e,sy:i}=t;let s,n;"v"==t.direction?(s=this.renderer.yscale.invert(i),n=this._ys):(s=this.renderer.xscale.invert(e),n=this._xs);const o=new Map;for(let r=0,a=n.length;r<a;r++){const t=n.get(r),e=[];for(let i=0,n=t.length-1;i<n;i++)t[i]<=s&&s<=t[i+1]&&e.push(i);e.length>0&&o.set(r,e)}return new p.Selection({indices:[...o.keys()],multiline_indices:_.to_object(o)})}get_interpolation_hit(t,e,i){const s=this._xs.get(t),n=this._ys.get(t),o=s[e],r=n[e],a=s[e+1],l=n[e+1];return u.line_interpolation(this.renderer,i,o,r,a,l)}draw_legend_for_index(t,e,i){u.generic_line_vector_legend(this.visuals,t,e,i)}scenterxy(){throw new Error(`${this}.scenterxy() is not implemented`)}}i.MultiLineView=m,m.__name__="MultiLineView";class g extends d.Glyph{constructor(t){super(t)}static init_MultiLine(){this.prototype.default_view=m,this.define((({})=>({xs:[c.XCoordinateSeqSpec,{field:"xs"}],ys:[c.YCoordinateSeqSpec,{field:"ys"}]}))),this.mixins(a.LineVector)}}i.MultiLine=g,g.__name__="MultiLine",g.init_MultiLine()},function(t,e,i,s,n){s();const o=t(1),r=t(98),a=t(106),l=t(12),c=t(48),h=o.__importStar(t(107)),_=o.__importStar(t(18)),d=t(59),u=t(11),p=t(65);class m extends r.GlyphView{_project_data(){p.inplace.project_xy(this._xs.array,this._ys.array)}_index_data(t){const{data_size:e}=this;for(let i=0;i<e;i++){const e=this._xs.get(i),s=this._ys.get(i);if(0==e.length)t.add_empty();else{const[i,n]=l.minmax(e),[o,r]=l.minmax(s);t.add(i,o,n,r)}}}_mask_data(){const{x_range:t,y_range:e}=this.renderer.plot_view.frame;return this.index.indices({x0:t.min,x1:t.max,y0:e.min,y1:e.max})}_inner_loop(t,e,i,s){for(let n=0,o=e.length;n<o;n++)0!=n?isNaN(e[n]+i[n])?(t.closePath(),s.apply(t),t.beginPath()):t.lineTo(e[n],i[n]):(t.beginPath(),t.moveTo(e[n],i[n]));t.closePath(),s.call(t)}_render(t,e,i){const{sxs:s,sys:n}=null!=i?i:this;for(const o of e){const e=s.get(o),i=n.get(o);this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,o),this._inner_loop(t,e,i,t.fill)),this.visuals.hatch.doit&&(this.visuals.hatch.set_vectorize(t,o),this._inner_loop(t,e,i,t.fill)),this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,o),this._inner_loop(t,e,i,t.stroke))}}_hit_rect(t){const{sx0:e,sx1:i,sy0:s,sy1:n}=t,o=[e,i,i,e],r=[s,s,n,n],[a,l]=this.renderer.xscale.r_invert(e,i),[c,_]=this.renderer.yscale.r_invert(s,n),u=this.index.indices({x0:a,x1:l,y0:c,y1:_}),p=[];for(const d of u){const t=this.sxs.get(d),e=this.sys.get(d);let i=!0;for(let s=0,n=t.length;s<n;s++){const n=t[s],a=e[s];if(!h.point_in_poly(n,a,o,r)){i=!1;break}}i&&p.push(d)}return new d.Selection({indices:p})}_hit_point(t){const{sx:e,sy:i}=t,s=this.renderer.xscale.invert(e),n=this.renderer.yscale.invert(i),o=this.index.indices({x0:s,y0:n,x1:s,y1:n}),r=[];for(const a of o){const t=this.sxs.get(a),s=this.sys.get(a),n=t.length;for(let o=0,l=0;;l++){if(isNaN(t[l])||l==n){const n=t.subarray(o,l),c=s.subarray(o,l);if(h.point_in_poly(e,i,n,c)){r.push(a);break}o=l+1}if(l==n)break}}return new d.Selection({indices:r})}_get_snap_coord(t){return l.sum(t)/t.length}scenterxy(t,e,i){const s=this.sxs.get(t),n=this.sys.get(t),o=s.length;let r=!1;for(let a=0,l=0;;l++){const t=isNaN(s[l]);if(r=r||t,l==o&&!r)return[this._get_snap_coord(s),this._get_snap_coord(n)];if(t||l==o){const t=s.subarray(a,l),o=n.subarray(a,l);if(h.point_in_poly(e,i,t,o))return[this._get_snap_coord(t),this._get_snap_coord(o)];a=l+1}if(l==o)break}u.unreachable()}draw_legend_for_index(t,e,i){a.generic_area_vector_legend(this.visuals,t,e,i)}}i.PatchesView=m,m.__name__="PatchesView";class g extends r.Glyph{constructor(t){super(t)}static init_Patches(){this.prototype.default_view=m,this.define((({})=>({xs:[_.XCoordinateSeqSpec,{field:"xs"}],ys:[_.YCoordinateSeqSpec,{field:"ys"}]}))),this.mixins([c.LineVector,c.FillVector,c.HatchVector])}}i.Patches=g,g.__name__="Patches",g.init_Patches()},function(t,e,i,s,n){s();const o=t(53);class r extends o.Model{do_selection(t,e,i,s){return null!=t&&(e.selected.update(t,i,s),e._select.emit(),!e.selected.is_empty())}}i.SelectionPolicy=r,r.__name__="SelectionPolicy";class a extends r{hit_test(t,e){const i=[];for(const s of e){const e=s.hit_test(t);null!=e&&i.push(e)}if(i.length>0){const t=i[0];for(const e of i)t.update_through_intersection(e);return t}return null}}i.IntersectRenderers=a,a.__name__="IntersectRenderers";class l extends r{hit_test(t,e){const i=[];for(const s of e){const e=s.hit_test(t);null!=e&&i.push(e)}if(i.length>0){const t=i[0];for(const e of i)t.update_through_union(e);return t}return null}}i.UnionRenderers=l,l.__name__="UnionRenderers"},function(t,e,i,s,n){s();const o=t(1),r=t(57),a=t(8),l=t(13),c=o.__importStar(t(131)),h=t(132),_=t(35);function d(t,e,i){if(a.isArray(t)){const s=t.concat(e);return null!=i&&s.length>i?s.slice(-i):s}if(a.isTypedArray(t)){const s=t.length+e.length;if(null!=i&&s>i){const n=s-i,o=t.length;let r;t.length<i?(r=new t.constructor(i),r.set(t,0)):r=t;for(let t=n,e=o;t<e;t++)r[t-n]=r[t];for(let t=0,i=e.length;t<i;t++)r[t+(o-n)]=e[t];return r}{const i=new t.constructor(e);return c.concat(t,i)}}throw new Error("unsupported array types")}function u(t,e){let i,s,n;return a.isNumber(t)?(i=t,n=t+1,s=1):(i=null!=t.start?t.start:0,n=null!=t.stop?t.stop:e,s=null!=t.step?t.step:1),[i,n,s]}function p(t,e){const i=new Set;let s=!1;for(const[n,o]of e){let e,r,l,c;if(a.isArray(n)){const[s]=n;i.add(s),e=t[s].shape,r=t[s],c=o,2===n.length?(e=[1,e[0]],l=[n[0],0,n[1]]):l=n}else a.isNumber(n)?(c=[o],i.add(n)):(c=o,s=!0),l=[0,0,n],e=[1,t.length],r=t;let h=0;const[_,d,p]=u(l[1],e[0]),[m,g,f]=u(l[2],e[1]);for(let t=_;t<d;t+=p)for(let n=m;n<g;n+=f)s&&i.add(n),r[t*e[1]+n]=c[h],h++}return i}i.stream_to_column=d,i.slice=u,i.patch_to_column=p;class m extends r.ColumnarDataSource{constructor(t){super(t)}static init_ColumnDataSource(){this.define((({Dict:t,Any:e})=>({data:[t(e),{}]})))}stream(t,e,i){const{data:s}=this;for(const[n,o]of l.entries(t))s[n]=d(s[n],o,e);if(this.setv({data:s},{silent:!0}),this.streaming.emit(),null!=this.document){const s=new _.ColumnsStreamedEvent(this.document,this.ref(),t,e);this.document._notify_change(this,"data",null,null,{setter_id:i,hint:s})}}patch(t,e){const{data:i}=this;let s=new Set;for(const[n,o]of l.entries(t))s=h.union(s,p(i[n],o));if(this.setv({data:i},{silent:!0}),this.patching.emit([...s]),null!=this.document){const i=new _.ColumnsPatchedEvent(this.document,this.ref(),t);this.document._notify_change(this,"data",null,null,{setter_id:e,hint:i})}}}i.ColumnDataSource=m,m.__name__="ColumnDataSource",m.init_ColumnDataSource()},function(t,e,i,s,n){s(),i.concat=function(t,...e){let i=t.length;for(const o of e)i+=o.length;const s=new t.constructor(i);s.set(t,0);let n=t.length;for(const o of e)s.set(o,n),n+=o.length;return s}},function(t,e,i,s,n){function o(...t){const e=new Set;for(const i of t)for(const t of i)e.add(t);return e}s(),i.union=o,i.intersection=function(t,...e){const i=new Set;t:for(const s of t){for(const t of e)if(!t.has(s))continue t;i.add(s)}return i},i.difference=function(t,...e){const i=new Set(t);for(const s of o(...e))i.delete(s);return i}},function(t,e,i,s,n){s();const o=t(1),r=t(53),a=t(42),l=o.__importStar(t(45)),c=t(48),h=o.__importStar(t(18));class _ extends a.View{initialize(){super.initialize(),this.visuals=new l.Visuals(this)}request_render(){this.parent.request_render()}get canvas(){return this.parent.canvas}set_data(t){const e=this;for(const i of this.model){if(!(i instanceof h.VectorSpec||i instanceof h.ScalarSpec))continue;const s=i.uniform(t);e[`${i.attr}`]=s}}}i.ArrowHeadView=_,_.__name__="ArrowHeadView";class d extends r.Model{constructor(t){super(t)}static init_ArrowHead(){this.define((()=>({size:[h.NumberSpec,25]})))}}i.ArrowHead=d,d.__name__="ArrowHead",d.init_ArrowHead();class u extends _{clip(t,e){this.visuals.line.set_vectorize(t,e);const i=this.size.get(e);t.moveTo(.5*i,i),t.lineTo(.5*i,-2),t.lineTo(-.5*i,-2),t.lineTo(-.5*i,i),t.lineTo(0,0),t.lineTo(.5*i,i)}render(t,e){if(this.visuals.line.doit){this.visuals.line.set_vectorize(t,e);const i=this.size.get(e);t.beginPath(),t.moveTo(.5*i,i),t.lineTo(0,0),t.lineTo(-.5*i,i),t.stroke()}}}i.OpenHeadView=u,u.__name__="OpenHeadView";class p extends d{constructor(t){super(t)}static init_OpenHead(){this.prototype.default_view=u,this.mixins(c.LineVector)}}i.OpenHead=p,p.__name__="OpenHead",p.init_OpenHead();class m extends _{clip(t,e){this.visuals.line.set_vectorize(t,e);const i=this.size.get(e);t.moveTo(.5*i,i),t.lineTo(.5*i,-2),t.lineTo(-.5*i,-2),t.lineTo(-.5*i,i),t.lineTo(.5*i,i)}render(t,e){this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,e),this._normal(t,e),t.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,e),this._normal(t,e),t.stroke())}_normal(t,e){const i=this.size.get(e);t.beginPath(),t.moveTo(.5*i,i),t.lineTo(0,0),t.lineTo(-.5*i,i),t.closePath()}}i.NormalHeadView=m,m.__name__="NormalHeadView";class g extends d{constructor(t){super(t)}static init_NormalHead(){this.prototype.default_view=m,this.mixins([c.LineVector,c.FillVector]),this.override({fill_color:"black"})}}i.NormalHead=g,g.__name__="NormalHead",g.init_NormalHead();class f extends _{clip(t,e){this.visuals.line.set_vectorize(t,e);const i=this.size.get(e);t.moveTo(.5*i,i),t.lineTo(.5*i,-2),t.lineTo(-.5*i,-2),t.lineTo(-.5*i,i),t.lineTo(0,.5*i),t.lineTo(.5*i,i)}render(t,e){this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,e),this._vee(t,e),t.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,e),this._vee(t,e),t.stroke())}_vee(t,e){const i=this.size.get(e);t.beginPath(),t.moveTo(.5*i,i),t.lineTo(0,0),t.lineTo(-.5*i,i),t.lineTo(0,.5*i),t.closePath()}}i.VeeHeadView=f,f.__name__="VeeHeadView";class b extends d{constructor(t){super(t)}static init_VeeHead(){this.prototype.default_view=f,this.mixins([c.LineVector,c.FillVector]),this.override({fill_color:"black"})}}i.VeeHead=b,b.__name__="VeeHead",b.init_VeeHead();class v extends _{render(t,e){if(this.visuals.line.doit){this.visuals.line.set_vectorize(t,e);const i=this.size.get(e);t.beginPath(),t.moveTo(.5*i,0),t.lineTo(-.5*i,0),t.stroke()}}clip(t,e){}}i.TeeHeadView=v,v.__name__="TeeHeadView";class y extends d{constructor(t){super(t)}static init_TeeHead(){this.prototype.default_view=v,this.mixins(c.LineVector)}}i.TeeHead=y,y.__name__="TeeHead",y.init_TeeHead()},function(t,e,i,s,n){s();const o=t(1),r=t(135),a=o.__importStar(t(48));class l extends r.UpperLowerView{paint(t){t.beginPath(),t.moveTo(this._lower_sx[0],this._lower_sy[0]);for(let e=0,i=this._lower_sx.length;e<i;e++)t.lineTo(this._lower_sx[e],this._lower_sy[e]);for(let e=this._upper_sx.length-1;e>=0;e--)t.lineTo(this._upper_sx[e],this._upper_sy[e]);t.closePath(),this.visuals.fill.doit&&(this.visuals.fill.set_value(t),t.fill()),t.beginPath(),t.moveTo(this._lower_sx[0],this._lower_sy[0]);for(let e=0,i=this._lower_sx.length;e<i;e++)t.lineTo(this._lower_sx[e],this._lower_sy[e]);this.visuals.line.doit&&(this.visuals.line.set_value(t),t.stroke()),t.beginPath(),t.moveTo(this._upper_sx[0],this._upper_sy[0]);for(let e=0,i=this._upper_sx.length;e<i;e++)t.lineTo(this._upper_sx[e],this._upper_sy[e]);this.visuals.line.doit&&(this.visuals.line.set_value(t),t.stroke())}}i.BandView=l,l.__name__="BandView";class c extends r.UpperLower{constructor(t){super(t)}static init_Band(){this.prototype.default_view=l,this.mixins([a.Line,a.Fill]),this.override({fill_color:"#fff9ba",fill_alpha:.4,line_color:"#cccccc",line_alpha:.3})}}i.Band=c,c.__name__="Band",c.init_Band()},function(t,e,i,s,n){s();const o=t(1),r=t(56),a=t(20),l=o.__importStar(t(18));class c extends r.DataAnnotationView{map_data(){const{frame:t}=this.plot_view,e=this.model.dimension,i=this.coordinates.x_scale,s=this.coordinates.y_scale,n="height"==e?s:i,o="height"==e?i:s,r="height"==e?t.bbox.yview:t.bbox.xview,a="height"==e?t.bbox.xview:t.bbox.yview;let l,c,h;l="data"==this.model.properties.lower.units?n.v_compute(this._lower):r.v_compute(this._lower),c="data"==this.model.properties.upper.units?n.v_compute(this._upper):r.v_compute(this._upper),h="data"==this.model.properties.base.units?o.v_compute(this._base):a.v_compute(this._base);const[_,d]="height"==e?[1,0]:[0,1],u=[l,h],p=[c,h];this._lower_sx=u[_],this._lower_sy=u[d],this._upper_sx=p[_],this._upper_sy=p[d]}}i.UpperLowerView=c,c.__name__="UpperLowerView";class h extends l.CoordinateSpec{get dimension(){return"width"==this.obj.dimension?"x":"y"}get units(){var t;return null!==(t=this.spec.units)&&void 0!==t?t:"data"}}i.XOrYCoordinateSpec=h,h.__name__="XOrYCoordinateSpec";class _ extends r.DataAnnotation{constructor(t){super(t)}static init_UpperLower(){this.define((()=>({dimension:[a.Dimension,"height"],lower:[h,{field:"lower"}],upper:[h,{field:"upper"}],base:[h,{field:"base"}]})))}}i.UpperLower=_,_.__name__="UpperLower",_.init_UpperLower()},function(t,e,i,s,n){s();const o=t(1),r=t(40),a=o.__importStar(t(48)),l=t(20),c=t(99);i.EDGE_TOLERANCE=2.5;class h extends r.AnnotationView{constructor(){super(...arguments),this.bbox=new c.BBox}connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>this.request_render()))}_render(){const{left:t,right:e,top:i,bottom:s}=this.model;if(null==t&&null==e&&null==i&&null==s)return;const{frame:n}=this.plot_view,o=this.coordinates.x_scale,r=this.coordinates.y_scale,a=(t,e,i,s,n)=>{let o;return o=null!=t?this.model.screen?t:"data"==e?i.compute(t):s.compute(t):n,o};this.bbox=c.BBox.from_rect({left:a(t,this.model.left_units,o,n.bbox.xview,n.bbox.left),right:a(e,this.model.right_units,o,n.bbox.xview,n.bbox.right),top:a(i,this.model.top_units,r,n.bbox.yview,n.bbox.top),bottom:a(s,this.model.bottom_units,r,n.bbox.yview,n.bbox.bottom)}),this._paint_box()}_paint_box(){const{ctx:t}=this.layer;t.save();const{left:e,top:i,width:s,height:n}=this.bbox;t.beginPath(),t.rect(e,i,s,n),this.visuals.fill.doit&&(this.visuals.fill.set_value(t),t.fill()),this.visuals.hatch.doit&&(this.visuals.hatch.set_value(t),t.fill()),this.visuals.line.doit&&(this.visuals.line.set_value(t),t.stroke()),t.restore()}interactive_bbox(){const t=this.model.line_width+i.EDGE_TOLERANCE;return this.bbox.grow_by(t)}interactive_hit(t,e){return null!=this.model.in_cursor&&this.interactive_bbox().contains(t,e)}cursor(t,e){const{left:i,right:s,bottom:n,top:o}=this.bbox;return Math.abs(t-i)<3||Math.abs(t-s)<3?this.model.ew_cursor:Math.abs(e-n)<3||Math.abs(e-o)<3?this.model.ns_cursor:this.bbox.contains(t,e)?this.model.in_cursor:null}}i.BoxAnnotationView=h,h.__name__="BoxAnnotationView";class _ extends r.Annotation{constructor(t){super(t)}static init_BoxAnnotation(){this.prototype.default_view=h,this.mixins([a.Line,a.Fill,a.Hatch]),this.define((({Number:t,Nullable:e})=>({top:[e(t),null],top_units:[l.SpatialUnits,"data"],bottom:[e(t),null],bottom_units:[l.SpatialUnits,"data"],left:[e(t),null],left_units:[l.SpatialUnits,"data"],right:[e(t),null],right_units:[l.SpatialUnits,"data"],render_mode:[l.RenderMode,"canvas"]}))),this.internal((({Boolean:t,String:e,Nullable:i})=>({screen:[t,!1],ew_cursor:[i(e),null],ns_cursor:[i(e),null],in_cursor:[i(e),null]}))),this.override({fill_color:"#fff9ba",fill_alpha:.4,line_color:"#cccccc",line_alpha:.3})}update({left:t,right:e,top:i,bottom:s}){this.setv({left:t,right:e,top:i,bottom:s,screen:!0})}}i.BoxAnnotation=_,_.__name__="BoxAnnotation",_.init_BoxAnnotation()},function(t,e,i,s,n){s();const o=t(1),r=t(40),a=t(138),l=t(144),c=t(162),h=t(165),_=t(198),d=t(166),u=t(205),p=t(169),m=t(203),g=t(202),f=t(209),b=t(217),v=t(220),y=t(20),x=o.__importStar(t(48)),w=t(9),A=t(221),k=t(222),S=t(225),T=t(140),C=t(11),M=t(122),E=t(8);class z extends r.AnnotationView{get orientation(){return this._orientation}initialize(){super.initialize();const{ticker:t,formatter:e,color_mapper:i}=this.model;this._ticker="auto"!=t?t:(()=>{switch(!0){case i instanceof f.LogColorMapper:return new _.LogTicker;case i instanceof f.ScanningColorMapper:return new _.BinnedTicker({mapper:i});case i instanceof f.CategoricalColorMapper:return new _.CategoricalTicker;default:return new _.BasicTicker}})(),this._formatter="auto"!=e?e:(()=>{switch(!0){case this._ticker instanceof _.LogTicker:return new u.LogTickFormatter;case i instanceof f.CategoricalColorMapper:return new u.CategoricalTickFormatter;default:return new u.BasicTickFormatter}})(),this._major_range=(()=>{if(i instanceof f.CategoricalColorMapper){const{factors:t}=i;return new v.FactorRange({factors:t})}if(i instanceof g.ContinuousColorMapper){const{min:t,max:e}=i.metrics;return new v.Range1d({start:t,end:e})}C.unreachable()})(),this._major_scale=(()=>{if(i instanceof f.LinearColorMapper)return new b.LinearScale;if(i instanceof f.LogColorMapper)return new b.LogScale;if(i instanceof f.ScanningColorMapper){const{binning:t}=i.metrics;return new b.LinearInterpolationScale({binning:t})}if(i instanceof f.CategoricalColorMapper)return new b.CategoricalScale;C.unreachable()})(),this._minor_range=new v.Range1d({start:0,end:1}),this._minor_scale=new b.LinearScale;const s=x.attrs_of(this.model,"major_label_",x.Text,!0),n=x.attrs_of(this.model,"major_tick_",x.Line,!0),o=x.attrs_of(this.model,"minor_tick_",x.Line,!0),r=x.attrs_of(this.model,"title_",x.Text),l=i instanceof f.CategoricalColorMapper?c.CategoricalAxis:i instanceof f.LogColorMapper?c.LogAxis:c.LinearAxis;this._axis=new l(Object.assign(Object.assign(Object.assign({ticker:this._ticker,formatter:this._formatter,major_tick_in:this.model.major_tick_in,major_tick_out:this.model.major_tick_out,minor_tick_in:this.model.minor_tick_in,minor_tick_out:this.model.minor_tick_out,major_label_standoff:this.model.label_standoff,major_label_overrides:this.model.major_label_overrides,major_label_policy:this.model.major_label_policy,axis_line_color:null},s),n),o));const{title:h}=this.model;h&&(this._title=new a.Title(Object.assign({text:h,standoff:this.model.title_standoff},r)))}async lazy_initialize(){await super.lazy_initialize();const t=this,e={get parent(){return t.parent},get root(){return t.root},get frame(){return t._frame},get canvas_view(){return t.parent.canvas_view},request_layout(){t.parent.request_layout()}};this._axis_view=await M.build_view(this._axis,{parent:e}),null!=this._title&&(this._title_view=await M.build_view(this._title,{parent:e}))}remove(){var t;null===(t=this._title_view)||void 0===t||t.remove(),this._axis_view.remove(),super.remove()}connect_signals(){super.connect_signals(),this.connect(this._ticker.change,(()=>this.request_render())),this.connect(this._formatter.change,(()=>this.request_render())),this.connect(this.model.color_mapper.metrics_change,(()=>{const t=this._major_range,e=this._major_scale,{color_mapper:i}=this.model;if(i instanceof g.ContinuousColorMapper&&t instanceof v.Range1d){const{min:e,max:s}=i.metrics;t.setv({start:e,end:s})}if(i instanceof f.ScanningColorMapper&&e instanceof b.LinearInterpolationScale){const{binning:t}=i.metrics;e.binning=t}this._set_canvas_image(),this.plot_view.request_layout()}))}_set_canvas_image(){const{orientation:t}=this,e=(()=>{const{palette:e}=this.model.color_mapper;return"vertical"==t?w.reversed(e):e})(),[i,s]="vertical"==t?[1,e.length]:[e.length,1],n=this._image=document.createElement("canvas");n.width=i,n.height=s;const o=n.getContext("2d"),r=o.getImageData(0,0,i,s),a=new f.LinearColorMapper({palette:e}).rgba_mapper.v_compute(w.range(0,e.length));r.data.set(a),o.putImageData(r,0,0)}update_layout(){const{location:t,width:e,height:i,padding:s,margin:n}=this.model,[o,r]=(()=>{if(!E.isString(t))return["end","start"];switch(t){case"top_left":return["start","start"];case"top":case"top_center":return["start","center"];case"top_right":return["start","end"];case"bottom_left":return["end","start"];case"bottom":case"bottom_center":return["end","center"];case"bottom_right":return["end","end"];case"left":case"center_left":return["center","start"];case"center":case"center_center":return["center","center"];case"right":case"center_right":return["center","end"]}})(),a=this._orientation=(()=>{const{orientation:t}=this.model;return"auto"==t?null!=this.panel?this.panel.is_horizontal?"horizontal":"vertical":"start"==r||"end"==r||"center"==r&&"center"==o?"vertical":"horizontal":t})(),c=new k.NodeLayout,h=new k.VStack,_=new k.VStack,d=new k.HStack,u=new k.HStack;c.absolute=!0,h.absolute=!0,_.absolute=!0,d.absolute=!0,u.absolute=!0;const[p,m,g,f]=(()=>"horizontal"==a?[this._major_scale,this._minor_scale,this._major_range,this._minor_range]:[this._minor_scale,this._major_scale,this._minor_range,this._major_range])();this._frame=new l.CartesianFrame(p,m,g,f),c.on_resize((t=>this._frame.set_geometry(t)));const b=new S.BorderLayout;this._inner_layout=b,b.absolute=!0,b.center_panel=c,b.top_panel=h,b.bottom_panel=_,b.left_panel=d,b.right_panel=u;const v={left:s,right:s,top:s,bottom:s},y=(()=>{if(null==this.panel){if(E.isString(t))return{left:n,right:n,top:n,bottom:n};{const[e,i]=t;return{left:e,right:n,top:n,bottom:i}}}if(!E.isString(t)){const[e,i]=t;return{left:e,right:0,top:0,bottom:i}}})();let x,w,C,M;if(b.padding=v,null!=this.panel?(x="max",w=void 0,C=void 0,M=void 0):"auto"==("horizontal"==a?e:i)?(x="fixed",w=25*this.model.color_mapper.palette.length,C={percent:.3},M={percent:.8}):(x="fit",w=void 0),"horizontal"==a){const t="auto"==e?void 0:e,s="auto"==i?25:i;b.set_sizing({width_policy:x,height_policy:"min",width:w,min_width:C,max_width:M,halign:r,valign:o,margin:y}),b.center_panel.set_sizing({width_policy:"auto"==e?"fit":"fixed",height_policy:"fixed",width:t,height:s})}else{const t="auto"==e?25:e,s="auto"==i?void 0:i;b.set_sizing({width_policy:"min",height_policy:x,height:w,min_height:C,max_height:M,halign:r,valign:o,margin:y}),b.center_panel.set_sizing({width_policy:"fixed",height_policy:"auto"==i?"fit":"fixed",width:t,height:s})}h.set_sizing({width_policy:"fit",height_policy:"min"}),_.set_sizing({width_policy:"fit",height_policy:"min"}),d.set_sizing({width_policy:"min",height_policy:"fit"}),u.set_sizing({width_policy:"min",height_policy:"fit"});const{_title_view:z}=this;null!=z&&("horizontal"==a?(z.panel=new T.Panel("above"),z.update_layout(),h.children.push(z.layout)):(z.panel=new T.Panel("left"),z.update_layout(),d.children.push(z.layout)));const{panel:R}=this,B=null!=R&&a==R.orientation?R.side:"horizontal"==a?"below":"right",P=(()=>{switch(B){case"above":return h;case"below":return _;case"left":return d;case"right":return u}})(),{_axis_view:N}=this;if(N.panel=new T.Panel(B),N.update_layout(),P.children.push(N.layout),null!=this.panel){const t=new A.Grid([{layout:b,row:0,col:0}]);t.absolute=!0,"horizontal"==a?t.set_sizing({width_policy:"max",height_policy:"min"}):t.set_sizing({width_policy:"min",height_policy:"max"}),this.layout=t}else this.layout=this._inner_layout;const{visible:I}=this.model;this.layout.sizing.visible=I,this._set_canvas_image()}_render(){var t;const{ctx:e}=this.layer;e.save(),this._paint_bbox(e,this._inner_layout.bbox),this._paint_image(e,this._inner_layout.center_panel.bbox),null===(t=this._title_view)||void 0===t||t.render(),this._axis_view.render(),e.restore()}_paint_bbox(t,e){const{x:i,y:s}=e;let{width:n,height:o}=e;i+n>=this.parent.canvas_view.bbox.width&&(n-=1),s+o>=this.parent.canvas_view.bbox.height&&(o-=1),t.save(),this.visuals.background_fill.doit&&(this.visuals.background_fill.set_value(t),t.fillRect(i,s,n,o)),this.visuals.border_line.doit&&(this.visuals.border_line.set_value(t),t.strokeRect(i,s,n,o)),t.restore()}_paint_image(t,e){const{x:i,y:s,width:n,height:o}=e;t.save(),t.setImageSmoothingEnabled(!1),t.globalAlpha=this.model.scale_alpha,t.drawImage(this._image,i,s,n,o),this.visuals.bar_line.doit&&(this.visuals.bar_line.set_value(t),t.strokeRect(i,s,n,o)),t.restore()}serializable_state(){const t=super.serializable_state(),{children:e=[]}=t,i=o.__rest(t,["children"]);return null!=this._title_view&&e.push(this._title_view.serializable_state()),e.push(this._axis_view.serializable_state()),Object.assign(Object.assign({},i),{children:e})}}i.ColorBarView=z,z.__name__="ColorBarView";class R extends r.Annotation{constructor(t){super(t)}static init_ColorBar(){this.prototype.default_view=z,this.mixins([["major_label_",x.Text],["title_",x.Text],["major_tick_",x.Line],["minor_tick_",x.Line],["border_",x.Line],["bar_",x.Line],["background_",x.Fill]]),this.define((({Alpha:t,Number:e,String:i,Tuple:s,Dict:n,Or:o,Ref:r,Auto:a,Nullable:l})=>({location:[o(y.Anchor,s(e,e)),"top_right"],orientation:[o(y.Orientation,a),"auto"],title:[l(i),null],title_standoff:[e,2],width:[o(e,a),"auto"],height:[o(e,a),"auto"],scale_alpha:[t,1],ticker:[o(r(h.Ticker),a),"auto"],formatter:[o(r(d.TickFormatter),a),"auto"],major_label_overrides:[n(i),{}],major_label_policy:[r(p.LabelingPolicy),()=>new p.NoOverlap],color_mapper:[r(m.ColorMapper)],label_standoff:[e,5],margin:[e,30],padding:[e,10],major_tick_in:[e,5],major_tick_out:[e,0],minor_tick_in:[e,0],minor_tick_out:[e,0]}))),this.override({background_fill_color:"#ffffff",background_fill_alpha:.95,bar_line_color:null,border_line_color:null,major_label_text_font_size:"11px",major_tick_line_color:"#ffffff",minor_tick_line_color:null,title_text_font_size:"13px",title_text_font_style:"italic"})}}i.ColorBar=R,R.__name__="ColorBar",R.init_ColorBar()},function(t,e,i,s,n){s();const o=t(1),r=t(139),a=t(20),l=t(143),c=o.__importStar(t(48));class h extends r.TextAnnotationView{_get_location(){const t=this.model.offset,e=this.model.standoff/2;let i,s;const{bbox:n}=this.layout;switch(this.panel.side){case"above":case"below":switch(this.model.vertical_align){case"top":s=n.top+e;break;case"middle":s=n.vcenter;break;case"bottom":s=n.bottom-e}switch(this.model.align){case"left":i=n.left+t;break;case"center":i=n.hcenter;break;case"right":i=n.right-t}break;case"left":switch(this.model.vertical_align){case"top":i=n.left+e;break;case"middle":i=n.hcenter;break;case"bottom":i=n.right-e}switch(this.model.align){case"left":s=n.bottom-t;break;case"center":s=n.vcenter;break;case"right":s=n.top+t}break;case"right":switch(this.model.vertical_align){case"top":i=n.right-e;break;case"middle":i=n.hcenter;break;case"bottom":i=n.left+e}switch(this.model.align){case"left":s=n.top+t;break;case"center":s=n.vcenter;break;case"right":s=n.bottom-t}}return[i,s]}_render(){const{text:t}=this.model;if(null==t||0==t.length)return;this.model.text_baseline=this.model.vertical_align,this.model.text_align=this.model.align;const[e,i]=this._get_location(),s=this.panel.get_label_angle_heuristic("parallel");("canvas"==this.model.render_mode?this._canvas_text.bind(this):this._css_text.bind(this))(this.layer.ctx,t,e,i,s)}_get_size(){const{text:t}=this.model;if(null==t||0==t.length)return{width:0,height:0};{const{ctx:e}=this.layer;this.visuals.text.set_value(e);const{width:i}=this.layer.ctx.measureText(t),{height:s}=l.font_metrics(e.font);return{width:i,height:2+s*this.model.text_line_height+this.model.standoff}}}}i.TitleView=h,h.__name__="TitleView";class _ extends r.TextAnnotation{constructor(t){super(t)}static init_Title(){this.prototype.default_view=h,this.mixins([c.Text,["border_",c.Line],["background_",c.Fill]]),this.define((({Number:t,String:e})=>({text:[e,""],vertical_align:[a.VerticalAlign,"bottom"],align:[a.TextAlign,"left"],offset:[t,0],standoff:[t,10]}))),this.prototype._props.text_align.options.internal=!0,this.prototype._props.text_baseline.options.internal=!0,this.override({text_font_size:"13px",text_font_style:"bold",text_line_height:1,background_fill_color:null,border_line_color:null})}}i.Title=_,_.__name__="Title",_.init_Title()},function(t,e,i,s,n){s();const o=t(40),r=t(43),a=t(20),l=t(140),c=t(143),h=t(11);class _ extends o.AnnotationView{update_layout(){const{panel:t}=this;this.layout=null!=t?new l.SideLayout(t,(()=>this.get_size()),!0):void 0}initialize(){super.initialize(),"css"==this.model.render_mode&&(this.el=r.div(),this.plot_view.canvas_view.add_overlay(this.el))}remove(){null!=this.el&&r.remove(this.el),super.remove()}connect_signals(){super.connect_signals(),"css"==this.model.render_mode?this.connect(this.model.change,(()=>this.render())):this.connect(this.model.change,(()=>this.request_render()))}render(){this.model.visible||"css"!=this.model.render_mode||r.undisplay(this.el),super.render()}_calculate_text_dimensions(t,e){const{width:i}=t.measureText(e),{height:s}=c.font_metrics(this.visuals.text.font_value());return[i,s]}_calculate_bounding_box_dimensions(t,e){const[i,s]=this._calculate_text_dimensions(t,e);let n,o;switch(t.textAlign){case"left":n=0;break;case"center":n=-i/2;break;case"right":n=-i;break;default:h.unreachable()}switch(t.textBaseline){case"top":o=0;break;case"middle":o=-.5*s;break;case"bottom":o=-1*s;break;case"alphabetic":o=-.8*s;break;case"hanging":o=-.17*s;break;case"ideographic":o=-.83*s;break;default:h.unreachable()}return[n,o,i,s]}_canvas_text(t,e,i,s,n){this.visuals.text.set_value(t);const o=this._calculate_bounding_box_dimensions(t,e);t.save(),t.beginPath(),t.translate(i,s),n&&t.rotate(n),t.rect(o[0],o[1],o[2],o[3]),this.visuals.background_fill.doit&&(this.visuals.background_fill.set_value(t),t.fill()),this.visuals.border_line.doit&&(this.visuals.border_line.set_value(t),t.stroke()),this.visuals.text.doit&&(this.visuals.text.set_value(t),t.fillText(e,0,0)),t.restore()}_css_text(t,e,i,s,n){const{el:o}=this;h.assert(null!=o),r.undisplay(o),this.visuals.text.set_value(t);const[a,l]=this._calculate_bounding_box_dimensions(t,e);o.style.position="absolute",o.style.left=`${i+a}px`,o.style.top=`${s+l}px`,o.style.color=t.fillStyle,o.style.font=t.font,o.style.lineHeight="normal",n&&(o.style.transform=`rotate(${n}rad)`),this.visuals.background_fill.doit&&(this.visuals.background_fill.set_value(t),o.style.backgroundColor=t.fillStyle),this.visuals.border_line.doit&&(this.visuals.border_line.set_value(t),o.style.borderStyle=t.lineDash.length<2?"solid":"dashed",o.style.borderWidth=`${t.lineWidth}px`,o.style.borderColor=t.strokeStyle),o.textContent=e,r.display(o)}}i.TextAnnotationView=_,_.__name__="TextAnnotationView";class d extends o.Annotation{constructor(t){super(t)}static init_TextAnnotation(){this.define((()=>({render_mode:[a.RenderMode,"canvas"]})))}}i.TextAnnotation=d,d.__name__="TextAnnotation",d.init_TextAnnotation()},function(t,e,i,s,n){s();const o=t(141),r=t(142),a=t(8),l=Math.PI/2,c={above:{parallel:0,normal:-l,horizontal:0,vertical:-l},below:{parallel:0,normal:l,horizontal:0,vertical:l},left:{parallel:-l,normal:0,horizontal:0,vertical:-l},right:{parallel:l,normal:0,horizontal:0,vertical:l}},h={above:{parallel:"bottom",normal:"center",horizontal:"bottom",vertical:"center"},below:{parallel:"top",normal:"center",horizontal:"top",vertical:"center"},left:{parallel:"bottom",normal:"center",horizontal:"center",vertical:"bottom"},right:{parallel:"bottom",normal:"center",horizontal:"center",vertical:"bottom"}},_={above:{parallel:"center",normal:"left",horizontal:"center",vertical:"left"},below:{parallel:"center",normal:"left",horizontal:"center",vertical:"left"},left:{parallel:"center",normal:"right",horizontal:"right",vertical:"center"},right:{parallel:"center",normal:"left",horizontal:"left",vertical:"center"}},d={above:"right",below:"left",left:"right",right:"left"},u={above:"left",below:"right",left:"right",right:"left"};class p{constructor(t){this.side=t}get dimension(){return"above"==this.side||"below"==this.side?0:1}get normals(){switch(this.side){case"above":return[0,-1];case"below":return[0,1];case"left":return[-1,0];case"right":return[1,0]}}get orientation(){return this.is_horizontal?"horizontal":"vertical"}get is_horizontal(){return 0==this.dimension}get is_vertical(){return 1==this.dimension}get_label_text_heuristics(t){const{side:e}=this;return a.isString(t)?{vertical_align:h[e][t],align:_[e][t]}:{vertical_align:"center",align:(t<0?d:u)[e]}}get_label_angle_heuristic(t){return a.isString(t)?c[this.side][t]:-t}}i.Panel=p,p.__name__="Panel";class m extends r.ContentLayoutable{constructor(t,e,i=!1){super(),this.panel=t,this.get_size=e,this.rotate=i,this.panel.is_horizontal?this.set_sizing({width_policy:"max",height_policy:"fixed"}):this.set_sizing({width_policy:"fixed",height_policy:"max"})}_content_size(){const{width:t,height:e}=this.get_size();return!this.rotate||this.panel.is_horizontal?new o.Sizeable({width:t,height:e}):new o.Sizeable({width:e,height:t})}has_size_changed(){const{width:t,height:e}=this._content_size();return this.panel.is_horizontal?this.bbox.height!=e:this.bbox.width!=t}}i.SideLayout=m,m.__name__="SideLayout"},function(t,e,i,s,n){s();const o=t(21),{min:r,max:a}=Math;class l{constructor(t={}){this.width=null!=t.width?t.width:0,this.height=null!=t.height?t.height:0}bounded_to({width:t,height:e}){return new l({width:this.width==1/0&&null!=t?t:this.width,height:this.height==1/0&&null!=e?e:this.height})}expanded_to({width:t,height:e}){return new l({width:t!=1/0?a(this.width,t):this.width,height:e!=1/0?a(this.height,e):this.height})}expand_to({width:t,height:e}){this.width=a(this.width,t),this.height=a(this.height,e)}narrowed_to({width:t,height:e}){return new l({width:r(this.width,t),height:r(this.height,e)})}narrow_to({width:t,height:e}){this.width=r(this.width,t),this.height=r(this.height,e)}grow_by({left:t,right:e,top:i,bottom:s}){const n=this.width+t+e,o=this.height+i+s;return new l({width:n,height:o})}shrink_by({left:t,right:e,top:i,bottom:s}){const n=a(this.width-t-e,0),o=a(this.height-i-s,0);return new l({width:n,height:o})}map(t,e){return new l({width:t(this.width),height:(null!=e?e:t)(this.height)})}}i.Sizeable=l,l.__name__="Sizeable",i.SizingPolicy=o.Enum("fixed","fit","min","max")},function(t,e,i,s,n){s();const o=t(141),r=t(99),a=t(8),{min:l,max:c,round:h}=Math;class _{constructor(){this.absolute=!1,this._bbox=new r.BBox,this._inner_bbox=new r.BBox,this._dirty=!1,this._handlers=[]}*[Symbol.iterator](){}get bbox(){return this._bbox}get inner_bbox(){return this._inner_bbox}get sizing(){return this._sizing}set visible(t){this._sizing.visible=t,this._dirty=!0}set_sizing(t){var e,i,s,n,o;const r=null!==(e=t.width_policy)&&void 0!==e?e:"fit",a=t.width,l=t.min_width,c=t.max_width,h=null!==(i=t.height_policy)&&void 0!==i?i:"fit",_=t.height,d=t.min_height,u=t.max_height,p=t.aspect,m=null!==(s=t.margin)&&void 0!==s?s:{top:0,right:0,bottom:0,left:0},g=!1!==t.visible,f=null!==(n=t.halign)&&void 0!==n?n:"start",b=null!==(o=t.valign)&&void 0!==o?o:"start";this._sizing={width_policy:r,min_width:l,width:a,max_width:c,height_policy:h,min_height:d,height:_,max_height:u,aspect:p,margin:m,visible:g,halign:f,valign:b,size:{width:a,height:_}},this._init()}_init(){}_set_geometry(t,e){this._bbox=t,this._inner_bbox=e}set_geometry(t,e){this._set_geometry(t,null!=e?e:t);for(const i of this._handlers)i(this._bbox,this._inner_bbox)}on_resize(t){this._handlers.push(t)}is_width_expanding(){return"max"==this.sizing.width_policy}is_height_expanding(){return"max"==this.sizing.height_policy}apply_aspect(t,{width:e,height:i}){const{aspect:s}=this.sizing;if(null!=s){const{width_policy:n,height_policy:o}=this.sizing,r=(t,e)=>{const i={max:4,fit:3,min:2,fixed:1};return i[t]>i[e]};if("fixed"!=n&&"fixed"!=o)if(n==o){const n=e,o=h(e/s),r=h(i*s),a=i;Math.abs(t.width-n)+Math.abs(t.height-o)<=Math.abs(t.width-r)+Math.abs(t.height-a)?(e=n,i=o):(e=r,i=a)}else r(n,o)?i=h(e/s):e=h(i*s);else"fixed"==n?i=h(e/s):"fixed"==o&&(e=h(i*s))}return{width:e,height:i}}measure(t){if(!this.sizing.visible)return{width:0,height:0};const e=new o.Sizeable(t).shrink_by(this.sizing.margin).map((t=>t==1/0&&"fixed"==this.sizing.width_policy&&null!=this.sizing.width?this.sizing.width:t),(t=>t==1/0&&"fixed"==this.sizing.height_policy&&null!=this.sizing.height?this.sizing.height:t)),i=this._measure(e),s=this.clip_size(i,e),n=this.apply_aspect(e,s);return Object.assign(Object.assign({},i),n)}compute(t={}){const e={width:null!=t.width&&this.is_width_expanding()?t.width:1/0,height:null!=t.height&&this.is_height_expanding()?t.height:1/0},i=this.measure(e),{width:s,height:n}=i,o=new r.BBox({left:0,top:0,width:s,height:n});let a;if(null!=i.inner){const{left:t,top:e,right:o,bottom:l}=i.inner;a=new r.BBox({left:t,top:e,right:s-o,bottom:n-l})}this.set_geometry(o,a)}get xview(){return this.bbox.xview}get yview(){return this.bbox.yview}clip_size(t,e){function i(t,e,i,s){return null==i?i=0:a.isNumber(i)||(i=Math.round(i.percent*e)),null==s?s=1/0:a.isNumber(s)||(s=Math.round(s.percent*e)),c(i,l(t,s))}return{width:i(t.width,e.width,this.sizing.min_width,this.sizing.max_width),height:i(t.height,e.height,this.sizing.min_height,this.sizing.max_height)}}has_size_changed(){const{_dirty:t}=this;return this._dirty=!1,t}}i.Layoutable=_,_.__name__="Layoutable";class d extends _{_measure(t){const{width_policy:e,height_policy:i}=this.sizing;return{width:(()=>{const{width:i}=this.sizing;if(t.width==1/0)return null!=i?i:0;switch(e){case"fixed":return null!=i?i:0;case"min":return null!=i?l(t.width,i):0;case"fit":return null!=i?l(t.width,i):t.width;case"max":return null!=i?c(t.width,i):t.width}})(),height:(()=>{const{height:e}=this.sizing;if(t.height==1/0)return null!=e?e:0;switch(i){case"fixed":return null!=e?e:0;case"min":return null!=e?l(t.height,e):0;case"fit":return null!=e?l(t.height,e):t.height;case"max":return null!=e?c(t.height,e):t.height}})()}}}i.LayoutItem=d,d.__name__="LayoutItem";class u extends _{_measure(t){const e=this._content_size(),i=t.bounded_to(this.sizing.size).bounded_to(e);return{width:(()=>{switch(this.sizing.width_policy){case"fixed":return null!=this.sizing.width?this.sizing.width:e.width;case"min":return e.width;case"fit":return i.width;case"max":return Math.max(e.width,i.width)}})(),height:(()=>{switch(this.sizing.height_policy){case"fixed":return null!=this.sizing.height?this.sizing.height:e.height;case"min":return e.height;case"fit":return i.height;case"max":return Math.max(e.height,i.height)}})()}}}i.ContentLayoutable=u,u.__name__="ContentLayoutable"},function(t,e,i,s,n){s();const o=t(11),r=(()=>{try{return"undefined"!=typeof OffscreenCanvas&&null!=new OffscreenCanvas(0,0).getContext("2d")}catch(t){return!1}})()?(t,e)=>new OffscreenCanvas(t,e):(t,e)=>{const i=document.createElement("canvas");return i.width=t,i.height=e,i},a=(()=>{const t=r(0,0).getContext("2d");return e=>{t.font=e;const i=t.measureText("M"),s=t.measureText("x"),n=t.measureText("ÅŚg|"),r=n.fontBoundingBoxAscent,a=n.fontBoundingBoxDescent;if(null!=r&&null!=a)return{height:r+a,ascent:r,descent:a,cap_height:i.actualBoundingBoxAscent,x_height:s.actualBoundingBoxAscent};const l=n.actualBoundingBoxAscent,c=n.actualBoundingBoxDescent;if(null!=l&&null!=c)return{height:l+c,ascent:l,descent:c,cap_height:i.actualBoundingBoxAscent,x_height:s.actualBoundingBoxAscent};o.unreachable()}})(),l=(()=>{const t=r(0,0).getContext("2d");return(e,i)=>{t.font=i;const s=t.measureText(e),n=s.actualBoundingBoxAscent,r=s.actualBoundingBoxDescent;if(null!=n&&null!=r)return{width:s.width,height:n+r,ascent:n,descent:r};o.unreachable()}})(),c=(()=>{const t=document.createElement("canvas"),e=t.getContext("2d");let i=-1,s=-1;return(n,o=1)=>{e.font=n;const{width:r}=e.measureText("M"),a=r*o,l=Math.ceil(a),c=Math.ceil(2*a),h=Math.ceil(1.5*a);i<l&&(i=l,t.width=l),s<c&&(s=c,t.height=c),e.save(),e.scale(o,o),e.fillStyle="#f00",e.fillRect(0,0,l,c);const _=t=>{let e=0;for(let i=0;i<=h;i++)for(let s=0;s<l;s++,e+=4)if(255!=t[e])return h-i;return 0};e.font=n,e.fillStyle="#000";for(const t of"xa")e.fillText(t,0,h/o);const{data:d}=e.getImageData(0,0,l,c),u=_(d)/o;for(const t of"ASQ")e.fillText(t,0,h/o);const{data:p}=e.getImageData(0,0,l,c),m=_(p)/o;for(const t of"ÅŚgy")e.fillText(t,0,h/o);const{data:g}=e.getImageData(0,0,l,c),f=_(g)/o,b=(t=>{let e=t.length-4;for(let i=c;i>=h;i--)for(let s=0;s<l;s++,e-=4)if(255!=t[e])return i-h;return 0})(g)/o;return e.restore(),{height:f+b,ascent:f,cap_height:m,x_height:u,descent:b}}})(),h=(()=>{const t=document.createElement("canvas"),e=t.getContext("2d");let i=-1,s=-1;return(n,o,r=1)=>{e.font=o;const{width:a}=e.measureText("M"),l=a*r,c=Math.ceil(l),h=Math.ceil(2*l),_=Math.ceil(1.5*l);(i<c||s<h)&&(i=c,t.width=c,s=h,t.height=h),e.save(),e.scale(r,r),e.fillStyle="#f00",e.fillRect(0,0,c,h),e.font=o,e.fillStyle="#000",e.fillText(n,0,_/r);const d=e.measureText(n),{data:u}=e.getImageData(0,0,c,h),p=(t=>{let e=0;for(let i=0;i<=_;i++)for(let s=0;s<c;s++,e+=4)if(255!=t[e])return _-i;return 0})(u)/r,m=(t=>{let e=t.length-4;for(let i=h;i>=_;i--)for(let s=0;s<c;s++,e-=4)if(255!=t[e])return i-_;return 0})(u)/r;return e.restore(),{width:d.width,height:p+m,ascent:p,descent:m}}})(),_=(()=>{try{return a("normal 10px sans-serif"),a}catch(t){return c}})(),d=(()=>{try{return l("A","normal 10px sans-serif"),l}catch(t){return h}})(),u=new Map;function p(t){let e=u.get(t);return null==e&&(e={font:_(t),glyphs:new Map},u.set(t,e)),e.font}i.font_metrics=p,i.glyph_metrics=function(t,e){let i=u.get(e);null==i&&(p(e),i=u.get(e));let s=i.glyphs.get(t);return null==s&&(s=d(t,e),i.glyphs.set(t,s)),s}},function(t,e,i,s,n){s();const o=t(145),r=t(157),a=t(156),l=t(159),c=t(104),h=t(99),_=t(13),d=t(11);class u{constructor(t,e,i,s,n={},o={}){this.in_x_scale=t,this.in_y_scale=e,this.x_range=i,this.y_range=s,this.extra_x_ranges=n,this.extra_y_ranges=o,this._bbox=new h.BBox,d.assert(null==t.source_range&&null==t.target_range),d.assert(null==e.source_range&&null==e.target_range),this._configure_scales()}get bbox(){return this._bbox}_get_ranges(t,e){return new Map(_.entries(Object.assign(Object.assign({},e),{default:t})))}_get_scales(t,e,i){const s=new Map;for(const[n,a]of e){if(a instanceof c.FactorRange!=t instanceof o.CategoricalScale)throw new Error(`Range ${a.type} is incompatible is Scale ${t.type}`);t instanceof r.LogScale&&a instanceof l.DataRange1d&&(a.scale_hint="log");const e=t.clone();e.setv({source_range:a,target_range:i}),s.set(n,e)}return s}_configure_frame_ranges(){const{bbox:t}=this;this._x_target=new a.Range1d({start:t.left,end:t.right}),this._y_target=new a.Range1d({start:t.bottom,end:t.top})}_configure_scales(){this._configure_frame_ranges(),this._x_ranges=this._get_ranges(this.x_range,this.extra_x_ranges),this._y_ranges=this._get_ranges(this.y_range,this.extra_y_ranges),this._x_scales=this._get_scales(this.in_x_scale,this._x_ranges,this._x_target),this._y_scales=this._get_scales(this.in_y_scale,this._y_ranges,this._y_target)}_update_scales(){this._configure_frame_ranges();for(const[,t]of this._x_scales)t.target_range=this._x_target;for(const[,t]of this._y_scales)t.target_range=this._y_target}set_geometry(t){this._bbox=t,this._update_scales()}get x_target(){return this._x_target}get y_target(){return this._y_target}get x_ranges(){return this._x_ranges}get y_ranges(){return this._y_ranges}get x_scales(){return this._x_scales}get y_scales(){return this._y_scales}get x_scale(){return this._x_scales.get("default")}get y_scale(){return this._y_scales.get("default")}get xscales(){return _.to_object(this.x_scales)}get yscales(){return _.to_object(this.y_scales)}}i.CartesianFrame=u,u.__name__="CartesianFrame"},function(t,e,i,s,n){s();const o=t(146);class r extends o.Scale{constructor(t){super(t)}get s_compute(){const[t,e]=this._linear_compute_state(),i=this.source_range;return s=>t*i.synthetic(s)+e}compute(t){return super._linear_compute(this.source_range.synthetic(t))}v_compute(t){return super._linear_v_compute(this.source_range.v_synthetic(t))}invert(t){return this._linear_invert(t)}v_invert(t){return this._linear_v_invert(t)}}i.CategoricalScale=r,r.__name__="CategoricalScale"},function(t,e,i,s,n){s();const o=t(147),r=t(105),a=t(156),l=t(24);class c extends o.Transform{constructor(t){super(t)}static init_Scale(){this.internal((({Ref:t})=>({source_range:[t(r.Range)],target_range:[t(a.Range1d)]})))}r_compute(t,e){return this.target_range.is_reversed?[this.compute(e),this.compute(t)]:[this.compute(t),this.compute(e)]}r_invert(t,e){return this.target_range.is_reversed?[this.invert(e),this.invert(t)]:[this.invert(t),this.invert(e)]}_linear_compute(t){const[e,i]=this._linear_compute_state();return e*t+i}_linear_v_compute(t){const[e,i]=this._linear_compute_state(),s=new l.ScreenArray(t.length);for(let n=0;n<t.length;n++)s[n]=e*t[n]+i;return s}_linear_invert(t){const[e,i]=this._linear_compute_state();return(t-i)/e}_linear_v_invert(t){const[e,i]=this._linear_compute_state(),s=new Float64Array(t.length);for(let n=0;n<t.length;n++)s[n]=(t[n]-i)/e;return s}_linear_compute_state(){const t=this.source_range.start,e=this.source_range.end,i=this.target_range.start,s=(this.target_range.end-i)/(e-t);return[s,-s*t+i]}}i.Scale=c,c.__name__="Scale",c.init_Scale()},function(t,e,i,s,n){s(),n("CustomJSTransform",t(148).CustomJSTransform),n("Dodge",t(150).Dodge),n("Interpolator",t(152).Interpolator),n("Jitter",t(153).Jitter),n("LinearInterpolator",t(154).LinearInterpolator),n("StepInterpolator",t(155).StepInterpolator),n("Transform",t(149).Transform)},function(t,e,i,s,n){s();const o=t(149),r=t(13),a=t(34);class l extends o.Transform{constructor(t){super(t)}static init_CustomJSTransform(){this.define((({Unknown:t,String:e,Dict:i})=>({args:[i(t),{}],func:[e,""],v_func:[e,""]})))}get names(){return r.keys(this.args)}get values(){return r.values(this.args)}_make_transform(t,e){return new Function(...this.names,t,a.use_strict(e))}get scalar_transform(){return this._make_transform("x",this.func)}get vector_transform(){return this._make_transform("xs",this.v_func)}compute(t){return this.scalar_transform(...this.values,t)}v_compute(t){return this.vector_transform(...this.values,t)}}i.CustomJSTransform=l,l.__name__="CustomJSTransform",l.init_CustomJSTransform()},function(t,e,i,s,n){s();const o=t(53);class r extends o.Model{constructor(t){super(t)}}i.Transform=r,r.__name__="Transform"},function(t,e,i,s,n){s();const o=t(151);class r extends o.RangeTransform{constructor(t){super(t)}static init_Dodge(){this.define((({Number:t})=>({value:[t,0]})))}_compute(t){return t+this.value}}i.Dodge=r,r.__name__="Dodge",r.init_Dodge()},function(t,e,i,s,n){s();const o=t(149),r=t(105),a=t(104),l=t(24),c=t(8);class h extends o.Transform{constructor(t){super(t)}static init_RangeTransform(){this.define((({Ref:t,Nullable:e})=>({range:[e(t(r.Range)),null]})))}v_compute(t){let e;if(this.range instanceof a.FactorRange)e=this.range.v_synthetic(t);else{if(!c.isArrayableOf(t,c.isNumber))throw new Error("unexpected");e=t}const i=new(l.infer_type(e))(e.length);for(let s=0;s<e.length;s++){const t=e[s];i[s]=this._compute(t)}return i}compute(t){if(this.range instanceof a.FactorRange)return this._compute(this.range.synthetic(t));if(c.isNumber(t))return this._compute(t);throw new Error("unexpected")}}i.RangeTransform=h,h.__name__="RangeTransform",h.init_RangeTransform()},function(t,e,i,s,n){s();const o=t(149),r=t(57),a=t(24),l=t(9),c=t(8);class h extends o.Transform{constructor(t){super(t),this._sorted_dirty=!0}static init_Interpolator(){this.define((({Boolean:t,Number:e,String:i,Ref:s,Array:n,Or:o,Nullable:a})=>({x:[o(i,n(e))],y:[o(i,n(e))],data:[a(s(r.ColumnarDataSource)),null],clip:[t,!0]})))}connect_signals(){super.connect_signals(),this.connect(this.change,(()=>this._sorted_dirty=!0))}v_compute(t){const e=new(a.infer_type(t))(t.length);for(let i=0;i<t.length;i++){const s=t[i];e[i]=this.compute(s)}return e}sort(t=!1){if(!this._sorted_dirty)return;let e,i;if(c.isString(this.x)&&c.isString(this.y)&&null!=this.data){const t=this.data.columns();if(!l.includes(t,this.x))throw new Error("The x parameter does not correspond to a valid column name defined in the data parameter");if(!l.includes(t,this.y))throw new Error("The y parameter does not correspond to a valid column name defined in the data parameter");e=this.data.get_column(this.x),i=this.data.get_column(this.y)}else{if(!c.isArray(this.x)||!c.isArray(this.y))throw new Error("parameters 'x' and 'y' must be both either string fields or arrays");e=this.x,i=this.y}if(e.length!==i.length)throw new Error("The length for x and y do not match");if(e.length<2)throw new Error("x and y must have at least two elements to support interpolation");const s=e.length,n=new Uint32Array(s);for(let r=0;r<s;r++)n[r]=r;const o=t?-1:1;n.sort(((t,i)=>o*(e[t]-e[i]))),this._x_sorted=new(a.infer_type(e))(s),this._y_sorted=new(a.infer_type(i))(s);for(let r=0;r<s;r++)this._x_sorted[r]=e[n[r]],this._y_sorted[r]=i[n[r]];this._sorted_dirty=!1}}i.Interpolator=h,h.__name__="Interpolator",h.init_Interpolator()},function(t,e,i,s,n){s();const o=t(1),r=t(151),a=t(20),l=o.__importStar(t(10));class c extends r.RangeTransform{constructor(t){super(t)}static init_Jitter(){this.define((({Number:t})=>({mean:[t,0],width:[t,1],distribution:[a.Distribution,"uniform"]})))}v_compute(t){return null!=this.previous_values&&this.previous_values.length==t.length||(this.previous_values=super.v_compute(t)),this.previous_values}_compute(t){switch(this.distribution){case"uniform":return t+this.mean+(l.random()-.5)*this.width;case"normal":return t+l.rnorm(this.mean,this.width)}}}i.Jitter=c,c.__name__="Jitter",c.init_Jitter()},function(t,e,i,s,n){s();const o=t(9),r=t(152);class a extends r.Interpolator{constructor(t){super(t)}compute(t){if(this.sort(!1),this.clip){if(t<this._x_sorted[0]||t>this._x_sorted[this._x_sorted.length-1])return NaN}else{if(t<this._x_sorted[0])return this._y_sorted[0];if(t>this._x_sorted[this._x_sorted.length-1])return this._y_sorted[this._y_sorted.length-1]}if(t==this._x_sorted[0])return this._y_sorted[0];const e=o.find_last_index(this._x_sorted,(e=>e<t)),i=this._x_sorted[e],s=this._x_sorted[e+1],n=this._y_sorted[e],r=this._y_sorted[e+1];return n+(t-i)/(s-i)*(r-n)}}i.LinearInterpolator=a,a.__name__="LinearInterpolator"},function(t,e,i,s,n){s();const o=t(152),r=t(20),a=t(9);class l extends o.Interpolator{constructor(t){super(t)}static init_StepInterpolator(){this.define((()=>({mode:[r.StepMode,"after"]})))}compute(t){if(this.sort(!1),this.clip){if(t<this._x_sorted[0]||t>this._x_sorted[this._x_sorted.length-1])return NaN}else{if(t<this._x_sorted[0])return this._y_sorted[0];if(t>this._x_sorted[this._x_sorted.length-1])return this._y_sorted[this._y_sorted.length-1]}let e;switch(this.mode){case"after":e=a.find_last_index(this._x_sorted,(e=>t>=e));break;case"before":e=a.find_index(this._x_sorted,(e=>t<=e));break;case"center":{const i=a.map(this._x_sorted,(e=>Math.abs(e-t))),s=a.min(i);e=a.find_index(i,(t=>s===t));break}default:throw new Error(`unknown mode: ${this.mode}`)}return-1!=e?this._y_sorted[e]:NaN}}i.StepInterpolator=l,l.__name__="StepInterpolator",l.init_StepInterpolator()},function(t,e,i,s,n){s();const o=t(105);class r extends o.Range{constructor(t){super(t)}static init_Range1d(){this.define((({Number:t,Nullable:e})=>({start:[t,0],end:[t,1],reset_start:[e(t),null,{on_update(t,e){e._reset_start=null!=t?t:e.start}}],reset_end:[e(t),null,{on_update(t,e){e._reset_end=null!=t?t:e.end}}]})))}_set_auto_bounds(){if("auto"==this.bounds){const t=Math.min(this._reset_start,this._reset_end),e=Math.max(this._reset_start,this._reset_end);this.setv({bounds:[t,e]},{silent:!0})}}initialize(){super.initialize(),this._set_auto_bounds()}get min(){return Math.min(this.start,this.end)}get max(){return Math.max(this.start,this.end)}reset(){this._set_auto_bounds();const{_reset_start:t,_reset_end:e}=this;this.start!=t||this.end!=e?this.setv({start:t,end:e}):this.change.emit()}map(t){return new r({start:t(this.start),end:t(this.end)})}widen(t){let{start:e,end:i}=this;return this.is_reversed?(e+=t,i-=t):(e-=t,i+=t),new r({start:e,end:i})}}i.Range1d=r,r.__name__="Range1d",r.init_Range1d()},function(t,e,i,s,n){s();const o=t(158),r=t(24);class a extends o.ContinuousScale{constructor(t){super(t)}get s_compute(){const[t,e,i,s]=this._compute_state();return n=>{if(0==i)return 0;{const o=(Math.log(n)-s)/i;return isFinite(o)?o*t+e:NaN}}}compute(t){const[e,i,s,n]=this._compute_state();let o;if(0==s)o=0;else{const r=(Math.log(t)-n)/s;o=isFinite(r)?r*e+i:NaN}return o}v_compute(t){const[e,i,s,n]=this._compute_state(),o=new r.ScreenArray(t.length);if(0==s)for(let r=0;r<t.length;r++)o[r]=0;else for(let r=0;r<t.length;r++){const a=(Math.log(t[r])-n)/s;let l;l=isFinite(a)?a*e+i:NaN,o[r]=l}return o}invert(t){const[e,i,s,n]=this._compute_state(),o=(t-i)/e;return Math.exp(s*o+n)}v_invert(t){const[e,i,s,n]=this._compute_state(),o=new Float64Array(t.length);for(let r=0;r<t.length;r++){const a=(t[r]-i)/e;o[r]=Math.exp(s*a+n)}return o}_get_safe_factor(t,e){let i=t<0?0:t,s=e<0?0:e;if(i==s)if(0==i)[i,s]=[1,10];else{const t=Math.log(i)/Math.log(10);i=10**Math.floor(t),s=Math.ceil(t)!=Math.floor(t)?10**Math.ceil(t):10**(Math.ceil(t)+1)}return[i,s]}_compute_state(){const t=this.source_range.start,e=this.source_range.end,i=this.target_range.start,s=this.target_range.end-i,[n,o]=this._get_safe_factor(t,e);let r,a;return 0==n?(r=Math.log(o),a=0):(r=Math.log(o)-Math.log(n),a=Math.log(n)),[s,i,r,a]}}i.LogScale=a,a.__name__="LogScale"},function(t,e,i,s,n){s();const o=t(146);class r extends o.Scale{constructor(t){super(t)}}i.ContinuousScale=r,r.__name__="ContinuousScale"},function(t,e,i,s,n){s();const o=t(1),r=t(160),a=t(20),l=t(9),c=t(19),h=o.__importStar(t(99)),_=t(161);class d extends r.DataRange{constructor(t){super(t),this.have_updated_interactively=!1}static init_DataRange1d(){this.define((({Boolean:t,Number:e,Nullable:i})=>({start:[e],end:[e],range_padding:[e,.1],range_padding_units:[a.PaddingUnits,"percent"],flipped:[t,!1],follow:[i(a.StartEnd),null],follow_interval:[i(e),null],default_span:[e,2],only_visible:[t,!1]}))),this.internal((({Enum:t})=>({scale_hint:[t("log","auto"),"auto"]})))}initialize(){super.initialize(),this._initial_start=this.start,this._initial_end=this.end,this._initial_range_padding=this.range_padding,this._initial_range_padding_units=this.range_padding_units,this._initial_follow=this.follow,this._initial_follow_interval=this.follow_interval,this._initial_default_span=this.default_span,this._plot_bounds=new Map}get min(){return Math.min(this.start,this.end)}get max(){return Math.max(this.start,this.end)}computed_renderers(){const{renderers:t,names:e}=this,i=l.concat(this.plots.map((t=>t.data_renderers)));return _.compute_renderers(0==t.length?"auto":t,i,e)}_compute_plot_bounds(t,e){let i=h.empty();for(const s of t){const t=e.get(s);null==t||!s.visible&&this.only_visible||(i=h.union(i,t))}return i}adjust_bounds_for_aspect(t,e){const i=h.empty();let s=t.x1-t.x0;s<=0&&(s=1);let n=t.y1-t.y0;n<=0&&(n=1);const o=.5*(t.x1+t.x0),r=.5*(t.y1+t.y0);return s<e*n?s=e*n:n=s/e,i.x1=o+.5*s,i.x0=o-.5*s,i.y1=r+.5*n,i.y0=r-.5*n,i}_compute_min_max(t,e){let i,s,n=h.empty();for(const o of t)n=h.union(n,o);return[i,s]=0==e?[n.x0,n.x1]:[n.y0,n.y1],[i,s]}_compute_range(t,e){const i=this.range_padding;let s,n;if(null!=this._initial_start&&(t=this._initial_start),null!=this._initial_end&&(e=this._initial_end),"log"==this.scale_hint){let o,r;if((isNaN(t)||!isFinite(t)||t<=0)&&(t=isNaN(e)||!isFinite(e)||e<=0?.1:e/100,c.logger.warn(`could not determine minimum data value for log axis, DataRange1d using value ${t}`)),(isNaN(e)||!isFinite(e)||e<=0)&&(e=isNaN(t)||!isFinite(t)||t<=0?10:100*t,c.logger.warn(`could not determine maximum data value for log axis, DataRange1d using value ${e}`)),e==t)r=this.default_span+.001,o=Math.log(t)/Math.log(10);else{let s,n;"percent"==this.range_padding_units?(s=Math.log(t)/Math.log(10),n=Math.log(e)/Math.log(10),r=(n-s)*(1+i)):(s=Math.log(t-i)/Math.log(10),n=Math.log(e+i)/Math.log(10),r=n-s),o=(s+n)/2}s=10**(o-r/2),n=10**(o+r/2)}else{let o;o=e==t?this.default_span:"percent"==this.range_padding_units?(e-t)*(1+i):e-t+2*i;const r=(e+t)/2;s=r-o/2,n=r+o/2}let o=1;this.flipped&&([s,n]=[n,s],o=-1);const r=this.follow_interval;return null!=r&&Math.abs(s-n)>r&&("start"==this.follow?n=s+o*r:"end"==this.follow&&(s=n-o*r)),[s,n]}update(t,e,i,s){if(this.have_updated_interactively)return;const n=this.computed_renderers();let o=this._compute_plot_bounds(n,t);null!=s&&(o=this.adjust_bounds_for_aspect(o,s)),this._plot_bounds.set(i,o);const[r,a]=this._compute_min_max(this._plot_bounds.values(),e);let[l,c]=this._compute_range(r,a);null!=this._initial_start&&("log"==this.scale_hint?this._initial_start>0&&(l=this._initial_start):l=this._initial_start),null!=this._initial_end&&("log"==this.scale_hint?this._initial_end>0&&(c=this._initial_end):c=this._initial_end);let h=!1;"auto"==this.bounds&&(this.setv({bounds:[l,c]},{silent:!0}),h=!0);const[_,d]=[this.start,this.end];if(l!=_||c!=d){const t={};l!=_&&(t.start=l),c!=d&&(t.end=c),this.setv(t),h=!1}h&&this.change.emit()}reset(){this.have_updated_interactively=!1,this.setv({range_padding:this._initial_range_padding,range_padding_units:this._initial_range_padding_units,follow:this._initial_follow,follow_interval:this._initial_follow_interval,default_span:this._initial_default_span},{silent:!0}),this.change.emit()}}i.DataRange1d=d,d.__name__="DataRange1d",d.init_DataRange1d()},function(t,e,i,s,n){s();const o=t(105),r=t(62);class a extends o.Range{constructor(t){super(t)}static init_DataRange(){this.define((({String:t,Array:e,Ref:i})=>({names:[e(t),[]],renderers:[e(i(r.DataRenderer)),[]]})))}}i.DataRange=a,a.__name__="DataRange",a.init_DataRange()},function(t,e,i,s,n){s();const o=t(9);i.compute_renderers=function(t,e,i){if(null==t)return[];let s="auto"==t?e:t;return i.length>0&&(s=s.filter((t=>o.includes(i,t.name)))),s}},function(t,e,i,s,n){s(),n("Axis",t(163).Axis),n("CategoricalAxis",t(170).CategoricalAxis),n("ContinuousAxis",t(173).ContinuousAxis),n("DatetimeAxis",t(174).DatetimeAxis),n("LinearAxis",t(175).LinearAxis),n("LogAxis",t(192).LogAxis),n("MercatorAxis",t(195).MercatorAxis)},function(t,e,i,s,n){s();const o=t(1),r=t(164),a=t(165),l=t(166),c=t(169),h=o.__importStar(t(48)),_=t(20),d=t(24),u=t(140),p=t(9),m=t(8),g=t(167),f=t(104),{abs:b}=Math;class v extends r.GuideRendererView{update_layout(){this.layout=new u.SideLayout(this.panel,(()=>this.get_size()),!0)}get_size(){const{visible:t,fixed_location:e}=this.model;if(t&&null==e&&this.is_renderable){const{extents:t}=this;return{width:0,height:Math.round(t.tick+t.tick_label+t.axis_label)}}return{width:0,height:0}}get is_renderable(){const[t,e]=this.ranges;return t.is_valid&&e.is_valid}_render(){var t;if(!this.is_renderable)return;const{tick_coords:e,extents:i}=this,s=this.layer.ctx;s.save(),this._draw_rule(s,i),this._draw_major_ticks(s,i,e),this._draw_minor_ticks(s,i,e),this._draw_major_labels(s,i,e),this._draw_axis_label(s,i,e),null===(t=this._paint)||void 0===t||t.call(this,s,i,e),s.restore()}connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>this.plot_view.request_layout()))}get needs_clip(){return null!=this.model.fixed_location}_draw_rule(t,e){if(!this.visuals.axis_line.doit)return;const[i,s]=this.rule_coords,[n,o]=this.coordinates.map_to_screen(i,s),[r,a]=this.normals,[l,c]=this.offsets;this.visuals.axis_line.set_value(t),t.beginPath();for(let h=0;h<n.length;h++){const e=Math.round(n[h]+r*l),i=Math.round(o[h]+a*c);t.lineTo(e,i)}t.stroke()}_draw_major_ticks(t,e,i){const s=this.model.major_tick_in,n=this.model.major_tick_out,o=this.visuals.major_tick_line;this._draw_ticks(t,i.major,s,n,o)}_draw_minor_ticks(t,e,i){const s=this.model.minor_tick_in,n=this.model.minor_tick_out,o=this.visuals.minor_tick_line;this._draw_ticks(t,i.minor,s,n,o)}_draw_major_labels(t,e,i){const s=i.major,n=this.compute_labels(s[this.dimension]),o=this.model.major_label_orientation,r=e.tick+this.model.major_label_standoff,a=this.visuals.major_label_text;this._draw_oriented_labels(t,n,s,o,this.panel.side,r,a)}_axis_label_extent(){const t=this.model.axis_label;if(!t)return 0;const e=new g.TextBox({text:t});e.angle=this.panel.get_label_angle_heuristic("parallel"),e.visuals=this.visuals.axis_label_text;const i=e.size(),s=0==this.dimension?i.height:i.width,n=this.model.axis_label_standoff;return s>0?n+s+3:0}_draw_axis_label(t,e,i){const s=this.model.axis_label;if(!s||null!=this.model.fixed_location)return;const n=new g.TextBox({text:s});n.angle=this.panel.get_label_angle_heuristic("parallel"),n.visuals=this.visuals.axis_label_text;const[o,r]=(()=>{const{bbox:t}=this.layout;switch(this.panel.side){case"above":return[t.hcenter,t.bottom];case"below":return[t.hcenter,t.top];case"left":return[t.right,t.vcenter];case"right":return[t.left,t.vcenter]}})(),[a,l]=this.normals,c=e.tick+e.tick_label+this.model.axis_label_standoff,{vertical_align:h,align:_}=this.panel.get_label_text_heuristics("parallel");n.position={sx:o+a*c,sy:r+l*c,x_anchor:_,y_anchor:h},n.align=_,n.paint(t)}_draw_ticks(t,e,i,s,n){if(!n.doit)return;const[o,r]=e,[a,l]=this.coordinates.map_to_screen(o,r),[c,h]=this.normals,[_,d]=this.offsets,[u,p]=[c*(_-i),h*(d-i)],[m,g]=[c*(_+s),h*(d+s)];n.set_value(t),t.beginPath();for(let f=0;f<a.length;f++){const e=Math.round(a[f]+m),i=Math.round(l[f]+g),s=Math.round(a[f]+u),n=Math.round(l[f]+p);t.moveTo(e,i),t.lineTo(s,n)}t.stroke()}_draw_oriented_labels(t,e,i,s,n,o,r){if(!r.doit||0==e.length)return;const[a,l]=i,[c,h]=this.coordinates.map_to_screen(a,l),[_,u]=this.offsets,[p,m]=this.normals,f=p*(_+o),b=m*(u+o),{vertical_align:v,align:y}=this.panel.get_label_text_heuristics(s),x=this.panel.get_label_angle_heuristic(s);e.visuals=r,e.angle=x;for(let d=0;d<e.length;d++){const t=e.items[d];t.position={sx:c[d]+f,sy:h[d]+b,x_anchor:y,y_anchor:v},t instanceof g.TextBox&&(t.align=y)}const w=e.length,A=d.Indices.all_set(w),{items:k}=e,S=k.map((t=>t.bbox())),T=(()=>{const[t]=this.ranges;return t.is_reversed?0==this.dimension?(t,e)=>S[t].left-S[e].right:(t,e)=>S[e].top-S[t].bottom:0==this.dimension?(t,e)=>S[e].left-S[t].right:(t,e)=>S[t].top-S[e].bottom})(),{major_label_policy:C}=this.model,M=C.filter(A,S,T),E=[...M.ones()];if(0!=E.length){const t=this.parent.canvas_view.bbox,e=e=>{const i=S[e];if(i.left<0){const t=-i.left,{position:s}=k[e];k[e].position=Object.assign(Object.assign({},s),{sx:s.sx+t})}else if(i.right>t.width){const s=i.right-t.width,{position:n}=k[e];k[e].position=Object.assign(Object.assign({},n),{sx:n.sx-s})}},i=e=>{const i=S[e];if(i.top<0){const t=-i.top,{position:s}=k[e];k[e].position=Object.assign(Object.assign({},s),{sy:s.sy+t})}else if(i.bottom>t.height){const s=i.bottom-t.height,{position:n}=k[e];k[e].position=Object.assign(Object.assign({},n),{sy:n.sy-s})}},s=E[0],n=E[E.length-1];0==this.dimension?(e(s),e(n)):(i(s),i(n))}for(const d of M)k[d].paint(t)}_tick_extent(){return this.model.major_tick_out}_tick_label_extents(){const t=this.tick_coords.major,e=this.compute_labels(t[this.dimension]),i=this.model.major_label_orientation,s=this.model.major_label_standoff,n=this.visuals.major_label_text;return[this._oriented_labels_extent(e,i,s,n)]}get extents(){const t=this._tick_label_extents();return{tick:this._tick_extent(),tick_labels:t,tick_label:p.sum(t),axis_label:this._axis_label_extent()}}_oriented_labels_extent(t,e,i,s){if(0==t.length)return 0;const n=this.panel.get_label_angle_heuristic(e);t.visuals=s,t.angle=n;const o=t.max_size(),r=0==this.dimension?o.height:o.width;return r>0?i+r+3:0}get normals(){return this.panel.normals}get dimension(){return this.panel.dimension}compute_labels(t){const e=this.model.formatter.format_graphics(t,this),{major_label_overrides:i}=this.model;for(let s=0;s<t.length;s++){const n=i[t[s]];null!=n&&(e[s]=new g.TextBox({text:n}))}return new g.GraphicsBoxes(e)}get offsets(){if(null!=this.model.fixed_location)return[0,0];const{frame:t}=this.plot_view;let[e,i]=[0,0];switch(this.panel.side){case"below":i=b(this.layout.bbox.top-t.bbox.bottom);break;case"above":i=b(this.layout.bbox.bottom-t.bbox.top);break;case"right":e=b(this.layout.bbox.left-t.bbox.right);break;case"left":e=b(this.layout.bbox.right-t.bbox.left)}return[e,i]}get ranges(){const t=this.dimension,e=(t+1)%2,{ranges:i}=this.coordinates;return[i[t],i[e]]}get computed_bounds(){const[t]=this.ranges,e=this.model.bounds,i=[t.min,t.max];if("auto"==e)return[t.min,t.max];{let t,s;const[n,o]=e,[r,a]=i,{min:l,max:c}=Math;return b(n-o)>b(r-a)?(t=c(l(n,o),r),s=l(c(n,o),a)):(t=l(n,o),s=c(n,o)),[t,s]}}get rule_coords(){const t=this.dimension,e=(t+1)%2,[i]=this.ranges,[s,n]=this.computed_bounds,o=[new Array(2),new Array(2)];return o[t][0]=Math.max(s,i.min),o[t][1]=Math.min(n,i.max),o[t][0]>o[t][1]&&(o[t][0]=o[t][1]=NaN),o[e][0]=this.loc,o[e][1]=this.loc,o}get tick_coords(){const t=this.dimension,e=(t+1)%2,[i]=this.ranges,[s,n]=this.computed_bounds,o=this.model.ticker.get_ticks(s,n,i,this.loc),r=o.major,a=o.minor,l=[[],[]],c=[[],[]],[h,_]=[i.min,i.max];for(let d=0;d<r.length;d++)r[d]<h||r[d]>_||(l[t].push(r[d]),l[e].push(this.loc));for(let d=0;d<a.length;d++)a[d]<h||a[d]>_||(c[t].push(a[d]),c[e].push(this.loc));return{major:l,minor:c}}get loc(){const{fixed_location:t}=this.model;if(null!=t){if(m.isNumber(t))return t;const[,e]=this.ranges;if(e instanceof f.FactorRange)return e.synthetic(t);throw new Error("unexpected")}const[,e]=this.ranges;switch(this.panel.side){case"left":case"below":return e.start;case"right":case"above":return e.end}}serializable_state(){return Object.assign(Object.assign({},super.serializable_state()),{bbox:this.layout.bbox.box})}}i.AxisView=v,v.__name__="AxisView";class y extends r.GuideRenderer{constructor(t){super(t)}static init_Axis(){this.prototype.default_view=v,this.mixins([["axis_",h.Line],["major_tick_",h.Line],["minor_tick_",h.Line],["major_label_",h.Text],["axis_label_",h.Text]]),this.define((({Any:t,Int:e,Number:i,String:s,Ref:n,Dict:o,Tuple:r,Or:h,Nullable:d,Auto:u})=>({bounds:[h(r(i,i),u),"auto"],ticker:[n(a.Ticker)],formatter:[n(l.TickFormatter)],axis_label:[d(s),""],axis_label_standoff:[e,5],major_label_standoff:[e,5],major_label_orientation:[h(_.TickLabelOrientation,i),"horizontal"],major_label_overrides:[o(s),{}],major_label_policy:[n(c.LabelingPolicy),()=>new c.AllLabels],major_tick_in:[i,2],major_tick_out:[i,6],minor_tick_in:[i,0],minor_tick_out:[i,4],fixed_location:[d(h(i,t)),null]}))),this.override({axis_line_color:"black",major_tick_line_color:"black",minor_tick_line_color:"black",major_label_text_font_size:"11px",major_label_text_align:"center",major_label_text_baseline:"alphabetic",axis_label_text_font_size:"13px",axis_label_text_font_style:"italic"})}}i.Axis=y,y.__name__="Axis",y.init_Axis()},function(t,e,i,s,n){s();const o=t(41);class r extends o.RendererView{}i.GuideRendererView=r,r.__name__="GuideRendererView";class a extends o.Renderer{constructor(t){super(t)}static init_GuideRenderer(){this.override({level:"guide"})}}i.GuideRenderer=a,a.__name__="GuideRenderer",a.init_GuideRenderer()},function(t,e,i,s,n){s();const o=t(53);class r extends o.Model{constructor(t){super(t)}}i.Ticker=r,r.__name__="Ticker"},function(t,e,i,s,n){s();const o=t(53),r=t(167);class a extends o.Model{constructor(t){super(t)}format_graphics(t,e){return this.doFormat(t,e).map((t=>new r.TextBox({text:t})))}compute(t,e){return this.doFormat([t],null!=e?e:{loc:0})[0]}v_compute(t,e){return this.doFormat(t,null!=e?e:{loc:0})}}i.TickFormatter=a,a.__name__="TickFormatter"},function(t,e,i,s,n){s();const o=t(99),r=t(143),a=t(9),l=t(8),c=t(168),h=t(22);i.text_width=(()=>{const t=document.createElement("canvas").getContext("2d");let e="";return(i,s)=>(s!=e&&(e=s,t.font=s),t.measureText(i).width)})();class _{constructor(){this._position={sx:0,sy:0},this.font_size_scale=1}set position(t){this._position=t}get position(){return this._position}infer_text_height(){return"ascent_descent"}bbox(){const{p0:t,p1:e,p2:i,p3:s}=this.rect(),n=Math.min(t.x,e.x,i.x,s.x),r=Math.min(t.y,e.y,i.y,s.y),a=Math.max(t.x,e.x,i.x,s.x),l=Math.max(t.y,e.y,i.y,s.y);return new o.BBox({left:n,right:a,top:r,bottom:l})}size(){const{width:t,height:e}=this._size(),{angle:i}=this;if(i){const s=Math.cos(Math.abs(i)),n=Math.sin(Math.abs(i));return{width:Math.abs(t*s+e*n),height:Math.abs(t*n+e*s)}}return{width:t,height:e}}rect(){const t=this._rect(),{angle:e}=this;if(e){const{sx:i,sy:s}=this.position,n=new c.AffineTransform;return n.translate(i,s),n.rotate(e),n.translate(-i,-s),n.apply_rect(t)}return t}paint_rect(t){const{p0:e,p1:i,p2:s,p3:n}=this.rect();t.save(),t.strokeStyle="red",t.lineWidth=1,t.beginPath();const{round:o}=Math;t.moveTo(o(e.x),o(e.y)),t.lineTo(o(i.x),o(i.y)),t.lineTo(o(s.x),o(s.y)),t.lineTo(o(n.x),o(n.y)),t.closePath(),t.stroke(),t.restore()}paint_bbox(t){const{x:e,y:i,width:s,height:n}=this.bbox();t.save(),t.strokeStyle="blue",t.lineWidth=1,t.beginPath();const{round:o}=Math;t.moveTo(o(e),o(i)),t.lineTo(o(e),o(i+n)),t.lineTo(o(e+s),o(i+n)),t.lineTo(o(e+s),o(i)),t.closePath(),t.stroke(),t.restore()}}i.GraphicsBox=_,_.__name__="GraphicsBox";class d extends _{constructor({text:t}){super(),this.align="left",this.text=t}set visuals(t){const e=t.text_color.get_value(),i=t.text_alpha.get_value(),s=t.text_font_style.get_value();let n=t.text_font_size.get_value();const o=t.text_font.get_value(),{font_size_scale:r}=this;if(1!=r){const t=n.match(/^\s*(\d+(\.\d+)?)(\w+)\s*$/);if(null!=t){const[,e,,i]=t,s=Number(e);isNaN(s)||(n=`${s*r}${i}`)}}const a=`${s} ${n} ${o}`;this.font=a,this.color=h.color2css(e,i),this.line_height=t.text_line_height.get_value()}infer_text_height(){return this.text.includes("\n")?"ascent_descent":function(t){for(const e of new Set(t))if(!("0"<=e&&e<="9"))switch(e){case",":case".":case"+":case"-":case"−":case"e":continue;default:return!1}return!0}(this.text)?"cap":"ascent_descent"}_text_line(t){var e;const i=null!==(e=this.text_height_metric)&&void 0!==e?e:this.infer_text_height(),s=(()=>{switch(i){case"x":case"x_descent":return t.x_height;case"cap":case"cap_descent":return t.cap_height;case"ascent":case"ascent_descent":return t.ascent}})(),n=(()=>{switch(i){case"x":case"cap":case"ascent":return 0;case"x_descent":case"cap_descent":case"ascent_descent":return t.descent}})();return{height:s+n,ascent:s,descent:n}}get nlines(){return this.text.split("\n").length}_size(){var t,e;const{font:s}=this,n=r.font_metrics(s),o=(this.line_height-1)*n.height,l=""==this.text,c=this.text.split("\n"),h=c.length,_=c.map((t=>i.text_width(t,s))),d=this._text_line(n).height*h,u="%"==(null===(t=this.width)||void 0===t?void 0:t.unit)?this.width.value:1,p="%"==(null===(e=this.height)||void 0===e?void 0:e.unit)?this.height.value:1;return{width:a.max(_)*u,height:l?0:(d+o*(h-1))*p,metrics:n}}_computed_position(t,e,i){const{width:s,height:n}=t,{sx:o,sy:r,x_anchor:a="left",y_anchor:c="center"}=this.position;return{x:o-(()=>{if(l.isNumber(a))return a*s;switch(a){case"left":return 0;case"center":return.5*s;case"right":return s}})(),y:r-(()=>{var t;if(l.isNumber(c))return c*n;switch(c){case"top":return 0;case"center":return.5*n;case"bottom":return n;case"baseline":if(1!=i)return.5*n;switch(null!==(t=this.text_height_metric)&&void 0!==t?t:this.infer_text_height()){case"x":case"x_descent":return e.x_height;case"cap":case"cap_descent":return e.cap_height;case"ascent":case"ascent_descent":return e.ascent}}})()}}_rect(){const{width:t,height:e,metrics:i}=this._size(),s=this.text.split("\n").length,{x:n,y:r}=this._computed_position({width:t,height:e},i,s);return new o.BBox({x:n,y:r,width:t,height:e}).rect}paint(t){var e,s;const{font:n}=this,o=r.font_metrics(n),l=(this.line_height-1)*o.height,c=this.text.split("\n"),h=c.length,_=c.map((t=>i.text_width(t,n))),d=this._text_line(o),u=d.height*h,p="%"==(null===(e=this.width)||void 0===e?void 0:e.unit)?this.width.value:1,m="%"==(null===(s=this.height)||void 0===s?void 0:s.unit)?this.height.value:1,g=a.max(_)*p,f=(u+l*(h-1))*m;t.save(),t.fillStyle=this.color,t.font=this.font,t.textAlign="left",t.textBaseline="alphabetic";const{sx:b,sy:v}=this.position,{align:y}=this,{angle:x}=this;x&&(t.translate(b,v),t.rotate(x),t.translate(-b,-v));let{x:w,y:A}=this._computed_position({width:g,height:f},o,h);if("justify"==y)for(let r=0;r<h;r++){let e=w;const s=c[r].split(" "),o=s.length,h=s.map((t=>i.text_width(t,n))),_=(g-a.sum(h))/(o-1);for(let i=0;i<o;i++)t.fillText(s[i],e,A),e+=h[i]+_;A+=d.height+l}else for(let i=0;i<h;i++){const e=w+(()=>{switch(y){case"left":return 0;case"center":return.5*(g-_[i]);case"right":return g-_[i]}})();t.fillStyle=this.color,t.fillText(c[i],e,A+d.ascent),A+=d.height+l}t.restore()}}i.TextBox=d,d.__name__="TextBox";class u extends _{constructor(t,e){super(),this.base=t,this.expo=e}get children(){return[this.base,this.expo]}set position(t){this._position=t;const e=this.base.size(),i=this.expo.size(),s=this._shift_scale()*e.height,n=Math.max(e.height,s+i.height);this.base.position={sx:0,x_anchor:"left",sy:n,y_anchor:"bottom"},this.expo.position={sx:e.width,x_anchor:"left",sy:s,y_anchor:"bottom"}}get position(){return this._position}set visuals(t){this.expo.font_size_scale=.7,this.base.visuals=t,this.expo.visuals=t}_shift_scale(){if(this.base instanceof d&&1==this.base.nlines){const{x_height:t,cap_height:e}=r.font_metrics(this.base.font);return t/e}return 2/3}infer_text_height(){return this.base.infer_text_height()}_rect(){const t=this.base.bbox(),e=this.expo.bbox(),i=t.union(e),{x:s,y:n}=this._computed_position();return i.translate(s,n).rect}_size(){const t=this.base.size(),e=this.expo.size();return{width:t.width+e.width,height:Math.max(t.height,this._shift_scale()*t.height+e.height)}}paint(t){t.save();const{angle:e}=this;if(e){const{sx:i,sy:s}=this.position;t.translate(i,s),t.rotate(e),t.translate(-i,-s)}const{x:i,y:s}=this._computed_position();t.translate(i,s),this.base.paint(t),this.expo.paint(t),t.restore()}paint_bbox(t){super.paint_bbox(t);const{x:e,y:i}=this._computed_position();t.save(),t.translate(e,i);for(const s of this.children)s.paint_bbox(t);t.restore()}_computed_position(){const{width:t,height:e}=this._size(),{sx:i,sy:s,x_anchor:n="left",y_anchor:o="center"}=this.position;return{x:i-(()=>{if(l.isNumber(n))return n*t;switch(n){case"left":return 0;case"center":return.5*t;case"right":return t}})(),y:s-(()=>{if(l.isNumber(o))return o*e;switch(o){case"top":return 0;case"center":return.5*e;case"bottom":return e;case"baseline":return.5*e}})()}}}i.BaseExpo=u,u.__name__="BaseExpo";class p{constructor(t){this.items=t}get length(){return this.items.length}set visuals(t){for(const s of this.items)s.visuals=t;const e={x:0,cap:1,ascent:2,x_descent:3,cap_descent:4,ascent_descent:5},i=a.max_by(this.items.map((t=>t.infer_text_height())),(t=>e[t]));for(const s of this.items)s.text_height_metric=i}set angle(t){for(const e of this.items)e.angle=t}max_size(){let t=0,e=0;for(const i of this.items){const s=i.size();t=Math.max(t,s.width),e=Math.max(e,s.height)}return{width:t,height:e}}}i.GraphicsBoxes=p,p.__name__="GraphicsBoxes"},function(t,e,i,s,n){s();const{sin:o,cos:r}=Math;class a{constructor(t=1,e=0,i=0,s=1,n=0,o=0){this.a=t,this.b=e,this.c=i,this.d=s,this.e=n,this.f=o}toString(){const{a:t,b:e,c:i,d:s,e:n,f:o}=this;return`matrix(${t}, ${e}, ${i}, ${s}, ${n}, ${o})`}clone(){const{a:t,b:e,c:i,d:s,e:n,f:o}=this;return new a(t,e,i,s,n,o)}get is_identity(){const{a:t,b:e,c:i,d:s,e:n,f:o}=this;return 1==t&&0==e&&0==i&&1==s&&0==n&&0==o}apply_point(t){const[e,i]=this.apply(t.x,t.y);return{x:e,y:i}}apply_rect(t){return{p0:this.apply_point(t.p0),p1:this.apply_point(t.p1),p2:this.apply_point(t.p2),p3:this.apply_point(t.p3)}}apply(t,e){const{a:i,b:s,c:n,d:o,e:r,f:a}=this;return[i*t+n*e+r,s*t+o*e+a]}iv_apply(t,e){const{a:i,b:s,c:n,d:o,e:r,f:a}=this,l=t.length;for(let c=0;c<l;c++){const l=t[c],h=e[c];t[c]=i*l+n*h+r,e[c]=s*l+o*h+a}}transform(t,e,i,s,n,o){const{a:r,b:a,c:l,d:c,e:h,f:_}=this;return this.a=r*t+l*e,this.c=r*i+l*s,this.e=r*n+l*o+h,this.b=a*t+c*e,this.d=a*i+c*s,this.f=a*n+c*o+_,this}translate(t,e){return this.transform(1,0,0,1,t,e)}scale(t,e){return this.transform(t,0,0,e,0,0)}skew(t,e){return this.transform(1,e,t,1,0,0)}rotate(t){const e=o(t),i=r(t);return this.transform(i,e,-e,i,0,0)}rotate_ccw(t){return this.rotate(-t)}translate_x(t){return this.translate(t,0)}translate_y(t){return this.translate(0,t)}flip(){return this.scale(-1,-1)}flip_x(){return this.scale(1,-1)}flip_y(){return this.scale(-1,1)}}i.AffineTransform=a,a.__name__="AffineTransform"},function(t,e,i,s,n){s();const o=t(53),r=t(13),a=t(34),l=t(8),c=t(24);class h extends o.Model{constructor(t){super(t)}}i.LabelingPolicy=h,h.__name__="LabelingPolicy";class _ extends h{constructor(t){super(t)}filter(t,e,i){return t}}i.AllLabels=_,_.__name__="AllLabels";class d extends h{constructor(t){super(t)}static init_NoOverlap(){this.define((({Number:t})=>({min_distance:[t,5]})))}filter(t,e,i){const{min_distance:s}=this;let n=null;for(const o of t)null!=n&&i(n,o)<s?t.unset(o):n=o;return t}}i.NoOverlap=d,d.__name__="NoOverlap",d.init_NoOverlap();class u extends h{constructor(t){super(t)}static init_CustomLabelingPolicy(){this.define((({Unknown:t,String:e,Dict:i})=>({args:[i(t),{}],code:[e,""]})))}get names(){return r.keys(this.args)}get values(){return r.values(this.args)}get func(){const t=a.use_strict(this.code);return new c.GeneratorFunction("indices","bboxes","distance",...this.names,t)}filter(t,e,i){const s=Object.create(null),n=this.func.call(s,t,e,i,...this.values);let o=n.next();if(o.done&&void 0!==o.value){const{value:e}=o;return e instanceof c.Indices?e:void 0===e?t:l.isIterable(e)?c.Indices.from_indices(t.size,e):c.Indices.all_unset(t.size)}{const e=[];do{e.push(o.value),o=n.next()}while(!o.done);return c.Indices.from_indices(t.size,e)}}}i.CustomLabelingPolicy=u,u.__name__="CustomLabelingPolicy",u.init_CustomLabelingPolicy()},function(t,e,i,s,n){s();const o=t(1),r=t(163),a=t(171),l=t(172),c=o.__importStar(t(48)),h=t(20),_=t(167),d=t(8);class u extends r.AxisView{_paint(t,e,i){this._draw_group_separators(t,e,i)}_draw_group_separators(t,e,i){const[s]=this.ranges,[n,o]=this.computed_bounds;if(!s.tops||s.tops.length<2||!this.visuals.separator_line.doit)return;const r=this.dimension,a=(r+1)%2,l=[[],[]];let c=0;for(let _=0;_<s.tops.length-1;_++){let t,e;for(let n=c;n<s.factors.length;n++)if(s.factors[n][0]==s.tops[_+1]){[t,e]=[s.factors[n-1],s.factors[n]],c=n;break}const i=(s.synthetic(t)+s.synthetic(e))/2;i>n&&i<o&&(l[r].push(i),l[a].push(this.loc))}const h=this.extents.tick_label;this._draw_ticks(t,l,-3,h-6,this.visuals.separator_line)}_draw_major_labels(t,e,i){const s=this._get_factor_info();let n=e.tick+this.model.major_label_standoff;for(let o=0;o<s.length;o++){const[i,r,a,l]=s[o];this._draw_oriented_labels(t,i,r,a,this.panel.side,n,l),n+=e.tick_labels[o]}}_tick_label_extents(){const t=this._get_factor_info(),e=[];for(const[i,,s,n]of t){const t=this._oriented_labels_extent(i,s,this.model.major_label_standoff,n);e.push(t)}return e}_get_factor_info(){const[t]=this.ranges,[e,i]=this.computed_bounds,s=this.loc,n=this.model.ticker.get_ticks(e,i,t,s),o=this.tick_coords,r=[],a=t=>new _.GraphicsBoxes(t.map((t=>d.isString(t)?new _.TextBox({text:t}):t))),l=t=>a(this.model.formatter.doFormat(t,this));if(1==t.levels){const t=l(n.major);r.push([t,o.major,this.model.major_label_orientation,this.visuals.major_label_text])}else if(2==t.levels){const t=l(n.major.map((t=>t[1])));r.push([t,o.major,this.model.major_label_orientation,this.visuals.major_label_text]),r.push([a(n.tops),o.tops,this.model.group_label_orientation,this.visuals.group_text])}else if(3==t.levels){const t=l(n.major.map((t=>t[2]))),e=n.mids.map((t=>t[1]));r.push([t,o.major,this.model.major_label_orientation,this.visuals.major_label_text]),r.push([a(e),o.mids,this.model.subgroup_label_orientation,this.visuals.subgroup_text]),r.push([a(n.tops),o.tops,this.model.group_label_orientation,this.visuals.group_text])}return r}get tick_coords(){const t=this.dimension,e=(t+1)%2,[i]=this.ranges,[s,n]=this.computed_bounds,o=this.model.ticker.get_ticks(s,n,i,this.loc),r={major:[[],[]],mids:[[],[]],tops:[[],[]],minor:[[],[]]};return r.major[t]=o.major,r.major[e]=o.major.map((()=>this.loc)),3==i.levels&&(r.mids[t]=o.mids,r.mids[e]=o.mids.map((()=>this.loc))),i.levels>1&&(r.tops[t]=o.tops,r.tops[e]=o.tops.map((()=>this.loc))),r}}i.CategoricalAxisView=u,u.__name__="CategoricalAxisView";class p extends r.Axis{constructor(t){super(t)}static init_CategoricalAxis(){this.prototype.default_view=u,this.mixins([["separator_",c.Line],["group_",c.Text],["subgroup_",c.Text]]),this.define((({Number:t,Or:e})=>({group_label_orientation:[e(h.TickLabelOrientation,t),"parallel"],subgroup_label_orientation:[e(h.TickLabelOrientation,t),"parallel"]}))),this.override({ticker:()=>new a.CategoricalTicker,formatter:()=>new l.CategoricalTickFormatter,separator_line_color:"lightgrey",separator_line_width:2,group_text_font_style:"bold",group_text_font_size:"11px",group_text_color:"grey",subgroup_text_font_style:"bold",subgroup_text_font_size:"11px"})}}i.CategoricalAxis=p,p.__name__="CategoricalAxis",p.init_CategoricalAxis()},function(t,e,i,s,n){s();const o=t(165);class r extends o.Ticker{constructor(t){super(t)}get_ticks(t,e,i,s){var n,o;return{major:this._collect(i.factors,i,t,e),minor:[],tops:this._collect(null!==(n=i.tops)&&void 0!==n?n:[],i,t,e),mids:this._collect(null!==(o=i.mids)&&void 0!==o?o:[],i,t,e)}}_collect(t,e,i,s){const n=[];for(const o of t){const t=e.synthetic(o);t>i&&t<s&&n.push(o)}return n}}i.CategoricalTicker=r,r.__name__="CategoricalTicker"},function(t,e,i,s,n){s();const o=t(166),r=t(9);class a extends o.TickFormatter{constructor(t){super(t)}doFormat(t,e){return r.copy(t)}}i.CategoricalTickFormatter=a,a.__name__="CategoricalTickFormatter"},function(t,e,i,s,n){s();const o=t(163);class r extends o.AxisView{}i.ContinuousAxisView=r,r.__name__="ContinuousAxisView";class a extends o.Axis{constructor(t){super(t)}}i.ContinuousAxis=a,a.__name__="ContinuousAxis"},function(t,e,i,s,n){s();const o=t(175),r=t(180),a=t(185);class l extends o.LinearAxisView{}i.DatetimeAxisView=l,l.__name__="DatetimeAxisView";class c extends o.LinearAxis{constructor(t){super(t)}static init_DatetimeAxis(){this.prototype.default_view=l,this.override({ticker:()=>new a.DatetimeTicker,formatter:()=>new r.DatetimeTickFormatter})}}i.DatetimeAxis=c,c.__name__="DatetimeAxis",c.init_DatetimeAxis()},function(t,e,i,s,n){s();const o=t(173),r=t(176),a=t(177);class l extends o.ContinuousAxisView{}i.LinearAxisView=l,l.__name__="LinearAxisView";class c extends o.ContinuousAxis{constructor(t){super(t)}static init_LinearAxis(){this.prototype.default_view=l,this.override({ticker:()=>new a.BasicTicker,formatter:()=>new r.BasicTickFormatter})}}i.LinearAxis=c,c.__name__="LinearAxis",c.init_LinearAxis()},function(t,e,i,s,n){s();const o=t(166),r=t(34);function a(t){let e="";for(const i of t)e+="-"==i?"−":i;return e}i.unicode_replace=a;class l extends o.TickFormatter{constructor(t){super(t),this.last_precision=3}static init_BasicTickFormatter(){this.define((({Boolean:t,Int:e,Auto:i,Or:s})=>({precision:[s(e,i),"auto"],use_scientific:[t,!0],power_limit_high:[e,5],power_limit_low:[e,-3]})))}get scientific_limit_low(){return 10**this.power_limit_low}get scientific_limit_high(){return 10**this.power_limit_high}_need_sci(t){if(!this.use_scientific)return!1;const{scientific_limit_high:e}=this,{scientific_limit_low:i}=this,s=t.length<2?0:Math.abs(t[1]-t[0])/1e4;for(const n of t){const t=Math.abs(n);if(!(t<=s)&&(t>=e||t<=i))return!0}return!1}_format_with_precision(t,e,i){return e?t.map((t=>a(t.toExponential(i)))):t.map((t=>a(r.to_fixed(t,i))))}_auto_precision(t,e){const i=new Array(t.length),s=this.last_precision<=15;t:for(let n=this.last_precision;s?n<=15:n>=1;s?n++:n--){if(e){i[0]=t[0].toExponential(n);for(let e=1;e<t.length;e++)if(i[e]==i[e-1])continue t;this.last_precision=n;break}i[0]=r.to_fixed(t[0],n);for(let e=1;e<t.length;e++)if(i[e]=r.to_fixed(t[e],n),i[e]==i[e-1])continue t;this.last_precision=n;break}return this.last_precision}doFormat(t,e){if(0==t.length)return[];const i=this._need_sci(t),s="auto"==this.precision?this._auto_precision(t,i):this.precision;return this._format_with_precision(t,i,s)}}i.BasicTickFormatter=l,l.__name__="BasicTickFormatter",l.init_BasicTickFormatter()},function(t,e,i,s,n){s();const o=t(178);class r extends o.AdaptiveTicker{constructor(t){super(t)}}i.BasicTicker=r,r.__name__="BasicTicker"},function(t,e,i,s,n){s();const o=t(179),r=t(9),a=t(10);class l extends o.ContinuousTicker{constructor(t){super(t)}static init_AdaptiveTicker(){this.define((({Number:t,Array:e,Nullable:i})=>({base:[t,10],mantissas:[e(t),[1,2,5]],min_interval:[t,0],max_interval:[i(t),null]})))}get_min_interval(){return this.min_interval}get_max_interval(){var t;return null!==(t=this.max_interval)&&void 0!==t?t:1/0}initialize(){super.initialize();const t=r.nth(this.mantissas,-1)/this.base,e=r.nth(this.mantissas,0)*this.base;this.extended_mantissas=[t,...this.mantissas,e],this.base_factor=0===this.get_min_interval()?1:this.get_min_interval()}get_interval(t,e,i){const s=e-t,n=this.get_ideal_interval(t,e,i),o=Math.floor(a.log(n/this.base_factor,this.base)),l=this.base**o*this.base_factor,c=this.extended_mantissas,h=c.map((t=>Math.abs(i-s/(t*l)))),_=c[r.argmin(h)]*l;return a.clamp(_,this.get_min_interval(),this.get_max_interval())}}i.AdaptiveTicker=l,l.__name__="AdaptiveTicker",l.init_AdaptiveTicker()},function(t,e,i,s,n){s();const o=t(165),r=t(9);class a extends o.Ticker{constructor(t){super(t)}static init_ContinuousTicker(){this.define((({Int:t})=>({num_minor_ticks:[t,5],desired_num_ticks:[t,6]})))}get_ticks(t,e,i,s){return this.get_ticks_no_defaults(t,e,s,this.desired_num_ticks)}get_ticks_no_defaults(t,e,i,s){const n=this.get_interval(t,e,s),o=Math.floor(t/n),a=Math.ceil(e/n);let l;l=isFinite(o)&&isFinite(a)?r.range(o,a+1):[];const c=l.map((t=>t*n)).filter((i=>t<=i&&i<=e)),h=this.num_minor_ticks,_=[];if(h>0&&c.length>0){const i=n/h,s=r.range(0,h).map((t=>t*i));for(const n of s.slice(1)){const i=c[0]-n;t<=i&&i<=e&&_.push(i)}for(const n of c)for(const i of s){const s=n+i;t<=s&&s<=e&&_.push(s)}}return{major:c,minor:_}}get_ideal_interval(t,e,i){return(e-t)/i}}i.ContinuousTicker=a,a.__name__="ContinuousTicker",a.init_ContinuousTicker()},function(t,e,i,s,n){s();const o=t(1).__importDefault(t(181)),r=t(166),a=t(19),l=t(182),c=t(9),h=t(8);function _(t){return o.default(t,"%Y %m %d %H %M %S").split(/\s+/).map((t=>parseInt(t,10)))}function d(t,e){if(h.isFunction(e))return e(t);{const i=l.sprintf("$1%06d",function(t){return Math.round(t/1e3%1*1e6)}(t));return-1==(e=e.replace(/((^|[^%])(%%)*)%f/,i)).indexOf("%")?e:o.default(t,e)}}const u=["microseconds","milliseconds","seconds","minsec","minutes","hourmin","hours","days","months","years"];class p extends r.TickFormatter{constructor(t){super(t),this.strip_leading_zeros=!0}static init_DatetimeTickFormatter(){this.define((({String:t,Array:e})=>({microseconds:[e(t),["%fus"]],milliseconds:[e(t),["%3Nms","%S.%3Ns"]],seconds:[e(t),["%Ss"]],minsec:[e(t),[":%M:%S"]],minutes:[e(t),[":%M","%Mm"]],hourmin:[e(t),["%H:%M"]],hours:[e(t),["%Hh","%H:%M"]],days:[e(t),["%m/%d","%a%d"]],months:[e(t),["%m/%Y","%b %Y"]],years:[e(t),["%Y"]]})))}initialize(){super.initialize(),this._update_width_formats()}_update_width_formats(){const t=+o.default(new Date),e=function(e){const i=e.map((e=>d(t,e).length)),s=c.sort_by(c.zip(i,e),(([t])=>t));return c.unzip(s)};this._width_formats={microseconds:e(this.microseconds),milliseconds:e(this.milliseconds),seconds:e(this.seconds),minsec:e(this.minsec),minutes:e(this.minutes),hourmin:e(this.hourmin),hours:e(this.hours),days:e(this.days),months:e(this.months),years:e(this.years)}}_get_resolution_str(t,e){const i=1.1*t;switch(!1){case!(i<.001):return"microseconds";case!(i<1):return"milliseconds";case!(i<60):return e>=60?"minsec":"seconds";case!(i<3600):return e>=3600?"hourmin":"minutes";case!(i<86400):return"hours";case!(i<2678400):return"days";case!(i<31536e3):return"months";default:return"years"}}doFormat(t,e){if(0==t.length)return[];const i=Math.abs(t[t.length-1]-t[0])/1e3,s=i/(t.length-1),n=this._get_resolution_str(s,i),[,[o]]=this._width_formats[n],r=[],l=u.indexOf(n),c={};for(const a of u)c[a]=0;c.seconds=5,c.minsec=4,c.minutes=4,c.hourmin=3,c.hours=3;for(const h of t){let e,i;try{i=_(h),e=d(h,o)}catch(t){a.logger.warn(`unable to format tick for timestamp value ${h}`),a.logger.warn(` - ${t}`),r.push("ERR");continue}let s=!1,p=l;for(;0==i[c[u[p]]];){let t;if(p+=1,p==u.length)break;if(("minsec"==n||"hourmin"==n)&&!s){if("minsec"==n&&0==i[4]&&0!=i[5]||"hourmin"==n&&0==i[3]&&0!=i[4]){t=this._width_formats[u[l-1]][1][0],e=d(h,t);break}s=!0}t=this._width_formats[u[p]][1][0],e=d(h,t)}if(this.strip_leading_zeros){let t=e.replace(/^0+/g,"");t!=e&&isNaN(parseInt(t))&&(t=`0${t}`),r.push(t)}else r.push(e)}return r}}i.DatetimeTickFormatter=p,p.__name__="DatetimeTickFormatter",p.init_DatetimeTickFormatter()},function(e,i,s,n,o){!function(e){"object"==typeof i&&i.exports?i.exports=e():"function"==typeof t?t(e):this.tz=e()}((function(){function t(t,e,i){var s,n=e.day[1];do{s=new Date(Date.UTC(i,e.month,Math.abs(n++)))}while(e.day[0]<7&&s.getUTCDay()!=e.day[0]);return(s={clock:e.clock,sort:s.getTime(),rule:e,save:6e4*e.save,offset:t.offset})[s.clock]=s.sort+6e4*e.time,s.posix?s.wallclock=s[s.clock]+(t.offset+e.saved):s.posix=s[s.clock]-(t.offset+e.saved),s}function e(e,i,s){var n,o,r,a,l,c,h,_=e[e.zone],d=[],u=new Date(s).getUTCFullYear(),p=1;for(n=1,o=_.length;n<o&&!(_[n][i]<=s);n++);if((r=_[n]).rules){for(c=e[r.rules],h=u+1;h>=u-p;--h)for(n=0,o=c.length;n<o;n++)c[n].from<=h&&h<=c[n].to?d.push(t(r,c[n],h)):c[n].to<h&&1==p&&(p=h-c[n].to);for(d.sort((function(t,e){return t.sort-e.sort})),n=0,o=d.length;n<o;n++)s>=d[n][i]&&d[n][d[n].clock]>r[d[n].clock]&&(a=d[n])}return a&&((l=/^(.*)\/(.*)$/.exec(r.format))?a.abbrev=l[a.save?2:1]:a.abbrev=r.format.replace(/%s/,a.rule.letter)),a||r}function i(t,i){return"UTC"==t.zone?i:(t.entry=e(t,"posix",i),i+t.entry.offset+t.entry.save)}function s(t,i){return"UTC"==t.zone?i:(t.entry=s=e(t,"wallclock",i),0<(n=i-s.wallclock)&&n<s.save?null:i-s.offset-s.save);var s,n}function n(t,e,n){var o,a=+(n[1]+1),c=n[2]*a,h=r.indexOf(n[3].toLowerCase());if(h>9)e+=c*l[h-10];else{if(o=new Date(i(t,e)),h<7)for(;c;)o.setUTCDate(o.getUTCDate()+a),o.getUTCDay()==h&&(c-=a);else 7==h?o.setUTCFullYear(o.getUTCFullYear()+c):8==h?o.setUTCMonth(o.getUTCMonth()+c):o.setUTCDate(o.getUTCDate()+c);null==(e=s(t,o.getTime()))&&(e=s(t,o.getTime()+864e5*a)-864e5*a)}return e}var o={clock:function(){return+new Date},zone:"UTC",entry:{abbrev:"UTC",offset:0,save:0},UTC:1,z:function(t,e,i,s){var n,o,r=this.entry.offset+this.entry.save,a=Math.abs(r/1e3),l=[],c=3600;for(n=0;n<3;n++)l.push(("0"+Math.floor(a/c)).slice(-2)),a%=c,c/=60;return"^"!=i||r?("^"==i&&(s=3),3==s?(o=(o=l.join(":")).replace(/:00$/,""),"^"!=i&&(o=o.replace(/:00$/,""))):s?(o=l.slice(0,s+1).join(":"),"^"==i&&(o=o.replace(/:00$/,""))):o=l.slice(0,2).join(""),o=(o=(r<0?"-":"+")+o).replace(/([-+])(0)/,{_:" $1","-":"$1"}[i]||"$1$2")):"Z"},"%":function(t){return"%"},n:function(t){return"\n"},t:function(t){return"\t"},U:function(t){return c(t,0)},W:function(t){return c(t,1)},V:function(t){return h(t)[0]},G:function(t){return h(t)[1]},g:function(t){return h(t)[1]%100},j:function(t){return Math.floor((t.getTime()-Date.UTC(t.getUTCFullYear(),0))/864e5)+1},s:function(t){return Math.floor(t.getTime()/1e3)},C:function(t){return Math.floor(t.getUTCFullYear()/100)},N:function(t){return t.getTime()%1e3*1e6},m:function(t){return t.getUTCMonth()+1},Y:function(t){return t.getUTCFullYear()},y:function(t){return t.getUTCFullYear()%100},H:function(t){return t.getUTCHours()},M:function(t){return t.getUTCMinutes()},S:function(t){return t.getUTCSeconds()},e:function(t){return t.getUTCDate()},d:function(t){return t.getUTCDate()},u:function(t){return t.getUTCDay()||7},w:function(t){return t.getUTCDay()},l:function(t){return t.getUTCHours()%12||12},I:function(t){return t.getUTCHours()%12||12},k:function(t){return t.getUTCHours()},Z:function(t){return this.entry.abbrev},a:function(t){return this[this.locale].day.abbrev[t.getUTCDay()]},A:function(t){return this[this.locale].day.full[t.getUTCDay()]},h:function(t){return this[this.locale].month.abbrev[t.getUTCMonth()]},b:function(t){return this[this.locale].month.abbrev[t.getUTCMonth()]},B:function(t){return this[this.locale].month.full[t.getUTCMonth()]},P:function(t){return this[this.locale].meridiem[Math.floor(t.getUTCHours()/12)].toLowerCase()},p:function(t){return this[this.locale].meridiem[Math.floor(t.getUTCHours()/12)]},R:function(t,e){return this.convert([e,"%H:%M"])},T:function(t,e){return this.convert([e,"%H:%M:%S"])},D:function(t,e){return this.convert([e,"%m/%d/%y"])},F:function(t,e){return this.convert([e,"%Y-%m-%d"])},x:function(t,e){return this.convert([e,this[this.locale].date])},r:function(t,e){return this.convert([e,this[this.locale].time12||"%I:%M:%S"])},X:function(t,e){return this.convert([e,this[this.locale].time24])},c:function(t,e){return this.convert([e,this[this.locale].dateTime])},convert:function(t){if(!t.length)return"1.0.23";var e,o,r,l,c,h=Object.create(this),_=[];for(e=0;e<t.length;e++)if(l=t[e],Array.isArray(l))e||isNaN(l[1])?l.splice.apply(t,[e--,1].concat(l)):c=l;else if(isNaN(l)){if("string"==(r=typeof l))~l.indexOf("%")?h.format=l:e||"*"!=l?!e&&(r=/^(\d{4})-(\d{2})-(\d{2})(?:[T\s](\d{2}):(\d{2})(?::(\d{2})(?:\.(\d+))?)?(Z|(([+-])(\d{2}(:\d{2}){0,2})))?)?$/.exec(l))?((c=[]).push.apply(c,r.slice(1,8)),r[9]?(c.push(r[10]+1),c.push.apply(c,r[11].split(/:/))):r[8]&&c.push(1)):/^\w{2,3}_\w{2}$/.test(l)?h.locale=l:(r=a.exec(l))?_.push(r):h.zone=l:c=l;else if("function"==r){if(r=l.call(h))return r}else if(/^\w{2,3}_\w{2}$/.test(l.name))h[l.name]=l;else if(l.zones){for(r in l.zones)h[r]=l.zones[r];for(r in l.rules)h[r]=l.rules[r]}}else e||(c=l);if(h[h.locale]||delete h.locale,h[h.zone]||delete h.zone,null!=c){if("*"==c)c=h.clock();else if(Array.isArray(c)){for(r=[],o=!c[7],e=0;e<11;e++)r[e]=+(c[e]||0);--r[1],c=Date.UTC.apply(Date.UTC,r)+-r[7]*(36e5*r[8]+6e4*r[9]+1e3*r[10])}else c=Math.floor(c);if(!isNaN(c)){if(o&&(c=s(h,c)),null==c)return c;for(e=0,o=_.length;e<o;e++)c=n(h,c,_[e]);return h.format?(r=new Date(i(h,c)),h.format.replace(/%([-0_^]?)(:{0,3})(\d*)(.)/g,(function(t,e,i,s,n){var o,a,l="0";if(o=h[n]){for(t=String(o.call(h,r,c,e,i.length)),"_"==(e||o.style)&&(l=" "),a="-"==e?0:o.pad||0;t.length<a;)t=l+t;for(a="-"==e?0:s||o.pad;t.length<a;)t=l+t;"N"==n&&a<t.length&&(t=t.slice(0,a)),"^"==e&&(t=t.toUpperCase())}return t}))):c}}return function(){return h.convert(arguments)}},locale:"en_US",en_US:{date:"%m/%d/%Y",time24:"%I:%M:%S %p",time12:"%I:%M:%S %p",dateTime:"%a %d %b %Y %I:%M:%S %p %Z",meridiem:["AM","PM"],month:{abbrev:"Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec".split("|"),full:"January|February|March|April|May|June|July|August|September|October|November|December".split("|")},day:{abbrev:"Sun|Mon|Tue|Wed|Thu|Fri|Sat".split("|"),full:"Sunday|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday".split("|")}}},r="Sunday|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|year|month|day|hour|minute|second|millisecond",a=new RegExp("^\\s*([+-])(\\d+)\\s+("+r+")s?\\s*$","i"),l=[36e5,6e4,1e3,1];function c(t,e){var i,s,n;return s=new Date(Date.UTC(t.getUTCFullYear(),0)),i=Math.floor((t.getTime()-s.getTime())/864e5),s.getUTCDay()==e?n=0:8==(n=7-s.getUTCDay()+e)&&(n=1),i>=n?Math.floor((i-n)/7)+1:0}function h(t){var e,i,s;return i=t.getUTCFullYear(),e=new Date(Date.UTC(i,0)).getUTCDay(),(s=c(t,1)+(e>1&&e<=4?1:0))?53!=s||4==e||3==e&&29==new Date(i,1,29).getDate()?[s,t.getUTCFullYear()]:[1,t.getUTCFullYear()+1]:(i=t.getUTCFullYear()-1,[s=4==(e=new Date(Date.UTC(i,0)).getUTCDay())||3==e&&29==new Date(i,1,29).getDate()?53:52,t.getUTCFullYear()-1])}return r=r.toLowerCase().split("|"),"delmHMSUWVgCIky".replace(/./g,(function(t){o[t].pad=2})),o.N.pad=9,o.j.pad=3,o.k.style="_",o.l.style="_",o.e.style="_",function(){return o.convert(arguments)}}))},function(t,e,i,s,n){s();const o=t(1),r=o.__importStar(t(183)),a=t(184),l=o.__importDefault(t(181)),c=t(21),h=t(8);function _(t,...e){return a.sprintf(t,...e)}function d(t,e,i){return h.isNumber(t)?_((()=>{switch(!1){case Math.floor(t)!=t:return"%d";case!(Math.abs(t)>.1&&Math.abs(t)<1e3):return"%0.3f";default:return"%0.3e"}})(),t):`${t}`}function u(t,e,s){if(null==e)return d;if(null!=s&&t in s){const e=s[t];if(h.isString(e)){if(e in i.DEFAULT_FORMATTERS)return i.DEFAULT_FORMATTERS[e];throw new Error(`Unknown tooltip field formatter type '${e}'`)}return function(t,i,s){return e.format(t,i,s)}}return i.DEFAULT_FORMATTERS.numeral}function p(t,e,i,s){return"$"==t[0]?function(t,e){if(t in e)return e[t];throw new Error(`Unknown special variable '$${t}'`)}(t.substring(1),s):function(t,e,i){const s=e.get_column(t);if(null==s)return null;if(h.isNumber(i))return s[i];const n=s[i.index];return h.isTypedArray(n)||h.isArray(n)?h.isArray(n[0])?n[i.dim2][i.dim1]:n[i.flat_index]:n}(t.substring(1).replace(/[{}]/g,""),e,i)}i.FormatterType=c.Enum("numeral","printf","datetime"),i.DEFAULT_FORMATTERS={numeral:(t,e,i)=>r.format(t,e),datetime:(t,e,i)=>l.default(t,e),printf:(t,e,i)=>_(e,t)},i.sprintf=_,i.basic_formatter=d,i.get_formatter=u,i.get_value=p,i.replace_placeholders=function(t,e,i,s,n={},o){let r,a;return h.isString(t)?(r=t,a=!1):(r=t.html,a=!0),r=r.replace(/@\$name/g,(t=>`@{${n.name}}`)),r=r.replace(/((?:\$\w+)|(?:@\w+)|(?:@{(?:[^{}]+)}))(?:{([^{}]+)})?/g,((t,r,l)=>{const c=p(r,e,i,n);if(null==c)return o?o("???"):"???";if("safe"==l)return a=!0,`${c}`;const h=`${u(r,l,s)(c,l,n)}`;return o?o(h):h})),a?[...(new DOMParser).parseFromString(r,"text/html").body.childNodes]:r}},function(t,e,i,s,n){
/*!
     * numbro.js
     * version : 1.6.2
     * author : Företagsplatsen AB
     * license : MIT
     * http://www.foretagsplatsen.se
     */
var o,r={},a=r,l="en-US",c=null,h="0,0";function _(t){this._value=t}function d(t){var e,i="";for(e=0;e<t;e++)i+="0";return i}function u(t,e,i,s){var n,o,r=Math.pow(10,e);return o=t.toFixed(0).search("e")>-1?function(t,e){var i,s,n,o;return i=(o=t.toString()).split("e")[0],n=o.split("e")[1],o=i.split(".")[0]+(s=i.split(".")[1]||"")+d(n-s.length),e>0&&(o+="."+d(e)),o}(t,e):(i(t*r)/r).toFixed(e),s&&(n=new RegExp("0{1,"+s+"}$"),o=o.replace(n,"")),o}function p(t,e,i){return e.indexOf("$")>-1?function(t,e,i){var s,n,o=e,a=o.indexOf("$"),c=o.indexOf("("),h=o.indexOf("+"),_=o.indexOf("-"),d="",u="";if(-1===o.indexOf("$")?"infix"===r[l].currency.position?(u=r[l].currency.symbol,r[l].currency.spaceSeparated&&(u=" "+u+" ")):r[l].currency.spaceSeparated&&(d=" "):o.indexOf(" $")>-1?(d=" ",o=o.replace(" $","")):o.indexOf("$ ")>-1?(d=" ",o=o.replace("$ ","")):o=o.replace("$",""),n=m(t,o,i,u),-1===e.indexOf("$"))switch(r[l].currency.position){case"postfix":n.indexOf(")")>-1?((n=n.split("")).splice(-1,0,d+r[l].currency.symbol),n=n.join("")):n=n+d+r[l].currency.symbol;break;case"infix":break;case"prefix":n.indexOf("(")>-1||n.indexOf("-")>-1?(n=n.split(""),s=Math.max(c,_)+1,n.splice(s,0,r[l].currency.symbol+d),n=n.join("")):n=r[l].currency.symbol+d+n;break;default:throw Error('Currency position should be among ["prefix", "infix", "postfix"]')}else a<=1?n.indexOf("(")>-1||n.indexOf("+")>-1||n.indexOf("-")>-1?(s=1,(a<c||a<h||a<_)&&(s=0),(n=n.split("")).splice(s,0,r[l].currency.symbol+d),n=n.join("")):n=r[l].currency.symbol+d+n:n.indexOf(")")>-1?((n=n.split("")).splice(-1,0,d+r[l].currency.symbol),n=n.join("")):n=n+d+r[l].currency.symbol;return n}(t,e,i):e.indexOf("%")>-1?function(t,e,i){var s,n="";return t*=100,e.indexOf(" %")>-1?(n=" ",e=e.replace(" %","")):e=e.replace("%",""),(s=m(t,e,i)).indexOf(")")>-1?((s=s.split("")).splice(-1,0,n+"%"),s=s.join("")):s=s+n+"%",s}(t,e,i):e.indexOf(":")>-1?function(t){var e=Math.floor(t/60/60),i=Math.floor((t-60*e*60)/60),s=Math.round(t-60*e*60-60*i);return e+":"+(i<10?"0"+i:i)+":"+(s<10?"0"+s:s)}(t):m(t,e,i)}function m(t,e,i,s){var n,o,a,h,_,d,p,m,g,f,b,v,y,x,w,A,k,S=!1,T=!1,C=!1,M="",E=!1,z=!1,R=!1,B=!1,P=!1,N="",I="",D=Math.abs(t),O=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],L=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],V="",j=!1,U=!1;if(0===t&&null!==c)return c;if(!isFinite(t))return""+t;if(0===e.indexOf("{")){var F=e.indexOf("}");if(-1===F)throw Error('Format should also contain a "}"');v=e.slice(1,F),e=e.slice(F+1)}else v="";if(e.indexOf("}")===e.length-1){var G=e.indexOf("{");if(-1===G)throw Error('Format should also contain a "{"');y=e.slice(G+1,-1),e=e.slice(0,G+1)}else y="";if(A=null===(k=-1===e.indexOf(".")?e.match(/([0-9]+).*/):e.match(/([0-9]+)\..*/))?-1:k[1].length,-1!==e.indexOf("-")&&(j=!0),e.indexOf("(")>-1?(S=!0,e=e.slice(1,-1)):e.indexOf("+")>-1&&(T=!0,e=e.replace(/\+/g,"")),e.indexOf("a")>-1){if(f=e.split(".")[0].match(/[0-9]+/g)||["0"],f=parseInt(f[0],10),E=e.indexOf("aK")>=0,z=e.indexOf("aM")>=0,R=e.indexOf("aB")>=0,B=e.indexOf("aT")>=0,P=E||z||R||B,e.indexOf(" a")>-1?(M=" ",e=e.replace(" a","")):e=e.replace("a",""),p=0===(p=(_=Math.floor(Math.log(D)/Math.LN10)+1)%3)?3:p,f&&0!==D&&(d=Math.floor(Math.log(D)/Math.LN10)+1-f,m=3*~~((Math.min(f,_)-p)/3),D/=Math.pow(10,m),-1===e.indexOf(".")&&f>3))for(e+="[.]",w=(w=0===d?0:3*~~(d/3)-d)<0?w+3:w,n=0;n<w;n++)e+="0";Math.floor(Math.log(Math.abs(t))/Math.LN10)+1!==f&&(D>=Math.pow(10,12)&&!P||B?(M+=r[l].abbreviations.trillion,t/=Math.pow(10,12)):D<Math.pow(10,12)&&D>=Math.pow(10,9)&&!P||R?(M+=r[l].abbreviations.billion,t/=Math.pow(10,9)):D<Math.pow(10,9)&&D>=Math.pow(10,6)&&!P||z?(M+=r[l].abbreviations.million,t/=Math.pow(10,6)):(D<Math.pow(10,6)&&D>=Math.pow(10,3)&&!P||E)&&(M+=r[l].abbreviations.thousand,t/=Math.pow(10,3)))}if(e.indexOf("b")>-1)for(e.indexOf(" b")>-1?(N=" ",e=e.replace(" b","")):e=e.replace("b",""),h=0;h<=O.length;h++)if(o=Math.pow(1024,h),a=Math.pow(1024,h+1),t>=o&&t<a){N+=O[h],o>0&&(t/=o);break}if(e.indexOf("d")>-1)for(e.indexOf(" d")>-1?(N=" ",e=e.replace(" d","")):e=e.replace("d",""),h=0;h<=L.length;h++)if(o=Math.pow(1e3,h),a=Math.pow(1e3,h+1),t>=o&&t<a){N+=L[h],o>0&&(t/=o);break}return e.indexOf("o")>-1&&(e.indexOf(" o")>-1?(I=" ",e=e.replace(" o","")):e=e.replace("o",""),r[l].ordinal&&(I+=r[l].ordinal(t))),e.indexOf("[.]")>-1&&(C=!0,e=e.replace("[.]",".")),g=t.toString().split(".")[0],b=e.split(".")[1],x=e.indexOf(","),b?(g=(V=-1!==b.indexOf("*")?u(t,t.toString().split(".")[1].length,i):b.indexOf("[")>-1?u(t,(b=(b=b.replace("]","")).split("["))[0].length+b[1].length,i,b[1].length):u(t,b.length,i)).split(".")[0],V=V.split(".")[1].length?(s?M+s:r[l].delimiters.decimal)+V.split(".")[1]:"",C&&0===Number(V.slice(1))&&(V="")):g=u(t,null,i),g.indexOf("-")>-1&&(g=g.slice(1),U=!0),g.length<A&&(g=new Array(A-g.length+1).join("0")+g),x>-1&&(g=g.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+r[l].delimiters.thousands)),0===e.indexOf(".")&&(g=""),v+(e.indexOf("(")<e.indexOf("-")?(S&&U?"(":"")+(j&&U||!S&&U?"-":""):(j&&U||!S&&U?"-":"")+(S&&U?"(":""))+(!U&&T&&0!==t?"+":"")+g+V+(I||"")+(M&&!s?M:"")+(N||"")+(S&&U?")":"")+y}function g(t,e){r[t]=e}function f(t){l=t;var e=r[t].defaults;e&&e.format&&o.defaultFormat(e.format),e&&e.currencyFormat&&o.defaultCurrencyFormat(e.currencyFormat)}void 0!==e&&e.exports,(o=function(t){return o.isNumbro(t)?t=t.value():0===t||void 0===t?t=0:Number(t)||(t=o.fn.unformat(t)),new _(Number(t))}).version="1.6.2",o.isNumbro=function(t){return t instanceof _},o.setLanguage=function(t,e){console.warn("`setLanguage` is deprecated since version 1.6.0. Use `setCulture` instead");var i=t,s=t.split("-")[0],n=null;a[i]||(Object.keys(a).forEach((function(t){n||t.split("-")[0]!==s||(n=t)})),i=n||e||"en-US"),f(i)},o.setCulture=function(t,e){var i=t,s=t.split("-")[1],n=null;r[i]||(s&&Object.keys(r).forEach((function(t){n||t.split("-")[1]!==s||(n=t)})),i=n||e||"en-US"),f(i)},o.language=function(t,e){if(console.warn("`language` is deprecated since version 1.6.0. Use `culture` instead"),!t)return l;if(t&&!e){if(!a[t])throw new Error("Unknown language : "+t);f(t)}return!e&&a[t]||g(t,e),o},o.culture=function(t,e){if(!t)return l;if(t&&!e){if(!r[t])throw new Error("Unknown culture : "+t);f(t)}return!e&&r[t]||g(t,e),o},o.languageData=function(t){if(console.warn("`languageData` is deprecated since version 1.6.0. Use `cultureData` instead"),!t)return a[l];if(!a[t])throw new Error("Unknown language : "+t);return a[t]},o.cultureData=function(t){if(!t)return r[l];if(!r[t])throw new Error("Unknown culture : "+t);return r[t]},o.culture("en-US",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",0000 a"},formats:{fourDigits:"0000 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00"}}),o.languages=function(){return console.warn("`languages` is deprecated since version 1.6.0. Use `cultures` instead"),a},o.cultures=function(){return r},o.zeroFormat=function(t){c="string"==typeof t?t:null},o.defaultFormat=function(t){h="string"==typeof t?t:"0.0"},o.defaultCurrencyFormat=function(t){},o.validate=function(t,e){var i,s,n,r,a,l,c,h;if("string"!=typeof t&&(t+="",console.warn&&console.warn("Numbro.js: Value is not string. It has been co-erced to: ",t)),(t=t.trim()).match(/^\d+$/))return!0;if(""===t)return!1;try{c=o.cultureData(e)}catch(t){c=o.cultureData(o.culture())}return n=c.currency.symbol,a=c.abbreviations,i=c.delimiters.decimal,s="."===c.delimiters.thousands?"\\.":c.delimiters.thousands,(null===(h=t.match(/^[^\d]+/))||(t=t.substr(1),h[0]===n))&&(null===(h=t.match(/[^\d]+$/))||(t=t.slice(0,-1),h[0]===a.thousand||h[0]===a.million||h[0]===a.billion||h[0]===a.trillion))&&(l=new RegExp(s+"{2}"),!t.match(/[^\d.,]/g)&&!((r=t.split(i)).length>2)&&(r.length<2?!!r[0].match(/^\d+.*\d$/)&&!r[0].match(l):1===r[0].length?!!r[0].match(/^\d+$/)&&!r[0].match(l)&&!!r[1].match(/^\d+$/):!!r[0].match(/^\d+.*\d$/)&&!r[0].match(l)&&!!r[1].match(/^\d+$/)))},e.exports={format:function(t,e,i,s){return null!=i&&i!==o.culture()&&o.setCulture(i),p(Number(t),null!=e?e:h,null==s?Math.round:s)}}},function(e,i,s,n,o){!function(){"use strict";var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function i(t){return o(a(t),arguments)}function n(t,e){return i.apply(null,[t].concat(e||[]))}function o(t,s){var n,o,r,a,l,c,h,_,d,u=1,p=t.length,m="";for(o=0;o<p;o++)if("string"==typeof t[o])m+=t[o];else if("object"==typeof t[o]){if((a=t[o]).keys)for(n=s[u],r=0;r<a.keys.length;r++){if(null==n)throw new Error(i('[sprintf] Cannot access property "%s" of undefined value "%s"',a.keys[r],a.keys[r-1]));n=n[a.keys[r]]}else n=a.param_no?s[a.param_no]:s[u++];if(e.not_type.test(a.type)&&e.not_primitive.test(a.type)&&n instanceof Function&&(n=n()),e.numeric_arg.test(a.type)&&"number"!=typeof n&&isNaN(n))throw new TypeError(i("[sprintf] expecting number but found %T",n));switch(e.number.test(a.type)&&(_=n>=0),a.type){case"b":n=parseInt(n,10).toString(2);break;case"c":n=String.fromCharCode(parseInt(n,10));break;case"d":case"i":n=parseInt(n,10);break;case"j":n=JSON.stringify(n,null,a.width?parseInt(a.width):0);break;case"e":n=a.precision?parseFloat(n).toExponential(a.precision):parseFloat(n).toExponential();break;case"f":n=a.precision?parseFloat(n).toFixed(a.precision):parseFloat(n);break;case"g":n=a.precision?String(Number(n.toPrecision(a.precision))):parseFloat(n);break;case"o":n=(parseInt(n,10)>>>0).toString(8);break;case"s":n=String(n),n=a.precision?n.substring(0,a.precision):n;break;case"t":n=String(!!n),n=a.precision?n.substring(0,a.precision):n;break;case"T":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=a.precision?n.substring(0,a.precision):n;break;case"u":n=parseInt(n,10)>>>0;break;case"v":n=n.valueOf(),n=a.precision?n.substring(0,a.precision):n;break;case"x":n=(parseInt(n,10)>>>0).toString(16);break;case"X":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}e.json.test(a.type)?m+=n:(!e.number.test(a.type)||_&&!a.sign?d="":(d=_?"+":"-",n=n.toString().replace(e.sign,"")),c=a.pad_char?"0"===a.pad_char?"0":a.pad_char.charAt(1):" ",h=a.width-(d+n).length,l=a.width&&h>0?c.repeat(h):"",m+=a.align?d+n+l:"0"===c?d+l+n:l+d+n)}return m}var r=Object.create(null);function a(t){if(r[t])return r[t];for(var i,s=t,n=[],o=0;s;){if(null!==(i=e.text.exec(s)))n.push(i[0]);else if(null!==(i=e.modulo.exec(s)))n.push("%");else{if(null===(i=e.placeholder.exec(s)))throw new SyntaxError("[sprintf] unexpected placeholder");if(i[2]){o|=1;var a=[],l=i[2],c=[];if(null===(c=e.key.exec(l)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(a.push(c[1]);""!==(l=l.substring(c[0].length));)if(null!==(c=e.key_access.exec(l)))a.push(c[1]);else{if(null===(c=e.index_access.exec(l)))throw new SyntaxError("[sprintf] failed to parse named argument key");a.push(c[1])}i[2]=a}else o|=2;if(3===o)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");n.push({placeholder:i[0],param_no:i[1],keys:i[2],sign:i[3],pad_char:i[4],align:i[5],width:i[6],precision:i[7],type:i[8]})}s=s.substring(i[0].length)}return r[t]=n}void 0!==s&&(s.sprintf=i,s.vsprintf=n),"undefined"!=typeof window&&(window.sprintf=i,window.vsprintf=n,"function"==typeof t&&t.amd&&t((function(){return{sprintf:i,vsprintf:n}})))}()},function(t,e,i,s,n){s();const o=t(9),r=t(178),a=t(186),l=t(187),c=t(190),h=t(191),_=t(189);class d extends a.CompositeTicker{constructor(t){super(t)}static init_DatetimeTicker(){this.override({num_minor_ticks:0,tickers:()=>[new r.AdaptiveTicker({mantissas:[1,2,5],base:10,min_interval:0,max_interval:500*_.ONE_MILLI,num_minor_ticks:0}),new r.AdaptiveTicker({mantissas:[1,2,5,10,15,20,30],base:60,min_interval:_.ONE_SECOND,max_interval:30*_.ONE_MINUTE,num_minor_ticks:0}),new r.AdaptiveTicker({mantissas:[1,2,4,6,8,12],base:24,min_interval:_.ONE_HOUR,max_interval:12*_.ONE_HOUR,num_minor_ticks:0}),new l.DaysTicker({days:o.range(1,32)}),new l.DaysTicker({days:o.range(1,31,3)}),new l.DaysTicker({days:[1,8,15,22]}),new l.DaysTicker({days:[1,15]}),new c.MonthsTicker({months:o.range(0,12,1)}),new c.MonthsTicker({months:o.range(0,12,2)}),new c.MonthsTicker({months:o.range(0,12,4)}),new c.MonthsTicker({months:o.range(0,12,6)}),new h.YearsTicker({})]})}}i.DatetimeTicker=d,d.__name__="DatetimeTicker",d.init_DatetimeTicker()},function(t,e,i,s,n){s();const o=t(179),r=t(9);class a extends o.ContinuousTicker{constructor(t){super(t)}static init_CompositeTicker(){this.define((({Array:t,Ref:e})=>({tickers:[t(e(o.ContinuousTicker)),[]]})))}get min_intervals(){return this.tickers.map((t=>t.get_min_interval()))}get max_intervals(){return this.tickers.map((t=>t.get_max_interval()))}get_min_interval(){return this.min_intervals[0]}get_max_interval(){return this.max_intervals[0]}get_best_ticker(t,e,i){const s=e-t,n=this.get_ideal_interval(t,e,i),o=[r.sorted_index(this.min_intervals,n)-1,r.sorted_index(this.max_intervals,n)],a=[this.min_intervals[o[0]],this.max_intervals[o[1]]].map((t=>Math.abs(i-s/t)));let l;if(r.is_empty(a.filter((t=>!isNaN(t)))))l=this.tickers[0];else{const t=o[r.argmin(a)];l=this.tickers[t]}return l}get_interval(t,e,i){return this.get_best_ticker(t,e,i).get_interval(t,e,i)}get_ticks_no_defaults(t,e,i,s){return this.get_best_ticker(t,e,s).get_ticks_no_defaults(t,e,i,s)}}i.CompositeTicker=a,a.__name__="CompositeTicker",a.init_CompositeTicker()},function(t,e,i,s,n){s();const o=t(188),r=t(189),a=t(9);class l extends o.SingleIntervalTicker{constructor(t){super(t)}static init_DaysTicker(){this.define((({Int:t,Array:e})=>({days:[e(t),[]]}))),this.override({num_minor_ticks:0})}initialize(){super.initialize();const t=this.days;t.length>1?this.interval=(t[1]-t[0])*r.ONE_DAY:this.interval=31*r.ONE_DAY}get_ticks_no_defaults(t,e,i,s){const n=function(t,e){const i=r.last_month_no_later_than(new Date(t)),s=r.last_month_no_later_than(new Date(e));s.setUTCMonth(s.getUTCMonth()+1);const n=[],o=i;for(;n.push(r.copy_date(o)),o.setUTCMonth(o.getUTCMonth()+1),!(o>s););return n}(t,e),o=this.days,l=this.interval;return{major:a.concat(n.map((t=>((t,e)=>{const i=t.getUTCMonth(),s=[];for(const n of o){const o=r.copy_date(t);o.setUTCDate(n),new Date(o.getTime()+e/2).getUTCMonth()==i&&s.push(o)}return s})(t,l)))).map((t=>t.getTime())).filter((i=>t<=i&&i<=e)),minor:[]}}}i.DaysTicker=l,l.__name__="DaysTicker",l.init_DaysTicker()},function(t,e,i,s,n){s();const o=t(179);class r extends o.ContinuousTicker{constructor(t){super(t)}static init_SingleIntervalTicker(){this.define((({Number:t})=>({interval:[t]})))}get_interval(t,e,i){return this.interval}get_min_interval(){return this.interval}get_max_interval(){return this.interval}}i.SingleIntervalTicker=r,r.__name__="SingleIntervalTicker",r.init_SingleIntervalTicker()},function(t,e,i,s,n){function o(t){return new Date(t.getTime())}function r(t){const e=o(t);return e.setUTCDate(1),e.setUTCHours(0),e.setUTCMinutes(0),e.setUTCSeconds(0),e.setUTCMilliseconds(0),e}s(),i.ONE_MILLI=1,i.ONE_SECOND=1e3,i.ONE_MINUTE=60*i.ONE_SECOND,i.ONE_HOUR=60*i.ONE_MINUTE,i.ONE_DAY=24*i.ONE_HOUR,i.ONE_MONTH=30*i.ONE_DAY,i.ONE_YEAR=365*i.ONE_DAY,i.copy_date=o,i.last_month_no_later_than=r,i.last_year_no_later_than=function(t){const e=r(t);return e.setUTCMonth(0),e}},function(t,e,i,s,n){s();const o=t(188),r=t(189),a=t(9);class l extends o.SingleIntervalTicker{constructor(t){super(t)}static init_MonthsTicker(){this.define((({Int:t,Array:e})=>({months:[e(t),[]]})))}initialize(){super.initialize();const t=this.months;t.length>1?this.interval=(t[1]-t[0])*r.ONE_MONTH:this.interval=12*r.ONE_MONTH}get_ticks_no_defaults(t,e,i,s){const n=function(t,e){const i=r.last_year_no_later_than(new Date(t)),s=r.last_year_no_later_than(new Date(e));s.setUTCFullYear(s.getUTCFullYear()+1);const n=[],o=i;for(;n.push(r.copy_date(o)),o.setUTCFullYear(o.getUTCFullYear()+1),!(o>s););return n}(t,e),o=this.months;return{major:a.concat(n.map((t=>o.map((e=>{const i=r.copy_date(t);return i.setUTCMonth(e),i}))))).map((t=>t.getTime())).filter((i=>t<=i&&i<=e)),minor:[]}}}i.MonthsTicker=l,l.__name__="MonthsTicker",l.init_MonthsTicker()},function(t,e,i,s,n){s();const o=t(177),r=t(188),a=t(189);class l extends r.SingleIntervalTicker{constructor(t){super(t)}initialize(){super.initialize(),this.interval=a.ONE_YEAR,this.basic_ticker=new o.BasicTicker({num_minor_ticks:0})}get_ticks_no_defaults(t,e,i,s){const n=a.last_year_no_later_than(new Date(t)).getUTCFullYear(),o=a.last_year_no_later_than(new Date(e)).getUTCFullYear();return{major:this.basic_ticker.get_ticks_no_defaults(n,o,i,s).major.map((t=>Date.UTC(t,0,1))).filter((i=>t<=i&&i<=e)),minor:[]}}}i.YearsTicker=l,l.__name__="YearsTicker"},function(t,e,i,s,n){s();const o=t(173),r=t(193),a=t(194);class l extends o.ContinuousAxisView{}i.LogAxisView=l,l.__name__="LogAxisView";class c extends o.ContinuousAxis{constructor(t){super(t)}static init_LogAxis(){this.prototype.default_view=l,this.override({ticker:()=>new a.LogTicker,formatter:()=>new r.LogTickFormatter})}}i.LogAxis=c,c.__name__="LogAxis",c.init_LogAxis()},function(t,e,i,s,n){s();const o=t(166),r=t(176),a=t(194),l=t(167),{log:c,round:h}=Math;class _ extends o.TickFormatter{constructor(t){super(t)}static init_LogTickFormatter(){this.define((({Ref:t,Nullable:e})=>({ticker:[e(t(a.LogTicker)),null]})))}initialize(){super.initialize(),this.basic_formatter=new r.BasicTickFormatter}format_graphics(t,e){var i,s;if(0==t.length)return[];const n=null!==(s=null===(i=this.ticker)||void 0===i?void 0:i.base)&&void 0!==s?s:10,o=this._exponents(t,n);return null==o?this.basic_formatter.format_graphics(t,e):o.map((t=>{const e=new l.TextBox({text:r.unicode_replace(`${n}`)}),i=new l.TextBox({text:r.unicode_replace(`${t}`)});return new l.BaseExpo(e,i)}))}_exponents(t,e){let i=null;const s=[];for(const n of t){const t=h(c(n)/c(e));if(i==t)return null;i=t,s.push(t)}return s}doFormat(t,e){var i,s;if(0==t.length)return[];const n=null!==(s=null===(i=this.ticker)||void 0===i?void 0:i.base)&&void 0!==s?s:10,o=this._exponents(t,n);return null==o?this.basic_formatter.doFormat(t,e):o.map((t=>r.unicode_replace(`${n}^${t}`)))}}i.LogTickFormatter=_,_.__name__="LogTickFormatter",_.init_LogTickFormatter()},function(t,e,i,s,n){s();const o=t(178),r=t(9);class a extends o.AdaptiveTicker{constructor(t){super(t)}static init_LogTicker(){this.override({mantissas:[1,5]})}get_ticks_no_defaults(t,e,i,s){const n=this.num_minor_ticks,o=[],a=this.base,l=Math.log(t)/Math.log(a),c=Math.log(e)/Math.log(a),h=c-l;let _;if(isFinite(h))if(h<2){const i=this.get_interval(t,e,s),a=Math.floor(t/i),l=Math.ceil(e/i);if(_=r.range(a,l+1).filter((t=>0!=t)).map((t=>t*i)).filter((i=>t<=i&&i<=e)),n>0&&_.length>0){const t=i/n,e=r.range(0,n).map((e=>e*t));for(const i of e.slice(1))o.push(_[0]-i);for(const i of _)for(const t of e)o.push(i+t)}}else{const t=Math.ceil(.999999*l),e=Math.floor(1.000001*c),i=Math.ceil((e-t)/9);if(_=r.range(t-1,e+1,i).map((t=>a**t)),n>0&&_.length>0){const t=a**i/n,e=r.range(1,n+1).map((e=>e*t));for(const i of e)o.push(_[0]/i);o.push(_[0]);for(const i of _)for(const t of e)o.push(i*t)}}else _=[];return{major:_.filter((i=>t<=i&&i<=e)),minor:o.filter((i=>t<=i&&i<=e))}}}i.LogTicker=a,a.__name__="LogTicker",a.init_LogTicker()},function(t,e,i,s,n){s();const o=t(163),r=t(175),a=t(196),l=t(197);class c extends o.AxisView{}i.MercatorAxisView=c,c.__name__="MercatorAxisView";class h extends r.LinearAxis{constructor(t){super(t)}static init_MercatorAxis(){this.prototype.default_view=c,this.override({ticker:()=>new l.MercatorTicker({dimension:"lat"}),formatter:()=>new a.MercatorTickFormatter({dimension:"lat"})})}}i.MercatorAxis=h,h.__name__="MercatorAxis",h.init_MercatorAxis()},function(t,e,i,s,n){s();const o=t(176),r=t(20),a=t(65);class l extends o.BasicTickFormatter{constructor(t){super(t)}static init_MercatorTickFormatter(){this.define((({Nullable:t})=>({dimension:[t(r.LatLon),null]})))}doFormat(t,e){if(null==this.dimension)throw new Error("MercatorTickFormatter.dimension not configured");if(0==t.length)return[];const i=t.length,s=new Array(i);if("lon"==this.dimension)for(let n=0;n<i;n++){const[i]=a.wgs84_mercator.invert(t[n],e.loc);s[n]=i}else for(let n=0;n<i;n++){const[,i]=a.wgs84_mercator.invert(e.loc,t[n]);s[n]=i}return super.doFormat(s,e)}}i.MercatorTickFormatter=l,l.__name__="MercatorTickFormatter",l.init_MercatorTickFormatter()},function(t,e,i,s,n){s();const o=t(177),r=t(20),a=t(65);class l extends o.BasicTicker{constructor(t){super(t)}static init_MercatorTicker(){this.define((({Nullable:t})=>({dimension:[t(r.LatLon),null]})))}get_ticks_no_defaults(t,e,i,s){if(null==this.dimension)throw new Error(`${this}.dimension wasn't configured`);return[t,e]=a.clip_mercator(t,e,this.dimension),"lon"==this.dimension?this._get_ticks_lon(t,e,i,s):this._get_ticks_lat(t,e,i,s)}_get_ticks_lon(t,e,i,s){const[n]=a.wgs84_mercator.invert(t,i),[o,r]=a.wgs84_mercator.invert(e,i),l=super.get_ticks_no_defaults(n,o,i,s),c=[];for(const _ of l.major)if(a.in_bounds(_,"lon")){const[t]=a.wgs84_mercator.compute(_,r);c.push(t)}const h=[];for(const _ of l.minor)if(a.in_bounds(_,"lon")){const[t]=a.wgs84_mercator.compute(_,r);h.push(t)}return{major:c,minor:h}}_get_ticks_lat(t,e,i,s){const[,n]=a.wgs84_mercator.invert(i,t),[o,r]=a.wgs84_mercator.invert(i,e),l=super.get_ticks_no_defaults(n,r,i,s),c=[];for(const _ of l.major)if(a.in_bounds(_,"lat")){const[,t]=a.wgs84_mercator.compute(o,_);c.push(t)}const h=[];for(const _ of l.minor)if(a.in_bounds(_,"lat")){const[,t]=a.wgs84_mercator.compute(o,_);h.push(t)}return{major:c,minor:h}}}i.MercatorTicker=l,l.__name__="MercatorTicker",l.init_MercatorTicker()},function(t,e,i,s,n){s(),n("AdaptiveTicker",t(178).AdaptiveTicker),n("BasicTicker",t(177).BasicTicker),n("CategoricalTicker",t(171).CategoricalTicker),n("CompositeTicker",t(186).CompositeTicker),n("ContinuousTicker",t(179).ContinuousTicker),n("DatetimeTicker",t(185).DatetimeTicker),n("DaysTicker",t(187).DaysTicker),n("FixedTicker",t(199).FixedTicker),n("LogTicker",t(194).LogTicker),n("MercatorTicker",t(197).MercatorTicker),n("MonthsTicker",t(190).MonthsTicker),n("SingleIntervalTicker",t(188).SingleIntervalTicker),n("Ticker",t(165).Ticker),n("YearsTicker",t(191).YearsTicker),n("BinnedTicker",t(200).BinnedTicker)},function(t,e,i,s,n){s();const o=t(179);class r extends o.ContinuousTicker{constructor(t){super(t)}static init_FixedTicker(){this.define((({Number:t,Array:e})=>({ticks:[e(t),[]],minor_ticks:[e(t),[]]})))}get_ticks_no_defaults(t,e,i,s){return{major:this.ticks,minor:this.minor_ticks}}get_interval(t,e,i){return 0}get_min_interval(){return 0}get_max_interval(){return 0}}i.FixedTicker=r,r.__name__="FixedTicker",r.init_FixedTicker()},function(t,e,i,s,n){s();const o=t(165),r=t(201),a=t(12);class l extends o.Ticker{constructor(t){super(t)}static init_BinnedTicker(){this.define((({Number:t,Ref:e,Or:i,Auto:s})=>({mapper:[e(r.ScanningColorMapper)],num_major_ticks:[i(t,s),8]})))}get_ticks(t,e,i,s){const{binning:n}=this.mapper.metrics,o=Math.max(0,a.left_edge_index(t,n)),r=Math.min(a.left_edge_index(e,n)+1,n.length-1),l=[];for(let a=o;a<=r;a++)l.push(n[a]);const{num_major_ticks:c}=this,h=[],_="auto"==c?l.length:c,d=Math.max(1,Math.floor(l.length/_));for(let a=0;a<l.length;a+=d)h.push(l[a]);return{major:h,minor:[]}}}i.BinnedTicker=l,l.__name__="BinnedTicker",l.init_BinnedTicker()},function(t,e,i,s,n){s();const o=t(202),r=t(12);class a extends o.ContinuousColorMapper{constructor(t){super(t)}cmap(t,e,i,s,n){return t<n.binning[0]?i:t>n.binning[n.binning.length-1]?s:e[r.left_edge_index(t,n.binning)]}}i.ScanningColorMapper=a,a.__name__="ScanningColorMapper"},function(t,e,i,s,n){s();const o=t(203),r=t(61),a=t(9),l=t(8);class c extends o.ColorMapper{constructor(t){super(t),this._scan_data=null}static init_ContinuousColorMapper(){this.define((({Number:t,String:e,Ref:i,Color:s,Or:n,Tuple:o,Array:a,Nullable:l})=>({high:[l(t),null],low:[l(t),null],high_color:[l(s),null],low_color:[l(s),null],domain:[a(o(i(r.GlyphRenderer),n(e,a(e)))),[]]})))}connect_signals(){super.connect_signals();const t=()=>{for(const[t]of this.domain)this.connect(t.view.change,(()=>this.update_data())),this.connect(t.data_source.selected.change,(()=>this.update_data()))};this.connect(this.properties.domain.change,(()=>t())),t()}update_data(){const{domain:t,palette:e}=this,i=[...this._collect(t)];this._scan_data=this.scan(i,e.length),this.metrics_change.emit(),this.change.emit()}get metrics(){return null==this._scan_data&&this.update_data(),this._scan_data}*_collect(t){for(const[e,i]of t)for(const t of l.isArray(i)?i:[i]){let i=e.data_source.get_column(t);i=e.view.indices.select(i);const s=e.view.masked,n=e.data_source.selected.indices;let o;if(null!=s&&n.length>0?o=a.intersection([...s],n):null!=s?o=[...s]:n.length>0&&(o=n),null!=o&&(i=a.map(o,(t=>i[t]))),i.length>0&&!l.isNumber(i[0]))for(const t of i)yield*t;else yield*i}}_v_compute(t,e,i,s){const{nan_color:n}=s;let{low_color:o,high_color:r}=s;null==o&&(o=i[0]),null==r&&(r=i[i.length-1]);const{domain:l}=this,c=a.is_empty(l)?t:[...this._collect(l)];this._scan_data=this.scan(c,i.length),this.metrics_change.emit();for(let a=0,h=t.length;a<h;a++){const s=t[a];isNaN(s)?e[a]=n:e[a]=this.cmap(s,i,o,r,this._scan_data)}}_colors(t){return Object.assign(Object.assign({},super._colors(t)),{low_color:null!=this.low_color?t(this.low_color):void 0,high_color:null!=this.high_color?t(this.high_color):void 0})}}i.ContinuousColorMapper=c,c.__name__="ContinuousColorMapper",c.init_ContinuousColorMapper()},function(t,e,i,s,n){s();const o=t(204),r=t(15),a=t(24),l=t(22),c=t(27);function h(t){return l.encode_rgba(l.color2rgba(t))}function _(t){const e=new Uint32Array(t.length);for(let i=0,s=t.length;i<s;i++)e[i]=h(t[i]);return e}i._convert_color=h,i._convert_palette=_;class d extends o.Mapper{constructor(t){super(t)}initialize(){super.initialize(),this.metrics_change=new r.Signal0(this,"metrics_change")}static init_ColorMapper(){this.define((({Color:t,Array:e})=>({palette:[e(t)],nan_color:[t,"gray"]})))}v_compute(t){const e=new Array(t.length);return this._v_compute(t,e,this.palette,this._colors((t=>t))),e}get rgba_mapper(){const t=this,e=_(this.palette),i=this._colors(h);return{v_compute(s){const n=new a.ColorArray(s.length);return t._v_compute(s,n,e,i),new Uint8ClampedArray(c.to_big_endian(n).buffer)}}}_colors(t){return{nan_color:t(this.nan_color)}}}i.ColorMapper=d,d.__name__="ColorMapper",d.init_ColorMapper()},function(t,e,i,s,n){s();const o=t(149);class r extends o.Transform{constructor(t){super(t)}compute(t){throw new Error("mapping single values is not supported")}}i.Mapper=r,r.__name__="Mapper"},function(t,e,i,s,n){s(),n("BasicTickFormatter",t(176).BasicTickFormatter),n("CategoricalTickFormatter",t(172).CategoricalTickFormatter),n("DatetimeTickFormatter",t(180).DatetimeTickFormatter),n("FuncTickFormatter",t(206).FuncTickFormatter),n("LogTickFormatter",t(193).LogTickFormatter),n("MercatorTickFormatter",t(196).MercatorTickFormatter),n("NumeralTickFormatter",t(207).NumeralTickFormatter),n("PrintfTickFormatter",t(208).PrintfTickFormatter),n("TickFormatter",t(166).TickFormatter)},function(t,e,i,s,n){s();const o=t(166),r=t(13),a=t(34);class l extends o.TickFormatter{constructor(t){super(t)}static init_FuncTickFormatter(){this.define((({Unknown:t,String:e,Dict:i})=>({args:[i(t),{}],code:[e,""]})))}get names(){return r.keys(this.args)}get values(){return r.values(this.args)}_make_func(){const t=a.use_strict(this.code);return new Function("tick","index","ticks",...this.names,t)}doFormat(t,e){const i=this._make_func().bind({});return t.map(((t,e,s)=>`${i(t,e,s,...this.values)}`))}}i.FuncTickFormatter=l,l.__name__="FuncTickFormatter",l.init_FuncTickFormatter()},function(t,e,i,s,n){s();const o=t(1).__importStar(t(183)),r=t(166),a=t(20);class l extends r.TickFormatter{constructor(t){super(t)}static init_NumeralTickFormatter(){this.define((({String:t})=>({format:[t,"0,0"],language:[t,"en"],rounding:[a.RoundingFunction,"round"]})))}get _rounding_fn(){switch(this.rounding){case"round":case"nearest":return Math.round;case"floor":case"rounddown":return Math.floor;case"ceil":case"roundup":return Math.ceil}}doFormat(t,e){const{format:i,language:s,_rounding_fn:n}=this;return t.map((t=>o.format(t,i,s,n)))}}i.NumeralTickFormatter=l,l.__name__="NumeralTickFormatter",l.init_NumeralTickFormatter()},function(t,e,i,s,n){s();const o=t(166),r=t(182);class a extends o.TickFormatter{constructor(t){super(t)}static init_PrintfTickFormatter(){this.define((({String:t})=>({format:[t,"%s"]})))}doFormat(t,e){return t.map((t=>r.sprintf(this.format,t)))}}i.PrintfTickFormatter=a,a.__name__="PrintfTickFormatter",a.init_PrintfTickFormatter()},function(t,e,i,s,n){s(),n("CategoricalColorMapper",t(210).CategoricalColorMapper),n("CategoricalMarkerMapper",t(212).CategoricalMarkerMapper),n("CategoricalPatternMapper",t(213).CategoricalPatternMapper),n("ContinuousColorMapper",t(202).ContinuousColorMapper),n("ColorMapper",t(203).ColorMapper),n("LinearColorMapper",t(214).LinearColorMapper),n("LogColorMapper",t(215).LogColorMapper),n("ScanningColorMapper",t(201).ScanningColorMapper),n("EqHistColorMapper",t(216).EqHistColorMapper)},function(t,e,i,s,n){s();const o=t(211),r=t(203),a=t(104);class l extends r.ColorMapper{constructor(t){super(t)}static init_CategoricalColorMapper(){this.define((({Number:t,Nullable:e})=>({factors:[a.FactorSeq],start:[t,0],end:[e(t),null]})))}_v_compute(t,e,i,{nan_color:s}){o.cat_v_compute(t,this.factors,i,e,this.start,this.end,s)}}i.CategoricalColorMapper=l,l.__name__="CategoricalColorMapper",l.init_CategoricalColorMapper()},function(t,e,i,s,n){s();const o=t(12),r=t(8);function a(t,e){if(t.length!=e.length)return!1;for(let i=0,s=t.length;i<s;i++)if(t[i]!==e[i])return!1;return!0}i._cat_equals=a,i.cat_v_compute=function(t,e,i,s,n,l,c){const h=t.length;for(let _=0;_<h;_++){let h,d,u=t[_];r.isString(u)?h=o.index_of(e,u):(null!=n?u=null!=l?u.slice(n,l):u.slice(n):null!=l&&(u=u.slice(0,l)),h=1==u.length?o.index_of(e,u[0]):o.find_index(e,(t=>a(t,u)))),d=h<0||h>=i.length?c:i[h],s[_]=d}}},function(t,e,i,s,n){s();const o=t(211),r=t(104),a=t(204),l=t(20);class c extends a.Mapper{constructor(t){super(t)}static init_CategoricalMarkerMapper(){this.define((({Number:t,Array:e,Nullable:i})=>({factors:[r.FactorSeq],markers:[e(l.MarkerType)],start:[t,0],end:[i(t),null],default_value:[l.MarkerType,"circle"]})))}v_compute(t){const e=new Array(t.length);return o.cat_v_compute(t,this.factors,this.markers,e,this.start,this.end,this.default_value),e}}i.CategoricalMarkerMapper=c,c.__name__="CategoricalMarkerMapper",c.init_CategoricalMarkerMapper()},function(t,e,i,s,n){s();const o=t(211),r=t(104),a=t(204),l=t(20);class c extends a.Mapper{constructor(t){super(t)}static init_CategoricalPatternMapper(){this.define((({Number:t,Array:e,Nullable:i})=>({factors:[r.FactorSeq],patterns:[e(l.HatchPatternType)],start:[t,0],end:[i(t),null],default_value:[l.HatchPatternType," "]})))}v_compute(t){const e=new Array(t.length);return o.cat_v_compute(t,this.factors,this.patterns,e,this.start,this.end,this.default_value),e}}i.CategoricalPatternMapper=c,c.__name__="CategoricalPatternMapper",c.init_CategoricalPatternMapper()},function(t,e,i,s,n){s();const o=t(202),r=t(12);class a extends o.ContinuousColorMapper{constructor(t){super(t)}scan(t,e){const i=null!=this.low?this.low:r.min(t),s=null!=this.high?this.high:r.max(t);return{max:s,min:i,norm_factor:1/(s-i),normed_interval:1/e}}cmap(t,e,i,s,n){const o=e.length-1;if(t==n.max)return e[o];const r=(t-n.min)*n.norm_factor,a=Math.floor(r/n.normed_interval);return a<0?i:a>o?s:e[a]}}i.LinearColorMapper=a,a.__name__="LinearColorMapper"},function(t,e,i,s,n){s();const o=t(202),r=t(12);class a extends o.ContinuousColorMapper{constructor(t){super(t)}scan(t,e){const i=null!=this.low?this.low:r.min(t),s=null!=this.high?this.high:r.max(t);return{max:s,min:i,scale:e/(Math.log(s)-Math.log(i))}}cmap(t,e,i,s,n){const o=e.length-1;if(t>n.max)return s;if(t==n.max)return e[o];if(t<n.min)return i;const r=Math.log(t)-Math.log(n.min);let a=Math.floor(r*n.scale);return a>o&&(a=o),e[a]}}i.LogColorMapper=a,a.__name__="LogColorMapper"},function(t,e,i,s,n){s();const o=t(201),r=t(12),a=t(9),l=t(19);class c extends o.ScanningColorMapper{constructor(t){super(t)}static init_EqHistColorMapper(){this.define((({Int:t})=>({bins:[t,65536]})))}scan(t,e){const i=null!=this.low?this.low:r.min(t),s=null!=this.high?this.high:r.max(t),n=this.bins,o=a.linspace(i,s,n+1),c=r.bin_counts(t,o),h=new Array(n);for(let r=0,a=o.length;r<a-1;r++){const t=o[r],e=o[r+1];h[r]=(t+e)/2}const _=a.cumsum(c),d=_[_.length-1],u=r.map(_,(t=>t/d));let p=e-1,m=[],g=0,f=2*e;for(;p!=e&&g<4&&0!=p;){const t=f/p;if(t>1e3)break;f=Math.round(Math.max(e*t,e));const i=a.range(0,f),s=r.map(u,(t=>t*(f-1)));m=r.interpolate(i,s,h),p=a.uniq(m).length-1,g++}if(0==p){m=[i,s];for(let t=0;t<e-1;t++)m.push(s)}else m=m.slice(m.length-e-1),p!=e&&l.logger.warn("EqHistColorMapper warning: Histogram equalization did not converge.");return m[0]=i,m[m.length-1]=s,{min:i,max:s,binning:m}}}i.EqHistColorMapper=c,c.__name__="EqHistColorMapper",c.init_EqHistColorMapper()},function(t,e,i,s,n){s(),n("CategoricalScale",t(145).CategoricalScale),n("ContinuousScale",t(158).ContinuousScale),n("LinearScale",t(218).LinearScale),n("LinearInterpolationScale",t(219).LinearInterpolationScale),n("LogScale",t(157).LogScale),n("Scale",t(146).Scale)},function(t,e,i,s,n){s();const o=t(158);class r extends o.ContinuousScale{constructor(t){super(t)}get s_compute(){const[t,e]=this._linear_compute_state();return i=>t*i+e}compute(t){return this._linear_compute(t)}v_compute(t){return this._linear_v_compute(t)}invert(t){return this._linear_invert(t)}v_invert(t){return this._linear_v_invert(t)}}i.LinearScale=r,r.__name__="LinearScale"},function(t,e,i,s,n){s();const o=t(146),r=t(12);class a extends o.Scale{constructor(t){super(t)}static init_LinearInterpolationScale(){this.internal((({Arrayable:t})=>({binning:[t]})))}get s_compute(){throw new Error("not implemented")}compute(t){return t}v_compute(t){const{binning:e}=this,{start:i,end:s}=this.source_range,n=i,o=s,a=e.length,l=(s-i)/(a-1),c=new Float64Array(a);for(let r=0;r<a;r++)c[r]=i+r*l;const h=r.map(t,(t=>{if(t<n)return n;if(t>o)return o;const i=r.left_edge_index(t,e),s=e[i],a=(t-s)/(e[i+1]-s),l=c[i];return l+a*(c[i+1]-l)}));return this._linear_v_compute(h)}invert(t){return t}v_invert(t){return new Float64Array(t)}}i.LinearInterpolationScale=a,a.__name__="LinearInterpolationScale",a.init_LinearInterpolationScale()},function(t,e,i,s,n){s(),n("DataRange",t(160).DataRange),n("DataRange1d",t(159).DataRange1d),n("FactorRange",t(104).FactorRange),n("Range",t(105).Range),n("Range1d",t(156).Range1d)},function(t,e,i,s,n){s();var o=t(141);n("Sizeable",o.Sizeable),n("SizingPolicy",o.SizingPolicy);var r=t(142);n("Layoutable",r.Layoutable),n("LayoutItem",r.LayoutItem);var a=t(222);n("HStack",a.HStack),n("VStack",a.VStack);var l=t(223);n("Grid",l.Grid),n("Row",l.Row),n("Column",l.Column);var c=t(224);n("ContentBox",c.ContentBox),n("VariadicBox",c.VariadicBox)},function(t,e,i,s,n){s();const o=t(142),r=t(99);class a extends o.Layoutable{constructor(){super(...arguments),this.children=[]}*[Symbol.iterator](){yield*this.children}}i.Stack=a,a.__name__="Stack";class l extends a{_measure(t){let e=0,i=0;for(const s of this.children){const t=s.measure({width:0,height:0});e+=t.width,i=Math.max(i,t.height)}return{width:e,height:i}}_set_geometry(t,e){super._set_geometry(t,e);const i=this.absolute?t.top:0;let s=this.absolute?t.left:0;const{height:n}=t;for(const o of this.children){const{width:t}=o.measure({width:0,height:0});o.set_geometry(new r.BBox({left:s,width:t,top:i,height:n})),s+=t}}}i.HStack=l,l.__name__="HStack";class c extends a{_measure(t){let e=0,i=0;for(const s of this.children){const t=s.measure({width:0,height:0});e=Math.max(e,t.width),i+=t.height}return{width:e,height:i}}_set_geometry(t,e){super._set_geometry(t,e);const i=this.absolute?t.left:0;let s=this.absolute?t.top:0;const{width:n}=t;for(const o of this.children){const{height:t}=o.measure({width:0,height:0});o.set_geometry(new r.BBox({top:s,height:t,left:i,width:n})),s+=t}}}i.VStack=c,c.__name__="VStack";class h extends o.Layoutable{constructor(){super(...arguments),this.children=[]}*[Symbol.iterator](){yield*this.children}_measure(t){const{width_policy:e,height_policy:i}=this.sizing,{min:s,max:n}=Math;let o=0,r=0;for(const a of this.children){const{width:e,height:i}=a.measure(t);o=n(o,e),r=n(r,i)}return{width:(()=>{const{width:i}=this.sizing;if(t.width==1/0)return"fixed"==e&&null!=i?i:o;switch(e){case"fixed":return null!=i?i:o;case"min":return o;case"fit":return null!=i?s(t.width,i):t.width;case"max":return null!=i?n(t.width,i):t.width}})(),height:(()=>{const{height:e}=this.sizing;if(t.height==1/0)return"fixed"==i&&null!=e?e:r;switch(i){case"fixed":return null!=e?e:r;case"min":return r;case"fit":return null!=e?s(t.height,e):t.height;case"max":return null!=e?n(t.height,e):t.height}})()}}_set_geometry(t,e){super._set_geometry(t,e);const i=this.absolute?t:t.relative(),{left:s,right:n,top:o,bottom:a}=i,l=Math.round(i.vcenter),c=Math.round(i.hcenter);for(const h of this.children){const{margin:e,halign:i,valign:_}=h.sizing,{width:d,height:u,inner:p}=h.measure(t),m=(()=>{switch(`${_}_${i}`){case"start_start":return new r.BBox({left:s+e.left,top:o+e.top,width:d,height:u});case"start_center":return new r.BBox({hcenter:c,top:o+e.top,width:d,height:u});case"start_end":return new r.BBox({right:n-e.right,top:o+e.top,width:d,height:u});case"center_start":return new r.BBox({left:s+e.left,vcenter:l,width:d,height:u});case"center_center":return new r.BBox({hcenter:c,vcenter:l,width:d,height:u});case"center_end":return new r.BBox({right:n-e.right,vcenter:l,width:d,height:u});case"end_start":return new r.BBox({left:s+e.left,bottom:a-e.bottom,width:d,height:u});case"end_center":return new r.BBox({hcenter:c,bottom:a-e.bottom,width:d,height:u});case"end_end":return new r.BBox({right:n-e.right,bottom:a-e.bottom,width:d,height:u})}})(),g=null==p?m:new r.BBox({left:m.left+p.left,top:m.top+p.top,right:m.right-p.right,bottom:m.bottom-p.bottom});h.set_geometry(m,g)}}}i.NodeLayout=h,h.__name__="NodeLayout"},function(t,e,i,s,n){s();const o=t(141),r=t(142),a=t(8),l=t(99),c=t(9),{max:h,round:_}=Math;class d{constructor(t){this.def=t,this._map=new Map}get(t){let e=this._map.get(t);return void 0===e&&(e=this.def(),this._map.set(t,e)),e}apply(t,e){const i=this.get(t);this._map.set(t,e(i))}}d.__name__="DefaultMap";class u{constructor(){this._items=[],this._nrows=0,this._ncols=0}get nrows(){return this._nrows}get ncols(){return this._ncols}add(t,e){const{r1:i,c1:s}=t;this._nrows=h(this._nrows,i+1),this._ncols=h(this._ncols,s+1),this._items.push({span:t,data:e})}at(t,e){return this._items.filter((({span:i})=>i.r0<=t&&t<=i.r1&&i.c0<=e&&e<=i.c1)).map((({data:t})=>t))}row(t){return this._items.filter((({span:e})=>e.r0<=t&&t<=e.r1)).map((({data:t})=>t))}col(t){return this._items.filter((({span:e})=>e.c0<=t&&t<=e.c1)).map((({data:t})=>t))}foreach(t){for(const{span:e,data:i}of this._items)t(e,i)}map(t){const e=new u;for(const{span:i,data:s}of this._items)e.add(i,t(i,s));return e}}u.__name__="Container";class p extends r.Layoutable{constructor(t=[]){super(),this.items=t,this.rows="auto",this.cols="auto",this.spacing=0}*[Symbol.iterator](){for(const{layout:t}of this.items)yield t}is_width_expanding(){if(super.is_width_expanding())return!0;if("fixed"==this.sizing.width_policy)return!1;const{cols:t}=this._state;return c.some(t,(t=>"max"==t.policy))}is_height_expanding(){if(super.is_height_expanding())return!0;if("fixed"==this.sizing.height_policy)return!1;const{rows:t}=this._state;return c.some(t,(t=>"max"==t.policy))}_init(){var t,e,i,s;super._init();const n=new u;for(const{layout:a,row:c,col:u,row_span:p,col_span:m}of this.items)if(a.sizing.visible){const t=c,e=u,i=c+(null!=p?p:1)-1,s=u+(null!=m?m:1)-1;n.add({r0:t,c0:e,r1:i,c1:s},a)}const{nrows:o,ncols:r}=n,l=new Array(o);for(let u=0;u<o;u++){const i=(()=>{var t;const e=a.isPlainObject(this.rows)?null!==(t=this.rows[u])&&void 0!==t?t:this.rows["*"]:this.rows;return null==e?{policy:"auto"}:a.isNumber(e)?{policy:"fixed",height:e}:a.isString(e)?{policy:e}:e})(),s=null!==(t=i.align)&&void 0!==t?t:"auto";if("fixed"==i.policy)l[u]={policy:"fixed",height:i.height,align:s};else if("min"==i.policy)l[u]={policy:"min",align:s};else if("fit"==i.policy||"max"==i.policy)l[u]={policy:i.policy,flex:null!==(e=i.flex)&&void 0!==e?e:1,align:s};else{if("auto"!=i.policy)throw new Error("unrechable");c.some(n.row(u),(t=>t.is_height_expanding()))?l[u]={policy:"max",flex:1,align:s}:l[u]={policy:"min",align:s}}}const h=new Array(r);for(let u=0;u<r;u++){const t=(()=>{var t;const e=a.isPlainObject(this.cols)?null!==(t=this.cols[u])&&void 0!==t?t:this.cols["*"]:this.cols;return null==e?{policy:"auto"}:a.isNumber(e)?{policy:"fixed",width:e}:a.isString(e)?{policy:e}:e})(),e=null!==(i=t.align)&&void 0!==i?i:"auto";if("fixed"==t.policy)h[u]={policy:"fixed",width:t.width,align:e};else if("min"==t.policy)h[u]={policy:"min",align:e};else if("fit"==t.policy||"max"==t.policy)h[u]={policy:t.policy,flex:null!==(s=t.flex)&&void 0!==s?s:1,align:e};else{if("auto"!=t.policy)throw new Error("unrechable");c.some(n.col(u),(t=>t.is_width_expanding()))?h[u]={policy:"max",flex:1,align:e}:h[u]={policy:"min",align:e}}}const[_,d]=a.isNumber(this.spacing)?[this.spacing,this.spacing]:this.spacing;this._state={items:n,nrows:o,ncols:r,rows:l,cols:h,rspacing:_,cspacing:d}}_measure_totals(t,e){const{nrows:i,ncols:s,rspacing:n,cspacing:o}=this._state;return{height:c.sum(t)+(i-1)*n,width:c.sum(e)+(s-1)*o}}_measure_cells(t){const{items:e,nrows:i,ncols:s,rows:n,cols:r,rspacing:a,cspacing:l}=this._state,c=new Array(i);for(let o=0;o<i;o++){const t=n[o];c[o]="fixed"==t.policy?t.height:0}const d=new Array(s);for(let o=0;o<s;o++){const t=r[o];d[o]="fixed"==t.policy?t.width:0}const p=new u;return e.foreach(((e,i)=>{const{r0:s,c0:u,r1:m,c1:g}=e,f=(m-s)*a,b=(g-u)*l;let v=0;for(let n=s;n<=m;n++)v+=t(n,u).height;v+=f;let y=0;for(let n=u;n<=g;n++)y+=t(s,n).width;y+=b;const x=i.measure({width:y,height:v});p.add(e,{layout:i,size_hint:x});const w=new o.Sizeable(x).grow_by(i.sizing.margin);w.height-=f,w.width-=b;const A=[];for(let t=s;t<=m;t++){const e=n[t];"fixed"==e.policy?w.height-=e.height:A.push(t)}if(w.height>0){const t=_(w.height/A.length);for(const e of A)c[e]=h(c[e],t)}const k=[];for(let t=u;t<=g;t++){const e=r[t];"fixed"==e.policy?w.width-=e.width:k.push(t)}if(w.width>0){const t=_(w.width/k.length);for(const e of k)d[e]=h(d[e],t)}})),{size:this._measure_totals(c,d),row_heights:c,col_widths:d,size_hints:p}}_measure_grid(t){const{nrows:e,ncols:i,rows:s,cols:n,rspacing:o,cspacing:r}=this._state,a=i=>{let n;n="fixed"==this.sizing.height_policy&&null!=this.sizing.height?this.sizing.height:t.height!=1/0&&this.is_height_expanding()?Math.max(t.height,i.size.height):i.size.height;let r=0;for(let t=0;t<e;t++){const e=s[t];"max"==e.policy?r+=e.flex:n-=i.row_heights[t]}if(n-=(e-1)*o,0!=r&&n>0)for(let t=0;t<e;t++){const e=s[t];if("max"==e.policy){const s=_(n*(e.flex/r));n-=s,i.row_heights[t]=s,r-=e.flex}}else if(n<0){let t=0;for(let i=0;i<e;i++)"fixed"!=s[i].policy&&t++;let o=-n;for(let n=0;n<e;n++)if("fixed"!=s[n].policy){const e=i.row_heights[n],s=_(o/t);i.row_heights[n]=h(e-s,0),o-=s>e?e:s,t--}}},l=e=>{let s;s="fixed"==this.sizing.width_policy&&null!=this.sizing.width?this.sizing.width:t.width!=1/0&&this.is_width_expanding()?t.width:e.size.width;let o=0;for(let t=0;t<i;t++){const i=n[t];"fit"==i.policy||"max"==i.policy?o+=i.flex:s-=e.col_widths[t]}if(s-=(i-1)*r,0!=o&&s>0)for(let t=0;t<i;t++){const i=n[t];if("fit"==i.policy||"max"==i.policy){const n=_(s*(i.flex/o));s-=n,e.col_widths[t]=n,o-=i.flex}}else if(s<0){let t=0;for(let e=0;e<i;e++)"fixed"!=n[e].policy&&t++;let o=-s;for(let s=0;s<i;s++)if("fixed"!=n[s].policy){const i=e.col_widths[s],n=_(o/t);e.col_widths[s]=h(i-n,0),o-=n>i?i:n,t--}}},c=this._measure_cells(((t,e)=>{const i=s[t],o=n[e];return{width:"fixed"==o.policy?o.width:1/0,height:"fixed"==i.policy?i.height:1/0}}));a(c),l(c);const d=this._measure_cells(((t,e)=>({width:c.col_widths[e],height:c.row_heights[t]})));a(d),l(d);const{row_heights:u,col_widths:p}=d;return{size:this._measure_totals(u,p),row_heights:u,col_widths:p}}_measure(t){const{size:e}=this._measure_grid(t);return e}_set_geometry(t,e){super._set_geometry(t,e);const{nrows:i,ncols:s,rspacing:n,cspacing:o}=this._state,{row_heights:r,col_widths:a}=this._measure_grid(t),{size_hints:c}=this._measure_cells(((t,e)=>({width:a[e],height:r[t]}))),u=this._state.rows.map(((t,e)=>Object.assign(Object.assign({},t),{top:0,height:r[e],get bottom(){return this.top+this.height}}))),p=this._state.cols.map(((t,e)=>Object.assign(Object.assign({},t),{left:0,width:a[e],get right(){return this.left+this.width}}))),m=c.map(((t,e)=>Object.assign(Object.assign({},e),{outer:new l.BBox,inner:new l.BBox})));for(let l=0,h=this.absolute?t.top:0;l<i;l++){const t=u[l];t.top=h,h+=t.height+n}for(let l=0,h=this.absolute?t.left:0;l<s;l++){const t=p[l];t.left=h,h+=t.width+o}m.foreach((({r0:t,c0:e,r1:i,c1:s},r)=>{const{layout:a,size_hint:c}=r,{sizing:h}=a,{width:d,height:m}=c,g=function(t,e){let i=(e-t)*o;for(let s=t;s<=e;s++)i+=p[s].width;return i}(e,s),f=function(t,e){let i=(e-t)*n;for(let s=t;s<=e;s++)i+=u[s].height;return i}(t,i),b=e==s&&"auto"!=p[e].align?p[e].align:h.halign,v=t==i&&"auto"!=u[t].align?u[t].align:h.valign;let y=p[e].left;"start"==b?y+=h.margin.left:"center"==b?y+=_((g-d)/2):"end"==b&&(y+=g-h.margin.right-d);let x=u[t].top;"start"==v?x+=h.margin.top:"center"==v?x+=_((f-m)/2):"end"==v&&(x+=f-h.margin.bottom-m),r.outer=new l.BBox({left:y,top:x,width:d,height:m})}));const g=u.map((()=>({start:new d((()=>0)),end:new d((()=>0))}))),f=p.map((()=>({start:new d((()=>0)),end:new d((()=>0))})));m.foreach((({r0:t,c0:e,r1:i,c1:s},{size_hint:n,outer:o})=>{const{inner:r}=n;null!=r&&(g[t].start.apply(o.top,(t=>h(t,r.top))),g[i].end.apply(u[i].bottom-o.bottom,(t=>h(t,r.bottom))),f[e].start.apply(o.left,(t=>h(t,r.left))),f[s].end.apply(p[s].right-o.right,(t=>h(t,r.right))))})),m.foreach((({r0:t,c0:e,r1:i,c1:s},n)=>{const{size_hint:o,outer:r}=n,a=t=>{const e=this.absolute?r:r.relative(),i=e.left+t.left,s=e.top+t.top,n=e.right-t.right,o=e.bottom-t.bottom;return new l.BBox({left:i,top:s,right:n,bottom:o})};if(null!=o.inner){let l=a(o.inner);if(!1!==o.align){const n=g[t].start.get(r.top),o=g[i].end.get(u[i].bottom-r.bottom),c=f[e].start.get(r.left),h=f[s].end.get(p[s].right-r.right);try{l=a({top:n,bottom:o,left:c,right:h})}catch(t){}}n.inner=l}else n.inner=r})),m.foreach(((t,{layout:e,outer:i,inner:s})=>{e.set_geometry(i,s)}))}}i.Grid=p,p.__name__="Grid";class m extends p{constructor(t){super(),this.items=t.map(((t,e)=>({layout:t,row:0,col:e}))),this.rows="fit"}}i.Row=m,m.__name__="Row";class g extends p{constructor(t){super(),this.items=t.map(((t,e)=>({layout:t,row:e,col:0}))),this.cols="fit"}}i.Column=g,g.__name__="Column"},function(t,e,i,s,n){s();const o=t(142),r=t(141),a=t(43);class l extends o.ContentLayoutable{constructor(t){super(),this.content_size=a.unsized(t,(()=>new r.Sizeable(a.size(t))))}_content_size(){return this.content_size}}i.ContentBox=l,l.__name__="ContentBox";class c extends o.Layoutable{constructor(t){super(),this.el=t}_measure(t){const e=new r.Sizeable(t).bounded_to(this.sizing.size);return a.sized(this.el,e,(()=>{const t=new r.Sizeable(a.content_size(this.el)),{border:e,padding:i}=a.extents(this.el);return t.grow_by(e).grow_by(i).map(Math.ceil)}))}}i.VariadicBox=c,c.__name__="VariadicBox";class h extends c{constructor(t){super(t),this._cache=new Map}_measure(t){const{width:e,height:i}=t,s=`${e},${i}`;let n=this._cache.get(s);return null==n&&(n=super._measure(t),this._cache.set(s,n)),n}invalidate_cache(){this._cache.clear()}}i.CachedVariadicBox=h,h.__name__="CachedVariadicBox"},function(t,e,i,s,n){s();const o=t(141),r=t(142),a=t(99);class l extends r.Layoutable{constructor(){super(...arguments),this.min_border={left:0,top:0,right:0,bottom:0},this.padding={left:0,top:0,right:0,bottom:0}}*[Symbol.iterator](){yield this.top_panel,yield this.bottom_panel,yield this.left_panel,yield this.right_panel,yield this.center_panel}_measure(t){t=new o.Sizeable({width:"fixed"==this.sizing.width_policy||t.width==1/0?this.sizing.width:t.width,height:"fixed"==this.sizing.height_policy||t.height==1/0?this.sizing.height:t.height});const e=this.left_panel.measure({width:0,height:t.height}),i=Math.max(e.width,this.min_border.left)+this.padding.left,s=this.right_panel.measure({width:0,height:t.height}),n=Math.max(s.width,this.min_border.right)+this.padding.right,r=this.top_panel.measure({width:t.width,height:0}),a=Math.max(r.height,this.min_border.top)+this.padding.top,l=this.bottom_panel.measure({width:t.width,height:0}),c=Math.max(l.height,this.min_border.bottom)+this.padding.bottom,h=new o.Sizeable(t).shrink_by({left:i,right:n,top:a,bottom:c}),_=this.center_panel.measure(h);return{width:i+_.width+n,height:a+_.height+c,inner:{left:i,right:n,top:a,bottom:c},align:(()=>{const{width_policy:t,height_policy:e}=this.center_panel.sizing;return"fixed"!=t&&"fixed"!=e})()}}_set_geometry(t,e){super._set_geometry(t,e),this.center_panel.set_geometry(e);const i=this.left_panel.measure({width:0,height:t.height}),s=this.right_panel.measure({width:0,height:t.height}),n=this.top_panel.measure({width:t.width,height:0}),o=this.bottom_panel.measure({width:t.width,height:0}),{left:r,top:l,right:c,bottom:h}=e;this.top_panel.set_geometry(new a.BBox({left:r,right:c,bottom:l,height:n.height})),this.bottom_panel.set_geometry(new a.BBox({left:r,right:c,top:h,height:o.height})),this.left_panel.set_geometry(new a.BBox({top:l,bottom:h,right:r,width:i.width})),this.right_panel.set_geometry(new a.BBox({top:l,bottom:h,left:c,width:s.width}))}}i.BorderLayout=l,l.__name__="BorderLayout"},function(t,e,i,s,n){s();const o=t(1),r=t(139),a=t(10),l=t(143),c=t(20),h=o.__importStar(t(48));class _ extends r.TextAnnotationView{_get_size(){const{ctx:t}=this.layer;this.visuals.text.set_value(t);const{width:e}=t.measureText(this.model.text),{height:i}=l.font_metrics(t.font);return{width:e,height:i}}_render(){const{angle:t,angle_units:e}=this.model,i=a.resolve_angle(t,e),s=null!=this.layout?this.layout:this.plot_view.frame,n=this.coordinates.x_scale,o=this.coordinates.y_scale;let r="data"==this.model.x_units?n.compute(this.model.x):s.bbox.xview.compute(this.model.x),l="data"==this.model.y_units?o.compute(this.model.y):s.bbox.yview.compute(this.model.y);r+=this.model.x_offset,l-=this.model.y_offset,("canvas"==this.model.render_mode?this._canvas_text.bind(this):this._css_text.bind(this))(this.layer.ctx,this.model.text,r,l,i)}}i.LabelView=_,_.__name__="LabelView";class d extends r.TextAnnotation{constructor(t){super(t)}static init_Label(){this.prototype.default_view=_,this.mixins([h.Text,["border_",h.Line],["background_",h.Fill]]),this.define((({Number:t,String:e,Angle:i})=>({x:[t],x_units:[c.SpatialUnits,"data"],y:[t],y_units:[c.SpatialUnits,"data"],text:[e,""],angle:[i,0],angle_units:[c.AngleUnits,"rad"],x_offset:[t,0],y_offset:[t,0]}))),this.override({background_fill_color:null,border_line_color:null})}}i.Label=d,d.__name__="Label",d.init_Label()},function(t,e,i,s,n){s();const o=t(1),r=t(139),a=t(56),l=t(130),c=o.__importStar(t(48)),h=t(20),_=t(43),d=o.__importStar(t(18)),u=t(143);class p extends r.TextAnnotationView{set_data(t){a.DataAnnotationView.prototype.set_data.call(this,t)}initialize(){if(super.initialize(),this.set_data(this.model.source),"css"==this.model.render_mode)for(let t=0,e=this.text.length;t<e;t++){const t=_.div({style:{display:"none"}});this.el.appendChild(t)}}connect_signals(){super.connect_signals();const t=()=>{this.set_data(this.model.source),"css"==this.model.render_mode?this.render():this.request_render()};this.connect(this.model.change,t),this.connect(this.model.source.streaming,t),this.connect(this.model.source.patching,t),this.connect(this.model.source.change,t)}_calculate_text_dimensions(t,e){const{width:i}=t.measureText(e),{height:s}=u.font_metrics(this.visuals.text.font_value(0));return[i,s]}_map_data(){const t=this.coordinates.x_scale,e=this.coordinates.y_scale,i=null!=this.layout?this.layout:this.plot_view.frame;return["data"==this.model.x_units?t.v_compute(this._x):i.bbox.xview.v_compute(this._x),"data"==this.model.y_units?e.v_compute(this._y):i.bbox.yview.v_compute(this._y)]}_render(){const t="canvas"==this.model.render_mode?this._v_canvas_text.bind(this):this._v_css_text.bind(this),{ctx:e}=this.layer,[i,s]=this._map_data();for(let n=0,o=this.text.length;n<o;n++)t(e,n,this.text.get(n),i[n]+this.x_offset.get(n),s[n]-this.y_offset.get(n),this.angle.get(n))}_get_size(){const{ctx:t}=this.layer;this.visuals.text.set_vectorize(t,0);const{width:e}=t.measureText(this.text.get(0)),{height:i}=u.font_metrics(t.font);return{width:e,height:i}}_v_canvas_text(t,e,i,s,n,o){this.visuals.text.set_vectorize(t,e);const r=this._calculate_bounding_box_dimensions(t,i);t.save(),t.beginPath(),t.translate(s,n),t.rotate(o),t.rect(r[0],r[1],r[2],r[3]),this.visuals.background_fill.doit&&(this.visuals.background_fill.set_vectorize(t,e),t.fill()),this.visuals.border_line.doit&&(this.visuals.border_line.set_vectorize(t,e),t.stroke()),this.visuals.text.doit&&(this.visuals.text.set_vectorize(t,e),t.fillText(i,0,0)),t.restore()}_v_css_text(t,e,i,s,n,o){const r=this.el.children[e];r.textContent=i,this.visuals.text.set_vectorize(t,e);const[a,l]=this._calculate_bounding_box_dimensions(t,i);r.style.position="absolute",r.style.left=`${s+a}px`,r.style.top=`${n+l}px`,r.style.color=t.fillStyle,r.style.font=t.font,r.style.lineHeight="normal",o&&(r.style.transform=`rotate(${o}rad)`),this.visuals.background_fill.doit&&(this.visuals.background_fill.set_vectorize(t,e),r.style.backgroundColor=t.fillStyle),this.visuals.border_line.doit&&(this.visuals.border_line.set_vectorize(t,e),r.style.borderStyle=t.lineDash.length<2?"solid":"dashed",r.style.borderWidth=`${t.lineWidth}px`,r.style.borderColor=t.strokeStyle),_.display(r)}}i.LabelSetView=p,p.__name__="LabelSetView";class m extends r.TextAnnotation{constructor(t){super(t)}static init_LabelSet(){this.prototype.default_view=p,this.mixins([c.TextVector,["border_",c.LineVector],["background_",c.FillVector]]),this.define((({Ref:t})=>({x:[d.XCoordinateSpec,{field:"x"}],y:[d.YCoordinateSpec,{field:"y"}],x_units:[h.SpatialUnits,"data"],y_units:[h.SpatialUnits,"data"],text:[d.StringSpec,{field:"text"}],angle:[d.AngleSpec,0],x_offset:[d.NumberSpec,{value:0}],y_offset:[d.NumberSpec,{value:0}],source:[t(l.ColumnDataSource),()=>new l.ColumnDataSource]}))),this.override({background_fill_color:null,border_line_color:null})}}i.LabelSet=m,m.__name__="LabelSet",m.init_LabelSet()},function(t,e,i,s,n){s();const o=t(1),r=t(40),a=t(229),l=t(20),c=o.__importStar(t(48)),h=t(15),_=t(140),d=t(143),u=t(99),p=t(9),m=t(8),g=t(11);class f extends r.AnnotationView{update_layout(){const{panel:t}=this;this.layout=null!=t?new _.SideLayout(t,(()=>this.get_size())):void 0}cursor(t,e){return"none"==this.model.click_policy?null:"pointer"}get legend_padding(){return null!=this.model.border_line_color?this.model.padding:0}connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>this.request_render())),this.connect(this.model.item_change,(()=>this.request_render()))}compute_legend_bbox(){const t=this.model.get_legend_names(),{glyph_height:e,glyph_width:i}=this.model,{label_height:s,label_width:n}=this.model;this.max_label_height=p.max([d.font_metrics(this.visuals.label_text.font_value()).height,s,e]);const{ctx:o}=this.layer;o.save(),this.visuals.label_text.set_value(o),this.text_widths=new Map;for(const d of t)this.text_widths.set(d,p.max([o.measureText(d).width,n]));this.visuals.title_text.set_value(o),this.title_height=this.model.title?d.font_metrics(this.visuals.title_text.font_value()).height+this.model.title_standoff:0,this.title_width=this.model.title?o.measureText(this.model.title).width:0,o.restore();const r=Math.max(p.max([...this.text_widths.values()]),0),a=this.model.margin,{legend_padding:l}=this,c=this.model.spacing,{label_standoff:h}=this.model;let _,f;if("vertical"==this.model.orientation)_=t.length*this.max_label_height+Math.max(t.length-1,0)*c+2*l+this.title_height,f=p.max([r+i+h+2*l,this.title_width+2*l]);else{let e=2*l+Math.max(t.length-1,0)*c;for(const[,t]of this.text_widths)e+=p.max([t,n])+i+h;f=p.max([this.title_width+2*l,e]),_=this.max_label_height+this.title_height+2*l}const b=null!=this.layout?this.layout:this.plot_view.frame,[v,y]=b.bbox.ranges,{location:x}=this.model;let w,A;if(m.isString(x))switch(x){case"top_left":w=v.start+a,A=y.start+a;break;case"top":case"top_center":w=(v.end+v.start)/2-f/2,A=y.start+a;break;case"top_right":w=v.end-a-f,A=y.start+a;break;case"bottom_right":w=v.end-a-f,A=y.end-a-_;break;case"bottom":case"bottom_center":w=(v.end+v.start)/2-f/2,A=y.end-a-_;break;case"bottom_left":w=v.start+a,A=y.end-a-_;break;case"left":case"center_left":w=v.start+a,A=(y.end+y.start)/2-_/2;break;case"center":case"center_center":w=(v.end+v.start)/2-f/2,A=(y.end+y.start)/2-_/2;break;case"right":case"center_right":w=v.end-a-f,A=(y.end+y.start)/2-_/2}else if(m.isArray(x)&&2==x.length){const[t,e]=x;w=b.bbox.xview.compute(t),A=b.bbox.yview.compute(e)-_}else g.unreachable();return new u.BBox({left:w,top:A,width:f,height:_})}interactive_bbox(){return this.compute_legend_bbox()}interactive_hit(t,e){return this.interactive_bbox().contains(t,e)}on_hit(t,e){let i;const{glyph_width:s}=this.model,{legend_padding:n}=this,o=this.model.spacing,{label_standoff:r}=this.model;let a=i=n;const l=this.compute_legend_bbox(),c="vertical"==this.model.orientation;for(const h of this.model.items){const _=h.get_labels_list_from_label_prop();for(const d of _){const _=l.x+a,p=l.y+i+this.title_height;let m,g;if([m,g]=c?[l.width-2*n,this.max_label_height]:[this.text_widths.get(d)+s+r,this.max_label_height],new u.BBox({left:_,top:p,width:m,height:g}).contains(t,e)){switch(this.model.click_policy){case"hide":for(const t of h.renderers)t.visible=!t.visible;break;case"mute":for(const t of h.renderers)t.muted=!t.muted}return!0}c?i+=this.max_label_height+o:a+=this.text_widths.get(d)+s+r+o}}return!1}_render(){if(0==this.model.items.length)return;for(const i of this.model.items)i.legend=this.model;const{ctx:t}=this.layer,e=this.compute_legend_bbox();t.save(),this._draw_legend_box(t,e),this._draw_legend_items(t,e),this._draw_title(t,e),t.restore()}_draw_legend_box(t,e){t.beginPath(),t.rect(e.x,e.y,e.width,e.height),this.visuals.background_fill.set_value(t),t.fill(),this.visuals.border_line.doit&&(this.visuals.border_line.set_value(t),t.stroke())}_draw_legend_items(t,e){const{glyph_width:i,glyph_height:s}=this.model,{legend_padding:n}=this,o=this.model.spacing,{label_standoff:r}=this.model;let a=n,l=n;const c="vertical"==this.model.orientation;for(const h of this.model.items){const _=h.get_labels_list_from_label_prop(),d=h.get_field_from_label_prop();if(0==_.length)continue;const u=(()=>{switch(this.model.click_policy){case"none":return!0;case"hide":return p.every(h.renderers,(t=>t.visible));case"mute":return p.every(h.renderers,(t=>!t.muted))}})();for(const p of _){const _=e.x+a,m=e.y+l+this.title_height,g=_+i,f=m+s;c?l+=this.max_label_height+o:a+=this.text_widths.get(p)+i+r+o,this.visuals.label_text.set_value(t),t.fillText(p,g+r,m+this.max_label_height/2);for(const e of h.renderers){const i=this.plot_view.renderer_view(e);null==i||i.draw_legend(t,_,g,m,f,d,p,h.index)}if(!u){let s,o;[s,o]=c?[e.width-2*n,this.max_label_height]:[this.text_widths.get(p)+i+r,this.max_label_height],t.beginPath(),t.rect(_,m,s,o),this.visuals.inactive_fill.set_value(t),t.fill()}}}}_draw_title(t,e){const{title:i}=this.model;i&&this.visuals.title_text.doit&&(t.save(),t.translate(e.x0,e.y0+this.title_height),this.visuals.title_text.set_value(t),t.fillText(i,this.legend_padding,this.legend_padding-this.model.title_standoff),t.restore())}_get_size(){const{width:t,height:e}=this.compute_legend_bbox();return{width:t+2*this.model.margin,height:e+2*this.model.margin}}}i.LegendView=f,f.__name__="LegendView";class b extends r.Annotation{constructor(t){super(t)}initialize(){super.initialize(),this.item_change=new h.Signal0(this,"item_change")}static init_Legend(){this.prototype.default_view=f,this.mixins([["label_",c.Text],["title_",c.Text],["inactive_",c.Fill],["border_",c.Line],["background_",c.Fill]]),this.define((({Number:t,String:e,Array:i,Tuple:s,Or:n,Ref:o,Nullable:r})=>({orientation:[l.Orientation,"vertical"],location:[n(l.LegendLocation,s(t,t)),"top_right"],title:[r(e),null],title_standoff:[t,5],label_standoff:[t,5],glyph_height:[t,20],glyph_width:[t,20],label_height:[t,20],label_width:[t,20],margin:[t,10],padding:[t,10],spacing:[t,3],items:[i(o(a.LegendItem)),[]],click_policy:[l.LegendClickPolicy,"none"]}))),this.override({border_line_color:"#e5e5e5",border_line_alpha:.5,border_line_width:1,background_fill_color:"#ffffff",background_fill_alpha:.95,inactive_fill_color:"white",inactive_fill_alpha:.7,label_text_font_size:"13px",label_text_baseline:"middle",title_text_font_size:"13px",title_text_font_style:"italic"})}get_legend_names(){const t=[];for(const e of this.items){const i=e.get_labels_list_from_label_prop();t.push(...i)}return t}}i.Legend=b,b.__name__="Legend",b.init_Legend()},function(t,e,i,s,n){s();const o=t(1),r=t(53),a=t(61),l=t(57),c=t(230),h=o.__importStar(t(18)),_=t(19),d=t(9);class u extends r.Model{constructor(t){super(t)}static init_LegendItem(){this.define((({Int:t,Array:e,Ref:i,Nullable:s})=>({label:[h.NullStringSpec,null],renderers:[e(i(a.GlyphRenderer)),[]],index:[s(t),null]})))}_check_data_sources_on_renderers(){if(null!=this.get_field_from_label_prop()){if(this.renderers.length<1)return!1;const t=this.renderers[0].data_source;if(null!=t)for(const e of this.renderers)if(e.data_source!=t)return!1}return!0}_check_field_label_on_data_source(){const t=this.get_field_from_label_prop();if(null!=t){if(this.renderers.length<1)return!1;const e=this.renderers[0].data_source;if(null!=e&&!d.includes(e.columns(),t))return!1}return!0}initialize(){super.initialize(),this.legend=null,this.connect(this.change,(()=>{var t;return null===(t=this.legend)||void 0===t?void 0:t.item_change.emit()})),this._check_data_sources_on_renderers()||_.logger.error("Non matching data sources on legend item renderers"),this._check_field_label_on_data_source()||_.logger.error(`Bad column name on label: ${this.label}`)}get_field_from_label_prop(){const{label:t}=this;return c.isField(t)?t.field:null}get_labels_list_from_label_prop(){if(c.isValue(this.label)){const{value:t}=this.label;return null!=t?[t]:[]}const t=this.get_field_from_label_prop();if(null!=t){let e;if(!this.renderers[0]||null==this.renderers[0].data_source)return["No source found"];if(e=this.renderers[0].data_source,e instanceof l.ColumnarDataSource){const i=e.get_column(t);return null!=i?d.uniq(Array.from(i)):["Invalid field"]}}return[]}}i.LegendItem=u,u.__name__="LegendItem",u.init_LegendItem()},function(t,e,i,s,n){s();const o=t(8);i.isValue=function(t){return o.isPlainObject(t)&&"value"in t},i.isField=function(t){return o.isPlainObject(t)&&"field"in t},i.isExpr=function(t){return o.isPlainObject(t)&&"expr"in t}},function(t,e,i,s,n){s();const o=t(1),r=t(40),a=o.__importStar(t(48)),l=t(20);class c extends r.AnnotationView{connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>this.request_render()))}_render(){const{xs:t,ys:e}=this.model;if(t.length!=e.length)return;const i=t.length;if(i<3)return;const{frame:s}=this.plot_view,{ctx:n}=this.layer,o=this.coordinates.x_scale,r=this.coordinates.y_scale,{screen:a}=this.model;function l(t,e,i,s){return a?t:"data"==e?i.v_compute(t):s.v_compute(t)}const c=l(t,this.model.xs_units,o,s.bbox.xview),h=l(e,this.model.ys_units,r,s.bbox.yview);n.beginPath();for(let _=0;_<i;_++)n.lineTo(c[_],h[_]);n.closePath(),this.visuals.fill.doit&&(this.visuals.fill.set_value(n),n.fill()),this.visuals.hatch.doit&&(this.visuals.hatch.set_value(n),n.fill()),this.visuals.line.doit&&(this.visuals.line.set_value(n),n.stroke())}}i.PolyAnnotationView=c,c.__name__="PolyAnnotationView";class h extends r.Annotation{constructor(t){super(t)}static init_PolyAnnotation(){this.prototype.default_view=c,this.mixins([a.Line,a.Fill,a.Hatch]),this.define((({Number:t,Array:e})=>({xs:[e(t),[]],xs_units:[l.SpatialUnits,"data"],ys:[e(t),[]],ys_units:[l.SpatialUnits,"data"]}))),this.internal((({Boolean:t})=>({screen:[t,!1]}))),this.override({fill_color:"#fff9ba",fill_alpha:.4,line_color:"#cccccc",line_alpha:.3})}update({xs:t,ys:e}){this.setv({xs:t,ys:e,screen:!0},{check_eq:!1})}}i.PolyAnnotation=h,h.__name__="PolyAnnotation",h.init_PolyAnnotation()},function(t,e,i,s,n){s();const o=t(1),r=t(40),a=o.__importStar(t(48));class l extends r.AnnotationView{connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>this.request_render()))}_render(){const{gradient:t,y_intercept:e}=this.model;if(null==t||null==e)return;const{frame:i}=this.plot_view,s=this.coordinates.x_scale,n=this.coordinates.y_scale;let o,r,a,l;if(0==t)o=n.compute(e),r=o,a=i.bbox.left,l=a+i.bbox.width;else{o=i.bbox.top,r=o+i.bbox.height;const c=(n.invert(o)-e)/t,h=(n.invert(r)-e)/t;a=s.compute(c),l=s.compute(h)}const{ctx:c}=this.layer;c.save(),c.beginPath(),this.visuals.line.set_value(c),c.moveTo(a,o),c.lineTo(l,r),c.stroke(),c.restore()}}i.SlopeView=l,l.__name__="SlopeView";class c extends r.Annotation{constructor(t){super(t)}static init_Slope(){this.prototype.default_view=l,this.mixins(a.Line),this.define((({Number:t,Nullable:e})=>({gradient:[e(t),null],y_intercept:[e(t),null]}))),this.override({line_color:"black"})}}i.Slope=c,c.__name__="Slope",c.init_Slope()},function(t,e,i,s,n){s();const o=t(1),r=t(40),a=o.__importStar(t(48)),l=t(20);class c extends r.AnnotationView{connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>this.plot_view.request_paint(this)))}_render(){const{location:t}=this.model;if(null==t)return;const{frame:e}=this.plot_view,i=this.coordinates.x_scale,s=this.coordinates.y_scale,n=(e,i)=>"data"==this.model.location_units?e.compute(t):this.model.for_hover?t:i.compute(t);let o,r,a,l;"width"==this.model.dimension?(a=n(s,e.bbox.yview),r=e.bbox.left,l=e.bbox.width,o=this.model.line_width):(a=e.bbox.top,r=n(i,e.bbox.xview),l=this.model.line_width,o=e.bbox.height);const{ctx:c}=this.layer;c.save(),c.beginPath(),this.visuals.line.set_value(c),c.moveTo(r,a),"width"==this.model.dimension?c.lineTo(r+l,a):c.lineTo(r,a+o),c.stroke(),c.restore()}}i.SpanView=c,c.__name__="SpanView";class h extends r.Annotation{constructor(t){super(t)}static init_Span(){this.prototype.default_view=c,this.mixins(a.Line),this.define((({Number:t,Nullable:e})=>({render_mode:[l.RenderMode,"canvas"],location:[e(t),null],location_units:[l.SpatialUnits,"data"],dimension:[l.Dimension,"width"]}))),this.internal((({Boolean:t})=>({for_hover:[t,!1]}))),this.override({line_color:"black"})}}i.Span=h,h.__name__="Span",h.init_Span()},function(t,e,i,s,n){s();const o=t(40),r=t(235),a=t(122),l=t(43),c=t(140),h=t(99);class _ extends o.AnnotationView{constructor(){super(...arguments),this._invalidate_toolbar=!0,this._previous_bbox=new h.BBox}update_layout(){this.layout=new c.SideLayout(this.panel,(()=>this.get_size()),!0)}initialize(){super.initialize(),this.el=l.div(),this.plot_view.canvas_view.add_event(this.el)}async lazy_initialize(){await super.lazy_initialize(),this._toolbar_view=await a.build_view(this.model.toolbar,{parent:this}),this.plot_view.visibility_callbacks.push((t=>this._toolbar_view.set_visibility(t)))}remove(){this._toolbar_view.remove(),l.remove(this.el),super.remove()}render(){this.model.visible||l.undisplay(this.el),super.render()}_render(){const{bbox:t}=this.layout;this._previous_bbox.equals(t)||(l.position(this.el,t),this._previous_bbox=t),this._invalidate_toolbar&&(this.el.style.position="absolute",this.el.style.overflow="hidden",this._toolbar_view.render(),l.empty(this.el),this.el.appendChild(this._toolbar_view.el),this._invalidate_toolbar=!1),l.display(this.el)}_get_size(){const{tools:t,logo:e}=this.model.toolbar;return{width:30*t.length+(null!=e?25:0),height:30}}}i.ToolbarPanelView=_,_.__name__="ToolbarPanelView";class d extends o.Annotation{constructor(t){super(t)}static init_ToolbarPanel(){this.prototype.default_view=_,this.define((({Ref:t})=>({toolbar:[t(r.Toolbar)]})))}}i.ToolbarPanel=d,d.__name__="ToolbarPanel",d.init_ToolbarPanel()},function(t,e,i,s,n){s();const o=t(8),r=t(9),a=t(13),l=t(236),c=t(237),h=t(247),_=t(248);i.Drag=l.Tool,i.Inspection=l.Tool,i.Scroll=l.Tool,i.Tap=l.Tool;const d=t=>{switch(t){case"tap":return"active_tap";case"pan":return"active_drag";case"pinch":case"scroll":return"active_scroll";case"multi":return"active_multi"}return null},u=t=>"tap"==t||"pan"==t;class p extends _.ToolbarBase{constructor(t){super(t)}static init_Toolbar(){this.prototype.default_view=_.ToolbarBaseView,this.define((({Or:t,Ref:e,Auto:s,Null:n,Nullable:o})=>({active_drag:[t(e(i.Drag),s,n),"auto"],active_inspect:[t(e(i.Inspection),s,n),"auto"],active_scroll:[t(e(i.Scroll),s,n),"auto"],active_tap:[t(e(i.Tap),s,n),"auto"],active_multi:[o(e(c.GestureTool)),null]})))}connect_signals(){super.connect_signals();const{tools:t,active_drag:e,active_inspect:i,active_scroll:s,active_tap:n,active_multi:o}=this.properties;this.on_change([t,e,i,s,n,o],(()=>this._init_tools()))}_init_tools(){if(super._init_tools(),"auto"==this.active_inspect);else if(this.active_inspect instanceof h.InspectTool){let t=!1;for(const e of this.inspectors)e!=this.active_inspect?e.active=!1:t=!0;t||(this.active_inspect=null)}else if(o.isArray(this.active_inspect)){const t=r.intersection(this.active_inspect,this.inspectors);t.length!=this.active_inspect.length&&(this.active_inspect=t);for(const e of this.inspectors)r.includes(this.active_inspect,e)||(e.active=!1)}else if(null==this.active_inspect)for(const e of this.inspectors)e.active=!1;const t=t=>{t.active?this._active_change(t):t.active=!0};for(const e of a.values(this.gestures)){e.tools=r.sort_by(e.tools,(t=>t.default_order));for(const t of e.tools)this.connect(t.properties.active.change,(()=>this._active_change(t)))}for(const[e,i]of a.entries(this.gestures)){const s=d(e);if(s){const n=this[s];"auto"==n?0!=i.tools.length&&u(e)&&t(i.tools[0]):null!=n&&(r.includes(this.tools,n)?t(n):this[s]=null)}}}}i.Toolbar=p,p.__name__="Toolbar",p.init_Toolbar()},function(t,e,i,s,n){s();const o=t(42),r=t(9),a=t(53);class l extends o.View{get plot_view(){return this.parent}get plot_model(){return this.parent.model}connect_signals(){super.connect_signals(),this.connect(this.model.properties.active.change,(()=>{this.model.active?this.activate():this.deactivate()}))}activate(){}deactivate(){}}i.ToolView=l,l.__name__="ToolView";class c extends a.Model{constructor(t){super(t)}static init_Tool(){this.prototype._known_aliases=new Map,this.define((({String:t,Nullable:e})=>({description:[e(t),null]}))),this.internal((({Boolean:t})=>({active:[t,!1]})))}get synthetic_renderers(){return[]}_get_dim_limits([t,e],[i,s],n,o){const a=n.bbox.h_range;let l;"width"==o||"both"==o?(l=[r.min([t,i]),r.max([t,i])],l=[r.max([l[0],a.start]),r.min([l[1],a.end])]):l=[a.start,a.end];const c=n.bbox.v_range;let h;return"height"==o||"both"==o?(h=[r.min([e,s]),r.max([e,s])],h=[r.max([h[0],c.start]),r.min([h[1],c.end])]):h=[c.start,c.end],[l,h]}static register_alias(t,e){this.prototype._known_aliases.set(t,e)}static from_string(t){const e=this.prototype._known_aliases.get(t);if(null!=e)return e();{const e=[...this.prototype._known_aliases.keys()];throw new Error(`unexpected tool name '${t}', possible tools are ${e.join(", ")}`)}}}i.Tool=c,c.__name__="Tool",c.init_Tool()},function(t,e,i,s,n){s();const o=t(238),r=t(246);class a extends o.ButtonToolView{}i.GestureToolView=a,a.__name__="GestureToolView";class l extends o.ButtonTool{constructor(t){super(t),this.button_view=r.OnOffButtonView}}i.GestureTool=l,l.__name__="GestureTool"},function(t,e,i,s,n){s();const o=t(1),r=o.__importDefault(t(239)),a=t(240),l=t(236),c=t(43),h=t(34),_=t(8),d=t(9),u=o.__importStar(t(241)),p=u,m=o.__importDefault(t(242)),g=o.__importDefault(t(243)),f=t(244);class b extends a.DOMView{initialize(){super.initialize();const t=this.model.menu;if(null!=t){const e=this.parent.model.toolbar_location,i="left"==e||"above"==e,s=this.parent.model.horizontal?"vertical":"horizontal";this._menu=new f.ContextMenu(i?d.reversed(t):t,{orientation:s,prevent_hide:t=>t.target==this.el})}this._hammer=new r.default(this.el,{touchAction:"auto",inputClass:r.default.TouchMouseInput}),this.connect(this.model.change,(()=>this.render())),this._hammer.on("tap",(t=>{var e;(null===(e=this._menu)||void 0===e?void 0:e.is_open)?this._menu.hide():t.target==this.el&&this._clicked()})),this._hammer.on("press",(()=>this._pressed()))}remove(){var t;this._hammer.destroy(),null===(t=this._menu)||void 0===t||t.remove(),super.remove()}styles(){return[...super.styles(),u.default,m.default,g.default]}css_classes(){return super.css_classes().concat(p.toolbar_button)}render(){c.empty(this.el);const t=this.model.computed_icon;_.isString(t)&&(h.startsWith(t,"data:image")?this.el.style.backgroundImage="url('"+t+"')":this.el.classList.add(t)),this.el.title=this.model.tooltip,null!=this._menu&&this.root.el.appendChild(this._menu.el)}_pressed(){var t;const{left:e,top:i,right:s,bottom:n}=this.el.getBoundingClientRect(),o=(()=>{switch(this.parent.model.toolbar_location){case"right":return{right:e,top:i};case"left":return{left:s,top:i};case"above":return{left:e,top:n};case"below":return{left:e,bottom:i}}})();null===(t=this._menu)||void 0===t||t.toggle(o)}}i.ButtonToolButtonView=b,b.__name__="ButtonToolButtonView";class v extends l.ToolView{}i.ButtonToolView=v,v.__name__="ButtonToolView";class y extends l.Tool{constructor(t){super(t)}static init_ButtonTool(){this.internal((({Boolean:t})=>({disabled:[t,!1]})))}_get_dim_tooltip(t){const{description:e,tool_name:i}=this;return null!=e?e:"both"==t?i:`${i} (${"width"==t?"x":"y"}-axis)`}get tooltip(){var t;return null!==(t=this.description)&&void 0!==t?t:this.tool_name}get computed_icon(){return this.icon}get menu(){return null}}i.ButtonTool=y,y.__name__="ButtonTool",y.init_ButtonTool()},function(e,i,s,n,o){
/*! Hammer.JS - v2.0.7 - 2016-04-22
     * http://hammerjs.github.io/
     *
     * Copyright (c) 2016 Jorik Tangelder;
     * Licensed under the MIT license */
!function(e,s,n,o){"use strict";var r,a=["","webkit","Moz","MS","ms","o"],l=s.createElement("div"),c=Math.round,h=Math.abs,_=Date.now;function d(t,e,i){return setTimeout(v(t,i),e)}function u(t,e,i){return!!Array.isArray(t)&&(p(t,i[e],i),!0)}function p(t,e,i){var s;if(t)if(t.forEach)t.forEach(e,i);else if(t.length!==o)for(s=0;s<t.length;)e.call(i,t[s],s,t),s++;else for(s in t)t.hasOwnProperty(s)&&e.call(i,t[s],s,t)}function m(t,i,s){var n="DEPRECATED METHOD: "+i+"\n"+s+" AT \n";return function(){var i=new Error("get-stack-trace"),s=i&&i.stack?i.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=e.console&&(e.console.warn||e.console.log);return o&&o.call(e.console,n,s),t.apply(this,arguments)}}r="function"!=typeof Object.assign?function(t){if(t===o||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var s=arguments[i];if(s!==o&&null!==s)for(var n in s)s.hasOwnProperty(n)&&(e[n]=s[n])}return e}:Object.assign;var g=m((function(t,e,i){for(var s=Object.keys(e),n=0;n<s.length;)(!i||i&&t[s[n]]===o)&&(t[s[n]]=e[s[n]]),n++;return t}),"extend","Use `assign`."),f=m((function(t,e){return g(t,e,!0)}),"merge","Use `assign`.");function b(t,e,i){var s,n=e.prototype;(s=t.prototype=Object.create(n)).constructor=t,s._super=n,i&&r(s,i)}function v(t,e){return function(){return t.apply(e,arguments)}}function y(t,e){return"function"==typeof t?t.apply(e&&e[0]||o,e):t}function x(t,e){return t===o?e:t}function w(t,e,i){p(T(e),(function(e){t.addEventListener(e,i,!1)}))}function A(t,e,i){p(T(e),(function(e){t.removeEventListener(e,i,!1)}))}function k(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function S(t,e){return t.indexOf(e)>-1}function T(t){return t.trim().split(/\s+/g)}function C(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var s=0;s<t.length;){if(i&&t[s][i]==e||!i&&t[s]===e)return s;s++}return-1}function M(t){return Array.prototype.slice.call(t,0)}function E(t,e,i){for(var s=[],n=[],o=0;o<t.length;){var r=e?t[o][e]:t[o];C(n,r)<0&&s.push(t[o]),n[o]=r,o++}return i&&(s=e?s.sort((function(t,i){return t[e]>i[e]})):s.sort()),s}function z(t,e){for(var i,s,n=e[0].toUpperCase()+e.slice(1),r=0;r<a.length;){if((s=(i=a[r])?i+n:e)in t)return s;r++}return o}var R=1;function B(t){var i=t.ownerDocument||t;return i.defaultView||i.parentWindow||e}var P="ontouchstart"in e,N=z(e,"PointerEvent")!==o,I=P&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),D="touch",O="mouse",L=24,V=["x","y"],j=["clientX","clientY"];function U(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){y(t.options.enable,[t])&&i.handler(e)},this.init()}function F(t,e,i){var s=i.pointers.length,n=i.changedPointers.length,r=1&e&&s-n==0,a=12&e&&s-n==0;i.isFirst=!!r,i.isFinal=!!a,r&&(t.session={}),i.eventType=e,function(t,e){var i=t.session,s=e.pointers,n=s.length;i.firstInput||(i.firstInput=G(e)),n>1&&!i.firstMultiple?i.firstMultiple=G(e):1===n&&(i.firstMultiple=!1);var r=i.firstInput,a=i.firstMultiple,l=a?a.center:r.center,c=e.center=H(s);e.timeStamp=_(),e.deltaTime=e.timeStamp-r.timeStamp,e.angle=W(l,c),e.distance=J(l,c),function(t,e){var i=e.center,s=t.offsetDelta||{},n=t.prevDelta||{},o=t.prevInput||{};1!==e.eventType&&4!==o.eventType||(n=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},s=t.offsetDelta={x:i.x,y:i.y}),e.deltaX=n.x+(i.x-s.x),e.deltaY=n.y+(i.y-s.y)}(i,e),e.offsetDirection=Y(e.deltaX,e.deltaY);var d,u,p=q(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=p.x,e.overallVelocityY=p.y,e.overallVelocity=h(p.x)>h(p.y)?p.x:p.y,e.scale=a?(d=a.pointers,u=s,J(u[0],u[1],j)/J(d[0],d[1],j)):1,e.rotation=a?function(t,e){return W(e[1],e[0],j)+W(t[1],t[0],j)}(a.pointers,s):0,e.maxPointers=i.prevInput?e.pointers.length>i.prevInput.maxPointers?e.pointers.length:i.prevInput.maxPointers:e.pointers.length,function(t,e){var i,s,n,r,a=t.lastInterval||e,l=e.timeStamp-a.timeStamp;if(8!=e.eventType&&(l>25||a.velocity===o)){var c=e.deltaX-a.deltaX,_=e.deltaY-a.deltaY,d=q(l,c,_);s=d.x,n=d.y,i=h(d.x)>h(d.y)?d.x:d.y,r=Y(c,_),t.lastInterval=e}else i=a.velocity,s=a.velocityX,n=a.velocityY,r=a.direction;e.velocity=i,e.velocityX=s,e.velocityY=n,e.direction=r}(i,e);var m=t.element;k(e.srcEvent.target,m)&&(m=e.srcEvent.target),e.target=m}(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function G(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:c(t.pointers[i].clientX),clientY:c(t.pointers[i].clientY)},i++;return{timeStamp:_(),pointers:e,center:H(e),deltaX:t.deltaX,deltaY:t.deltaY}}function H(t){var e=t.length;if(1===e)return{x:c(t[0].clientX),y:c(t[0].clientY)};for(var i=0,s=0,n=0;n<e;)i+=t[n].clientX,s+=t[n].clientY,n++;return{x:c(i/e),y:c(s/e)}}function q(t,e,i){return{x:e/t||0,y:i/t||0}}function Y(t,e){return t===e?1:h(t)>=h(e)?t<0?2:4:e<0?8:16}function J(t,e,i){i||(i=V);var s=e[i[0]]-t[i[0]],n=e[i[1]]-t[i[1]];return Math.sqrt(s*s+n*n)}function W(t,e,i){i||(i=V);var s=e[i[0]]-t[i[0]],n=e[i[1]]-t[i[1]];return 180*Math.atan2(n,s)/Math.PI}U.prototype={handler:function(){},init:function(){this.evEl&&w(this.element,this.evEl,this.domHandler),this.evTarget&&w(this.target,this.evTarget,this.domHandler),this.evWin&&w(B(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&A(this.element,this.evEl,this.domHandler),this.evTarget&&A(this.target,this.evTarget,this.domHandler),this.evWin&&A(B(this.element),this.evWin,this.domHandler)}};var X={mousedown:1,mousemove:2,mouseup:4},Q="mousedown",Z="mousemove mouseup";function K(){this.evEl=Q,this.evWin=Z,this.pressed=!1,U.apply(this,arguments)}b(K,U,{handler:function(t){var e=X[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:O,srcEvent:t}))}});var $={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},tt={2:D,3:"pen",4:O,5:"kinect"},et="pointerdown",it="pointermove pointerup pointercancel";function st(){this.evEl=et,this.evWin=it,U.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}e.MSPointerEvent&&!e.PointerEvent&&(et="MSPointerDown",it="MSPointerMove MSPointerUp MSPointerCancel"),b(st,U,{handler:function(t){var e=this.store,i=!1,s=t.type.toLowerCase().replace("ms",""),n=$[s],o=tt[t.pointerType]||t.pointerType,r=o==D,a=C(e,t.pointerId,"pointerId");1&n&&(0===t.button||r)?a<0&&(e.push(t),a=e.length-1):12&n&&(i=!0),a<0||(e[a]=t,this.callback(this.manager,n,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),i&&e.splice(a,1))}});var nt={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ot="touchstart",rt="touchstart touchmove touchend touchcancel";function at(){this.evTarget=ot,this.evWin=rt,this.started=!1,U.apply(this,arguments)}function lt(t,e){var i=M(t.touches),s=M(t.changedTouches);return 12&e&&(i=E(i.concat(s),"identifier",!0)),[i,s]}b(at,U,{handler:function(t){var e=nt[t.type];if(1===e&&(this.started=!0),this.started){var i=lt.call(this,t,e);12&e&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:D,srcEvent:t})}}});var ct={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ht="touchstart touchmove touchend touchcancel";function _t(){this.evTarget=ht,this.targetIds={},U.apply(this,arguments)}function dt(t,e){var i=M(t.touches),s=this.targetIds;if(3&e&&1===i.length)return s[i[0].identifier]=!0,[i,i];var n,o,r=M(t.changedTouches),a=[],l=this.target;if(o=i.filter((function(t){return k(t.target,l)})),1===e)for(n=0;n<o.length;)s[o[n].identifier]=!0,n++;for(n=0;n<r.length;)s[r[n].identifier]&&a.push(r[n]),12&e&&delete s[r[n].identifier],n++;return a.length?[E(o.concat(a),"identifier",!0),a]:void 0}function ut(){U.apply(this,arguments);var t=v(this.handler,this);this.touch=new _t(this.manager,t),this.mouse=new K(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function pt(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,mt.call(this,e)):12&t&&mt.call(this,e)}function mt(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var i={x:e.clientX,y:e.clientY};this.lastTouches.push(i);var s=this.lastTouches;setTimeout((function(){var t=s.indexOf(i);t>-1&&s.splice(t,1)}),2500)}}function gt(t){for(var e=t.srcEvent.clientX,i=t.srcEvent.clientY,s=0;s<this.lastTouches.length;s++){var n=this.lastTouches[s],o=Math.abs(e-n.x),r=Math.abs(i-n.y);if(o<=25&&r<=25)return!0}return!1}b(_t,U,{handler:function(t){var e=ct[t.type],i=dt.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:D,srcEvent:t})}}),b(ut,U,{handler:function(t,e,i){var s=i.pointerType==D,n=i.pointerType==O;if(!(n&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(s)pt.call(this,e,i);else if(n&&gt.call(this,i))return;this.callback(t,e,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ft=z(l.style,"touchAction"),bt=ft!==o,vt="compute",yt="auto",xt="manipulation",wt="none",At="pan-x",kt="pan-y",St=function(){if(!bt)return!1;var t={},i=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(s){t[s]=!i||e.CSS.supports("touch-action",s)})),t}();function Tt(t,e){this.manager=t,this.set(e)}Tt.prototype={set:function(t){t==vt&&(t=this.compute()),bt&&this.manager.element.style&&St[t]&&(this.manager.element.style[ft]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return p(this.manager.recognizers,(function(e){y(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(S(t,wt))return wt;var e=S(t,At),i=S(t,kt);return e&&i?wt:e||i?e?At:kt:S(t,xt)?xt:yt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var s=this.actions,n=S(s,wt)&&!St.none,o=S(s,kt)&&!St["pan-y"],r=S(s,At)&&!St["pan-x"];if(n){var a=1===t.pointers.length,l=t.distance<2,c=t.deltaTime<250;if(a&&l&&c)return}if(!r||!o)return n||o&&6&i||r&&i&L?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Ct=32;function Mt(t){this.options=r({},this.defaults,t||{}),this.id=R++,this.manager=null,this.options.enable=x(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Et(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function zt(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function Rt(t,e){var i=e.manager;return i?i.get(t):t}function Bt(){Mt.apply(this,arguments)}function Pt(){Bt.apply(this,arguments),this.pX=null,this.pY=null}function Nt(){Bt.apply(this,arguments)}function It(){Mt.apply(this,arguments),this._timer=null,this._input=null}function Dt(){Bt.apply(this,arguments)}function Ot(){Bt.apply(this,arguments)}function Lt(){Mt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Vt(t,e){return(e=e||{}).recognizers=x(e.recognizers,Vt.defaults.preset),new jt(t,e)}function jt(t,e){var i;this.options=r({},Vt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((i=this).options.inputClass||(N?st:I?_t:P?ut:K))(i,F),this.touchAction=new Tt(this,this.options.touchAction),Ut(this,!0),p(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function Ut(t,e){var i,s=t.element;s.style&&(p(t.options.cssProps,(function(n,o){i=z(s.style,o),e?(t.oldCssProps[i]=s.style[i],s.style[i]=n):s.style[i]=t.oldCssProps[i]||""})),e||(t.oldCssProps={}))}Mt.prototype={defaults:{},set:function(t){return r(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(u(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Rt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return u(t,"dropRecognizeWith",this)||(t=Rt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(u(t,"requireFailure",this))return this;var e=this.requireFail;return-1===C(e,t=Rt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(u(t,"dropRequireFailure",this))return this;t=Rt(t,this);var e=C(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,i=this.state;function s(i){e.manager.emit(i,t)}i<8&&s(e.options.event+Et(i)),s(e.options.event),t.additionalEvent&&s(t.additionalEvent),i>=8&&s(e.options.event+Et(i))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=Ct},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=r({},t);if(!y(this.options.enable,[this,e]))return this.reset(),void(this.state=Ct);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},b(Bt,Mt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,i=t.eventType,s=6&e,n=this.attrTest(t);return s&&(8&i||!n)?16|e:s||n?4&i?8|e:2&e?4|e:2:Ct}}),b(Pt,Bt,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push(kt),t&L&&e.push(At),e},directionTest:function(t){var e=this.options,i=!0,s=t.distance,n=t.direction,o=t.deltaX,r=t.deltaY;return n&e.direction||(6&e.direction?(n=0===o?1:o<0?2:4,i=o!=this.pX,s=Math.abs(t.deltaX)):(n=0===r?1:r<0?8:16,i=r!=this.pY,s=Math.abs(t.deltaY))),t.direction=n,i&&s>e.threshold&&n&e.direction},attrTest:function(t){return Bt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=zt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),b(Nt,Bt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[wt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),b(It,Mt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[yt]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,s=t.distance<e.threshold,n=t.deltaTime>e.time;if(this._input=t,!s||!i||12&t.eventType&&!n)this.reset();else if(1&t.eventType)this.reset(),this._timer=d((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return Ct},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=_(),this.manager.emit(this.options.event,this._input)))}}),b(Dt,Bt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[wt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),b(Ot,Bt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Pt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,i=this.options.direction;return 30&i?e=t.overallVelocity:6&i?e=t.overallVelocityX:i&L&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&i&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&h(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=zt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),b(Lt,Mt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[xt]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,s=t.distance<e.threshold,n=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(s&&n&&i){if(4!=t.eventType)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,r=!this.pCenter||J(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,r&&o?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=d((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return Ct},failTimeout:function(){return this._timer=d((function(){this.state=Ct}),this.options.interval,this),Ct},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Vt.VERSION="2.0.7",Vt.defaults={domEvents:!1,touchAction:vt,enable:!0,inputTarget:null,inputClass:null,preset:[[Dt,{enable:!1}],[Nt,{enable:!1},["rotate"]],[Ot,{direction:6}],[Pt,{direction:6},["swipe"]],[Lt],[Lt,{event:"doubletap",taps:2},["tap"]],[It]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},jt.prototype={set:function(t){return r(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var i;this.touchAction.preventDefaults(t);var s=this.recognizers,n=e.curRecognizer;(!n||n&&8&n.state)&&(n=e.curRecognizer=null);for(var o=0;o<s.length;)i=s[o],2===e.stopped||n&&i!=n&&!i.canRecognizeWith(n)?i.reset():i.recognize(t),!n&&14&i.state&&(n=e.curRecognizer=i),o++}},get:function(t){if(t instanceof Mt)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event==t)return e[i];return null},add:function(t){if(u(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(u(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,i=C(e,t);-1!==i&&(e.splice(i,1),this.touchAction.update())}return this},on:function(t,e){if(t!==o&&e!==o){var i=this.handlers;return p(T(t),(function(t){i[t]=i[t]||[],i[t].push(e)})),this}},off:function(t,e){if(t!==o){var i=this.handlers;return p(T(t),(function(t){e?i[t]&&i[t].splice(C(i[t],e),1):delete i[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var i=s.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e,e.target.dispatchEvent(i)}(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](e),n++}},destroy:function(){this.element&&Ut(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},r(Vt,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Ct,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:L,DIRECTION_ALL:30,Manager:jt,Input:U,TouchAction:Tt,TouchInput:_t,MouseInput:K,PointerEventInput:st,TouchMouseInput:ut,SingleTouchInput:at,Recognizer:Mt,AttrRecognizer:Bt,Tap:Lt,Pan:Pt,Swipe:Ot,Pinch:Nt,Rotate:Dt,Press:It,on:w,off:A,each:p,merge:f,extend:g,assign:r,inherit:b,bindFn:v,prefixed:z}),(void 0!==e?e:"undefined"!=typeof self?self:{}).Hammer=Vt,"function"==typeof t&&t.amd?t((function(){return Vt})):void 0!==i&&i.exports?i.exports=Vt:e.Hammer=Vt}(window,document)},function(t,e,i,s,n){s();const o=t(42),r=t(43);class a extends o.View{initialize(){super.initialize(),this.el=this._createElement()}remove(){r.remove(this.el),super.remove()}css_classes(){return[]}render(){}renderTo(t){t.appendChild(this.el),this.render()}_createElement(){return r.createElement(this.tagName,{class:this.css_classes()})}}i.DOMView=a,a.__name__="DOMView",a.prototype.tagName="div"},function(t,e,i,s,n){s(),i.root="bk-root",i.toolbar_hidden="bk-toolbar-hidden",i.toolbar="bk-toolbar",i.button_bar="bk-button-bar",i.logo="bk-logo",i.above="bk-above",i.below="bk-below",i.left="bk-left",i.right="bk-right",i.toolbar_button="bk-toolbar-button",i.active="bk-active",i.default='.bk-root .bk-toolbar-hidden{visibility:hidden;opacity:0;transition:visibility 0.3s linear, opacity 0.3s linear;}.bk-root .bk-toolbar,.bk-root .bk-button-bar{display:flex;display:-webkit-flex;flex-wrap:nowrap;-webkit-flex-wrap:nowrap;align-items:center;-webkit-align-items:center;user-select:none;-ms-user-select:none;-moz-user-select:none;-webkit-user-select:none;}.bk-root .bk-toolbar .bk-logo{flex-shrink:0;-webkit-flex-shrink:0;}.bk-root .bk-toolbar.bk-above,.bk-root .bk-toolbar.bk-below{flex-direction:row;-webkit-flex-direction:row;justify-content:flex-end;-webkit-justify-content:flex-end;}.bk-root .bk-toolbar.bk-above .bk-button-bar,.bk-root .bk-toolbar.bk-below .bk-button-bar{display:flex;display:-webkit-flex;flex-direction:row;-webkit-flex-direction:row;}.bk-root .bk-toolbar.bk-above .bk-logo,.bk-root .bk-toolbar.bk-below .bk-logo{order:1;-webkit-order:1;margin-left:5px;margin-right:0px;}.bk-root .bk-toolbar.bk-left,.bk-root .bk-toolbar.bk-right{flex-direction:column;-webkit-flex-direction:column;justify-content:flex-start;-webkit-justify-content:flex-start;}.bk-root .bk-toolbar.bk-left .bk-button-bar,.bk-root .bk-toolbar.bk-right .bk-button-bar{display:flex;display:-webkit-flex;flex-direction:column;-webkit-flex-direction:column;}.bk-root .bk-toolbar.bk-left .bk-logo,.bk-root .bk-toolbar.bk-right .bk-logo{order:0;-webkit-order:0;margin-bottom:5px;margin-top:0px;}.bk-root .bk-toolbar-button{width:30px;height:30px;cursor:pointer;background-size:60% 60%;background-origin:border-box;background-color:transparent;background-repeat:no-repeat;background-position:center center;}.bk-root .bk-toolbar-button:hover{background-color:rgba(192, 192, 192, 0.15);}.bk-root .bk-toolbar-button:focus{outline:none;}.bk-root .bk-toolbar-button::-moz-focus-inner{border:0;}.bk-root .bk-toolbar.bk-above .bk-toolbar-button{border-bottom:2px solid transparent;}.bk-root .bk-toolbar.bk-above .bk-toolbar-button.bk-active{border-bottom-color:#26aae1;}.bk-root .bk-toolbar.bk-below .bk-toolbar-button{border-top:2px solid transparent;}.bk-root .bk-toolbar.bk-below .bk-toolbar-button.bk-active{border-top-color:#26aae1;}.bk-root .bk-toolbar.bk-right .bk-toolbar-button{border-left:2px solid transparent;}.bk-root .bk-toolbar.bk-right .bk-toolbar-button.bk-active{border-left-color:#26aae1;}.bk-root .bk-toolbar.bk-left .bk-toolbar-button{border-right:2px solid transparent;}.bk-root .bk-toolbar.bk-left .bk-toolbar-button.bk-active{border-right-color:#26aae1;}.bk-root .bk-button-bar + .bk-button-bar:before{content:" ";display:inline-block;background-color:lightgray;}.bk-root .bk-toolbar.bk-above .bk-button-bar + .bk-button-bar:before,.bk-root .bk-toolbar.bk-below .bk-button-bar + .bk-button-bar:before{height:10px;width:1px;}.bk-root .bk-toolbar.bk-left .bk-button-bar + .bk-button-bar:before,.bk-root .bk-toolbar.bk-right .bk-button-bar + .bk-button-bar:before{height:1px;width:10px;}'},function(t,e,i,s,n){s(),i.root="bk-root",i.tool_icon_copy_to_clipboard="bk-tool-icon-copy-to-clipboard",i.tool_icon_replace_mode="bk-tool-icon-replace-mode",i.tool_icon_append_mode="bk-tool-icon-append-mode",i.tool_icon_intersect_mode="bk-tool-icon-intersect-mode",i.tool_icon_subtract_mode="bk-tool-icon-subtract-mode",i.tool_icon_clear_selection="bk-tool-icon-clear-selection",i.tool_icon_box_select="bk-tool-icon-box-select",i.tool_icon_box_zoom="bk-tool-icon-box-zoom",i.tool_icon_zoom_in="bk-tool-icon-zoom-in",i.tool_icon_zoom_out="bk-tool-icon-zoom-out",i.tool_icon_help="bk-tool-icon-help",i.tool_icon_hover="bk-tool-icon-hover",i.tool_icon_crosshair="bk-tool-icon-crosshair",i.tool_icon_lasso_select="bk-tool-icon-lasso-select",i.tool_icon_pan="bk-tool-icon-pan",i.tool_icon_xpan="bk-tool-icon-xpan",i.tool_icon_ypan="bk-tool-icon-ypan",i.tool_icon_range="bk-tool-icon-range",i.tool_icon_polygon_select="bk-tool-icon-polygon-select",i.tool_icon_redo="bk-tool-icon-redo",i.tool_icon_reset="bk-tool-icon-reset",i.tool_icon_save="bk-tool-icon-save",i.tool_icon_tap_select="bk-tool-icon-tap-select",i.tool_icon_undo="bk-tool-icon-undo",i.tool_icon_wheel_pan="bk-tool-icon-wheel-pan",i.tool_icon_wheel_zoom="bk-tool-icon-wheel-zoom",i.tool_icon_box_edit="bk-tool-icon-box-edit",i.tool_icon_freehand_draw="bk-tool-icon-freehand-draw",i.tool_icon_poly_draw="bk-tool-icon-poly-draw",i.tool_icon_point_draw="bk-tool-icon-point-draw",i.tool_icon_poly_edit="bk-tool-icon-poly-edit",i.tool_icon_line_edit="bk-tool-icon-line-edit",i.default='.bk-root .bk-tool-icon-copy-to-clipboard{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5AUSDBoBvcHQeQAAAG9JREFUWMNjXLhsJcNAAiaGAQYwB/xHwh/Q+ITEkfHQCwEWND4jmeb8H/JpgBwfI6cNBhLSEkqaGXRpgFRAcZoZsmlg1AGjDhh1wKgDRh0w6gCaVcf/R2wIkNqw+D9s0wADvUNiyIYA47BJAwPuAAAj/Cjd0TCN6wAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-replace-mode{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5AUFFxokK3gniQAAAHpJREFUWMNjXLhsJcNAAiaGAQajDhhwB7DgEP+PxmeksvjgDwFcLmYkUh2hkBj8IcBIZXsYh1w2/I8v3sgAOM0bLYhGc8GgrwuICgldfQO88pcvXvg/aOuCUQeM5oLRuoCFCJcTbOMh5XOiW0JDNhdQS3y0IBp1ABwAAF8KGrhC1Eg6AAAAAElFTkSuQmCC");}.bk-root .bk-tool-icon-append-mode{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5AUFFxkZWD04WwAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAAoUlEQVRYw+1WQQ6AIAwrhO8Y/bIXEz9jIMSDr8ETCUEPQzA4pMeFLKNbu4l5WR0CDOMEALBGIzMuQIBEZQjPgP9JLjwTfBjY9sO9lZsFA9IafZng3BlIyVefgd8XQFZBAWe8jfNxwsDhir6rzoCiPiy1K+J8/FRQemv2XfAdFcQ9znU4Viqg9ta1qYJ+D1BnAIBrkgGVOrXNqUA9rbyZm/AEzFh4jEeY/soAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-intersect-mode{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5AUFFxkrkOpp2wAAAPhJREFUWMPtV1EKwjAMTUavI3oawR/vtn5srJdREfzwMvHHQlcT2mpdMzFfWxiP5r2+JMN+mAiCOB72CABgR1cln4oOGocJnuMTSxWk8jMm7OggYkYXA9gPE3uyd8NXHONJ+eYMdE/NqCJmEZ5ZqlJJ4sUksKN7cYSaPoCZFWR1QI+Xm1fBACU63Cw22x0AAJxudwrffVwvZ+JmQdAHZkw0d4EpAMCw8k87pMdbnwtizQumJYv3nwV6XOA1qbUT/oQLUJgFRbsiNwFVucBIlyR3p0tdMp+XmFjfLKi1LatyAXtCRjPWBdL3Ke3VuACJKFfDr/xFN2fgAR/Go0qaLlmEAAAAAElFTkSuQmCC");}.bk-root .bk-tool-icon-subtract-mode{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5AUFFxgsF5XNOQAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAABFUlEQVRYw9VWUQqDMAxNpWfxQxD1MoP97G7zQ5mH2RTZYLtM9lWoMbXtxLXNX4OG9r28l4hrd0PQoqxqAACYpxH25C/nkwCHyCBwSPoS09k1T5Fo+4EiExcC4v584xGFmyIXHBLRISAVZyZufUPVa4rcrwmPDgr93ylo+2GliLRUYHK6th/o/6r7nfLpqaCsagEA8Hh9FmcNKeRmgeYDC+SCq0B6FFi8/BcV6BdR9cL3gCv3ijPKOacsn3rBEcjmaVxpfGcg4wHxzgJJnc6241Hn23DERFRAu1bNcWa3Q0uXi62XR6sCaWoSejbtdLYmU3kTEunNgj0bUbQqYG/IcMaqwPS9jftoVCAQ0ZVDJwf0zQdH4AsyW6fpQu4YegAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-clear-selection{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5AUGEhcuan3d3wAAAoRJREFUWMPtlzFP3EAQhd+b3TNSzg0N5TWXLkJQUUaKhIQ4fgP/g5ArrriE/I3opEgRrZtIVJR0FJQ010SioUmEZHtnUpwN9gWHGA5BJCy58MraffvmfZ41v3z9hqe8BE98vQh4cgG+Ydzmnrng8efvQJNi/uN7dznx/B3ggtfhf4ehNdUttRzBDIm/2VTiiWCG1HK0nc+3UWtq8BQIiEEakEQOADBIA4QCQmBqoHBhFNR27ikQSmGdYCdTqCpEHMDZmEKRWUBEv1gBDg5SzRJnpopILWICgWuRYflLamuzxB2BmtYqSRIka5VWU8QduXO+1hRc5YZu5GAwmP2ZJzND0IBu5HCV2+NQcAhAVRsnC2IbPzPdSjzd6to6VtfWkXi6YLaVWr7xoAwkfpb8MnC3SH7rKSMBe4M0jA/OTicFIbtCGRIyNbURhcf3ErCd6YwA1m0HgAxhw1NGQnlXBHG4kylVlSJuH0RfIP2CkL2I/qS1gIAAQiBl1QwFggIHtyxgrxK5PgyfC0JWKoT0HLh8LwoietB4TYKaIl7yeNURxB05UtMxDOcVQlZIrlRKdK6m47gjR/fuBRQihyLArtNeJD50Izcx2Eczu7iFkIug4VM3cpOr3MKDekFED0fWUHv9Zq0kpLnridjhY3XDg7NTN0jDrhO3X7O9Wg7wwyANu4mnayNg3gmbu0tCNoUyBNGv2l4rB9EXynA7082FOxAQLhU6rQVO9T2AvWowFToNCJcPORGxIRcnpjZSKATSU9NxvOQnAPArDSaQoUKnNI4iufkGtD4P3EHIcWZhz4HLceSOyrR3Izf5memPAL2cX3yhAkonysZVaWLBkd9dw1Ivv2a/AYPkK+ty1U1DAAAAAElFTkSuQmCC");}.bk-root .bk-tool-icon-box-select{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg0kduFrowAAAIdJREFUWMPtVtEKwCAI9KL//4e9DPZ3+wP3KgOjNZouFYI4C8q7s7DtB1lGIeMoRMRinCLXg/ML3EcFqpjjloOyZxRntxpwQ8HsgHYARKFAtSFrCg3TCdMFCE1BuuALEXJLjC4qENsFVXCESZw38/kWLOkC/K4PcOc/Hj03WkoDT3EaWW9egQul6CUbq90JTwAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-box-zoom{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg82t254aQAAAkBJREFUWMPN11+E1FEUB/DPTFn2qaeIpcSwr5NlUyJiKWVXWUqvlUh/iE3RY9mUekkPPURtLKNRrFJEeuphGfUUaVliiX1aVjGs6aG7+XX9ZnZ+d2fTl2vmnHvPPfeee/79Sk+may2/UQq/q7Qu+bAJoxjHIKqB/wlfUMcMVqI9bLZ+DGIKwzlzQ2GcxCx2xwvKOUKlaHTiX8bHNspjDONHkOmJBW5jIof/FvPh/06MZOb6cRc7cGn1AKUE5cdzlM/gAr5F/O24H3xkFRfxAbVygvK+cIsspjGWo1zgjeFpxL+BvnLw7laBA4xjIFJwrgu52DoVjKdY4HBEX8dSF3JLYe1fe6UcYCii3xWQjdfuSTnAtoheKCC7GNED5Zx4L4qt61jbTLHA94geKSC7P7ZeShQ0Inoi1IJuEOeORooFXkV0FZNdZs5qvFfKAeqYy7nZ6yg//HG0MBfffh71lFrQDCW2EvEP4mt4okZUDftz9rmGZkotmMxJRtlisy+MTniAWrty3AlXw0hFM2TD89l+oNsoOJXjbIs4EpqNtTCLXbiZ0g+M4mFObj8U3vsNjoZCVcmk60ZwthpepLZkB/AsivWfOJZxtpUQHfWib7KWDwzjeegBZJSdKFiE2qJTFFTwElsi/unQ/awXrU4WGMD7nOJxBY/1EO2iYConq93CHT1GOwucjdqnRyFz+VcHmMNefMY9nNkA3SWUOoXhQviSWQ4huLIRFlirFixnQq/XaKXUgg2xQNGv4V7x/RcW+AXPB3h7H1PaiQAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-zoom-in{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEgsUBmL8iQAAA2JJREFUWMO9l12IlFUYx3//MzPrLpSjkm5oN4FFIWVEl66IQlFYwtLOzozsjHdGRSCRF0sfBEXRVV0FQuQiLm5CZNBFgRRaRLVFhbJ2EdiN5gbK7toObTPn6eYdPTvNzPvOBz5Xh/ec5/n/n89zXtEHmZqeSXSuXBz/3zfdKvBWJHQrwZuRcP0El+QkbQXeBX6WZEgm6TtJk5lM5o4Lc+cV6qpf4Ga20Tm338zeATItVK9Ker6yvPzp4NDQ3+XieGsCU9MzTYumGbhz7m4ze9/MHgvBgItACrgfGAj2jgAvAYs3wlEujjc13kii8YyZrXXOfWhmo9GnFUlvOOemarVapVqtkslksmb2KjARqL62ecuWN9NxbRInzrldAXhV0uFSIfdew7G/gNLU9MwS8CwSmE3Oz88fcXG5blfpqVRq0Ix8VIAAX0XgrVL7HDCHGcCaWrV60LUBN8Dae58aQIxEqcA592I9M610JL0cpG/U9TIHJNKY3RV5z0R+7Nd4HZ0P1g/2RMBuegLAsRMnb4vT8d5vqKfMzOgtAlADrkmqGywmiMBTwfr3dC9j1Xv/r6Tvg/5/5ejxE6cO7M9faVbQZrYNOFSPmqQvVo9FKexvi5uWX58943aM7DwAfBDY+FbSCxP5sdkGx55GeguzrUEXPaSo2pFkAbiSZQCAzZJOmdkjwd6SpB/M7KykQTPbA2wDhoIzRzcNDx9MJwGNIXdJ0mEzmwbujL7dbma7gd03A7lKfnTOvf74nl0r6bonTUbujRSUCrm2d4L3/kvn3JPe+8+BDW2i9o+kT7z3kxP5sYsA6W47oE64TsR7P9tQL4vA2mh9WdIscKxUyJ0M7aR7acOGzikD65EQLEjaa2ZXzMwDFeB6qZBbbLTRE4EGeSaozNOZgYFf8qP7lmIvs354n0qlHpB0T7B9Ogl4IgJJrmjv/SiQjbrkD+BMUkfSbYATPdckrTOzkciWAXOlQu5cYgLdPEIapud9wMOR9zVJH3ViKx333mtHMJvNuoWFhZ3A+ojMcja77njXBEKwJJfTcqUyCIQ34Mf7nnh0paMnXacFuGoC1mr3AtuDfLzd8Zuyl+rfuGn4HLAD+Az4qZQf+61TAj0Noj8vX6oC35SL43u7teG6rf5+iXppwW7/JUL5D03qaFRvvUe+AAAAAElFTkSuQmCC");}.bk-root .bk-tool-icon-zoom-out{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEgsHgty9VwAAA0FJREFUWMO9l09oXFUUxn/fmXlpItppi22k7UJBRSlVkCytSAuKUloIdjKT0El3FXVXdVFKRVAQV7qQohsNwdA0UFvBhYtqUVyIVlRaogtFQVq7qSTVjA3z3nHzBq/jvPmTN/Ss7rv3nvN99/y794kByMzcfE/7picn/jenmwWeRUI3E7wdCRskuCSTdDfwBvCtJEdySV9KOhpF0e0/LF5SqKtBgbv7ZjObcvfXgShD9Zqk5+orKx8Oj4z8NT05kU1gZm6+bdK0Azezu9z9hLs/HoIBvwAF4H5gKFh7B3gBWFY3460kWve4+3oze9fdx9OpVUmvmNlMHMf1RqNBFEUldz8OHAxUX9q6bduryut+Sfvc/Wz62ZD0fK1afjND9y3gGSRwv1GMojstTxUUCoVhdyopEYDzKXjWwZ4FFnEHWBc3Goet00m7lZlZYQixKw0FZnakGZksHUnHgvCN5/KARBH37enpOVg58H13HV0Kxg/kIuD/ngSA2ZMLt3bTSZJkUzNk7k4+D0AM/CGpaXCyBw/sC8Y/qZd2GpZiuL9YLN4Sx/HpoP5/c/exQ1OVq+1yyt13SLoArEsJnMjlgfOffvK3u58Kprab2QezJxfG2iTzUzI70wRPG9jbmpmb95SNB9mpzp7/j2yVdNbdx4K565K+cvfPJQ27+x5gBzAS7Hlvy+jo4WIvoC3kWpcvS3rR3eeAO9K529x9N7C7zX6AC2b28hN7Hl1Vt44niVq13LUjmtlYkiQfA5s6eO+GpDNJkhw9NFX5ueNt2ARodyF1IHIN2JiOl4H16fiKpK+B2Vq1vBAqFAf4IJkGNiIhWJK0192vunsC1IE/a9XycquNXARa5OnApeeioaHvKuP7r3dTGsiLqFAo7JR0T7B8rhfwXARa2us4UEqr5Ffgs151i/08oTNKdIO770ptObBYq5Yv5ibQq/sl3Qc8lJ4+lnSqH1vFfp9koZRKJVtaWnqkWXqSVkqlDe+vmUDWpZMlK/X6MBDegKf3P/nYaj8ErN9fqZBYEsf3Ag8G8Xit33BaniTcvGX0IvAw8BHwTa1y4Md+CeRqRL9fudwAvpienNi7Vhu21uwflOT+L+i1X2TJP57iUvUFtHWsAAAAAElFTkSuQmCC");}.bk-root .bk-tool-icon-help{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAABltpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj4KICAgICAgICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5pdD4KICAgICAgICAgPHRpZmY6Q29tcHJlc3Npb24+NTwvdGlmZjpDb21wcmVzc2lvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzI8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNvbHV0aW9uPjcyPC90aWZmOllSZXNvbHV0aW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+MzI8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MzI8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjE8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPHhtcE1NOkluc3RhbmNlSUQ+eG1wLmlpZDpBODVDNDBDMzIwQjMxMUU0ODREQUYzNzM5QTM2MjBCRTwveG1wTU06SW5zdGFuY2VJRD4KICAgICAgICAgPHhtcE1NOkRvY3VtZW50SUQ+eG1wLmRpZDpBODVDNDBDNDIwQjMxMUU0ODREQUYzNzM5QTM2MjBCRTwveG1wTU06RG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkRlcml2ZWRGcm9tIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgPHN0UmVmOmluc3RhbmNlSUQ+eG1wLmlpZDpBODVDNDBDMTIwQjMxMUU0ODREQUYzNzM5QTM2MjBCRTwvc3RSZWY6aW5zdGFuY2VJRD4KICAgICAgICAgICAgPHN0UmVmOmRvY3VtZW50SUQ+eG1wLmRpZDpBODVDNDBDMjIwQjMxMUU0ODREQUYzNzM5QTM2MjBCRTwvc3RSZWY6ZG9jdW1lbnRJRD4KICAgICAgICAgPC94bXBNTTpEZXJpdmVkRnJvbT4KICAgICAgICAgPGRjOnN1YmplY3Q+CiAgICAgICAgICAgIDxyZGY6U2VxLz4KICAgICAgICAgPC9kYzpzdWJqZWN0PgogICAgICAgICA8eG1wOk1vZGlmeURhdGU+MjAxNjoxMToyOCAxMToxMTo4MjwveG1wOk1vZGlmeURhdGU+CiAgICAgICAgIDx4bXA6Q3JlYXRvclRvb2w+UGl4ZWxtYXRvciAzLjY8L3htcDpDcmVhdG9yVG9vbD4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+Cphjt2AAAAT7SURBVFgJxRdbaFxFdGb2bhui227BWrsVKYgf2kJUbP9EUPuzEB803WTXJjH61Q/7Ya1+CMYKEVTsh4J/EpvY7BoabUiNiA8s1p+4KIhpoUUEselHqyS76TbZ3HuP58ydc3d2u4+IkQxczpz3mZkzZ86VYpXjvenpjZsLhUcliE4AuUuASAgptmt1EFdwPiclzIIUUwubNn17OJlcXo1p2UpodHRiux9xB1Eug1+slbzhFxGOKc851tu7/0oznYYBDA8Pt0U2tL8KQryIq2tvZqQhD0QJHRz3yqWhgYGBpXpydQMwqz6NCnurleCSADkJEfgKfOePqL80R/wV1ZaQyr1LenKfkPCkEPKeaj0xg7vxVL3duCmA0Vyuw/fl52hgBxsBED+h4Cv9z3R/zbRm8MTJTx7HQN7GQB6w5C4L4SX7M5lfLBpurjXMyvNIShiyi0l1pL8n9b7EDGPR8fHxzSsQ6XDB3618/xqo6Pk25V5MpVJllgHM1BO58RdQ612kOYZ+GXdij70TYQB05mpj+1kU5G2fB+l3PZtOf8NGx6ambnMXb3yAxg8wjSEG6OKKR9oicBQD+ZvpH2Wzj0lQpxCPG9qMv1x6hHNCsSAlHM7ZOa682vlI9tRDbvHGbD3nZAPpDoD/3JIrLpAs26UFkC3EMUA99hpfGtEBfJjNJnS2Gwnadnvl+Xw+iuc3DAJuNyIaSCHpilVldyDjjUxj3WDZIAhxhHHyRcdNuA7AAfUaXzVKODpzFiZ4/uLvh5G+m2no+C/pyIf7MqlEJB7bpqR6nXkEUfbeawuLaZsW2ISfNQ2vtaktQlGFQyIVGT0o2+2EC4iQNGwjBIN9qdQ5Qg4mk4X4rW3vCClLtowE2FOFUxKDfNmiZci3ovKKRFPh4FK9q4Zbdr+lKKJiA13TcHR2dmLBgdmQ0GAS2MZaEowY+XbAk09IvgtYZGp16SyvFhaHcIUh645t8T9DBCcnz5zZ4hZLu3DzK2QlL1QQa0Y+pHiJKPSuOGj3PmZTheM5w2TwqBxnvBZOTk7G5gvXJ5Aelms8wnJURL+olSWcfEhf6gDoUXPMq6ZlqbzWU2pE+3hi4s6F68tfIj9cBMlikr7Z0/P0b/X0yIcUXsDCF1WhtL4OROHaXk+xlkbV0Cu732Nmhc4peaWSg73pA8dq5RkvO37ldUTfXCKZv2q45MkhvG87WQEzpCCUSvV1d9GONBy3lMvgKSwrZig8gjAietWY0QriylO2jIo4yVbOSb7KB/qmI9BPKjHpSSXYauRyn92Nq9/Kcrj13x3s3v8D481glQ/0raiNYgX9njPSBOImbrHZePl+tfFmc9sH+Xaoh8NjOKSVdDMhjjYzQLy+dFceH5+IJQf9VYXX4tROg4ZFU8m31M3mfPEqUoJqCGJfvWpo2xnNfdrhC28n06SCeSzNZxlvBINGRXCtKS7EY1uV6V7HWAm38y1cXaXsMcOCvr9ySPj+af7A1U2HJXHzVNvUXVLIGyPf+jV0pf8GHoN+TLAyPkidTCi2RpPApmnR0Bd1zGRaB/B8Oj2HSw7LLbVR1MmskW8RdEWVXSJf3JbpAMgRtc4IZoxTh9qotQjCasm46M0YX9pV1VmbpvRH5OwwgdRtSg2vKaAz/1dNKVtb17Y8DCL4HVufHxMOYl1/zTgIgiYvBnFKfaNp3YjTdPz3n9Na8//X7/k/O1tdwopcZlcAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4oVHp0SwAAAQJJREFUWMPtlsENgzAMRb8RQ5VJItFDOgaZAMaAA0iZpN3KPZSoEEHSQBCViI/G8pfNt/KAFFcPshPdoAGgZkYVVYjQAFCyFLN8tlAbXRwAxp61nc9XCkGERpZCxRDvBl0zoxp7K98GAACxxH29srNNmPsK2l7zHoHHXZDr+/9vwDfB3kgeSB5IHkgeOH0DmesJjSXi6pUvkYt5u9teVy6aWREDM0D0BRvmGRV5N6DsQkMzI64FidtI5t3AOKWaFhuioY8dlYf9TO1PREUh/9HVeAqzIThHgWZ6MuNmC1jiL1mK4pAzlKUojEmNsxcmL0J60tazWjLZFpClPbd9BMJfL95145YajN5RHQAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-crosshair{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADEUlEQVRYR81XXVIaQRCeHqug8CXmBNETaE4gniDwIgpVspxAbxC9ATkBkCpQ8gKeQDiB5AQxNyAvUlrldr7eHxyGXZi1rMJ5opbp7m++7un+htSGF204vsoMoNXrlzSpfWa1oxQfhAegCZGaEtPorHo8znIoJwCt6+td8uk7ApUQCIHTF4BNAWzImq8ap6cP68CsBdDp9i9ZqXM7ML79g/EnCWD+jgMKENKqWT+tXK0CkQqgNRjs0OxpQIqKhoMxaG6/6JeRnK7T6yO2UvVqhYSlLX+ryORfgKn9ORDFIy7ky41yGcwsr0QAQfDH5zucOswx819fs4egI9OFCcD8DjBF7VNbEX0JzdWEt3NHSSASAcCxBDqMgt/623kvyTgNgNjJIfTjk4D4FqaJR1715MjmYAmA5Bx3AwUXQL+t105KaTlcBSC26XRvhjEIoLiq1yqXpr8FAGG16/ug4IT27fxBWu7EiQuAiImJpEMKE6nYM30uAIDDttSUOPfJP7JzbjPhAiBIh9QE67vIvoOi9WJfCwDavf40ulpjbCqmUf+W753ezURuh7Dg1SqflwAEHU6pgfyBq9Y4qx0LG++2fnZ/eUzcstmdM2AWH+jfc+liWdBJfSENf8Lifi3GVwC9mybOfi5dzatWVrbbLIHNva8p5h/16gkaFiLGGxbufkoE6XguwePiXLF3XmMfCUCUAqtKXU7sumd1CowOuJEi3Pg1FBpjitIGhyvVSfvmjci6ZR+rFQfDiPVE2jFYeICQ+PoewwjC5h7CZld6DBdyu6nDSKgzOyIMhmhK5TTqXYbRorZYM46TmpKAAOrGWwSJJekSB1yqJNOzp1Gs7YJ0EDeySDIMtJbQHh6Kf/uFfNFZkolJICRmz0P8DKWZuIG2g1hpok+Mk0Qphs0h9lzMtWRoNvYLuVImUWrmPJDlBKeRBDfATGOpHkhw670QSHWGLLckmF1PTsMlYqMJpyUbiO0weiMMceqLVTcotnMCYAYJJbcuQrVgZFP0NOOJYpr62pf3AmrHfWUG4O7abefGAfwH7EXSMJafOlYAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-lasso-select{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEgwlGP1qdAAABMBJREFUWMO9V1uIVVUY/r61z57ZMx4DnbzgkbQXL5iCJphlWdpIGY4jpFBkEiU9ZNaDRRcITcIwMwgxoQtU2IMXdAZfMjFvpERXYiSbysyBEXFmyuHMnLP32uvrwT2xnY5nxvHQ93Jg7fWv71/r//7L4a59TRgqJk+Z6v3a+sv0OI5nk5wu6VaSVZImAThHsgjgrKTvM5nMUWvtmf5n8HodCIKgOgzDhc65pSTrJQWDsSNpJX1ljHnDOfdT37oZLLHv+8OMMasKhcIJ59xHAJYMlhwAJGUAzJfUTHLFuFzOG5QDU6dNMyQfs9Yedc5tBpAD4IYYNQGoBrDtQnt7/b0LFrJsCHzfn2itfQfAnZLiazytA3AaQAuAiwDaEgeNpGkkswAWSBqRONB38b88z5uTKePt6iiKXkk8jq+iJC5LOmiMaTLGHLPWhmWeHr7vV0dRtATAapAzIVmSo51zyzIlbm2stesFPA6pKk0r6Ryg93y/ek8YFvPOOTg3cDSiKCoC2OP7/rEoirYm4rUkF12lAWNM1lr7lqQn0+QA8gI2jBg5cj6Aj8OwmB+KAKIoukhyp6SRJAUgl0ndPLDWPi9pJQCbuviXvu+/GIZhW1dnJ24UJFuTjCCA2ADA8sYGWmsXS3qmL94kDYAtkh4Nw7ANlQJ5U6INT1KrAYC9zQdykl7nFSj5fXp5Y8NWVBhy7mUAjqShMYdMXV2dJ2klyRwAJ8lIeuGWCRMP7N7frEqSG2OmAFhKshNAp5wrmO7u7jEAngPQm1S2z2pqapr+OPt7XEly0oxwzq2RdFmSD2AMgKKJouhhAL4kA+Cs53l7e3t7uytJHgRBreTWkXwkKVJnJD0B4GAGwIJE9R6AFufc6UqSZ7PZbD6ff5dkA4CQZEHSqwAOISmXtwGIE+F1SeqqIP8d+Xz+C0mLJYWSAODteXffczjdDQNJ0BWMCoLg5gqIbRTJNwHsljQhUb0luWPM2LE7Thw/9m/5NCT/TByxAOYWi8X6/gdWV1dnfN8fNRBxJpMZTXKdc+6IpFVJWAEgkvSJpA0X2tvtVTaSjgOYBCAEEADYSHK87/sfhmEYA9gShuEDkgzJHyWtB/B1irQ2juP7ADxkrX0wOUOpzmdpzEY590HJ7Ni1r2kSyZOSiv2+hSRjSTXp/QAukzySNJOJkmalyNIl10hqMcasdc61XDNcQRD8BnITgNp+36r6kfcNFMMlLQGwTNLMEuQGQBfJl2bdPru+HDkAZAqFQux53jZHEsC6aw0eg2gylNRBcqcx5v04ji999+03AwsWAOI4Lsy9a94WkisAnE5a5WCJYwCfA1g7LJudI2lTHMeXBm1faiQzxkyRtF3S5CTupeAB+KG2tnZFT0/P30NO2VKLzrmfAbwGMipjG5Oc0dPTc0Md05SZ5U4Q2FxChErtEYD7jTGNQ3UgM8Asv90Yc9I5LSKRlXSI5CxJa0jWSALJjKRnAewfkniT+vwf7N7fXHK9rq7O7+jo+BTA/NRrdBpjnnLOnUrvXd7YMPQXSBunneno6IhIHgYwW1JtkgmBpBkATlVMAwOk3nFJ+VSoqgCMr6gIy2FcLtdKspAedyQN/98caDt/3kpyabUmf8WvG/8A1vODTBVE/0MAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-pan{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4lKssI9gAAAOtJREFUWMPVll0KwyAMgNPgoc0JzDX2Mtgp3csKErSamGabIEUo/T6bHz0ezxdsjPJ5kvUDaROem7VJAp3gufkbtwtI+JYEOsHNEugIN0mgM1wtsVoF1MnyKtZHZBW4DVxoMh6jaAW0MTfnBAbALyUwCD6UwEB4VyJN4FXx4aqUAACgFLjzrsRP9AECAP4Cm88QtJeJrGivdeNdPpko+j1H7XzUB+6WYHmo4eDk4wj41XFMEfBZGXpK0F/eB+QhVcXslVo7i6eANjF5NYSojCN7wi05MJNgbfKiMaPZA75TBVKCrWWbnGrb3DPePZ9Bcbe/QecAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-xpan{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4X4hxZdgAAAMpJREFUWMPtlsEKwjAMhr/pwOOedINJe/PobWXCfAIvgo/nA4heOiilZQqN2yE5lpD/I38SWt3uD9aMHSuHAiiAAmwaYCqoM/0KMABtQYDW11wEaHyiEei28bWb8LGOkk5C4iEEgE11YBQWDyHGuAMD0CeS30IQPfACbC3o+Vd2bOIOWMCtoO1mC+ap3CfmoCokFs/SZd6E0ILjnzrhvFbyEJ2FIZzXyB6iZ3AkjITn8WOdSbbAoaD4NSW+tIZdQYBOPyQKoAAKkIsPv0se4A/1UC0AAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-ypan{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4anK0lywAAAMVJREFUWMPtlzEKwzAMRX/S7rlpIMXeOnaLaME36FLo8XqCdNFghGljyc4kgQi2Q/SUj0F/eL7eMMTKz6j9wNlYPGRrFcSoLH4XxQPvdQeYuPOlcLbw2dRTgqvoXEaolWM0aP4LYm0NkHYWzyFSSwlmzjw2sR6OvAXNwgEcwAEcwAEcwAEcoGYk20SiMCHlmVoCzACoojEqjHBmCeJOCOo1lgPA7Q8E8TvdjMmHuzsV3NFD4w+1t+Ai/gTx3qHuOFqdMQB8ASMwJX0IEHOeAAAAAElFTkSuQmCC");}.bk-root .bk-tool-icon-range{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAABCJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIgogICAgICAgICAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICAgICAgICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDx0aWZmOkNvbXByZXNzaW9uPjU8L3RpZmY6Q29tcHJlc3Npb24+CiAgICAgICAgIDx0aWZmOlhSZXNvbHV0aW9uPjcyPC90aWZmOlhSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8dGlmZjpZUmVzb2x1dGlvbj43MjwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjMyPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT4xPC9leGlmOkNvbG9yU3BhY2U+CiAgICAgICAgIDxleGlmOlBpeGVsWURpbWVuc2lvbj4zMjwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgICAgIDxkYzpzdWJqZWN0PgogICAgICAgICAgICA8cmRmOkJhZy8+CiAgICAgICAgIDwvZGM6c3ViamVjdD4KICAgICAgICAgPHhtcDpNb2RpZnlEYXRlPjIwMTgtMDQtMjhUMTQ6MDQ6NDk8L3htcDpNb2RpZnlEYXRlPgogICAgICAgICA8eG1wOkNyZWF0b3JUb29sPlBpeGVsbWF0b3IgMy43PC94bXA6Q3JlYXRvclRvb2w+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgrsrWBhAAAD60lEQVRYCcVWv2scRxSemZ097SHbSeWkcYwwclDhzr1Q5T6QE1LghP6BGNIYJGRWNlaZItiFK1mr+JAu4HQu0kjpU8sgF3ITAsaFg0hOvt2Zyfvmdsa7a610Unx44Zgf773vvfneezPHNzrbhn3CT3xC3wPXYOC8LDzqdi8YY/gwh4BeknS/2th6dr2kf94AOp3OFyWgMyziOPbMDxV9FTtJnl1ut795Xd0/YQ0/vtYQwMT1KXWCfr2IjOWwtNehwN4xL9ykTrm6Pzl58yLn3J+mKh9mXbT3uRjGEDph+O8/TjfP5dBp7Ha7AX7O3o5nZeD/0E/OGyXntDgzA0X6qmCnrVutVlrUWV9f/3xo+pwhGDhvEPHOjoxnZjJggXmMHzBQ7NGNp9vxk61fr0HR7e/u7pZzCGHlc7qwBYYTT7tJYSx1AQzppyFPft5apta9w7SKcn0b7P7+/jCsDQ5mbc0dCmIJGDN0ehdcjsmkm6A6KUeKFOTE11PLxrC7Ukqh3ylL2fT0NAP9q6ur6rRCJJYsbKB0JsbCKMuy+xREePDyxQPCz+Crlw062QcA5wBOOt1l6vIl2WiI9F1fN6Q+BBqit6hEC4Hk08GQJMn4myjSP7RavVxgdaVUh/3U6HCMsPr9pYnJKRziHtWQ+un58+hGs6nsjQSjpuTyKGN3CX+FBwHXSiEVgjP+O8X6N12kIePES+GzTKAkGbNp8yJsGUMVzz8jPKReiyAQRimy5/cjye5RpF8utFp/+nwmT7d/NMzcFkS7yjJNGDaPURQxIQThEQy0SyF4l5WJYYhBa816vZ6dU7A6CAhbZVow/pDe0O9hVOoCi13r4BgBAvJHqMSQL2vE/iH6IAXEwgrRVUmBoRRwnwJQT98xEeVeSUyB4dJ5nwJBKdCFFGRmUCcu7rwIYypCTblaChuNBhWODrman5ub+4v0rMNBt8z6Ezh7GksJQpCbm79cMQE7QBFm/X6f0rjWnv8WRYg/QdbUpwDAEBy8vPyA8rNGzg3a8MiElwiM7dAtRqNoNptjGPM1laVxP9umWEMGLOKhKUOJDtBwDmzsw9fC/CzHr9SGuCTi2LbbKvVtmqXpCjMihBFa79Wrt5fGx9PDzc3fmu32Lf8qFliwU9emKhBSp+kRKn/hu9k1COEDbFdt/BoKWOAkuEbdVYyoIXv8+I/QK9dMHEb1Knb7MHOv8LFFOsjzCVHWOD7Ltn+MXCRF4729vWMDK+p8rLkvwjLg4N4v741m5YuwCI9CvHp1Ha8gFdBoPnQAkGsYYGxxcfEI7QQlFCTGUXwjAz4tWF+EpymOWu7fglE7qsOvrYE6g4+9/x/vhRbMdLOCFgAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-polygon-select{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEjc1OfiVKAAAAe1JREFUWMPt1r9rU1EUB/DPK0XbqphFHETo4OCiFhwF0V1KHbRSROLqon+AUMVRRFBwEbRFMBiV+mMW/wIxi5OD1kERRVKRJHUwLvfBTZrU5OWBGXLgQu7Jfe98z/ec7z0vKa88b2q1BDtRHdAPBaylm1NzsxsOjPnPNt6WSWprbft+/c3I3zOAjhT1Y4+fvcjEQJIXnVECSa+AhqIHqlHH5lWCZoe+Gk4GRgDG86j9SAUdlDBSQaZhlOkuHyoVdJmsw98D1S5fM4NYM1LCpqM+Lwa240oLgmZzpVZvzKT75VLZcqksSZKWlQeAy/iORVwIvh31xvotvK7VG3Px4aWHj3Jl4C2uYSvq+Bn8v6LLbaVWb9zsBiKLCvbiNG7gLm7jAYqbPHMJMziZ9lsKoh8GtqCEVVzHftwJn+TFHp4/hg8BSCYVfMOZoPEv2NZGdy9WCGUr9toDR3E2/H4V6nwRe/BmgN65H1ZhvMuB3XiKIyFoGefwO6ysVkUlrNUNsyAK/jli533Q+Y8cJFvAeXyMS1CI/jiMr/gUtD2LQwMGr4R3p7bY3oQHQ5b38CT4D2AXXg6YcQXHpyYnlqKsi5iOAVSwL9zd7zJ09r+Cpwq72omFMazjT9Dnibym0dTkRDUKrrgwH7MwXVyYB38BstaGDfLUTsgAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-redo{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4itK+dVQAAAaFJREFUWMPt1L1rFFEUBfDfJDaBBSslIFjbaSFp1FJQFMVCHkzhKIqdUYOCoBgErVz8rCwiTDMwBCIKipDWyip/gxAIWAmBgBC0eYFh2Gx2l9lFcA5M8e59782Zc84dWrT435Hs1siLchqn43MS0zgW22vYxjesYjVLw3YjBPKinMUTBOwf8J5fKLGYpWFjJAJ5Uc7gIW6jM6Kim3iNZ1katgYmEL/6I+YasvY7Lg6iRpIX5VF8wuEe/XV8wGf8jN6LWTiAc7iEQ7ucPZ+lYW0vAtfwvlbfwCKW9gpXDOv1mJvZHiSO91MiyYsyiQSuxtpXXM7SsDmM5nlRdrCMMz3sOJWl4Xevc/vwBzdwAl+yNNwZxfRI+GxelK9ikHcwh8d4NNR/YFRES1ZwoTYdR7I0rNf3TzVNIGbmSvR/Bx08mIgCFSVu4l2ltIWD9WxNGR+W8KOynqnZ0rwCeVG+wa0hjrxtWoF5dAfc28V8Mib/n+Nev5dnabg/zgw87aNEN/bHOwVRiRe4Wym9zNKwMKkpgIWKEt24njxiJlq0aPFv4i9ZWXMSPPhE/QAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-reset{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4gWqH8eQAABLdJREFUWMPtlktsVGUUx3/nfvfOlLQaY2IiRRMQIRpI0PjamJhoVASDvNpCpYw1vJQYSVwZwIVQF6wwRHmkAUof9ElrI6VqDAXcID4TF0IiYQMkSlTokNCZ+b7jove2t+NMH7rQBWd3v+989/zP+Z8X3Jb/WGQySvUNTQBJESkNguAVYIWqzhaRhwBU9WcR+QXoymazn6jqzUQiMQSQzWZRVdal1vwzAI2tHQBPOuc2AbWTdOyQ53n7nHNfRwee51GzqoIQMCLDpr3x/tLQ0oZzrk5Vj0/BOEBt+KYuOlBVGlrahr0Wob27t3gEjnZ2AyQzmUwHsDgP6J/AYRE553neDwDOuUdU9QngNeCumK4TkRMhZUORcYC1qysLA6iuSQHIwkWLD6lqapQsuSmwTVV3h99I7EcAR462A2xR2Ilq6ehTaejvO1774kuLNALR33eclsaGsQDe3fYegHl43vyNwEeqGl1963mm2jl7YZRTQ82qlWP4HM6ZToC5ztkW4LHQoALru7s6Di5dvlIj/e6ujrEAWoZDn8hmMjXATMACGaAVuBjXTVVXFc/AxhaA+4zvn1DV+eHxVWPMAmvtb5GeMWZyZVhI2rt7qVy2pOh9U1snwIPW2vMi4oWJuBPYHkVAVScPoKmtkzVVK6cEMsyJraHhiCqJqJUwj/JRz7TW1iSSyR2rVyylqa0Ta+24Ic8vXaAEmDFc/l5Z2A/80OibuVyuz/f9ElUdHCmvw82t5HK5h6y1PYhsz2YyGw43t2KtBZHIGwB6+j4rCkBVUdV7gXrggnPuu8h4eP+xMeZS2D0rJYZ6AdAMzAt1b4nI26p6IFZOY8pugijcKSIHVLUK0LyST4vnrVfnWr3mjmP4QTATaERkXkypRFX3isjmuHdRJEK6Ckqquopp06bdKCkp2Sgi7XnGLcg7gzeutwNIiPYc8HixqIrIOlU9ONVIhHPEd851icgSVXUiskVV94gIqoonIt0i8gfQCfwae38e6BWRXuBZz5jZ8VbaOE4EIqlZVUEQBLlkMplS1QER2RwkEnsSyaREDUzyeNsvIhvCMqkH1kdIJ2o+k8iJB1LVVRfjZ6nqqlEAIbdVQGto8Lrv+/dbawcjAL7vc+6bs+zetetfLSHxniIFGofGGsU2oC7eOCbDfZ7nQawBOSAX74SF9oEPImOq+r7nmVmxb5raukZa8UReGmNmhbMkAwwBH467EYVZe49z7kdgenj8k7V2oTHm8kgdWcvrNdVFjR8cHkYzjDH9wLjDaEwEzpwa4MypgWvAjtjxfGNMj4jMiT+M+kFsZI/Q6Pv+HGNMT8w4wI7TAyevxXVPD5z8+zD64tRXAMHVK1eaVLUyVvuDqroV2BOnJF4ZIedviUidqt4Re9s+vbx8zZXLl7PR2+nl5Tz/zNOFp2FzxzGAklw22wUsLLaSKXwf8vhosZUM6PeDYEUum70VHfpBwKsVyyfeikOP6oBNwN1TrLbfgX3A1kKLzKeff8nLLzw38T5wZDgxn1LnNk5lLRfP26/OnR2hwfNYW2Atn9RCsrf+EECyrKysDFimqhXhyjY3VLkAXBKRDqA7nU6nS0tLhyIj6XSaN9bVclv+l/IXAmkwvZc+jNUAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-save{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4UexUIzAAAAIRJREFUWMNjXLhs5X+GAQRMDAMMWJDYjGhyf7CoIQf8x2H+f0KGM9M7BBio5FNcITo408CoA0YdQM1cwEhtB/ylgqMkCJmFLwrOQguj/xTg50hmkeyARAYGhlNUCIXjDAwM0eREwTUGBgbz0Ww46oBRB4w6YNQBow4YdcCIahP+H5EhAAAH2R8hH3Rg0QAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-tap-select{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2hpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo3NzIwRUFGMDYyMjE2ODExOTdBNUNBNjVEQTY5OTRDRSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpCOTJBQzE0RDQ0RDUxMUU0QTE0ODk2NTE1M0M0MkZENCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpCOTJBQzE0QzQ0RDUxMUU0QTE0ODk2NTE1M0M0MkZENCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1LjEgTWFjaW50b3NoIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTQ0QzIwMUM1RjIxNjgxMUE3QkFFMzhGRjc2NTI3MjgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NzcyMEVBRjA2MjIxNjgxMTk3QTVDQTY1REE2OTk0Q0UiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6eYZ88AAADLklEQVR42rSXf2TUYRzHv7tuGcfE6Vwb5zLSSjEj7Y9KWqfEmFZJP+yPMdKKmUrrn0iUfjhWlLFi6YfNrF+StBoTo39iYkTGco4xxxG59P7k/T2PT8/37nu3bx9ezvPj+zyf5/PreS78bGLS8SmrwE6yje3NHJsDBTALpknBz6JhH3NiYAB0gHqPOVv52wJ6QQ48BzdAttTioRJjdeA8mAHHS2xuk3p+M8M16ipVQE49Ds6CiFO9RLjGONf05QLx6wPQaBlbBlPgJVgkP0ETiIJ2sB/E1XfimjfgBOOlKDUqCGOcqBcQnw6BYW5YTo4wbvQhMmCfGRemC2rBiGXzWUb+kM/NRZ6CHWBM9ce5R61NgX6ayhSJ5EPlItlDRNkz4JbFHf06BkSzHjXxM+gDv1S/mPUo2AXWgt9UUHL/IVhS8yUV1/EbV3o4N+NaoE9Fu/i827K5pNYHnqAVJECShWmAaddpscYFFXwR7vnXBRGlnUN/L6kqKJlxnRUuDbaDBiL+vst5d4gpcpBrqk/2jIgCKVUolhntplzivHmwh4stGOPfwBWwl/2dpp8p7xjQZqFLiQJtauKkivYm+kzccpK57yXfOUe+P23JqAnVbhMFmlXntCWnxbT31am9ZJ4BJifsUmNTqt0cYhA5ypympPg7VkEKunPbVb8cIG+0kyHLJZNR7fUMooUKFHAPkfQo58VLK+RzwRDd4FdWG9mjpaAXzqkJa1R7kQttqEABWXMjOOxxVRfnhRm5URX1prk/0pQHwNcKlchZ+jdpC+hFdVqO0my9Hj5dkYgCn1Rfh/KdlNDHrJhPqlDih+IfBd6qwpOgEqYMsorJ2HtWxtagLJDn/W3KRfPOZhoeBJfZPgVeGKeKrkQBh5dLXl25Ny3pc4/1fkTdbvFqFQgbxWeYD0hXulhQ0pYiM1jG547fcbMQpVnHTZEn9W3ljsCzwHxCdVteNHIZvQa7/7cC7nV6zHIfyFP9EXjFa7YxKAVqPP4bxhhoLWW+z9JyCb6M/MREg59/RlmmXbmneIybB+YC/ay+yrffqEddDzwGvKxxDmzhc0tc80XVgblqFfgjwAAPubcGjAOl1wAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-undo{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4em8Dh0gAAAatJREFUWMPt1rFrFFEQBvDfGhACASshkL/ALpWVrSAKEQV5sIULWlgZNSgIFkGIVQ412gkBt1lYLERREFJqJRaW1oHAoZUQsDqwecWy7N3tbe6C4H2wxc682Zn3zTfvLXPM8b8j6RqYF+UCzsfnHBawGt3fMcAX7GEvS8NgKgXkRbmMxwg41TLsN0psZmnodyogL8pFPMIdLHUk7hA7eJKl4U/rAuKu3+HslFr/FZezNPSTFslX8QErDe4DvMVH/Iq9F7VwGpdwZUjsPtaSFjv/1vCBPjaxO0xcNbHejLpZrrlvJCMCT+JzA+2fcC1Lw+GE4l3CG1yIptfjCtiKoqtiJ0vD3aM0Py/K57iIMxgkQxat4EdN7e9xdRzlk+LEEPvDWvIDXJ928sYxjL36icWK+VaWhlezOIqbGFirJd/H7szugrwoX+D2BDEvszSsT5OBdfRaru/F9dPXQF6U27g/KnmWhgctxqyzBrZGMNGL/rHI0nDkKXiKexXTsywNGx0OnFbFNk3BRoWJXnw//j+ivCi32/S8CxPVNiWOAdUiJtXITIqYY45/Cn8B2D97FYW2H+IAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-wheel-pan{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEgswOmEYWAAABddJREFUWMO9l09oXNcVxn/n3vc0fzRjj2RHyIZ6ERuy6CarxJtS0pQSCsXNpqGFWK5tTHAwyqIGN7VdEts1LV04BEoxdlJnUbfNogtDCYWQRZOSxtAUCoFiJY0pWJVUjeTKM9LMe+9+Xcyb8ZMychuofeHCffeee7/vnXvOuefYlV/+mv932//tb91z/Y2rvxmMHQ+4FcEfOIGN4A+UwDDwoQScc7vM7AIwB8yZ2QXn3K77Ab6OgJnVgeOSbkqaBiaACUnTkm4Cx3OZzwf+qzcRQup1zNZ9RwDe+0YI4YKZTUn6zCGSMLOfAF/03r+QZdnyfwO+ePEiI6N1nPMgMDMkETLRbd2mXG8gCbd9YiIKIUxLKoLfBN7I+80+CUlTIYTp7RMT0b3Af37p8kh5y9gZcy4Fzt+5szqSaxkzUR7dwtrKMmaGW242d0t6vrD/He/90865o865o977p4F3Ctp4frnZ3L0Z+OryUrVSrZ0z8ZxhHjhcq1XPrS43q/0flDlK9XpPA2ma7gMeyvfPx3H8TJZlH4YQWiGEVpZlH8Zx/Awwn8s8lKbpvmq1ahvB641SXNk6dhLskNA2MIBtwKHK1vGTW8bKMRbAMgyPqWeETxUM8VSSJAv52JmZA0iSZMHMThWwnipXKp8hsLLcSaIR92oU8xjSayCQXotiHotG3Ku3m+0EOQwPQCDggMf7BzQajSs5eAk4B5zLx4O1vD2eJMmAQKliscgASJMw21pansFs1swQ/DNLmUmTMNuXX+taXHTDaj5OW612R1JZ0nFJJ/J+XFJ5aWmpA6S5bHV8fHsPHFU6q3pJCjtFxtrKMuXRLUUXXxdrRLazFOtUolZlsGhmACsgnHPTwJnCnjP5HMBKLotzxsTE9rgDL0t6LoriKsDIaB31ZEK+JxQJRHFUBR2NqLw8OTkZR0OC0ntm9k1JWU7OA4vD/mZ+YfElsANmNEKi75vztzB5M8uAr+bx48me88g757PQ1U5zNg52YH7hX8l6f+4Fi3c3BqHNmkI4YQOV2MGCNu9qHPYCewfzbrC+XSGcWEcgTRKA3wFfyzdDz5d+D3x9CIcfA4eBbQS9LscskgfLnHNPAnslvS/pbZDHLLPADpx9N9fqpSIBH8cxWZY9m6bpb4Ev5fN/iKLo2TRNgdx/eo8Wk5O7Ts/N/SOSdMjHdj4kmgkIEJLJzPZKetvMTkIvFLsR25Ml2gfuF5M7vnA66sdooJYkCSGERe/9VAjhzRxoKk3Tvg3U8nulVqvx8cyNpER2umM+SdOkbc5B8JhpqBdIgTRR24h+lpKen731aRIN7thscH9Zlv0d2F8YD2TIX7F2uw3A7ZWV1a0TYz9ca8cJZHRbuRuaDfUCw9/qJHamPOKToAwHtHN6lMvlSkH2o7wDMDo6WuGuQbbn5+YAKNcb3J5fSvrhtTY+vsOPuD1IOyRhMOkj9kSx29HfXB5RUnS964NT2+3vbGbxG9auO2cDNuV6A8NTb5TitBuOpQkfYD2vwOxgmvBB2g3Hto5X42EJyVsFlztbKpXGNgqVSqUxSWcLU2+tdToa9hasLjfPYlwGa+bTi8Dl1dvNsyvNtQQL9MO2w+HM7BqwlAtPdrvdq9773WAVsIr3fne3270KTOYyS2Z2bbXdHhogKmPj7YWF+VOSXs/v/9KdO+0fVBrjbRkgB/KIDBnYu9f/7D+ZmfmRxPd6qwB8YmZXcq1MAQ/nJhTM+OnDe/a8+PGNG9lm19V/D1Qw7HXZlcRa69+U6w38l5/4ipxzf5X0CPBILjcGPJH34pVcc8692FxcXLlXRnTwwH7+9P4f8aWe3fY59LIqo1NMyQBCCHNmdgx4BegUWefjDvCKmR0LIcz9L8nokSNH+PRvH4HC3YQ098pSbevg24qlmZmNmtmjkg4D3+j/tZldkvQXSa3PW5ptlpL3ZaIN99OS9F7+IgKUgSyEkNyv2nHT7DZX0dr9rpjua2l2r4rogRAYVqZvnPsPqVnpEXjEaB4AAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-wheel-zoom{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEgskILvMJQAABTtJREFUWMPdl1+MXVUVxn/fPvf2zrSFmUKnoBCUdjRoVaIxEpO2JhilMYBCtBQS2hejpg1Uo2NUrIFAoyGmtiE+GHwQGtvQJhqDmKYRBv+URFsFDNCSptH60DJTO3dKnX/33rM/H7rvsDu9M20fDMaVnGTvtb69z7fWXmvtc/TEzqd4OyXwNsv/FwFJQVI/sA14SZKRLOlPkr5TrVYXHz70quYkEEK4TtI2YAgYkrQthHDdhV5uuw+43/ZrwCbgRttgY/tjtrc0m83X3/f+D6ydnJhYcB4BSZcBA7aP2d4ELAGW2N5k+xgwkDB0IH19CGGH7R8B1aQeAf4KvAw0ku4K2zu7uru3ApdPEyiKohd4TNKjtjt5h6RHgccSNrddbvuHtm9Jqoak7xVF8WFgdavV+pSk5cCObNmXgK++85prCj3z28HKqZMnH7D9YAY4BvwujT8BvCuL1INX9vVt+dfwcCvNb7f9q2RuSfrGvWu/sL2Nf3LX7pzvj4ENSGBPVarVd4fRkZFltjdmoMGiKO4IIWwIIWwoiuIOYDDzeOPoyMiyFLkum7WJCMDztrcrTTrIRuAQZ6NcK1utL4dWq/VZoC8BhqvV6l1lWb4YYxyLMY6VZflitVq9CxhOmL60hhCKeYiV7WMKIXw9jT1HpXw3c+bOAKzOjJubzebJrKQCQLPZPClpc7bP6rMYKtjXth2OMf7tIkr11Wz8oQDc1Fb09vY+kQw1YAuwJY2nbUluAnCWpKkaFl6IQIzxivaR2SYA89sJVK/Xp2x32R6w/a30DNjuqtfrU0ArYecDCEqgLqm94T0dEm9mBG7PxkdDlkBnkhebgIezNQ8nHcCZPL9ijE1Jf/bZZoPtzbavmqNZLbf9tSxq+yoduuJ+SZ+zXSZyBXCqU+d8fvC5yRUrV+0G2j3g2hDCLyXd/+Su3QdnvP/zCuH72LWsgf2k0oHlH2c2odlkxcpVEdgr6aDtjyb8x20/J+mA7T9I6rL9SWA5dne2/GdXLl58qNJh398An85yTMA+4DOz8Dgu6Zu2dwJXJ91ltm8Gbp7Fgb+EEB4aHhpq5CEtACqVyr3AC0AlPS8k3TSmQ2YPhhBuS/1/LpmS9JTtNTHGfwBU2uUALARotVqniqJYH2Pck85pfavVaufAwnQvnHc0McaDKVptebN94QAnJB0EdtjekydyZXqjs/0ZgLIs/w6sy8bnYGYJ63pgERKC05JutT1kOwITwL9tvzlzUQUYB+Zjs2DBgu6xsbGJZHstByZbezregcBXeCsEz1bnzXt5anLyzLq71zDLxTRdVgemdx0fv2e2w5thO5DbiqL4oKT3ZKpnpyYnz+SY2ZpTAPZmJfdIrVZbNBNUq9UW2X4kU+2dcf53Aj1pj2PA7y/6m1DS00A9za9uNBq7iqJYBuoGdRdFsazRaOzKSqye1rTbaa/tlbYrqXQP2X4FIA9/J1l39xrC0v7+w5IeB8XkwS1lWe6TGJAYKMty31tfO4qSHl/a3384I3CDpI+kzC4lnRfrue6GytEjR8oQwlY73gC0L4qlth/q0M1/LYWtR48cKQF6enrC6dOnVwGLEpnxnp7en4+O1i/tszzGOCTpPmB7ahb57QUwBWyXdF+McWg6MScmuoA8OX8xOlpvXGz422XYTsB/SnpA0h7bX5R0WzI9HUL4qe2XbI+dk3xl+V7gxoztD5jRI+YK/zkEEokx2/uB/RdzIfUtueqVN04cXwF8G3iHY3z9Urw/j8ClyhsnjrcS2Vv/J/8NLxT+/zqBTkcxU/cfEkyEAu3kmjAAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-box-edit{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEg4QfHjM1QAAAGRJREFUWMNjXLhsJcNAAiaGAQYsDAwM/+lsJ+OgCwGsLqMB+D8o08CoA0YdMOqAUQewDFQdMBoFIyoN/B/U7YFRB7DQIc7xyo9GwbBMA4xDqhxgISH1klXbDYk0QOseEeOgDgEAIS0JQleje6IAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-freehand-draw{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADTElEQVRYCeWWTWwMYRjH/88721X1lZJIGxJxcEE4OOiBgzjXWh8TJKR76kWacOBGxdEJIdk4VChZI/phidRBHMRRIr7DSUiaSCRFRM3u88gz+o7Z6bBTdjmYZPf9eJ55fv/5zzvvDPC/H9QsA66Olo9Ga+/MdR+Ljm2/KQIULsz9FqItGdOfJKLhApLgVkiSCGODjWit7QpKWy+TNrFeXvzKVUT8NiTVaIgDcbiCFJ7GiT8WkARXAdYBK0Lbhi/CenArRNskuM7/tgNp4ArQ42dwjf3WY5gWTqC7O/NbNn2Xkfw/YwdSw/We14HP2IEZwX+y9cZ9SH0LmgFP7UCz4KkENBNeV0Cz4b8U8DfgKiDxMWwUXETqLvJpCQpXZfawbzS7t9v5pL19cHBwfja7YA0y/lyCM0+E5hv5+piZXwKYcF23as+37bTXsQVqgkL0p/34fHR7DcBtbetFsBmGDwMOJCggYG55yw7dMlk6DuC1Bdu2RsCU9TYWQq2IoGbsreZ5NzvEqfSBsIsIy8OTbcdgiRHeh4o8AFAEwDakbY2AaCCpH7V9aGhoUUUy3UyVbkPYFuYLDlUZH8XBpwxkK0Dbgxg5HcVi0ent7a0RULMIozaHBSMfF9b2SzdutFcFB2FkwMIJOG6qfteXOa1nHZ48tyefuwyfT9s6wtzZ3t7eZse2DR2I228TtHXzuWCx9g8MtK5cuHCZTH4tiHEOa4xFngvTyS8f35d6enomiCi4/foEXBkZaQuukChL4FYA2Whd7YcC4gEdW3CpdL3LtGAVCVYJywEyTpAuJKeMOKXZs/Bw947C50KhUFOG4cwz35cjWNBlHGeD53n3xsfHP/T19U1qciggar8Fa4I3PHobIotBWBtc2hSiChyZxVzM53Pv7FVH6Tp3uVy+g0r1ImD2GjIrQGYIxjnfuXTZGICS5k/bBwJoubwEFX4TLah9EXomJGMA3za+f9913Yl4TnzsDQ+vE6YTZOjHh4ngibstt1pzQwd04F0bPStEBpXqRoBeQ/AKghfBnOEKgS+Q7z91Xfdz/HGKg8Ox7z8iYD9z6wqTkZFgnvhMGP9VZ2or1XVkPM9z0mytSfVsHa1RLBZbLoyNzUnK+ydz3wC6I9x+lwbngwAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-poly-draw{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEjglo9eZgwAAAc5JREFUWMPt1zFrU1EUB/DfS4OmVTGDIChCP4BgnQXRxVHqIJUupp9AB8VBQcRBQUXIB9DWQoMRiXZzcnQSA34A7aAuHSJKkgo2LvfBrU3aJnlYkBy4vHcP557zP/9z3r33JdXa647N0kHSZd5Nn0rSxc8G3cXp85sMcnZZ8vge3osZ+l3vB8CWFA0iL14t79h210swAjACMAIwAjACkB90D/8/GchI9ve4nPwTBh5E9ws7OepzGWb9EddSn51Op9ZstadSg4VK1UKlKkmSDSMLALewiuNh/hVJq71Wxttmqz0dG88vPc+MgWP4grvYG3SLOBrZFFFrttqPe4HIDxh4GSei+98iSlusuYopXEAjBtEPA3tQwUpwluAbDm4TPJUz+BTW9l2Ce6G7L0X/Bw8D3T/7SKKIDzHg7QCcxjvcQAEtXAnrrg/RP0/DKPbqgcN4iVOR7gcO4dcQgRuoh7HSqwlP4n20m63jJu5n8MkWMYfP3UowhzdR8FU8w9iQwevBdyq3/27CMRzAE5yLuvsRLg+ZcR1nJ8YL81HWJUzGAPaFZwe/Q5MdyYDyNHgjzO90YyGHtVDncuiJchaHw8R4oREFV5qdiVmYLM3OgD9k5209/atmIAAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-point-draw{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEMEiERGWPELgAAA4RJREFUWMO1lr1uG1cQhb9ztdRSP7AF1QxgwKlcuZSqRC9gWUUUINWqTh5AnaFOnVPEteQmRuhCURqWsSqqc9IolREXdEvQBElxtdw7KURSFEVKu4w8wAKLxdw9Z+bMnRmZGXfZ29//II8th4WwGVNyIoQLYB5vxA9Caq04iUd9A+7ZlsNC2I7TdSd2hZXMJKlnTqp9jtl/GBaqoyQ0noFKpUIzBicYYc+DEFpxkglc4oVJa5gvDn8v1xV2irG3FM4NSVwjUKlUaMcpJhCGmSEJQ6QGD8M5WnHCd8+f3QCXpPLx8WNwv0j6Bm9FMK7FJ3WBE+R/2t7c/GBmFvSBrzRTCsyTDjXrxUgEMtpxynJYmJoBJ4VAybwVARgvL7Oik0okCodnKpVKX7P0leiVMb0VvbJT+upznK4vh0GIeQwwQStJkHQD3MwsCALTJRG7Qrdrj5m/djgYaIa0hlkRdJk26XEgC9txurccBtVW3IudBImmZuACUP+ZlIDBt9FKcubYNTcAH/X0RYM1E7utJPlqe+uZzPxUcEkiSS4sTT95n15Mud0xWC0o2PAWOCdK3KYZlFxfM+tHOcnMzNr1es18ug+cgsVjP4yBU/Ppfrter1m/+l0+zYygML1xRVHU7TSb1cSzBzoBzszsH+AMdJJ49jrNZjWKou6wBnwOzcyndBpNbuueURR1Dw8Pq35p9cc5p/Dy9Dypt7jXrtdGwQECS9NPhr6Gq6txUzNigE6zydLK6lTw12/KT4FGFEUfJX2YJNONq5tVs4ODA7sD/DnwJ/BoADZuE3tHFs12dna6d4C/BI6AlbyzI8ii2TTw12/KK33gb2cdXsNZoAntbZC2SeO4c9592k/5eNQbiwvFd1kJuFGwLJr1wSPg/SwpvyFBHufOeXcFeAlE97U/uCxOY+P3b+Bn4B3Q+L8EdJfD4a+/AbC4UBzPxiPg3wlHZquB28Cn2IuR9x3gr3uV4DbwfvSDOvi4uFA8BDZmIRHkjHpS9Ht9iRqd8+5G3g05mAGcQbsdiX5QJ428G7Kygo8XYdb1/K4NWVmjzkNge2sz84bs+ELmpDDLtqWsNZBXgvmw8CTtpWVMT7x5YWBjLARnwZfKQNYN2U2LPvrh+5nBt7c2M2/It9bArCTKR8eZN+SJ13AScPnoODeRdqNenH+wul5w2gUr2WUjMFAt8bZ/0axX/wNnv4H8vTFb1QAAAABJRU5ErkJggg==");}.bk-root .bk-tool-icon-poly-edit{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gELFi46qJmxxAAABV9JREFUWMOdl19vFFUYxn9n9u9sCyylUIzWUoMQBAWCMdEEIt6xIRQSLIEKtvHe6AcA4yeQb7CAUNJy0daLeomJN8SEULAC2kBBapBKoLvbmdl/c14vdmY7u91tF95kknPOnHmf95znPc97Ro2OTeBbdjFDT3c32ZxVHUOE9kSMB0/m6ExuoJn1H+ur6Y+OTfD50SMN5168OgrAlyf7CfuD+z7+iDs3p8hkLUQ0iFQ/yFl5Nm/qonfHVva+s32Zw9GxCYILsZ08tpNfBhbs+1YN4OH9+7huGdECSBVfqUosbsllfmauBqiR+cCNwOr7AEo8pPHJnymXykhg5fUWjoQpl0vVvhZhbSzGoUOHqgBlt6B6uruj2Zy1E9jo0fhfeyL2x4Mnc8VErK0KUEOB64JSyptfG4RSytsJjUJVxw2lsFy3urL9nx1Qd25ObctkrVMi+jQivd7U2ZyV/3Hzpq7h3h1b/7p9Y0o8v8rwAbTWrGpSocN/FGDlbAI0Rl23PCBan0Ok158H9Ipwzi25A/Mzc9Gl/BYx/E4kYqC1NKRARNAaDCNUM27Z+Zr+ouXs0q4+LSLBHPYCFkTkC6uU39kwCdsS7WRKmaYUiAhdnZ3MPX2K4+QjQI+C94A93rMzm8ltMwyDeDzWjMZeEb2pYQDdW3vITU2jtUZ5QThOPgm8C7wP7J15OPsBsB3oWpGnVWisCeDS1VHj4vBI92+/3tgB7Ab2AruAXiDBK5oIOkhtkEYRNRuJhObrd8Dl9ewf4D5wG7hVLpen29vb5wzD+BrkbBMaL3d1dk5nsrnlFDTTFWAWmAZueWD3gCemGde2k2fw1Al1YXhEvjozoO49eczdqekrWmsc2zlrmvEKOGoW1GUjFLqSk2KpJrCLwyMCPAP+BO54QL8DM6YZX/ClsP9YnwKkXnIBP4jdIpJRpdJTCYdMwwi98KU0Hjc/dDILNyUcwTCWdOSMJ0TRmBktGRhLugu0xyLk7CIqVNm+0bGJptl1YXikD0grpY4Rjc4a8Fbgdab/6OGbAJeCUuyJnnHmZH9pbSyGuBXV8NUwlUpR1EWyixmSyTWEwqGlJ2Swbo2JXbAAfgDGgGQA9I1A9t1tlq0AxrXxn0ilUpw4fhQqYkH/sT41OTnJJwf2s6FjI5mshdYa7bqVR2uezr9MJmJt14FvGrh/O9D+e6UkM/xyCuCqEKCYnJyUTKFQrZDHjxzGshwWLQcRsOz8Hi85P23id0ug/XilAMLBmm4tPGdoaKjSH5+oAGrhwvBI9SjZTn4QSK9yenoD7dlrExPoJlXW8G8ytpNHxRKk02lGxsdRKFwXLNvx5yY94HQLGhGk4LFCYQSqaE0AwWM1eOoEbR0dKBSW7bC4mKuffxs4D/wCLKwQQPAUzIkslfp6cVomROWSolh0GjldAM4nzDi2k9/i5UAzC9aKfwNJ3zgJg9YEvN6+C7SHgKm69+sD7RfNnKTTaZRPQfAut4oFV//IS7gkcB34VlVo8kGzphlfB+DU+TfNGBpZtRastvrvARJmfMF28ge9sc2B9/PNnCilMIDwK6y8/ow/Ai4kvILTljAXvDvEvrqKSUs60KolzPjBxspavQD2tKqCAGF/Ba+xE/Wbilu54wZV8NEKF5fXzQHl/bh4hUsE0WAXSlDMYcQSrQXgCmsTseXHsJkNnjqBFGwKJaHsKlxtUHYVhbLCzr1kaOA4bcn1y1Swmb+iLpJKpVrfgdpfsiVVCYcgluwgnU7jEgJ4s5UkLFtWYyHyEg0/N1q1tmQH+YXnAMFr97Nmv3p+0QsHQRsF8qpBOE5+rb9Nkaj50tVQKjqh4OU3GNL/1/So3vuUgbAAAAAASUVORK5CYII=");}.bk-root .bk-tool-icon-line-edit{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAG/3pUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjarVdpknSpDfzPKXwEJBDLccQW4Rv4+E4BtXR198znCdeLLijgQUoppWg3//Pv5f6FDwefXJRcUk3J4xNrrKzoFH8+pyUf9/f+8J3C7y/j7jnBGApow/mZ5l2vGJfXCzne8fZ13OV+9yl3ozvx2DDYyXbauCDvRoHPON3frl5Imt7MuX8hH0seiz9/xwxnDMFgYMczUPD7m89J4fwp/iK+OVRbiMf6gm8K4bv/3NN1Pzjw2fvwn+93PLzccTZ6mJU+/HTHSX723/bSOyLi58n8jmiqz/798+a/tUZZax7rNCKOakzXqIcpu4eFDe483kh4Mv4E/byfiqd49R2OHzC1Od/woxLD44siDVJaNHfbqQNi5MkZLXPnsMdKyFy5gwwCHXhocXahhhEK+OhgLmCYn1hon1vtPBxWcPIgrGTCZrR5fHvc58A/fb5stJaFOZEvT18BF1t8AYYxZ99YBUJoXZ/K9i+50/jPjxEbwKBsNxcYqL6dLZrQK7bC5jl4cVga/Ql5yuNuABfhbAEYCmDAJwpCiXxmzkTwYwE/CuQcIjcwQOKEB1ByDCGBnMJ2Nt7JtNey8BmGvIAICSlkUFODgqwYJSbkW0EIqZMgUUSSZClSRVNIMUlKKSfTKc0hxyw55ZxLrllLKLFISSWXUmrRyjVAxsTVVHMttVZVHKpRsZdivWKgcQstNmmp5VZabdoRPj126annXnrtOniEAQlwI408yqhDJ02E0oxTZpp5llmnLsTaCisuWWnlVVZd+mTtsvqVtU/m/po1uqzxJsrW5RdrGM75sQWZnIhxBsY4EhjPxgACmo0zXyhGNuaMM185uBCEgVKMnEHGGBiMk1gWPbl7Mfcrbw7e/V9545+Yc0bd/4M5Z9S9Mfedtx9YG7rlNmyCLAvhUyhkQPrNhvO5AJFnrZIR0plaLL5liQYdDi5TubaIokFDkmoFEB8CzxZVxemssDqthPhUblPgW1iQU5g6XwNwyVI7bUFRm035iNziMkgWvEso2SXnsJfveR0Y4SlVF8YWC1pVQhJiQa8JwDvlMNIxAfq3F7GDObHU1LlhzlZaWwNp6BvACxAgInGXlllMGZCpEnZHrGA6GM2718xuFcz7YdUQxzEEfjdWz4GlkcwaonT0pgA6mB25grPILtnSMhuCpsGhmMU6uJbixJs4lbKHqh+wos1jW2rchyGRCIvN9MXu+KAmMSfAlIKVvi/tybhCPJZCu2Ow9pLdyo427+X2ovMBmKNu8PA0zgl3fS0PB1DWWkVYB47bkyiJHhkFPzTzCjzn4Dq1mqoIWzCmcDGsHQmQAQdEHsixK1IXESd5rLU7THVJNV8obHS8sZeN0G5Jdt5pQTVKCCbgK1hItTS8o92iEZpuWJ/oC2r/0+zTmhvFXoaMVKRe27altDtid6OvG1hENVwBnC61KKugNoemOiPCCNb3GoHAZOFuDxxPsD+07nbSPcr/o1Zmc4jARhotrA5F5ZcjP9rPk90vR8A+k028A+8+5wKlHVID542sMzMCuXktkRzUCpE+xCBZywjNcJITx0II9x5948CekBl4XaC5OCX2nCyObdwN3HwQh5DWL/BBEkhDYHn/vpXNgZkVTZs8rj+HO8JFC6qvDVhgAEQSYCDyC86rMhG1WPzAVB9ZldDWG6EzDcFiqJBDvFS8mXDv3SK2LPoguVB2kwUx7UL5KqZWiEzocsbvSjNnaYDNtcYJuA5cDcsrvHd6yCxGjqvl9+wh3Qh8Kc9py8sNW8ncU8qwxdPj1qIGfrPqlXeoS4/JLa/LwRLTCtxuSoZUT+2Su6kXW3QNacYQbId6NUKVbROpviybFSPQQL9lhB2MamEnFyB9Y+hrG1+xBg+L0QG2TZdTdlcsBdq9oHdt9Bu5/IM9+Nfh1AwrSqlboTA6Bgq568A7UfbaMrZjoQZhQphofvNw93+bN+5X7FYKBgLmRid+tSdV6c02A4R0cHwKobmoMt5+6WI9XNISFIywpf6RMd5/a91vE78FzVHIFmxud4woyJx76OMTCa4yhgN3iJO2VfRPFMv9sYTxFzU+1eWeYS52pwOoSJldZY6koib4P1O427rbeUrNZfu44hWjz5ZSuu/vKPpimoXbLkfxWSPetvxDWG5jQSaZCxA3ad+p6rlttDhK+YwwK1LHVe0drDtorc5vnQ1247g58vewDtU7L3DRwrG4dhCUDRKKOtYr2dXHtpt+33d1WZmfkAHdl7Q8ENF+CNgB+nOw29n5F7SeNo/ckbu4laLTCdqJLHjmhJbKzmrCEX7zULrhefuHmu0V/1nbP1pnb6FaT7sOxn4pvWkfrYhYtCeJ4Xv+kOXrroIs1eHWXN1/AfzaY94ms5vaAAABg2lDQ1BJQ0MgcHJvZmlsZQAAeJx9kT1Iw0AcxV/TSkUqDnYQUchQnSyIijhqFYpQIdQKrTqYXPoFTRqSFBdHwbXg4Mdi1cHFWVcHV0EQ/ABxcnRSdJES/5cUWsR4cNyPd/ced+8AoVFhmhUaBzTdNtPJhJjNrYrhV4QwjAgGIMrMMuYkKQXf8XWPAF/v4jzL/9yfo1fNWwwIiMSzzDBt4g3i6U3b4LxPHGUlWSU+Jx4z6YLEj1xXPH7jXHRZ4JlRM5OeJ44Si8UOVjqYlUyNeIo4pmo65QtZj1XOW5y1So217slfGMnrK8tcpzmEJBaxBAkiFNRQRgU24rTqpFhI037Cxz/o+iVyKeQqg5FjAVVokF0/+B/87tYqTE54SZEE0PXiOB8jQHgXaNYd5/vYcZonQPAZuNLb/moDmPkkvd7WYkdA3zZwcd3WlD3gcgcYeDJkU3alIE2hUADez+ibckD/LdCz5vXW2sfpA5ChrlI3wMEhMFqk7HWfd3d39vbvmVZ/P2aecqIM1FFZAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5AQdDBkQmV+argAABM5JREFUWMOtl9trHFUcxz9n9jYzm7Tb9JIWGtqUllLwVgRBQWl90S6lTaGmF6E2/4H+A4r+A0offdlWodL4kEZw9bG+iC9iKqLF0os0EBq02dtcdmdnfj7szGZ2M5vulv5g4JwzZ873+7ufUfMLi0RSa1TZNzVFrW511xBhzMxx79EyOwrbGSSzZ073zOcXFnlv5lTi3mvfzAPwwYVZ0tHiq6+/xu+/LlGtWYgEINL9oG657N41yfSRgxw9cHjDgfMLi8QVsR0X23E3gMXnkXQJ3L9zB99vI4EA0sVXqsPF93xW7y73ACVJBJwE1j8HUBIi3Sz/QNtrIzHN+yWdSdNue915IMKWXI4TJ050Adp+U+2bmkrV6tZeYAXwEJExMyf3Hi0rM5fvAvS4wPdBKRW6vZeEUiq0RIBCddddpymu0+rRbPvEzkPVmmWLBA1EdGAbYNctt7V712QwfeSgd/uXJQnPVVoEEAQBTxXpuEMELNtNNFW1WrsrQdBCRImQEeE/wBUh53v+7tW7y5n1+BZRIoJSioXvy3itdgclURSZTBrP87AdV57G1TT0d4GPgC+Bw8Ca7bifATsTgzBvjlH1qgNdICJM7tjB8soKw4jtuD+Gw3c229e1wF+P/uHPpT86rhBBRHActwAcAl4EjgIvAYcFJnlOoq5dv6EBU8AR4OUQ6AVgGjATwuC5YUdZ4A+z+1mBTUM/AKwqpZSIpPfu2VP7+/6DYEMMPE9N83lzq23ZWwxDd4GaQnmgUloqperSCpKC8HGCXz8G7NANU8CWUKPzsUDbyLPVyjYC39e0VMZx3Ccoha4b4lQqbUlnsBqNWCXpEMgKfA38DNSBcdPQr4zlMtTtFiqlulmQmJv9ks2idUZGZMjZmZMAfBUvxWHR0y5dmPV2FcbPG9ncFdPQS3nTuAJQLBZpBS1qjSqFwjipdGr9SWlsHTewm9ZmnngMKAaV9nBd+/bmdxSLRc6dnemm3+yZ06pcLvPGW2+yfWIn1ZpFEAQEvt95goCV1TXMXH4zAt4woaRF7RTAVylAUS6Xpdpsdjvk2VMnsSyHhuVEZTh+xgywBhwLfZIdKRfj7dWqPGFubq7T428ukslkaHttLNsZ9P3nwIfh+DhwS4EO9DA0zByBCE2n1fPxpQuznSCaX1js9nFp2pjbtqGhobQ0jUY9CbgALERah3IM+El1rNqTaqaph5W1uYGAFrfA5YvnyE9MoFBYtjMI/BXgQR/4pqVDZL3V9/cYrX+x7SnsXh/H5TLwW2iBQbVLNgn65CDsrSPOIJOXwmdQ4fRHrZilUqmXwNXrNzbbfxv4ArgFVBLeJ95oDEMHwHHcvvUcRqEwuBf0SSUEB9gfxsAgAkO1kcj/WvwKPaR8EhvPAUvRtdIMtR1FtBH37w8DEeChaehXw/xfAnzHcVOjEkhHrIe0Qlz7T8PuWLEd9+2w9KphgUUgQJ7JAgAPDT13NTrJyOYqIilrlEwQv/NPMTSByxfPIU37eCqtq2zWmPYDjbavaLYVdn2NuffPjqRJK2hRLBaHzoK+X7L1QE+nIFeYoFQqkTVMaTn2UOe1LWtwEJqGzqgRnS9M4Fb+3XBJGfSrFzW9dBw0icioJBzHzUXdMJM18APwWo6Kmy1O6X+V8UHDotBqogAAAABJRU5ErkJggg==");}'},function(t,e,i,s,n){s(),i.root="bk-root",i.menu_icon="bk-menu-icon",i.context_menu="bk-context-menu",i.horizontal="bk-horizontal",i.vertical="bk-vertical",i.divider="bk-divider",i.active="bk-active",i.menu="bk-menu",i.above="bk-above",i.below="bk-below",i.caret="bk-caret",i.down="bk-down",i.up="bk-up",i.left="bk-left",i.right="bk-right",i.default=".bk-root .bk-menu-icon{width:28px;height:28px;background-size:60%;background-color:transparent;background-repeat:no-repeat;background-position:center center;}.bk-root .bk-context-menu{position:absolute;display:inline-flex;display:-webkit-inline-flex;flex-wrap:nowrap;-webkit-flex-wrap:nowrap;user-select:none;-ms-user-select:none;-moz-user-select:none;-webkit-user-select:none;width:auto;height:auto;z-index:100;cursor:pointer;font-size:12px;background-color:#fff;border:1px solid #ccc;border-radius:4px;box-shadow:0 6px 12px rgba(0, 0, 0, 0.175);}.bk-root .bk-context-menu.bk-horizontal{flex-direction:row;-webkit-flex-direction:row;}.bk-root .bk-context-menu.bk-vertical{flex-direction:column;-webkit-flex-direction:column;}.bk-root .bk-context-menu > .bk-divider{cursor:default;overflow:hidden;background-color:#e5e5e5;}.bk-root .bk-context-menu.bk-horizontal > .bk-divider{width:1px;margin:5px 0;}.bk-root .bk-context-menu.bk-vertical > .bk-divider{height:1px;margin:0 5px;}.bk-root .bk-context-menu > :not(.bk-divider){border:1px solid transparent;}.bk-root .bk-context-menu > :not(.bk-divider).bk-active{border-color:#26aae1;}.bk-root .bk-context-menu > :not(.bk-divider):hover{background-color:#f9f9f9;}.bk-root .bk-context-menu.bk-horizontal > :not(.bk-divider):first-child{border-top-left-radius:4px;border-bottom-left-radius:4px;}.bk-root .bk-context-menu.bk-horizontal > :not(.bk-divider):last-child{border-top-right-radius:4px;border-bottom-right-radius:4px;}.bk-root .bk-context-menu.bk-vertical > :not(.bk-divider):first-child{border-top-left-radius:4px;border-top-right-radius:4px;}.bk-root .bk-context-menu.bk-vertical > :not(.bk-divider):last-child{border-bottom-left-radius:4px;border-bottom-right-radius:4px;}.bk-root .bk-menu{position:absolute;left:0;width:100%;z-index:100;cursor:pointer;font-size:12px;background-color:#fff;border:1px solid #ccc;border-radius:4px;box-shadow:0 6px 12px rgba(0, 0, 0, 0.175);}.bk-root .bk-menu.bk-above{bottom:100%;}.bk-root .bk-menu.bk-below{top:100%;}.bk-root .bk-menu > .bk-divider{height:1px;margin:7.5px 0;overflow:hidden;background-color:#e5e5e5;}.bk-root .bk-menu > :not(.bk-divider){padding:6px 12px;}.bk-root .bk-menu > :not(.bk-divider):hover,.bk-root .bk-menu > :not(.bk-divider).bk-active{background-color:#e6e6e6;}.bk-root .bk-caret{display:inline-block;vertical-align:middle;width:0;height:0;margin:0 5px;}.bk-root .bk-caret.bk-down{border-top:4px solid;}.bk-root .bk-caret.bk-up{border-bottom:4px solid;}.bk-root .bk-caret.bk-down,.bk-root .bk-caret.bk-up{border-right:4px solid transparent;border-left:4px solid transparent;}.bk-root .bk-caret.bk-left{border-right:4px solid;}.bk-root .bk-caret.bk-right{border-left:4px solid;}.bk-root .bk-caret.bk-left,.bk-root .bk-caret.bk-right{border-top:4px solid transparent;border-bottom:4px solid transparent;}"},function(t,e,i,s,n){s();const o=t(1),r=t(43),a=t(245),l=o.__importStar(t(243));class c{constructor(t,e={}){this.items=t,this.options=e,this.el=r.div(),this._open=!1,this._item_click=t=>{var e;null===(e=this.items[t])||void 0===e||e.handler(),this.hide()},this._on_mousedown=t=>{var e,i;const{target:s}=t;s instanceof Node&&this.el.contains(s)||(null===(i=(e=this.options).prevent_hide)||void 0===i?void 0:i.call(e,t))||this.hide()},this._on_keydown=t=>{t.keyCode==r.Keys.Esc&&this.hide()},this._on_blur=()=>{this.hide()},r.undisplay(this.el)}get is_open(){return this._open}get can_open(){return 0!=this.items.length}remove(){r.remove(this.el),this._unlisten()}_listen(){document.addEventListener("mousedown",this._on_mousedown),document.addEventListener("keydown",this._on_keydown),window.addEventListener("blur",this._on_blur)}_unlisten(){document.removeEventListener("mousedown",this._on_mousedown),document.removeEventListener("keydown",this._on_keydown),window.removeEventListener("blur",this._on_blur)}_position(t){const e=this.el.parentElement;if(null!=e){const i=e.getBoundingClientRect();this.el.style.left=null!=t.left?t.left-i.left+"px":"",this.el.style.top=null!=t.top?t.top-i.top+"px":"",this.el.style.right=null!=t.right?i.right-t.right+"px":"",this.el.style.bottom=null!=t.bottom?i.bottom-t.bottom+"px":""}}render(){var t,e;r.empty(this.el,!0);const i=null!==(t=this.options.orientation)&&void 0!==t?t:"vertical";r.classes(this.el).add("bk-context-menu",`bk-${i}`);for(const[s,n]of a.enumerate(this.items)){let t;if(null==s)t=r.div({class:l.divider});else{if(null!=s.if&&!s.if())continue;{const i=null!=s.icon?r.div({class:["bk-menu-icon",s.icon]}):null;t=r.div({class:(null===(e=s.active)||void 0===e?void 0:e.call(s))?"bk-active":null,title:s.tooltip},i,s.label)}}t.addEventListener("click",(()=>this._item_click(n))),this.el.appendChild(t)}}show(t){if(0!=this.items.length&&!this._open){if(this.render(),0==this.el.children.length)return;this._position(null!=t?t:{left:0,top:0}),r.display(this.el),this._listen(),this._open=!0}}hide(){this._open&&(this._open=!1,this._unlisten(),r.undisplay(this.el))}toggle(t){this._open?this.hide():this.show(t)}}i.ContextMenu=c,c.__name__="ContextMenu"},function(t,e,i,s,n){s();const o=t(9);function*r(t,e){const i=t.length;if(e>i)return;const s=o.range(e);for(yield s.map((e=>t[e]));;){let n;for(const t of o.reversed(o.range(e)))if(s[t]!=t+i-e){n=t;break}if(null==n)return;s[n]+=1;for(const t of o.range(n+1,e))s[t]=s[t-1]+1;yield s.map((e=>t[e]))}}i.enumerate=function*(t){let e=0;for(const i of t)yield[i,e++]},i.combinations=r,i.subsets=function*(t){for(const e of o.range(t.length+1))yield*r(t,e)}},function(t,e,i,s,n){s();const o=t(1),r=t(238),a=o.__importStar(t(241)),l=t(43);class c extends r.ButtonToolButtonView{render(){super.render(),l.classes(this.el).toggle(a.active,this.model.active)}_clicked(){const{active:t}=this.model;this.model.active=!t}}i.OnOffButtonView=c,c.__name__="OnOffButtonView"},function(t,e,i,s,n){s();const o=t(238),r=t(246);class a extends o.ButtonToolView{}i.InspectToolView=a,a.__name__="InspectToolView";class l extends o.ButtonTool{constructor(t){super(t),this.event_type="move"}static init_InspectTool(){this.prototype.button_view=r.OnOffButtonView,this.define((({Boolean:t})=>({toggleable:[t,!0]}))),this.override({active:!0})}}i.InspectTool=l,l.__name__="InspectTool",l.init_InspectTool()},function(t,e,i,s,n){s();const o=t(1),r=t(19),a=t(43),l=t(122),c=t(240),h=t(20),_=t(9),d=t(13),u=t(8),p=t(249),m=t(99),g=t(53),f=t(236),b=t(237),v=t(251),y=t(252),x=t(247),w=o.__importStar(t(241)),A=w,k=o.__importStar(t(253)),S=k;class T extends g.Model{constructor(t){super(t)}static init_ToolbarViewModel(){this.define((({Boolean:t,Nullable:e})=>({_visible:[e(t),null],autohide:[t,!1]})))}get visible(){return!this.autohide||null!=this._visible&&this._visible}}i.ToolbarViewModel=T,T.__name__="ToolbarViewModel",T.init_ToolbarViewModel();class C extends c.DOMView{constructor(){super(...arguments),this.layout={bbox:new m.BBox}}initialize(){super.initialize(),this._tool_button_views=new Map,this._toolbar_view_model=new T({autohide:this.model.autohide})}async lazy_initialize(){await super.lazy_initialize(),await this._build_tool_button_views()}connect_signals(){super.connect_signals(),this.connect(this.model.properties.tools.change,(async()=>{await this._build_tool_button_views(),this.render()})),this.connect(this.model.properties.autohide.change,(()=>{this._toolbar_view_model.autohide=this.model.autohide,this._on_visible_change()})),this.connect(this._toolbar_view_model.properties._visible.change,(()=>this._on_visible_change()))}styles(){return[...super.styles(),w.default,k.default]}remove(){l.remove_views(this._tool_button_views),super.remove()}async _build_tool_button_views(){const t=null!=this.model._proxied_tools?this.model._proxied_tools:this.model.tools;await l.build_views(this._tool_button_views,t,{parent:this},(t=>t.button_view))}set_visibility(t){t!=this._toolbar_view_model._visible&&(this._toolbar_view_model._visible=t)}_on_visible_change(){const t=this._toolbar_view_model.visible,e=A.toolbar_hidden;this.el.classList.contains(e)&&t?this.el.classList.remove(e):t||this.el.classList.add(e)}render(){if(a.empty(this.el),this.el.classList.add(A.toolbar),this.el.classList.add(A[this.model.toolbar_location]),this._toolbar_view_model.autohide=this.model.autohide,this._on_visible_change(),null!=this.model.logo){const t="grey"===this.model.logo?S.grey:null,e=a.a({href:"https://bokeh.org/",target:"_blank",class:[S.logo,S.logo_small,t]});this.el.appendChild(e)}for(const[,s]of this._tool_button_views)s.render();const t=[],e=t=>this._tool_button_views.get(t).el,{gestures:i}=this.model;for(const s of d.values(i))t.push(s.tools.map(e));t.push(this.model.actions.map(e)),t.push(this.model.inspectors.filter((t=>t.toggleable)).map(e));for(const s of t)if(0!==s.length){const t=a.div({class:A.button_bar},s);this.el.appendChild(t)}}update_layout(){}update_position(){}after_layout(){this._has_finished=!0}export(t,e=!0){const i="png"==t?"canvas":"svg",s=new p.CanvasLayer(i,e);return s.resize(0,0),s}}function M(){return{pan:{tools:[],active:null},scroll:{tools:[],active:null},pinch:{tools:[],active:null},tap:{tools:[],active:null},doubletap:{tools:[],active:null},press:{tools:[],active:null},pressup:{tools:[],active:null},rotate:{tools:[],active:null},move:{tools:[],active:null},multi:{tools:[],active:null}}}i.ToolbarBaseView=C,C.__name__="ToolbarBaseView";class E extends g.Model{constructor(t){super(t)}static init_ToolbarBase(){this.prototype.default_view=C,this.define((({Boolean:t,Array:e,Ref:i,Nullable:s})=>({tools:[e(i(f.Tool)),[]],logo:[s(h.Logo),"normal"],autohide:[t,!1]}))),this.internal((({Array:t,Struct:e,Ref:i,Nullable:s})=>{const n=e({tools:t(i(b.GestureTool)),active:s(i(f.Tool))});return{gestures:[e({pan:n,scroll:n,pinch:n,tap:n,doubletap:n,press:n,pressup:n,rotate:n,move:n,multi:n}),M],actions:[t(i(v.ActionTool)),[]],inspectors:[t(i(x.InspectTool)),[]],help:[t(i(y.HelpTool)),[]],toolbar_location:[h.Location,"right"]}}))}initialize(){super.initialize(),this._init_tools()}_init_tools(){const t=function(t,e){if(t.length!=e.length)return!0;const i=new Set(e.map((t=>t.id)));return _.some(t,(t=>!i.has(t.id)))},e=this.tools.filter((t=>t instanceof x.InspectTool));t(this.inspectors,e)&&(this.inspectors=e);const i=this.tools.filter((t=>t instanceof y.HelpTool));t(this.help,i)&&(this.help=i);const s=this.tools.filter((t=>t instanceof v.ActionTool));t(this.actions,s)&&(this.actions=s);const n=(t,e)=>{t in this.gestures||r.logger.warn(`Toolbar: unknown event type '${t}' for tool: ${e}`)},o={pan:{tools:[],active:null},scroll:{tools:[],active:null},pinch:{tools:[],active:null},tap:{tools:[],active:null},doubletap:{tools:[],active:null},press:{tools:[],active:null},pressup:{tools:[],active:null},rotate:{tools:[],active:null},move:{tools:[],active:null},multi:{tools:[],active:null}};for(const r of this.tools)if(r instanceof b.GestureTool&&r.event_type)if(u.isString(r.event_type))o[r.event_type].tools.push(r),n(r.event_type,r);else{o.multi.tools.push(r);for(const t of r.event_type)n(t,r)}for(const r of Object.keys(o)){const e=this.gestures[r];t(e.tools,o[r].tools)&&(e.tools=o[r].tools),e.active&&_.every(e.tools,(t=>t.id!=e.active.id))&&(e.active=null)}}get horizontal(){return"above"===this.toolbar_location||"below"===this.toolbar_location}get vertical(){return"left"===this.toolbar_location||"right"===this.toolbar_location}_active_change(t){const{event_type:e}=t;if(null==e)return;const i=u.isString(e)?[e]:e;for(const s of i)if(t.active){const e=this.gestures[s].active;null!=e&&t!=e&&(r.logger.debug(`Toolbar: deactivating tool: ${e} for event type '${s}'`),e.active=!1),this.gestures[s].active=t,r.logger.debug(`Toolbar: activating tool: ${t} for event type '${s}'`)}else this.gestures[s].active=null}}i.ToolbarBase=E,E.__name__="ToolbarBase",E.init_ToolbarBase()},function(t,e,i,s,n){s();const o=t(250),r=t(99),a=t(43);function l(t){!function(t){void 0===t.lineDash&&Object.defineProperty(t,"lineDash",{get:()=>t.getLineDash(),set:e=>t.setLineDash(e)})}(t),function(t){t.setImageSmoothingEnabled=e=>{t.imageSmoothingEnabled=e,t.mozImageSmoothingEnabled=e,t.oImageSmoothingEnabled=e,t.webkitImageSmoothingEnabled=e,t.msImageSmoothingEnabled=e},t.getImageSmoothingEnabled=()=>{const e=t.imageSmoothingEnabled;return null==e||e}}(t),function(t){t.ellipse||(t.ellipse=function(e,i,s,n,o,r,a,l=!1){const c=.551784;t.translate(e,i),t.rotate(o);let h=s,_=n;l&&(h=-s,_=-n),t.moveTo(-h,0),t.bezierCurveTo(-h,_*c,-h*c,_,0,_),t.bezierCurveTo(h*c,_,h,_*c,h,0),t.bezierCurveTo(h,-_*c,h*c,-_,0,-_),t.bezierCurveTo(-h*c,-_,-h,-_*c,-h,0),t.rotate(-o),t.translate(-e,-i)})}(t)}const c={position:"absolute",top:"0",left:"0",width:"100%",height:"100%"};class h{constructor(t,e){switch(this.backend=t,this.hidpi=e,this.pixel_ratio=1,this.bbox=new r.BBox,t){case"webgl":case"canvas":{this._el=this._canvas=a.canvas({style:c});const t=this.canvas.getContext("2d");if(null==t)throw new Error("unable to obtain 2D rendering context");this._ctx=t,e&&(this.pixel_ratio=devicePixelRatio);break}case"svg":{const t=new o.SVGRenderingContext2D;this._ctx=t,this._canvas=t.get_svg(),this._el=a.div({style:c},this._canvas);break}}l(this._ctx)}get canvas(){return this._canvas}get ctx(){return this._ctx}get el(){return this._el}resize(t,e){this.bbox=new r.BBox({left:0,top:0,width:t,height:e});const i=this._ctx instanceof o.SVGRenderingContext2D?this._ctx:this.canvas;i.width=t*this.pixel_ratio,i.height=e*this.pixel_ratio}prepare(){const{ctx:t,hidpi:e,pixel_ratio:i}=this;t.save(),e&&(t.scale(i,i),t.translate(.5,.5)),this.clear()}clear(){const{x:t,y:e,width:i,height:s}=this.bbox;this.ctx.clearRect(t,e,i,s)}finish(){this.ctx.restore()}to_blob(){const{_canvas:t}=this;if(t instanceof HTMLCanvasElement)return null!=t.msToBlob?Promise.resolve(t.msToBlob()):new Promise(((e,i)=>{t.toBlob((t=>null!=t?e(t):i()),"image/png")}));{const t=this._ctx.get_serialized_svg(!0),e=new Blob([t],{type:"image/svg+xml"});return Promise.resolve(e)}}}i.CanvasLayer=h,h.__name__="CanvasLayer"},function(t,e,i,s,n){s();const o=t(168),r=t(8),a=t(43);function l(t){if(!t)throw new Error("cannot create a random attribute name for an undefined object");const e="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";let i="";do{i="";for(let t=0;t<12;t++)i+=e[Math.floor(Math.random()*e.length)]}while(t[i]);return i}function c(t){var e;const i={left:"start",right:"end",center:"middle",start:"start",end:"end"};return null!==(e=i[t])&&void 0!==e?e:i.start}function h(t){var e;const i={alphabetic:"alphabetic",hanging:"hanging",top:"text-before-edge",bottom:"text-after-edge",middle:"central"};return null!==(e=i[t])&&void 0!==e?e:i.alphabetic}const _=function(t,e){const i=new Map,s=t.split(",");e=null!=e?e:10;for(let n=0;n<s.length;n+=2){const t="&"+s[n+1]+";",o=parseInt(s[n],e);i.set(t,"&#"+o+";")}return i.set("\\xa0","&#160;"),i}("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),d={strokeStyle:{svgAttr:"stroke",canvas:"#000000",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",canvas:"#000000",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",canvas:"butt",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",canvas:"miter",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",canvas:10,svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",canvas:1,svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",canvas:1,svg:1,apply:"fill stroke"},font:{canvas:"10px sans-serif"},shadowColor:{canvas:"#000000"},shadowOffsetX:{canvas:0},shadowOffsetY:{canvas:0},shadowBlur:{canvas:0},textAlign:{canvas:"start"},textBaseline:{canvas:"alphabetic"},lineDash:{svgAttr:"stroke-dasharray",canvas:[],svg:null,apply:"stroke"}};class u{constructor(t,e){this.__root=t,this.__ctx=e}addColorStop(t,e){const i=this.__ctx.__createElement("stop");if(i.setAttribute("offset",`${t}`),-1!==e.indexOf("rgba")){const t=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(e),[,s,n,o,r]=t;i.setAttribute("stop-color",`rgb(${s},${n},${o})`),i.setAttribute("stop-opacity",r)}else i.setAttribute("stop-color",e);this.__root.appendChild(i)}}u.__name__="CanvasGradient";class p{constructor(t,e){this.__root=t,this.__ctx=e}}p.__name__="CanvasPattern";class m{constructor(t){var e,i,s;this.__currentPosition=null,this._transform=new o.AffineTransform,this._clip_path=null,this.__document=null!==(e=null==t?void 0:t.document)&&void 0!==e?e:document,(null==t?void 0:t.ctx)?this.__ctx=t.ctx:(this.__canvas=this.__document.createElement("canvas"),this.__ctx=this.__canvas.getContext("2d")),this.__setDefaultStyles(),this.__stack=[],this.__root=this.__document.createElementNS("http://www.w3.org/2000/svg","svg"),this.__root.setAttribute("version","1.1"),this.__root.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.__root.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.width=null!==(i=null==t?void 0:t.width)&&void 0!==i?i:500,this.height=null!==(s=null==t?void 0:t.height)&&void 0!==s?s:500,this.__ids={},this.__defs=this.__document.createElementNS("http://www.w3.org/2000/svg","defs"),this.__root.appendChild(this.__defs)}get canvas(){return this}get width(){return this._width}set width(t){this._width=t,this.__root.setAttribute("width",`${t}`)}get height(){return this._height}set height(t){this._height=t,this.__root.setAttribute("height",`${t}`)}__createElement(t,e={},i=!1){const s=this.__document.createElementNS("http://www.w3.org/2000/svg",t);i&&(s.setAttribute("fill","none"),s.setAttribute("stroke","none"));const n=Object.keys(e);for(const o of n)s.setAttribute(o,`${e[o]}`);return s}__setDefaultStyles(){const t=Object.keys(d),e=this;for(let i=0;i<t.length;i++){const s=t[i];e[s]=d[s].canvas}}__applyStyleState(t){const e=Object.keys(t),i=this;for(let s=0;s<e.length;s++){const n=e[s];i[n]=t[n]}}__getStyleState(){const t=Object.keys(d),e={};for(let i=0;i<t.length;i++){const s=t[i];e[s]=this[s]}return e}__applyStyleToCurrentElement(t){var e;const i=this.__currentElement,s=Object.keys(d);for(let n=0;n<s.length;n++){const o=d[s[n]],a=this[s[n]];if(null===(e=o.apply)||void 0===e?void 0:e.includes(t))if(a instanceof p){for(const e of[...a.__ctx.__defs.childNodes])if(e instanceof Element){const t=e.getAttribute("id");this.__ids[t]=t,this.__defs.appendChild(e)}const t=a.__root.getAttribute("id");i.setAttribute(o.apply,`url(#${t})`)}else if(a instanceof u){const t=a.__root.getAttribute("id");i.setAttribute(o.apply,`url(#${t})`)}else if(o.svg!==a)if("stroke"!==o.svgAttr&&"fill"!==o.svgAttr||!r.isString(a)||-1===a.indexOf("rgba")){let e=o.svgAttr;if("globalAlpha"===s[n]&&(e=t+"-"+o.svgAttr,i.getAttribute(e)))continue;i.setAttribute(e,`${a}`)}else{const t=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(a),[,e,s,n,r]=t;i.setAttribute(o.svgAttr,`rgb(${e},${s},${n})`);let l=parseFloat(r);const c=this.globalAlpha;null!=c&&(l*=c),i.setAttribute(o.svgAttr+"-opacity",`${l}`)}}}get_serialized_svg(t=!1){let e=(new XMLSerializer).serializeToString(this.__root);if(/xmlns="http:\/\/www\.w3\.org\/2000\/svg".+xmlns="http:\/\/www\.w3\.org\/2000\/svg/gi.test(e)&&(e=e.replace('xmlns="http://www.w3.org/2000/svg','xmlns:xlink="http://www.w3.org/1999/xlink')),t)for(const[i,s]of _){const t=new RegExp(i,"gi");t.test(e)&&(e=e.replace(t,s))}return e}get_svg(){return this.__root}save(){this.__stack.push({transform:this._transform,clip_path:this._clip_path,attributes:this.__getStyleState()}),this._transform=this._transform.clone()}restore(){if(0==this.__stack.length)return;const{transform:t,clip_path:e,attributes:i}=this.__stack.pop();this._transform=t,this._clip_path=e,this.__applyStyleState(i)}_apply_transform(t,e=this._transform){e.is_identity||t.setAttribute("transform",e.toString())}scale(t,e){isFinite(t)&&(null==e||isFinite(e))&&this._transform.scale(t,null!=e?e:t)}rotate(t){isFinite(t)&&this._transform.rotate(t)}translate(t,e){isFinite(t+e)&&this._transform.translate(t,e)}transform(t,e,i,s,n,o){isFinite(t+e+i+s+n+o)&&this._transform.transform(t,e,i,s,n,o)}beginPath(){this.__currentDefaultPath="",this.__currentPosition=null;const t=this.__createElement("path",{},!0);this.__root.appendChild(t),this.__currentElement=t}__applyCurrentDefaultPath(){const t=this.__currentElement;"path"===t.nodeName?t.setAttribute("d",this.__currentDefaultPath):console.error("Attempted to apply path command to node",t.nodeName)}__addPathCommand(t,e,i){const s=this.__currentDefaultPath?" ":"";this.__currentDefaultPath+=s+i,this.__currentPosition={x:t,y:e}}get _hasCurrentDefaultPath(){return!!this.__currentDefaultPath}moveTo(t,e){if(!isFinite(t+e))return;"path"!==this.__currentElement.nodeName&&this.beginPath();const[i,s]=this._transform.apply(t,e);this.__addPathCommand(i,s,`M ${i} ${s}`)}closePath(){this._hasCurrentDefaultPath&&this.__addPathCommand(NaN,NaN,"Z")}lineTo(t,e){if(isFinite(t+e))if(this._hasCurrentDefaultPath){const[i,s]=this._transform.apply(t,e);this.__addPathCommand(i,s,`L ${i} ${s}`)}else this.moveTo(t,e)}bezierCurveTo(t,e,i,s,n,o){if(!isFinite(t+e+i+s+n+o))return;const[r,a]=this._transform.apply(n,o),[l,c]=this._transform.apply(t,e),[h,_]=this._transform.apply(i,s);this.__addPathCommand(r,a,`C ${l} ${c} ${h} ${_} ${r} ${a}`)}quadraticCurveTo(t,e,i,s){if(!isFinite(t+e+i+s))return;const[n,o]=this._transform.apply(i,s),[r,a]=this._transform.apply(t,e);this.__addPathCommand(n,o,`Q ${r} ${a} ${n} ${o}`)}arcTo(t,e,i,s,n){if(!isFinite(t+e+i+s+n))return;if(null==this.__currentPosition)return;const o=this.__currentPosition.x,r=this.__currentPosition.y;if(n<0)throw new Error("IndexSizeError: The radius provided ("+n+") is negative.");if(o===t&&r===e||t===i&&e===s||0===n)return void this.lineTo(t,e);function a([t,e]){const i=Math.sqrt(t**2+e**2);return[t/i,e/i]}const l=a([o-t,r-e]),c=a([i-t,s-e]);if(l[0]*c[1]==l[1]*c[0])return void this.lineTo(t,e);const h=l[0]*c[0]+l[1]*c[1],_=Math.acos(Math.abs(h)),d=a([l[0]+c[0],l[1]+c[1]]),u=n/Math.sin(_/2),p=t+u*d[0],m=e+u*d[1],g=[-l[1],l[0]],f=[c[1],-c[0]];function b(t){const e=t[0];return t[1]>=0?Math.acos(e):-Math.acos(e)}const v=b(g),y=b(f);this.lineTo(p+g[0]*n,m+g[1]*n),this.arc(p,m,n,v,y)}stroke(){"path"===this.__currentElement.nodeName&&this.__currentElement.setAttribute("paint-order","fill"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("stroke"),null!=this._clip_path&&this.__currentElement.setAttribute("clip-path",this._clip_path)}fill(t){if("path"===this.__currentElement.nodeName&&this.__currentElement.setAttribute("paint-order","stroke"),"none"!=this.__currentElement.getAttribute("fill")){const t=this.__currentElement.cloneNode(!0);this.__root.appendChild(t),this.__currentElement=t}this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("fill"),null!=t&&this.__currentElement.setAttribute("fill-rule",t),null!=this._clip_path&&this.__currentElement.setAttribute("clip-path",this._clip_path)}rect(t,e,i,s){isFinite(t+e+i+s)&&("path"!==this.__currentElement.nodeName&&this.beginPath(),this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+s),this.lineTo(t,e+s),this.lineTo(t,e))}fillRect(t,e,i,s){isFinite(t+e+i+s)&&(this.beginPath(),this.rect(t,e,i,s),this.fill())}strokeRect(t,e,i,s){isFinite(t+e+i+s)&&(this.beginPath(),this.rect(t,e,i,s),this.stroke())}__clearCanvas(){a.empty(this.__defs),a.empty(this.__root),this.__root.appendChild(this.__defs),this.__currentElement=this.__root}clearRect(t,e,i,s){if(!isFinite(t+e+i+s))return;if(0===t&&0===e&&i===this.width&&s===this.height)return void this.__clearCanvas();const n=this.__createElement("rect",{x:t,y:e,width:i,height:s,fill:"#FFFFFF"},!0);this._apply_transform(n),this.__root.appendChild(n)}createLinearGradient(t,e,i,s){if(!isFinite(t+e+i+s))throw new Error("The provided double value is non-finite");const[n,o]=this._transform.apply(t,e),[r,a]=this._transform.apply(i,s),c=this.__createElement("linearGradient",{id:l(this.__ids),x1:`${n}px`,x2:`${r}px`,y1:`${o}px`,y2:`${a}px`,gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(c),new u(c,this)}createRadialGradient(t,e,i,s,n,o){if(!isFinite(t+e+i+s+n+o))throw new Error("The provided double value is non-finite");const[r,a]=this._transform.apply(t,e),[c,h]=this._transform.apply(s,n),_=this.__createElement("radialGradient",{id:l(this.__ids),cx:`${c}px`,cy:`${h}px`,r:`${o}px`,fx:`${r}px`,fy:`${a}px`,gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(_),new u(_,this)}__parseFont(){var t,e,i,s,n;const o=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-,\'\"\sa-z0-9]+?)\s*$/i.exec(this.font),r={style:null!==(t=o[1])&&void 0!==t?t:"normal",size:null!==(e=o[4])&&void 0!==e?e:"10px",family:null!==(i=o[6])&&void 0!==i?i:"sans-serif",weight:null!==(s=o[3])&&void 0!==s?s:"normal",decoration:null!==(n=o[2])&&void 0!==n?n:"normal"};return"underline"===this.__fontUnderline&&(r.decoration="underline"),null!=this.__fontHref&&(r.href=this.__fontHref),r}__wrapTextLink(t,e){if(t.href){const i=this.__createElement("a");return i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t.href),i.appendChild(e),i}return e}__applyText(t,e,i,s){const n=this.__parseFont(),o=this.__createElement("text",{"font-family":n.family,"font-size":n.size,"font-style":n.style,"font-weight":n.weight,"text-decoration":n.decoration,x:e,y:i,"text-anchor":c(this.textAlign),"dominant-baseline":h(this.textBaseline)},!0);o.appendChild(this.__document.createTextNode(t)),this._apply_transform(o),this.__currentElement=o,this.__applyStyleToCurrentElement(s),this.__root.appendChild(this.__wrapTextLink(n,o))}fillText(t,e,i){null!=t&&isFinite(e+i)&&this.__applyText(t,e,i,"fill")}strokeText(t,e,i){null!=t&&isFinite(e+i)&&this.__applyText(t,e,i,"stroke")}measureText(t){return this.__ctx.font=this.font,this.__ctx.measureText(t)}arc(t,e,i,s,n,o=!1){if(!isFinite(t+e+i+s+n))return;if(s===n)return;(s%=2*Math.PI)===(n%=2*Math.PI)&&(n=(n+2*Math.PI-.001*(o?-1:1))%(2*Math.PI));const r=t+i*Math.cos(n),a=e+i*Math.sin(n),l=t+i*Math.cos(s),c=e+i*Math.sin(s),h=o?0:1;let _=0,d=n-s;d<0&&(d+=2*Math.PI),_=o?d>Math.PI?0:1:d>Math.PI?1:0,this.lineTo(l,c);const u=i,p=i,[m,g]=this._transform.apply(r,a);this.__addPathCommand(m,g,`A ${u} ${p} 0 ${_} ${h} ${m} ${g}`)}clip(){const t=this.__createElement("clipPath"),e=l(this.__ids);this.__applyCurrentDefaultPath(),t.setAttribute("id",e),t.appendChild(this.__currentElement),this.__defs.appendChild(t),this._clip_path=`url(#${e})`}drawImage(t,...e){let i,s,n,o,r,a,l,c;if(2==e.length){if([i,s]=e,!isFinite(i+s))return;r=0,a=0,l=t.width,c=t.height,n=l,o=c}else if(4==e.length){if([i,s,n,o]=e,!isFinite(i+s+n+o))return;r=0,a=0,l=t.width,c=t.height}else{if(8!==e.length)throw new Error(`Inavlid number of arguments passed to drawImage: ${arguments.length}`);if([r,a,l,c,i,s,n,o]=e,!isFinite(r+a+l+c+i+s+n+o))return}const h=this.__root,_=this._transform.clone().translate(i,s);if(t instanceof m||t instanceof SVGSVGElement){const e=(t instanceof SVGSVGElement?t:t.get_svg()).cloneNode(!0);let i;_.is_identity?i=h:(i=this.__createElement("g"),this._apply_transform(i,_),h.appendChild(i));for(const t of[...e.childNodes])if(t instanceof SVGDefsElement){for(const e of[...t.childNodes])if(e instanceof Element){const t=e.getAttribute("id");this.__ids[t]=t,this.__defs.appendChild(e)}}else i.appendChild(t)}else if(t instanceof HTMLImageElement||t instanceof SVGImageElement){const e=this.__createElement("image");if(e.setAttribute("width",`${n}`),e.setAttribute("height",`${o}`),e.setAttribute("preserveAspectRatio","none"),r||a||l!==t.width||c!==t.height){const e=this.__document.createElement("canvas");e.width=n,e.height=o,e.getContext("2d").drawImage(t,r,a,l,c,0,0,n,o),t=e}this._apply_transform(e,_);const i=t instanceof HTMLCanvasElement?t.toDataURL():t.getAttribute("src");e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i),h.appendChild(e)}else if(t instanceof HTMLCanvasElement){const e=this.__createElement("image");e.setAttribute("width",`${n}`),e.setAttribute("height",`${o}`),e.setAttribute("preserveAspectRatio","none");const i=this.__document.createElement("canvas");i.width=n,i.height=o;const s=i.getContext("2d");s.imageSmoothingEnabled=!1,s.drawImage(t,r,a,l,c,0,0,n,o),t=i,this._apply_transform(e,_),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t.toDataURL()),h.appendChild(e)}}createPattern(t,e){const i=this.__document.createElementNS("http://www.w3.org/2000/svg","pattern"),s=l(this.__ids);if(i.setAttribute("id",s),i.setAttribute("width",`${this._to_number(t.width)}`),i.setAttribute("height",`${this._to_number(t.height)}`),i.setAttribute("patternUnits","userSpaceOnUse"),t instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof SVGImageElement){const e=this.__document.createElementNS("http://www.w3.org/2000/svg","image"),s=t instanceof HTMLCanvasElement?t.toDataURL():t.getAttribute("src");e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",s),i.appendChild(e),this.__defs.appendChild(i)}else if(t instanceof m){for(const e of[...t.__root.childNodes])e instanceof SVGDefsElement||i.appendChild(e);this.__defs.appendChild(i)}else{if(!(t instanceof SVGSVGElement))throw new Error("unsupported");for(const e of[...t.childNodes])e instanceof SVGDefsElement||i.appendChild(e);this.__defs.appendChild(i)}return new p(i,this)}setLineDash(t){t&&t.length>0?this.lineDash=t.join(","):this.lineDash=null}_to_number(t){return r.isNumber(t)?t:t.baseVal.value}}i.SVGRenderingContext2D=m,m.__name__="SVGRenderingContext2D"},function(t,e,i,s,n){s();const o=t(238),r=t(15);class a extends o.ButtonToolButtonView{_clicked(){this.model.do.emit(void 0)}}i.ActionToolButtonView=a,a.__name__="ActionToolButtonView";class l extends o.ButtonToolView{connect_signals(){super.connect_signals(),this.connect(this.model.do,(t=>this.doit(t)))}}i.ActionToolView=l,l.__name__="ActionToolView";class c extends o.ButtonTool{constructor(t){super(t),this.button_view=a,this.do=new r.Signal(this,"do")}}i.ActionTool=c,c.__name__="ActionTool"},function(t,e,i,s,n){s();const o=t(251),r=t(242);class a extends o.ActionToolView{doit(){window.open(this.model.redirect)}}i.HelpToolView=a,a.__name__="HelpToolView";class l extends o.ActionTool{constructor(t){super(t),this.tool_name="Help",this.icon=r.tool_icon_help}static init_HelpTool(){this.prototype.default_view=a,this.define((({String:t})=>({redirect:[t,"https://docs.bokeh.org/en/latest/docs/user_guide/tools.html"]}))),this.override({description:"Click the question mark to learn more about Bokeh plot tools."}),this.register_alias("help",(()=>new l))}}i.HelpTool=l,l.__name__="HelpTool",l.init_HelpTool()},function(t,e,i,s,n){s(),i.root="bk-root",i.logo="bk-logo",i.grey="bk-grey",i.logo_small="bk-logo-small",i.logo_notebook="bk-logo-notebook",i.default=".bk-root .bk-logo{margin:5px;position:relative;display:block;background-repeat:no-repeat;}.bk-root .bk-logo.bk-grey{filter:url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg'><filter id='grayscale'><feColorMatrix type='matrix' values='0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0'/></filter></svg>#grayscale\");filter:gray;-webkit-filter:grayscale(100%);}.bk-root .bk-logo-small{width:20px;height:20px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAOkSURBVDiNjZRtaJVlGMd/1/08zzln5zjP1LWcU9N0NkN8m2CYjpgQYQXqSs0I84OLIC0hkEKoPtiH3gmKoiJDU7QpLgoLjLIQCpEsNJ1vqUOdO7ppbuec5+V+rj4ctwzd8IIbbi6u+8f1539dt3A78eXC7QizUF7gyV1fD1Yqg4JWz84yffhm0qkFqBogB9rM8tZdtwVsPUhWhGcFJngGeWrPzHm5oaMmkfEg1usvLFyc8jLRqDOMru7AyC8saQr7GG7f5fvDeH7Ej8CM66nIF+8yngt6HWaKh7k49Soy9nXurCi1o3qUbS3zWfrYeQDTB/Qj6kX6Ybhw4B+bOYoLKCC9H3Nu/leUTZ1JdRWkkn2ldcCamzrcf47KKXdAJllSlxAOkRgyHsGC/zRday5Qld9DyoM4/q/rUoy/CXh3jzOu3bHUVZeU+DEn8FInkPBFlu3+nW3Nw0mk6vCDiWg8CeJaxEwuHS3+z5RgY+YBR6V1Z1nxSOfoaPa4LASWxxdNp+VWTk7+4vzaou8v8PN+xo+KY2xsw6une2frhw05CTYOmQvsEhjhWjn0bmXPjpE1+kplmmkP3suftwTubK9Vq22qKmrBhpY4jvd5afdRA3wGjFAgcnTK2s4hY0/GPNIb0nErGMCRxWOOX64Z8RAC4oCXdklmEvcL8o0BfkNK4lUg9HTl+oPlQxdNo3Mg4Nv175e/1LDGzZen30MEjRUtmXSfiTVu1kK8W4txyV6BMKlbgk3lMwYCiusNy9fVfvvwMxv8Ynl6vxoByANLTWplvuj/nF9m2+PDtt1eiHPBr1oIfhCChQMBw6Aw0UulqTKZdfVvfG7VcfIqLG9bcldL/+pdWTLxLUy8Qq38heUIjh4XlzZxzQm19lLFlr8vdQ97rjZVOLf8nclzckbcD4wxXMidpX30sFd37Fv/GtwwhzhxGVAprjbg0gCAEeIgwCZyTV2Z1REEW8O4py0wsjeloKoMr6iCY6dP92H6Vw/oTyICIthibxjm/DfN9lVz8IqtqKYLUXfoKVMVQVVJOElGjrnnUt9T9wbgp8AyYKaGlqingHZU/uG2NTZSVqwHQTWkx9hxjkpWDaCg6Ckj5qebgBVbT3V3NNXMSiWSDdGV3hrtzla7J+duwPOToIg42ChPQOQjspnSlp1V+Gjdged7+8UN5CRAV7a5EdFNwCjEaBR27b3W890TE7g24NAP/mMDXRWrGoFPQI9ls/MWO2dWFAar/xcOIImbbpA3zgAAAABJRU5ErkJggg==);}.bk-root .bk-logo-notebook{display:inline-block;vertical-align:middle;margin-right:5px;}"},function(t,e,i,s,n){s();const o=t(1),r=t(40),a=t(20),l=t(43),c=o.__importStar(t(255)),h=c;class _ extends r.AnnotationView{initialize(){super.initialize(),this.el=l.div({class:h.tooltip}),l.undisplay(this.el),this.plot_view.canvas_view.add_overlay(this.el)}remove(){l.remove(this.el),super.remove()}connect_signals(){super.connect_signals(),this.connect(this.model.properties.content.change,(()=>this.render())),this.connect(this.model.properties.position.change,(()=>this._reposition()))}styles(){return[...super.styles(),c.default]}render(){this.model.visible||l.undisplay(this.el),super.render()}_render(){const{content:t}=this.model;null!=t?(l.empty(this.el),l.classes(this.el).toggle("bk-tooltip-custom",this.model.custom),this.el.appendChild(t),this.model.show_arrow&&this.el.classList.add(h.tooltip_arrow)):l.undisplay(this.el)}_reposition(){const{position:t}=this.model;if(null==t)return void l.undisplay(this.el);const[e,i]=t,s=(()=>{const t=this.parent.layout.bbox.relative(),{attachment:s}=this.model;switch(s){case"horizontal":return e<t.hcenter?"right":"left";case"vertical":return i<t.vcenter?"below":"above";default:return s}})();let n;this.el.classList.remove(h.right),this.el.classList.remove(h.left),this.el.classList.remove(h.above),this.el.classList.remove(h.below),l.display(this.el);let o=null,r=null;switch(s){case"right":this.el.classList.add(h.left),o=e+(this.el.offsetWidth-this.el.clientWidth)+10,n=i-this.el.offsetHeight/2;break;case"left":this.el.classList.add(h.right),r=this.plot_view.layout.bbox.width-e+10,n=i-this.el.offsetHeight/2;break;case"below":this.el.classList.add(h.above),n=i+(this.el.offsetHeight-this.el.clientHeight)+10,o=Math.round(e-this.el.offsetWidth/2);break;case"above":this.el.classList.add(h.below),n=i-this.el.offsetHeight-10,o=Math.round(e-this.el.offsetWidth/2)}this.el.style.top=`${n}px`,this.el.style.left=null!=o?`${o}px`:"auto",this.el.style.right=null!=r?`${r}px`:"auto"}}i.TooltipView=_,_.__name__="TooltipView";class d extends r.Annotation{constructor(t){super(t)}static init_Tooltip(){this.prototype.default_view=_,this.define((({Boolean:t})=>({attachment:[a.TooltipAttachment,"horizontal"],inner_only:[t,!0],show_arrow:[t,!0]}))),this.internal((({Boolean:t,Number:e,Tuple:i,Ref:s,Nullable:n})=>({position:[n(i(e,e)),null],content:[s(HTMLElement),()=>l.div()],custom:[t]}))),this.override({level:"overlay"})}clear(){this.position=null}}i.Tooltip=d,d.__name__="Tooltip",d.init_Tooltip()},function(t,e,i,s,n){s(),i.root="bk-root",i.tooltip="bk-tooltip",i.left="bk-left",i.tooltip_arrow="bk-tooltip-arrow",i.right="bk-right",i.above="bk-above",i.below="bk-below",i.tooltip_row_label="bk-tooltip-row-label",i.tooltip_row_value="bk-tooltip-row-value",i.tooltip_color_block="bk-tooltip-color-block",i.default='.bk-root{}.bk-root .bk-tooltip{font-weight:300;font-size:12px;position:absolute;padding:5px;border:1px solid #e5e5e5;color:#2f2f2f;background-color:white;pointer-events:none;opacity:0.95;z-index:100;}.bk-root .bk-tooltip > div:not(:first-child){margin-top:5px;border-top:#e5e5e5 1px dashed;}.bk-root .bk-tooltip.bk-left.bk-tooltip-arrow::before{position:absolute;margin:-7px 0 0 0;top:50%;width:0;height:0;border-style:solid;border-width:7px 0 7px 0;border-color:transparent;content:" ";display:block;left:-10px;border-right-width:10px;border-right-color:#909599;}.bk-root .bk-tooltip.bk-left::before{left:-10px;border-right-width:10px;border-right-color:#909599;}.bk-root .bk-tooltip.bk-right.bk-tooltip-arrow::after{position:absolute;margin:-7px 0 0 0;top:50%;width:0;height:0;border-style:solid;border-width:7px 0 7px 0;border-color:transparent;content:" ";display:block;right:-10px;border-left-width:10px;border-left-color:#909599;}.bk-root .bk-tooltip.bk-right::after{right:-10px;border-left-width:10px;border-left-color:#909599;}.bk-root .bk-tooltip.bk-above::before{position:absolute;margin:0 0 0 -7px;left:50%;width:0;height:0;border-style:solid;border-width:0 7px 0 7px;border-color:transparent;content:" ";display:block;top:-10px;border-bottom-width:10px;border-bottom-color:#909599;}.bk-root .bk-tooltip.bk-below::after{position:absolute;margin:0 0 0 -7px;left:50%;width:0;height:0;border-style:solid;border-width:0 7px 0 7px;border-color:transparent;content:" ";display:block;bottom:-10px;border-top-width:10px;border-top-color:#909599;}.bk-root .bk-tooltip-row-label{text-align:right;color:#26aae1;}.bk-root .bk-tooltip-row-value{color:default;}.bk-root .bk-tooltip-color-block{width:12px;height:12px;margin-left:5px;margin-right:5px;outline:#dddddd solid 1px;display:inline-block;}'},function(t,e,i,s,n){s();const o=t(135),r=t(133),a=t(122),l=t(48);class c extends o.UpperLowerView{async lazy_initialize(){await super.lazy_initialize();const{lower_head:t,upper_head:e}=this.model;null!=t&&(this.lower_head=await a.build_view(t,{parent:this})),null!=e&&(this.upper_head=await a.build_view(e,{parent:this}))}set_data(t){var e,i;super.set_data(t),null===(e=this.lower_head)||void 0===e||e.set_data(t),null===(i=this.upper_head)||void 0===i||i.set_data(t)}paint(t){if(this.visuals.line.doit)for(let i=0,s=this._lower_sx.length;i<s;i++)this.visuals.line.set_vectorize(t,i),t.beginPath(),t.moveTo(this._lower_sx[i],this._lower_sy[i]),t.lineTo(this._upper_sx[i],this._upper_sy[i]),t.stroke();const e="height"==this.model.dimension?0:Math.PI/2;if(null!=this.lower_head)for(let i=0,s=this._lower_sx.length;i<s;i++)t.save(),t.translate(this._lower_sx[i],this._lower_sy[i]),t.rotate(e+Math.PI),this.lower_head.render(t,i),t.restore();if(null!=this.upper_head)for(let i=0,s=this._upper_sx.length;i<s;i++)t.save(),t.translate(this._upper_sx[i],this._upper_sy[i]),t.rotate(e),this.upper_head.render(t,i),t.restore()}}i.WhiskerView=c,c.__name__="WhiskerView";class h extends o.UpperLower{constructor(t){super(t)}static init_Whisker(){this.prototype.default_view=c,this.mixins(l.LineVector),this.define((({Ref:t,Nullable:e})=>({lower_head:[e(t(r.ArrowHead)),()=>new r.TeeHead({size:10})],upper_head:[e(t(r.ArrowHead)),()=>new r.TeeHead({size:10})]}))),this.override({level:"underlay"})}}i.Whisker=h,h.__name__="Whisker",h.init_Whisker()},function(t,e,i,s,n){s(),n("CustomJS",t(258).CustomJS),n("OpenURL",t(260).OpenURL)},function(t,e,i,s,n){s();const o=t(259),r=t(13),a=t(34);class l extends o.Callback{constructor(t){super(t)}static init_CustomJS(){this.define((({Unknown:t,String:e,Dict:i})=>({args:[i(t),{}],code:[e,""]})))}get names(){return r.keys(this.args)}get values(){return r.values(this.args)}get func(){const t=a.use_strict(this.code);return new Function(...this.names,"cb_obj","cb_data",t)}execute(t,e={}){return this.func.apply(t,this.values.concat(t,e))}}i.CustomJS=l,l.__name__="CustomJS",l.init_CustomJS()},function(t,e,i,s,n){s();const o=t(53);class r extends o.Model{constructor(t){super(t)}}i.Callback=r,r.__name__="Callback"},function(t,e,i,s,n){s();const o=t(259),r=t(182),a=t(8);class l extends o.Callback{constructor(t){super(t)}static init_OpenURL(){this.define((({Boolean:t,String:e})=>({url:[e,"http://"],same_tab:[t,!1]})))}execute(t,{source:e}){const i=t=>{const i=r.replace_placeholders(this.url,e,t,void 0,void 0,encodeURIComponent);if(!a.isString(i))throw new Error("HTML output is not supported in this context");this.same_tab?window.location.href=i:window.open(i)},{selected:s}=e;for(const n of s.indices)i(n);for(const n of s.line_indices)i(n)}}i.OpenURL=l,l.__name__="OpenURL",l.init_OpenURL()},function(t,e,i,s,n){s(),n("Canvas",t(262).Canvas),n("CartesianFrame",t(144).CartesianFrame)},function(t,e,i,s,n){s();const o=t(14),r=t(240),a=t(19),l=t(43),c=t(20),h=t(13),_=t(263),d=t(99),u=t(249),p=(()=>{const t=document.createElement("canvas"),e=t.getContext("webgl",{premultipliedAlpha:!0});return null!=e?{canvas:t,gl:e}:void a.logger.trace("WebGL is not supported")})(),m={position:"absolute",top:"0",left:"0",width:"100%",height:"100%"};class g extends r.DOMView{constructor(){super(...arguments),this.bbox=new d.BBox}initialize(){super.initialize(),"webgl"==this.model.output_backend&&(this.webgl=p),this.underlays_el=l.div({style:m}),this.primary=this.create_layer(),this.overlays=this.create_layer(),this.overlays_el=l.div({style:m}),this.events_el=l.div({class:"bk-canvas-events",style:m});const t=[this.underlays_el,this.primary.el,this.overlays.el,this.overlays_el,this.events_el];h.extend(this.el.style,m),l.append(this.el,...t),this.ui_event_bus=new _.UIEventBus(this)}remove(){this.ui_event_bus.destroy(),super.remove()}add_underlay(t){this.underlays_el.appendChild(t)}add_overlay(t){this.overlays_el.appendChild(t)}add_event(t){this.events_el.appendChild(t)}get pixel_ratio(){return this.primary.pixel_ratio}resize(t,e){this.bbox=new d.BBox({left:0,top:0,width:t,height:e}),this.primary.resize(t,e),this.overlays.resize(t,e)}prepare_webgl(t){const{webgl:e}=this;if(null!=e){const{width:i,height:s}=this.bbox;e.canvas.width=this.pixel_ratio*i,e.canvas.height=this.pixel_ratio*s;const{gl:n}=e;n.enable(n.SCISSOR_TEST);const[o,r,a,l]=t,{xview:c,yview:h}=this.bbox,_=c.compute(o),d=h.compute(r+l),u=this.pixel_ratio;n.scissor(u*_,u*d,u*a,u*l),n.enable(n.BLEND),n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE_MINUS_DST_ALPHA,n.ONE),this._clear_webgl()}}blit_webgl(t){const{webgl:e}=this;if(null!=e){if(a.logger.debug("Blitting WebGL canvas"),t.restore(),t.drawImage(e.canvas,0,0),t.save(),this.model.hidpi){const e=this.pixel_ratio;t.scale(e,e),t.translate(.5,.5)}this._clear_webgl()}}_clear_webgl(){const{webgl:t}=this;if(null!=t){const{gl:e,canvas:i}=t;e.viewport(0,0,i.width,i.height),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}}compose(){const t=this.create_layer(),{width:e,height:i}=this.bbox;return t.resize(e,i),t.ctx.drawImage(this.primary.canvas,0,0),t.ctx.drawImage(this.overlays.canvas,0,0),t}create_layer(){const{output_backend:t,hidpi:e}=this.model;return new u.CanvasLayer(t,e)}to_blob(){return this.compose().to_blob()}}i.CanvasView=g,g.__name__="CanvasView";class f extends o.HasProps{constructor(t){super(t)}static init_Canvas(){this.prototype.default_view=g,this.internal((({Boolean:t})=>({hidpi:[t,!0],output_backend:[c.OutputBackend,"canvas"]})))}}i.Canvas=f,f.__name__="Canvas",f.init_Canvas()},function(t,e,i,s,n){s();const o=t(1),r=o.__importDefault(t(239)),a=t(15),l=t(19),c=t(43),h=o.__importStar(t(264)),_=t(265),d=t(9),u=t(8),p=t(27),m=t(244);class g{constructor(t){this.canvas_view=t,this.pan_start=new a.Signal(this,"pan:start"),this.pan=new a.Signal(this,"pan"),this.pan_end=new a.Signal(this,"pan:end"),this.pinch_start=new a.Signal(this,"pinch:start"),this.pinch=new a.Signal(this,"pinch"),this.pinch_end=new a.Signal(this,"pinch:end"),this.rotate_start=new a.Signal(this,"rotate:start"),this.rotate=new a.Signal(this,"rotate"),this.rotate_end=new a.Signal(this,"rotate:end"),this.tap=new a.Signal(this,"tap"),this.doubletap=new a.Signal(this,"doubletap"),this.press=new a.Signal(this,"press"),this.pressup=new a.Signal(this,"pressup"),this.move_enter=new a.Signal(this,"move:enter"),this.move=new a.Signal(this,"move"),this.move_exit=new a.Signal(this,"move:exit"),this.scroll=new a.Signal(this,"scroll"),this.keydown=new a.Signal(this,"keydown"),this.keyup=new a.Signal(this,"keyup"),this.hammer=new r.default(this.hit_area,{touchAction:"auto",inputClass:r.default.TouchMouseInput}),this._prev_move=null,this._curr_pan=null,this._curr_pinch=null,this._curr_rotate=null,this._configure_hammerjs(),this.hit_area.addEventListener("mousemove",(t=>this._mouse_move(t))),this.hit_area.addEventListener("mouseenter",(t=>this._mouse_enter(t))),this.hit_area.addEventListener("mouseleave",(t=>this._mouse_exit(t))),this.hit_area.addEventListener("contextmenu",(t=>this._context_menu(t))),this.hit_area.addEventListener("wheel",(t=>this._mouse_wheel(t))),document.addEventListener("keydown",this),document.addEventListener("keyup",this),this.menu=new m.ContextMenu([],{prevent_hide:t=>2==t.button&&t.target==this.hit_area}),this.hit_area.appendChild(this.menu.el)}get hit_area(){return this.canvas_view.events_el}destroy(){this.menu.remove(),this.hammer.destroy(),document.removeEventListener("keydown",this),document.removeEventListener("keyup",this)}handleEvent(t){"keydown"==t.type?this._key_down(t):"keyup"==t.type&&this._key_up(t)}_configure_hammerjs(){this.hammer.get("doubletap").recognizeWith("tap"),this.hammer.get("tap").requireFailure("doubletap"),this.hammer.get("doubletap").dropRequireFailure("tap"),this.hammer.on("doubletap",(t=>this._doubletap(t))),this.hammer.on("tap",(t=>this._tap(t))),this.hammer.on("press",(t=>this._press(t))),this.hammer.on("pressup",(t=>this._pressup(t))),this.hammer.get("pan").set({direction:r.default.DIRECTION_ALL}),this.hammer.on("panstart",(t=>this._pan_start(t))),this.hammer.on("pan",(t=>this._pan(t))),this.hammer.on("panend",(t=>this._pan_end(t))),this.hammer.get("pinch").set({enable:!0}),this.hammer.on("pinchstart",(t=>this._pinch_start(t))),this.hammer.on("pinch",(t=>this._pinch(t))),this.hammer.on("pinchend",(t=>this._pinch_end(t))),this.hammer.get("rotate").set({enable:!0}),this.hammer.on("rotatestart",(t=>this._rotate_start(t))),this.hammer.on("rotate",(t=>this._rotate(t))),this.hammer.on("rotateend",(t=>this._rotate_end(t)))}register_tool(t){const e=t.model.event_type;null!=e&&(u.isString(e)?this._register_tool(t,e):e.forEach(((e,i)=>this._register_tool(t,e,i<1))))}_register_tool(t,e,i=!0){const s=t,{id:n}=s.model,o=t=>e=>{e.id==n&&t(e.e)},r=t=>e=>{t(e.e)};switch(e){case"pan":null!=s._pan_start&&s.connect(this.pan_start,o(s._pan_start.bind(s))),null!=s._pan&&s.connect(this.pan,o(s._pan.bind(s))),null!=s._pan_end&&s.connect(this.pan_end,o(s._pan_end.bind(s)));break;case"pinch":null!=s._pinch_start&&s.connect(this.pinch_start,o(s._pinch_start.bind(s))),null!=s._pinch&&s.connect(this.pinch,o(s._pinch.bind(s))),null!=s._pinch_end&&s.connect(this.pinch_end,o(s._pinch_end.bind(s)));break;case"rotate":null!=s._rotate_start&&s.connect(this.rotate_start,o(s._rotate_start.bind(s))),null!=s._rotate&&s.connect(this.rotate,o(s._rotate.bind(s))),null!=s._rotate_end&&s.connect(this.rotate_end,o(s._rotate_end.bind(s)));break;case"move":null!=s._move_enter&&s.connect(this.move_enter,o(s._move_enter.bind(s))),null!=s._move&&s.connect(this.move,o(s._move.bind(s))),null!=s._move_exit&&s.connect(this.move_exit,o(s._move_exit.bind(s)));break;case"tap":null!=s._tap&&s.connect(this.tap,o(s._tap.bind(s))),null!=s._doubletap&&s.connect(this.doubletap,o(s._doubletap.bind(s)));break;case"press":null!=s._press&&s.connect(this.press,o(s._press.bind(s))),null!=s._pressup&&s.connect(this.pressup,o(s._pressup.bind(s)));break;case"scroll":null!=s._scroll&&s.connect(this.scroll,o(s._scroll.bind(s)));break;default:throw new Error(`unsupported event_type: ${e}`)}i&&(null!=s._keydown&&s.connect(this.keydown,r(s._keydown.bind(s))),null!=s._keyup&&s.connect(this.keyup,r(s._keyup.bind(s))),p.is_mobile&&null!=s._scroll&&"pinch"==e&&(l.logger.debug("Registering scroll on touch screen"),s.connect(this.scroll,o(s._scroll.bind(s)))))}_hit_test_renderers(t,e,i){var s;const n=t.get_renderer_views();for(const o of d.reversed(n))if(null===(s=o.interactive_hit)||void 0===s?void 0:s.call(o,e,i))return o;return null}set_cursor(t="default"){this.hit_area.style.cursor=t}_hit_test_frame(t,e,i){return t.frame.bbox.contains(e,i)}_hit_test_canvas(t,e,i){return t.layout.bbox.contains(e,i)}_hit_test_plot(t,e){for(const i of this.canvas_view.plot_views)if(i.layout.bbox.relative().contains(t,e))return i;return null}_trigger(t,e,i){var s;const{sx:n,sy:o}=e,r=this._hit_test_plot(n,o),a=t=>{const[i,s]=[n,o];return Object.assign(Object.assign({},e),{sx:i,sy:s})};if("panstart"==e.type||"pan"==e.type||"panend"==e.type){let s;if("panstart"==e.type&&null!=r?(this._curr_pan={plot_view:r},s=r):"pan"==e.type&&null!=this._curr_pan?s=this._curr_pan.plot_view:"panend"==e.type&&null!=this._curr_pan?(s=this._curr_pan.plot_view,this._curr_pan=null):s=null,null!=s){const e=a();this.__trigger(s,t,e,i)}}else if("pinchstart"==e.type||"pinch"==e.type||"pinchend"==e.type){let s;if("pinchstart"==e.type&&null!=r?(this._curr_pinch={plot_view:r},s=r):"pinch"==e.type&&null!=this._curr_pinch?s=this._curr_pinch.plot_view:"pinchend"==e.type&&null!=this._curr_pinch?(s=this._curr_pinch.plot_view,this._curr_pinch=null):s=null,null!=s){const e=a();this.__trigger(s,t,e,i)}}else if("rotatestart"==e.type||"rotate"==e.type||"rotateend"==e.type){let s;if("rotatestart"==e.type&&null!=r?(this._curr_rotate={plot_view:r},s=r):"rotate"==e.type&&null!=this._curr_rotate?s=this._curr_rotate.plot_view:"rotateend"==e.type&&null!=this._curr_rotate?(s=this._curr_rotate.plot_view,this._curr_rotate=null):s=null,null!=s){const e=a();this.__trigger(s,t,e,i)}}else if("mouseenter"==e.type||"mousemove"==e.type||"mouseleave"==e.type){const l=null===(s=this._prev_move)||void 0===s?void 0:s.plot_view;if(null!=l&&("mouseleave"==e.type||l!=r)){const{sx:t,sy:e}=a();this.__trigger(l,this.move_exit,{type:"mouseleave",sx:t,sy:e,shiftKey:!1,ctrlKey:!1},i)}if(null!=r&&("mouseenter"==e.type||l!=r)){const{sx:t,sy:e}=a();this.__trigger(r,this.move_enter,{type:"mouseenter",sx:t,sy:e,shiftKey:!1,ctrlKey:!1},i)}if(null!=r&&"mousemove"==e.type){const e=a();this.__trigger(r,t,e,i)}this._prev_move={sx:n,sy:o,plot_view:r}}else if(null!=r){const e=a();this.__trigger(r,t,e,i)}}__trigger(t,e,i,s){var n,o;const r=t.model.toolbar.gestures,a=e.name.split(":")[0],l=this._hit_test_renderers(t,i.sx,i.sy),c=this._hit_test_canvas(t,i.sx,i.sy);switch(a){case"move":{const s=r[a].active;null!=s&&this.trigger(e,i,s.id);const o=t.model.toolbar.inspectors.filter((t=>t.active));let h="default";null!=l?(h=null!==(n=l.cursor(i.sx,i.sy))&&void 0!==n?n:h,d.is_empty(o)||(e=this.move_exit)):this._hit_test_frame(t,i.sx,i.sy)&&(d.is_empty(o)||(h="crosshair")),this.set_cursor(h),t.set_toolbar_visibility(c),o.map((t=>this.trigger(e,i,t.id)));break}case"tap":{const{target:t}=s;if(null!=t&&t!=this.hit_area)return;null!=l&&null!=l.on_hit&&l.on_hit(i.sx,i.sy);const n=r[a].active;null!=n&&this.trigger(e,i,n.id);break}case"doubletap":{const t=null!==(o=r.doubletap.active)&&void 0!==o?o:r.tap.active;null!=t&&this.trigger(e,i,t.id);break}case"scroll":{const t=r[p.is_mobile?"pinch":"scroll"].active;null!=t&&(s.preventDefault(),s.stopPropagation(),this.trigger(e,i,t.id));break}case"pan":{const t=r[a].active;null!=t&&(s.preventDefault(),this.trigger(e,i,t.id));break}default:{const t=r[a].active;null!=t&&this.trigger(e,i,t.id)}}this._trigger_bokeh_event(t,i)}trigger(t,e,i=null){t.emit({id:i,e:e})}_trigger_bokeh_event(t,e){const i=(()=>{const{sx:i,sy:s}=e,n=t.frame.x_scale.invert(i),o=t.frame.y_scale.invert(s);switch(e.type){case"wheel":return new h.MouseWheel(i,s,n,o,e.delta);case"mousemove":return new h.MouseMove(i,s,n,o);case"mouseenter":return new h.MouseEnter(i,s,n,o);case"mouseleave":return new h.MouseLeave(i,s,n,o);case"tap":return new h.Tap(i,s,n,o);case"doubletap":return new h.DoubleTap(i,s,n,o);case"press":return new h.Press(i,s,n,o);case"pressup":return new h.PressUp(i,s,n,o);case"pan":return new h.Pan(i,s,n,o,e.deltaX,e.deltaY);case"panstart":return new h.PanStart(i,s,n,o);case"panend":return new h.PanEnd(i,s,n,o);case"pinch":return new h.Pinch(i,s,n,o,e.scale);case"pinchstart":return new h.PinchStart(i,s,n,o);case"pinchend":return new h.PinchEnd(i,s,n,o);case"rotate":return new h.Rotate(i,s,n,o,e.rotation);case"rotatestart":return new h.RotateStart(i,s,n,o);case"rotateend":return new h.RotateEnd(i,s,n,o);default:return}})();null!=i&&t.model.trigger_event(i)}_get_sxy(t){const{pageX:e,pageY:i}=function(t){return"undefined"!=typeof TouchEvent&&t instanceof TouchEvent}(t)?(0!=t.touches.length?t.touches:t.changedTouches)[0]:t,{left:s,top:n}=c.offset(this.hit_area);return{sx:e-s,sy:i-n}}_pan_event(t){return Object.assign(Object.assign({type:t.type},this._get_sxy(t.srcEvent)),{deltaX:t.deltaX,deltaY:t.deltaY,shiftKey:t.srcEvent.shiftKey,ctrlKey:t.srcEvent.ctrlKey})}_pinch_event(t){return Object.assign(Object.assign({type:t.type},this._get_sxy(t.srcEvent)),{scale:t.scale,shiftKey:t.srcEvent.shiftKey,ctrlKey:t.srcEvent.ctrlKey})}_rotate_event(t){return Object.assign(Object.assign({type:t.type},this._get_sxy(t.srcEvent)),{rotation:t.rotation,shiftKey:t.srcEvent.shiftKey,ctrlKey:t.srcEvent.ctrlKey})}_tap_event(t){return Object.assign(Object.assign({type:t.type},this._get_sxy(t.srcEvent)),{shiftKey:t.srcEvent.shiftKey,ctrlKey:t.srcEvent.ctrlKey})}_move_event(t){return Object.assign(Object.assign({type:t.type},this._get_sxy(t)),{shiftKey:t.shiftKey,ctrlKey:t.ctrlKey})}_scroll_event(t){return Object.assign(Object.assign({type:t.type},this._get_sxy(t)),{delta:_.getDeltaY(t),shiftKey:t.shiftKey,ctrlKey:t.ctrlKey})}_key_event(t){return{type:t.type,keyCode:t.keyCode}}_pan_start(t){const e=this._pan_event(t);e.sx-=t.deltaX,e.sy-=t.deltaY,this._trigger(this.pan_start,e,t.srcEvent)}_pan(t){this._trigger(this.pan,this._pan_event(t),t.srcEvent)}_pan_end(t){this._trigger(this.pan_end,this._pan_event(t),t.srcEvent)}_pinch_start(t){this._trigger(this.pinch_start,this._pinch_event(t),t.srcEvent)}_pinch(t){this._trigger(this.pinch,this._pinch_event(t),t.srcEvent)}_pinch_end(t){this._trigger(this.pinch_end,this._pinch_event(t),t.srcEvent)}_rotate_start(t){this._trigger(this.rotate_start,this._rotate_event(t),t.srcEvent)}_rotate(t){this._trigger(this.rotate,this._rotate_event(t),t.srcEvent)}_rotate_end(t){this._trigger(this.rotate_end,this._rotate_event(t),t.srcEvent)}_tap(t){this._trigger(this.tap,this._tap_event(t),t.srcEvent)}_doubletap(t){this._trigger(this.doubletap,this._tap_event(t),t.srcEvent)}_press(t){this._trigger(this.press,this._tap_event(t),t.srcEvent)}_pressup(t){this._trigger(this.pressup,this._tap_event(t),t.srcEvent)}_mouse_enter(t){this._trigger(this.move_enter,this._move_event(t),t)}_mouse_move(t){this._trigger(this.move,this._move_event(t),t)}_mouse_exit(t){this._trigger(this.move_exit,this._move_event(t),t)}_mouse_wheel(t){this._trigger(this.scroll,this._scroll_event(t),t)}_context_menu(t){!this.menu.is_open&&this.menu.can_open&&t.preventDefault();const{sx:e,sy:i}=this._get_sxy(t);this.menu.toggle({left:e,top:i})}_key_down(t){this.trigger(this.keydown,this._key_event(t))}_key_up(t){this.trigger(this.keyup,this._key_event(t))}}i.UIEventBus=g,g.__name__="UIEventBus"},function(t,e,i,s,n){s();var o=this&&this.__decorate||function(t,e,i,s){var n,o=arguments.length,r=o<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(o<3?n(r):o>3?n(e,i,r):n(e,i))||r);return o>3&&r&&Object.defineProperty(e,i,r),r};function r(t){return function(e){e.prototype.event_name=t}}class a{to_json(){const{event_name:t}=this;return{event_name:t,event_values:this._to_json()}}}i.BokehEvent=a,a.__name__="BokehEvent";class l extends a{constructor(){super(...arguments),this.origin=null}_to_json(){return{model:this.origin}}}i.ModelEvent=l,l.__name__="ModelEvent";let c=class extends a{_to_json(){return{}}};i.DocumentReady=c,c.__name__="DocumentReady",i.DocumentReady=c=o([r("document_ready")],c);let h=class extends l{};i.ButtonClick=h,h.__name__="ButtonClick",i.ButtonClick=h=o([r("button_click")],h);let _=class extends l{constructor(t){super(),this.item=t}_to_json(){const{item:t}=this;return Object.assign(Object.assign({},super._to_json()),{item:t})}};i.MenuItemClick=_,_.__name__="MenuItemClick",i.MenuItemClick=_=o([r("menu_item_click")],_);class d extends l{}i.UIEvent=d,d.__name__="UIEvent";let u=class extends d{};i.LODStart=u,u.__name__="LODStart",i.LODStart=u=o([r("lodstart")],u);let p=class extends d{};i.LODEnd=p,p.__name__="LODEnd",i.LODEnd=p=o([r("lodend")],p);let m=class extends d{constructor(t,e){super(),this.geometry=t,this.final=e}_to_json(){const{geometry:t,final:e}=this;return Object.assign(Object.assign({},super._to_json()),{geometry:t,final:e})}};i.SelectionGeometry=m,m.__name__="SelectionGeometry",i.SelectionGeometry=m=o([r("selectiongeometry")],m);let g=class extends d{};i.Reset=g,g.__name__="Reset",i.Reset=g=o([r("reset")],g);class f extends d{constructor(t,e,i,s){super(),this.sx=t,this.sy=e,this.x=i,this.y=s}_to_json(){const{sx:t,sy:e,x:i,y:s}=this;return Object.assign(Object.assign({},super._to_json()),{sx:t,sy:e,x:i,y:s})}}i.PointEvent=f,f.__name__="PointEvent";let b=class extends f{constructor(t,e,i,s,n,o){super(t,e,i,s),this.sx=t,this.sy=e,this.x=i,this.y=s,this.delta_x=n,this.delta_y=o}_to_json(){const{delta_x:t,delta_y:e}=this;return Object.assign(Object.assign({},super._to_json()),{delta_x:t,delta_y:e})}};i.Pan=b,b.__name__="Pan",i.Pan=b=o([r("pan")],b);let v=class extends f{constructor(t,e,i,s,n){super(t,e,i,s),this.sx=t,this.sy=e,this.x=i,this.y=s,this.scale=n}_to_json(){const{scale:t}=this;return Object.assign(Object.assign({},super._to_json()),{scale:t})}};i.Pinch=v,v.__name__="Pinch",i.Pinch=v=o([r("pinch")],v);let y=class extends f{constructor(t,e,i,s,n){super(t,e,i,s),this.sx=t,this.sy=e,this.x=i,this.y=s,this.rotation=n}_to_json(){const{rotation:t}=this;return Object.assign(Object.assign({},super._to_json()),{rotation:t})}};i.Rotate=y,y.__name__="Rotate",i.Rotate=y=o([r("rotate")],y);let x=class extends f{constructor(t,e,i,s,n){super(t,e,i,s),this.sx=t,this.sy=e,this.x=i,this.y=s,this.delta=n}_to_json(){const{delta:t}=this;return Object.assign(Object.assign({},super._to_json()),{delta:t})}};i.MouseWheel=x,x.__name__="MouseWheel",i.MouseWheel=x=o([r("wheel")],x);let w=class extends f{};i.MouseMove=w,w.__name__="MouseMove",i.MouseMove=w=o([r("mousemove")],w);let A=class extends f{};i.MouseEnter=A,A.__name__="MouseEnter",i.MouseEnter=A=o([r("mouseenter")],A);let k=class extends f{};i.MouseLeave=k,k.__name__="MouseLeave",i.MouseLeave=k=o([r("mouseleave")],k);let S=class extends f{};i.Tap=S,S.__name__="Tap",i.Tap=S=o([r("tap")],S);let T=class extends f{};i.DoubleTap=T,T.__name__="DoubleTap",i.DoubleTap=T=o([r("doubletap")],T);let C=class extends f{};i.Press=C,C.__name__="Press",i.Press=C=o([r("press")],C);let M=class extends f{};i.PressUp=M,M.__name__="PressUp",i.PressUp=M=o([r("pressup")],M);let E=class extends f{};i.PanStart=E,E.__name__="PanStart",i.PanStart=E=o([r("panstart")],E);let z=class extends f{};i.PanEnd=z,z.__name__="PanEnd",i.PanEnd=z=o([r("panend")],z);let R=class extends f{};i.PinchStart=R,R.__name__="PinchStart",i.PinchStart=R=o([r("pinchstart")],R);let B=class extends f{};i.PinchEnd=B,B.__name__="PinchEnd",i.PinchEnd=B=o([r("pinchend")],B);let P=class extends f{};i.RotateStart=P,P.__name__="RotateStart",i.RotateStart=P=o([r("rotatestart")],P);let N=class extends f{};i.RotateEnd=N,N.__name__="RotateEnd",i.RotateEnd=N=o([r("rotateend")],N)},function(t,e,i,s,n){
/*!
     * jQuery Mousewheel 3.1.13
     *
     * Copyright jQuery Foundation and other contributors
     * Released under the MIT license
     * http://jquery.org/license
     */
function o(t){const e=getComputedStyle(t).fontSize;return null!=e?parseInt(e,10):null}s(),i.getDeltaY=function(t){let e=-t.deltaY;if(t.target instanceof HTMLElement)switch(t.deltaMode){case t.DOM_DELTA_LINE:e*=(i=t.target,null!==(r=null!==(n=o(null!==(s=i.offsetParent)&&void 0!==s?s:document.body))&&void 0!==n?n:o(i))&&void 0!==r?r:16);break;case t.DOM_DELTA_PAGE:e*=function(t){return t.clientHeight}(t.target)}var i,s,n,r;return e}},function(t,e,i,s,n){s(),n("Expression",t(124).Expression),n("CustomJSExpr",t(267).CustomJSExpr),n("Stack",t(268).Stack),n("CumSum",t(269).CumSum),n("ScalarExpression",t(124).ScalarExpression),n("Minimum",t(270).Minimum),n("Maximum",t(271).Maximum)},function(t,e,i,s,n){s();const o=t(14),r=t(124),a=t(24),l=t(9),c=t(13),h=t(34),_=t(8);class d extends r.Expression{constructor(t){super(t)}static init_CustomJSExpr(){this.define((({Unknown:t,String:e,Dict:i})=>({args:[i(t),{}],code:[e,""]})))}connect_signals(){super.connect_signals();for(const t of c.values(this.args))t instanceof o.HasProps&&t.change.connect((()=>{this._result.clear(),this.change.emit()}))}get names(){return c.keys(this.args)}get values(){return c.values(this.args)}get func(){const t=h.use_strict(this.code);return new a.GeneratorFunction(...this.names,t)}_v_compute(t){const e=this.func.apply(t,this.values);let i=e.next();if(i.done&&void 0!==i.value){const{value:e}=i;return _.isArray(e)||_.isTypedArray(e)?e:_.isIterable(e)?[...e]:l.repeat(e,t.length)}{const t=[];do{t.push(i.value),i=e.next()}while(!i.done);return t}}}i.CustomJSExpr=d,d.__name__="CustomJSExpr",d.init_CustomJSExpr()},function(t,e,i,s,n){s();const o=t(124);class r extends o.Expression{constructor(t){super(t)}static init_Stack(){this.define((({String:t,Array:e})=>({fields:[e(t),[]]})))}_v_compute(t){var e;const i=null!==(e=t.get_length())&&void 0!==e?e:0,s=new Float64Array(i);for(const n of this.fields){const e=t.data[n];if(null!=e)for(let t=0,n=Math.min(i,e.length);t<n;t++)s[t]+=e[t]}return s}}i.Stack=r,r.__name__="Stack",r.init_Stack()},function(t,e,i,s,n){s();const o=t(124);class r extends o.Expression{constructor(t){super(t)}static init_CumSum(){this.define((({Boolean:t,String:e})=>({field:[e],include_zero:[t,!1]})))}_v_compute(t){var e;const i=new Float64Array(null!==(e=t.get_length())&&void 0!==e?e:0),s=t.data[this.field],n=this.include_zero?1:0;i[0]=this.include_zero?0:s[0];for(let o=1;o<i.length;o++)i[o]=i[o-1]+s[o-n];return i}}i.CumSum=r,r.__name__="CumSum",r.init_CumSum()},function(t,e,i,s,n){s();const o=t(124),r=t(9);class a extends o.ScalarExpression{constructor(t){super(t)}static init_Minimum(){this.define((({Number:t,String:e,Nullable:i})=>({field:[e],initial:[i(t),null]})))}_compute(t){var e,i;const s=null!==(e=t.data[this.field])&&void 0!==e?e:[];return Math.min(null!==(i=this.initial)&&void 0!==i?i:1/0,r.min(s))}}i.Minimum=a,a.__name__="Minimum",a.init_Minimum()},function(t,e,i,s,n){s();const o=t(124),r=t(9);class a extends o.ScalarExpression{constructor(t){super(t)}static init_Maximum(){this.define((({Number:t,String:e,Nullable:i})=>({field:[e],initial:[i(t),null]})))}_compute(t){var e,i;const s=null!==(e=t.data[this.field])&&void 0!==e?e:[];return Math.max(null!==(i=this.initial)&&void 0!==i?i:-1/0,r.max(s))}}i.Maximum=a,a.__name__="Maximum",a.init_Maximum()},function(t,e,i,s,n){s(),n("BooleanFilter",t(273).BooleanFilter),n("CustomJSFilter",t(274).CustomJSFilter),n("Filter",t(121).Filter),n("GroupFilter",t(275).GroupFilter),n("IndexFilter",t(276).IndexFilter)},function(t,e,i,s,n){s();const o=t(121),r=t(24);class a extends o.Filter{constructor(t){super(t)}static init_BooleanFilter(){this.define((({Boolean:t,Array:e,Nullable:i})=>({booleans:[i(e(t)),null]})))}compute_indices(t){const e=t.length,{booleans:i}=this;return null==i?r.Indices.all_set(e):r.Indices.from_booleans(e,i)}}i.BooleanFilter=a,a.__name__="BooleanFilter",a.init_BooleanFilter()},function(t,e,i,s,n){s();const o=t(121),r=t(24),a=t(13),l=t(8),c=t(34);class h extends o.Filter{constructor(t){super(t)}static init_CustomJSFilter(){this.define((({Unknown:t,String:e,Dict:i})=>({args:[i(t),{}],code:[e,""]})))}get names(){return a.keys(this.args)}get values(){return a.values(this.args)}get func(){const t=c.use_strict(this.code);return new Function(...this.names,"source",t)}compute_indices(t){const e=t.length,i=this.func(...this.values,t);if(null==i)return r.Indices.all_set(e);if(l.isArrayOf(i,l.isInteger))return r.Indices.from_indices(e,i);if(l.isArrayOf(i,l.isBoolean))return r.Indices.from_booleans(e,i);throw new Error(`expect an array of integers or booleans, or null, got ${i}`)}}i.CustomJSFilter=h,h.__name__="CustomJSFilter",h.init_CustomJSFilter()},function(t,e,i,s,n){s();const o=t(121),r=t(24),a=t(19);class l extends o.Filter{constructor(t){super(t)}static init_GroupFilter(){this.define((({String:t})=>({column_name:[t],group:[t]})))}compute_indices(t){const e=t.get_column(this.column_name);if(null==e)return a.logger.warn(`${this}: groupby column '${this.column_name}' not found in the data source`),new r.Indices(t.length,1);{const i=new r.Indices(t.length);for(let t=0;t<i.size;t++)e[t]===this.group&&i.set(t);return i}}}i.GroupFilter=l,l.__name__="GroupFilter",l.init_GroupFilter()},function(t,e,i,s,n){s();const o=t(121),r=t(24);class a extends o.Filter{constructor(t){super(t)}static init_IndexFilter(){this.define((({Int:t,Array:e,Nullable:i})=>({indices:[i(e(t)),null]})))}compute_indices(t){const e=t.length,{indices:i}=this;return null==i?r.Indices.all_set(e):r.Indices.from_indices(e,i)}}i.IndexFilter=a,a.__name__="IndexFilter",a.init_IndexFilter()},function(t,e,i,s,n){s(),n("AnnularWedge",t(278).AnnularWedge),n("Annulus",t(279).Annulus),n("Arc",t(280).Arc),n("Bezier",t(281).Bezier),n("Circle",t(282).Circle),n("Ellipse",t(286).Ellipse),n("EllipseOval",t(287).EllipseOval),n("Glyph",t(98).Glyph),n("HArea",t(117).HArea),n("HBar",t(289).HBar),n("HexTile",t(291).HexTile),n("Image",t(292).Image),n("ImageRGBA",t(294).ImageRGBA),n("ImageURL",t(295).ImageURL),n("Line",t(63).Line),n("MultiLine",t(127).MultiLine),n("MultiPolygons",t(297).MultiPolygons),n("Oval",t(298).Oval),n("Patch",t(116).Patch),n("Patches",t(128).Patches),n("Quad",t(299).Quad),n("Quadratic",t(300).Quadratic),n("Ray",t(301).Ray),n("Rect",t(302).Rect),n("Scatter",t(303).Scatter),n("Segment",t(306).Segment),n("Spline",t(307).Spline),n("Step",t(309).Step),n("Text",t(310).Text),n("VArea",t(119).VArea),n("VBar",t(311).VBar),n("Wedge",t(312).Wedge)},function(t,e,i,s,n){s();const o=t(1),r=t(64),a=t(106),l=t(48),c=t(24),h=t(20),_=o.__importStar(t(18)),d=t(10),u=t(59);class p extends r.XYGlyphView{_map_data(){"data"==this.model.properties.inner_radius.units?this.sinner_radius=this.sdist(this.renderer.xscale,this._x,this.inner_radius):this.sinner_radius=c.to_screen(this.inner_radius),"data"==this.model.properties.outer_radius.units?this.souter_radius=this.sdist(this.renderer.xscale,this._x,this.outer_radius):this.souter_radius=c.to_screen(this.outer_radius)}_render(t,e,i){const{sx:s,sy:n,start_angle:o,end_angle:r,sinner_radius:a,souter_radius:l}=null!=i?i:this,c="anticlock"==this.model.direction;for(const h of e){const e=s[h],i=n[h],_=a[h],d=l[h],u=o.get(h),p=r.get(h);if(isNaN(e+i+_+d+u+p))continue;const m=p-u;t.translate(e,i),t.rotate(u),t.beginPath(),t.moveTo(d,0),t.arc(0,0,d,0,m,c),t.rotate(m),t.lineTo(_,0),t.arc(0,0,_,0,-m,!c),t.closePath(),t.rotate(-m-u),t.translate(-e,-i),this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,h),t.fill()),this.visuals.hatch.doit&&(this.visuals.hatch.set_vectorize(t,h),t.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,h),t.stroke())}}_hit_point(t){const{sx:e,sy:i}=t,s=this.renderer.xscale.invert(e),n=this.renderer.yscale.invert(i);let o,r,a,l;if("data"==this.model.properties.outer_radius.units)o=s-this.max_outer_radius,a=s+this.max_outer_radius,r=n-this.max_outer_radius,l=n+this.max_outer_radius;else{const t=e-this.max_outer_radius,s=e+this.max_outer_radius;[o,a]=this.renderer.xscale.r_invert(t,s);const n=i-this.max_outer_radius,c=i+this.max_outer_radius;[r,l]=this.renderer.yscale.r_invert(n,c)}const c=[];for(const d of this.index.indices({x0:o,x1:a,y0:r,y1:l})){const t=this.souter_radius[d]**2,e=this.sinner_radius[d]**2,[i,o]=this.renderer.xscale.r_compute(s,this._x[d]),[r,a]=this.renderer.yscale.r_compute(n,this._y[d]),l=(i-o)**2+(r-a)**2;l<=t&&l>=e&&c.push(d)}const h="anticlock"==this.model.direction,_=[];for(const u of c){const t=Math.atan2(i-this.sy[u],e-this.sx[u]);d.angle_between(-t,-this.start_angle.get(u),-this.end_angle.get(u),h)&&_.push(u)}return new u.Selection({indices:_})}draw_legend_for_index(t,e,i){a.generic_area_vector_legend(this.visuals,t,e,i)}scenterxy(t){const e=(this.sinner_radius[t]+this.souter_radius[t])/2,i=(this.start_angle.get(t)+this.end_angle.get(t))/2;return[this.sx[t]+e*Math.cos(i),this.sy[t]+e*Math.sin(i)]}}i.AnnularWedgeView=p,p.__name__="AnnularWedgeView";class m extends r.XYGlyph{constructor(t){super(t)}static init_AnnularWedge(){this.prototype.default_view=p,this.mixins([l.LineVector,l.FillVector,l.HatchVector]),this.define((({})=>({direction:[h.Direction,"anticlock"],inner_radius:[_.DistanceSpec,{field:"inner_radius"}],outer_radius:[_.DistanceSpec,{field:"outer_radius"}],start_angle:[_.AngleSpec,{field:"start_angle"}],end_angle:[_.AngleSpec,{field:"end_angle"}]})))}}i.AnnularWedge=m,m.__name__="AnnularWedge",m.init_AnnularWedge()},function(t,e,i,s,n){s();const o=t(1),r=t(64),a=t(24),l=t(48),c=o.__importStar(t(18)),h=t(27),_=t(59);class d extends r.XYGlyphView{_map_data(){"data"==this.model.properties.inner_radius.units?this.sinner_radius=this.sdist(this.renderer.xscale,this._x,this.inner_radius):this.sinner_radius=a.to_screen(this.inner_radius),"data"==this.model.properties.outer_radius.units?this.souter_radius=this.sdist(this.renderer.xscale,this._x,this.outer_radius):this.souter_radius=a.to_screen(this.outer_radius)}_render(t,e,i){const{sx:s,sy:n,sinner_radius:o,souter_radius:r}=null!=i?i:this;for(const l of e){const e=s[l],i=n[l],c=o[l],_=r[l];function a(){if(t.beginPath(),h.is_ie)for(const s of[!1,!0])t.arc(e,i,c,0,Math.PI,s),t.arc(e,i,_,Math.PI,0,!s);else t.arc(e,i,c,0,2*Math.PI,!0),t.arc(e,i,_,2*Math.PI,0,!1)}isNaN(e+i+c+_)||(this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,l),a(),t.fill()),this.visuals.hatch.doit&&(this.visuals.hatch.set_vectorize(t,l),a(),t.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,l),t.beginPath(),t.arc(e,i,c,0,2*Math.PI),t.moveTo(e+_,i),t.arc(e,i,_,0,2*Math.PI),t.stroke()))}}_hit_point(t){const{sx:e,sy:i}=t,s=this.renderer.xscale.invert(e),n=this.renderer.yscale.invert(i);let o,r,a,l;if("data"==this.model.properties.outer_radius.units)o=s-this.max_outer_radius,a=s+this.max_outer_radius,r=n-this.max_outer_radius,l=n+this.max_outer_radius;else{const t=e-this.max_outer_radius,s=e+this.max_outer_radius;[o,a]=this.renderer.xscale.r_invert(t,s);const n=i-this.max_outer_radius,c=i+this.max_outer_radius;[r,l]=this.renderer.yscale.r_invert(n,c)}const c=[];for(const h of this.index.indices({x0:o,x1:a,y0:r,y1:l})){const t=this.souter_radius[h]**2,e=this.sinner_radius[h]**2,[i,o]=this.renderer.xscale.r_compute(s,this._x[h]),[r,a]=this.renderer.yscale.r_compute(n,this._y[h]),l=(i-o)**2+(r-a)**2;l<=t&&l>=e&&c.push(h)}return new _.Selection({indices:c})}draw_legend_for_index(t,{x0:e,y0:i,x1:s,y1:n},o){const r=o+1,a=new Array(r);a[o]=(e+s)/2;const l=new Array(r);l[o]=(i+n)/2;const c=.5*Math.min(Math.abs(s-e),Math.abs(n-i)),h=new Array(r);h[o]=.4*c;const _=new Array(r);_[o]=.8*c,this._render(t,[o],{sx:a,sy:l,sinner_radius:h,souter_radius:_})}}i.AnnulusView=d,d.__name__="AnnulusView";class u extends r.XYGlyph{constructor(t){super(t)}static init_Annulus(){this.prototype.default_view=d,this.mixins([l.LineVector,l.FillVector,l.HatchVector]),this.define((({})=>({inner_radius:[c.DistanceSpec,{field:"inner_radius"}],outer_radius:[c.DistanceSpec,{field:"outer_radius"}]})))}}i.Annulus=u,u.__name__="Annulus",u.init_Annulus()},function(t,e,i,s,n){s();const o=t(1),r=t(64),a=t(106),l=t(48),c=t(24),h=t(20),_=o.__importStar(t(18));class d extends r.XYGlyphView{_map_data(){"data"==this.model.properties.radius.units?this.sradius=this.sdist(this.renderer.xscale,this._x,this.radius):this.sradius=c.to_screen(this.radius)}_render(t,e,i){if(this.visuals.line.doit){const{sx:s,sy:n,sradius:o,start_angle:r,end_angle:a}=null!=i?i:this,l="anticlock"==this.model.direction;for(const i of e){const e=s[i],c=n[i],h=o[i],_=r.get(i),d=a.get(i);isNaN(e+c+h+_+d)||(t.beginPath(),t.arc(e,c,h,_,d,l),this.visuals.line.set_vectorize(t,i),t.stroke())}}}draw_legend_for_index(t,e,i){a.generic_line_vector_legend(this.visuals,t,e,i)}}i.ArcView=d,d.__name__="ArcView";class u extends r.XYGlyph{constructor(t){super(t)}static init_Arc(){this.prototype.default_view=d,this.mixins(l.LineVector),this.define((({})=>({direction:[h.Direction,"anticlock"],radius:[_.DistanceSpec,{field:"radius"}],start_angle:[_.AngleSpec,{field:"start_angle"}],end_angle:[_.AngleSpec,{field:"end_angle"}]})))}}i.Arc=u,u.__name__="Arc",u.init_Arc()},function(t,e,i,s,n){s();const o=t(1),r=t(48),a=t(98),l=t(106),c=t(65),h=o.__importStar(t(18));function _(t,e,i,s,n,o,r,a){const l=[],c=[[],[]];for(let d=0;d<=2;d++){let c,h,_;if(0===d?(h=6*t-12*i+6*n,c=-3*t+9*i-9*n+3*r,_=3*i-3*t):(h=6*e-12*s+6*o,c=-3*e+9*s-9*o+3*a,_=3*s-3*e),Math.abs(c)<1e-12){if(Math.abs(h)<1e-12)continue;const t=-_/h;0<t&&t<1&&l.push(t);continue}const u=h*h-4*_*c,p=Math.sqrt(u);if(u<0)continue;const m=(-h+p)/(2*c);0<m&&m<1&&l.push(m);const g=(-h-p)/(2*c);0<g&&g<1&&l.push(g)}let h=l.length;const _=h;for(;h--;){const _=l[h],d=1-_,u=d*d*d*t+3*d*d*_*i+3*d*_*_*n+_*_*_*r;c[0][h]=u;const p=d*d*d*e+3*d*d*_*s+3*d*_*_*o+_*_*_*a;c[1][h]=p}return c[0][_]=t,c[1][_]=e,c[0][_+1]=r,c[1][_+1]=a,[Math.min(...c[0]),Math.max(...c[1]),Math.max(...c[0]),Math.min(...c[1])]}class d extends a.GlyphView{_project_data(){c.inplace.project_xy(this._x0,this._y0),c.inplace.project_xy(this._x1,this._y1)}_index_data(t){const{data_size:e,_x0:i,_y0:s,_x1:n,_y1:o,_cx0:r,_cy0:a,_cx1:l,_cy1:c}=this;for(let h=0;h<e;h++){const e=i[h],d=s[h],u=n[h],p=o[h],m=r[h],g=a[h],f=l[h],b=c[h];if(isNaN(e+u+d+p+m+g+f+b))t.add_empty();else{const[i,s,n,o]=_(e,d,u,p,m,g,f,b);t.add(i,s,n,o)}}}_render(t,e,i){if(this.visuals.line.doit){const{sx0:s,sy0:n,sx1:o,sy1:r,scx0:a,scy0:l,scx1:c,scy1:h}=null!=i?i:this;for(const i of e){const e=s[i],_=n[i],d=o[i],u=r[i],p=a[i],m=l[i],g=c[i],f=h[i];isNaN(e+_+d+u+p+m+g+f)||(t.beginPath(),t.moveTo(e,_),t.bezierCurveTo(p,m,g,f,d,u),this.visuals.line.set_vectorize(t,i),t.stroke())}}}draw_legend_for_index(t,e,i){l.generic_line_vector_legend(this.visuals,t,e,i)}scenterxy(){throw new Error(`${this}.scenterxy() is not implemented`)}}i.BezierView=d,d.__name__="BezierView";class u extends a.Glyph{constructor(t){super(t)}static init_Bezier(){this.prototype.default_view=d,this.define((({})=>({x0:[h.XCoordinateSpec,{field:"x0"}],y0:[h.YCoordinateSpec,{field:"y0"}],x1:[h.XCoordinateSpec,{field:"x1"}],y1:[h.YCoordinateSpec,{field:"y1"}],cx0:[h.XCoordinateSpec,{field:"cx0"}],cy0:[h.YCoordinateSpec,{field:"cy0"}],cx1:[h.XCoordinateSpec,{field:"cx1"}],cy1:[h.YCoordinateSpec,{field:"cy1"}]}))),this.mixins(r.LineVector)}}i.Bezier=u,u.__name__="Bezier",u.init_Bezier()},function(t,e,i,s,n){s();const o=t(1),r=t(64),a=t(283),l=t(48),c=t(24),h=t(20),_=o.__importStar(t(107)),d=o.__importStar(t(18)),u=t(9),p=t(12),m=t(59);class g extends r.XYGlyphView{initialize(){super.initialize();const{webgl:t}=this.renderer.plot_view.canvas_view;null!=t&&(this.glglyph=new a.MarkerGL(t.gl,this,"circle"))}get use_radius(){return!(this.radius.is_Scalar()&&isNaN(this.radius.value))}_map_data(){if(this.use_radius)if("data"==this.model.properties.radius.units)switch(this.model.radius_dimension){case"x":this.sradius=this.sdist(this.renderer.xscale,this._x,this.radius);break;case"y":this.sradius=this.sdist(this.renderer.yscale,this._y,this.radius);break;case"max":{const t=this.sdist(this.renderer.xscale,this._x,this.radius),e=this.sdist(this.renderer.yscale,this._y,this.radius);this.sradius=p.map(t,((t,i)=>Math.max(t,e[i])));break}case"min":{const t=this.sdist(this.renderer.xscale,this._x,this.radius),e=this.sdist(this.renderer.yscale,this._y,this.radius);this.sradius=p.map(t,((t,i)=>Math.min(t,e[i])));break}}else this.sradius=c.to_screen(this.radius),this._configure("max_size",{value:2*this.max_radius});else{const t=new c.ScreenArray(this.size);this.sradius=p.map(t,(t=>t/2))}}_mask_data(){const{frame:t}=this.renderer.plot_view,e=t.x_target,i=t.y_target;let s,n;return this.use_radius&&"data"==this.model.properties.radius.units?(s=e.map((t=>this.renderer.xscale.invert(t))).widen(this.max_radius),n=i.map((t=>this.renderer.yscale.invert(t))).widen(this.max_radius)):(s=e.widen(this.max_size).map((t=>this.renderer.xscale.invert(t))),n=i.widen(this.max_size).map((t=>this.renderer.yscale.invert(t)))),this.index.indices({x0:s.start,x1:s.end,y0:n.start,y1:n.end})}_render(t,e,i){const{sx:s,sy:n,sradius:o}=null!=i?i:this;for(const r of e){const e=s[r],i=n[r],a=o[r];isNaN(e+i+a)||(t.beginPath(),t.arc(e,i,a,0,2*Math.PI,!1),this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,r),t.fill()),this.visuals.hatch.doit&&(this.visuals.hatch.set_vectorize(t,r),t.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,r),t.stroke()))}}_hit_point(t){const{sx:e,sy:i}=t,s=this.renderer.xscale.invert(e),n=this.renderer.yscale.invert(i),{hit_dilation:o}=this.model;let r,a,l,c;if(this.use_radius&&"data"==this.model.properties.radius.units)r=s-this.max_radius*o,a=s+this.max_radius*o,l=n-this.max_radius*o,c=n+this.max_radius*o;else{const t=e-this.max_size*o,s=e+this.max_size*o;[r,a]=this.renderer.xscale.r_invert(t,s);const n=i-this.max_size*o,h=i+this.max_size*o;[l,c]=this.renderer.yscale.r_invert(n,h)}const h=this.index.indices({x0:r,x1:a,y0:l,y1:c}),_=[];if(this.use_radius&&"data"==this.model.properties.radius.units)for(const d of h){const t=(this.sradius[d]*o)**2,[e,i]=this.renderer.xscale.r_compute(s,this._x[d]),[r,a]=this.renderer.yscale.r_compute(n,this._y[d]);(e-i)**2+(r-a)**2<=t&&_.push(d)}else for(const d of h){const t=(this.sradius[d]*o)**2;(this.sx[d]-e)**2+(this.sy[d]-i)**2<=t&&_.push(d)}return new m.Selection({indices:_})}_hit_span(t){const{sx:e,sy:i}=t,s=this.bounds();let n,o,r,a;if("h"==t.direction){let t,i;if(r=s.y0,a=s.y1,this.use_radius&&"data"==this.model.properties.radius.units)t=e-this.max_radius,i=e+this.max_radius,[n,o]=this.renderer.xscale.r_invert(t,i);else{const s=this.max_size/2;t=e-s,i=e+s,[n,o]=this.renderer.xscale.r_invert(t,i)}}else{let t,e;if(n=s.x0,o=s.x1,this.use_radius&&"data"==this.model.properties.radius.units)t=i-this.max_radius,e=i+this.max_radius,[r,a]=this.renderer.yscale.r_invert(t,e);else{const s=this.max_size/2;t=i-s,e=i+s,[r,a]=this.renderer.yscale.r_invert(t,e)}}const l=[...this.index.indices({x0:n,x1:o,y0:r,y1:a})];return new m.Selection({indices:l})}_hit_rect(t){const{sx0:e,sx1:i,sy0:s,sy1:n}=t,[o,r]=this.renderer.xscale.r_invert(e,i),[a,l]=this.renderer.yscale.r_invert(s,n),c=[...this.index.indices({x0:o,x1:r,y0:a,y1:l})];return new m.Selection({indices:c})}_hit_poly(t){const{sx:e,sy:i}=t,s=u.range(0,this.sx.length),n=[];for(let o=0,r=s.length;o<r;o++){const t=s[o];_.point_in_poly(this.sx[o],this.sy[o],e,i)&&n.push(t)}return new m.Selection({indices:n})}draw_legend_for_index(t,{x0:e,y0:i,x1:s,y1:n},o){const r=o+1,a=new Array(r);a[o]=(e+s)/2;const l=new Array(r);l[o]=(i+n)/2;const c=new Array(r);c[o]=.2*Math.min(Math.abs(s-e),Math.abs(n-i)),this._render(t,[o],{sx:a,sy:l,sradius:c})}}i.CircleView=g,g.__name__="CircleView";class f extends r.XYGlyph{constructor(t){super(t)}static init_Circle(){this.prototype.default_view=g,this.mixins([l.LineVector,l.FillVector,l.HatchVector]),this.define((({Number:t})=>({angle:[d.AngleSpec,0],size:[d.ScreenDistanceSpec,{value:4}],radius:[d.NullDistanceSpec,null],radius_dimension:[h.RadiusDimension,"x"],hit_dilation:[t,1]})))}}i.Circle=f,f.__name__="Circle",f.init_Circle()},function(t,e,i,s,n){s();const o=t(1),r=t(109),a=t(113),l=o.__importDefault(t(284)),c=o.__importDefault(t(285)),h=t(282),_=t(12),d=t(19),u=t(24),p=t(22),m=t(11);function g(t,e,i,s,n,o,r){if(n.doit)if(o.is_Scalar()&&r.is_Scalar()){e.used=!1;const[s,n,a,l]=p.color2rgba(o.value,r.value);t.set_attribute(i,"vec4",[s/255,n/255,a/255,l/255])}else{let n;if(e.used=!0,o.is_Vector()){const t=new u.ColorArray(o.array);if(n=new u.RGBAArray(t.buffer),!r.is_Scalar()||1!=r.value)for(let e=0;e<s;e++){const t=4*e+3;255==n[t]&&(n[t]=255*r.get(e))}}else if(o.is_Scalar()&&r.is_Vector()){const t=new u.ColorArray(s);t.fill(o.value),n=new u.RGBAArray(t.buffer);for(let e=0;e<s;e++)for(let t=0;t<s;t++){const e=4*t+3;255==n[e]&&(n[e]=255*r.get(t))}}else m.unreachable();e.set_size(4*s),e.set_data(0,n),t.set_attribute(i,"vec4_uint8",e,0,0,!0)}else e.used=!1,t.set_attribute(i,"vec4",[0,0,0,0])}class f extends a.BaseGLGlyph{constructor(t,e,i){super(t,e),this.glyph=e,this.marker_type=i;const s=[`#define USE_${i.toUpperCase()}`],n=l.default,o=`${s.join("\n")}\n\n${c.default}`;this.prog=new r.Program(t),this.prog.set_shaders(n,o),this.vbo_sx=new r.VertexBuffer(t),this.prog.set_attribute("a_sx","float",this.vbo_sx),this.vbo_sy=new r.VertexBuffer(t),this.prog.set_attribute("a_sy","float",this.vbo_sy),this.vbo_s=new r.VertexBuffer(t),this.prog.set_attribute("a_size","float",this.vbo_s),this.vbo_a=new r.VertexBuffer(t),this.prog.set_attribute("a_angle","float",this.vbo_a),this.vbo_linewidth=new r.VertexBuffer(t),this.vbo_fg_color=new r.VertexBuffer(t),this.vbo_bg_color=new r.VertexBuffer(t),this.index_buffer=new r.IndexBuffer(t)}static is_supported(t){switch(t){case"asterisk":case"circle":case"circle_cross":case"circle_x":case"cross":case"diamond":case"diamond_cross":case"hex":case"inverted_triangle":case"square":case"square_cross":case"square_x":case"star":case"triangle":case"x":return!0;default:return!1}}draw(t,e,i){const s=e.glglyph,{nvertices:n}=s;if(s.data_changed&&(s._set_data(n),this.glyph instanceof h.CircleView&&null!=this.glyph.radius&&this.vbo_s.set_data(0,_.map(this.glyph.sradius,(t=>2*t))),s.data_changed=!1),this.visuals_changed&&(this._set_visuals(n),this.visuals_changed=!1),this.prog.set_uniform("u_pixel_ratio","float",[i.pixel_ratio]),this.prog.set_uniform("u_canvas_size","vec2",[i.width,i.height]),this.prog.set_attribute("a_sx","float",s.vbo_sx),this.prog.set_attribute("a_sy","float",s.vbo_sy),this.prog.set_attribute("a_size","float",s.vbo_s),this.prog.set_attribute("a_angle","float",s.vbo_a),0!=t.length)if(t.length===n)this.prog.draw(this.gl.POINTS,[0,n]);else if(n<65535){const e=window.navigator.userAgent;e.indexOf("MSIE ")+e.indexOf("Trident/")+e.indexOf("Edge/")>0&&d.logger.warn("WebGL warning: IE is known to produce 1px sprites whith selections."),this.index_buffer.set_size(2*t.length),this.index_buffer.set_data(0,new Uint16Array(t)),this.prog.draw(this.gl.POINTS,this.index_buffer)}else{const e=64e3,i=[];for(let t=0,s=Math.ceil(n/e);t<s;t++)i.push([]);for(let s=0,n=t.length;s<n;s++){const n=t[s]%e;i[Math.floor(t[s]/e)].push(n)}for(let t=0,n=i.length;t<n;t++){const n=new Uint16Array(i[t]),o=t*e*4;0!==n.length&&(this.prog.set_attribute("a_sx","float",s.vbo_sx,0,o),this.prog.set_attribute("a_sy","float",s.vbo_sy,0,o),this.prog.set_attribute("a_size","float",s.vbo_s,0,o),this.prog.set_attribute("a_angle","float",s.vbo_a,0,o),this.vbo_linewidth.used&&this.prog.set_attribute("a_linewidth","float",this.vbo_linewidth,0,o),this.vbo_fg_color.used&&this.prog.set_attribute("a_fg_color","vec4_uint8",this.vbo_fg_color,0,4*o,!0),this.vbo_bg_color.used&&this.prog.set_attribute("a_bg_color","vec4_uint8",this.vbo_bg_color,0,4*o,!0),this.index_buffer.set_size(2*n.length),this.index_buffer.set_data(0,n),this.prog.draw(this.gl.POINTS,this.index_buffer))}}}_set_data(t){const e=4*t;this.vbo_sx.set_size(e),this.vbo_sy.set_size(e),this.vbo_a.set_size(e),this.vbo_s.set_size(e),this.vbo_sx.set_data(0,this.glyph.sx),this.vbo_sy.set_data(0,this.glyph.sy),null!=this.glyph.angle&&this.vbo_a.set_data(0,new Float32Array(this.glyph.angle)),this.glyph instanceof h.CircleView&&null!=this.glyph.radius?this.vbo_s.set_data(0,_.map(this.glyph.sradius,(t=>2*t))):this.vbo_s.set_data(0,new Float32Array(this.glyph.size))}_set_visuals(t){const{line:e,fill:i}=this.glyph.visuals;!function(t,e,i,s,n,o){if(n.doit){if(o.is_Scalar())e.used=!1,t.set_attribute(i,"float",[o.value]);else if(o.is_Vector()){e.used=!0;const n=new Float32Array(o.array);e.set_size(4*s),e.set_data(0,n),t.set_attribute(i,"float",e)}}else e.used=!1,t.set_attribute(i,"float",[0])}(this.prog,this.vbo_linewidth,"a_linewidth",t,e,e.line_width),g(this.prog,this.vbo_fg_color,"a_fg_color",t,e,e.line_color,e.line_alpha),g(this.prog,this.vbo_bg_color,"a_bg_color",t,i,i.fill_color,i.fill_alpha),this.prog.set_uniform("u_antialias","float",[.8])}}i.MarkerGL=f,f.__name__="MarkerGL"},function(t,e,i,s,n){s(),i.default="\nprecision mediump float;\nconst float SQRT_2 = 1.4142135623730951;\n//\nuniform float u_pixel_ratio;\nuniform vec2 u_canvas_size;\nuniform vec2 u_offset;\nuniform vec2 u_scale;\nuniform float u_antialias;\n//\nattribute float a_sx;\nattribute float a_sy;\nattribute float a_size;\nattribute float a_angle;  // in radians\nattribute float a_linewidth;\nattribute vec4  a_fg_color;\nattribute vec4  a_bg_color;\n//\nvarying float v_linewidth;\nvarying float v_size;\nvarying vec4  v_fg_color;\nvarying vec4  v_bg_color;\nvarying vec2  v_rotation;\n\nvoid main (void)\n{\n    v_size = a_size * u_pixel_ratio;\n    v_linewidth = a_linewidth * u_pixel_ratio;\n    v_fg_color = a_fg_color;\n    v_bg_color = a_bg_color;\n    v_rotation = vec2(cos(-a_angle), sin(-a_angle));\n    vec2 pos = vec2(a_sx, a_sy);  // in pixels\n    pos += 0.5;  // make up for Bokeh's offset\n    pos /= u_canvas_size / u_pixel_ratio;  // in 0..1\n    gl_Position = vec4(pos*2.0-1.0, 0.0, 1.0);\n    gl_Position.y *= -1.0;\n    gl_PointSize = SQRT_2 * v_size + 2.0 * (v_linewidth + 1.5*u_antialias);\n}\n"},function(t,e,i,s,n){s(),i.default='\nprecision mediump float;\n\nconst float SQRT_2 = 1.4142135623730951;\nconst float PI = 3.14159265358979323846264;\n\nconst float IN_ANGLE = 0.6283185307179586; // PI/5. = 36 degrees (star of 5 pikes)\n//const float OUT_ANGLE = PI/2. - IN_ANGLE; // External angle for regular stars\nconst float COS_A = 0.8090169943749475; // cos(IN_ANGLE)\nconst float SIN_A = 0.5877852522924731; // sin(IN_ANGLE)\nconst float COS_B = 0.5877852522924731; // cos(OUT_ANGLE)\nconst float SIN_B = 0.8090169943749475; // sin(OUT_ANGLE)\n\n//\nuniform float u_antialias;\n//\nvarying vec4  v_fg_color;\nvarying vec4  v_bg_color;\nvarying float v_linewidth;\nvarying float v_size;\nvarying vec2  v_rotation;\n\n#ifdef USE_ASTERISK\n// asterisk\nfloat marker(vec2 P, float size)\n{\n    // Masks\n    float diamond = max(abs(SQRT_2 / 2.0 * (P.x - P.y)), abs(SQRT_2 / 2.0 * (P.x + P.y))) - size / (2.0 * SQRT_2);\n    float square = max(abs(P.x), abs(P.y)) - size / (2.0 * SQRT_2);\n    // Shapes\n    float X = min(abs(P.x - P.y), abs(P.x + P.y)) - size / 100.0;  // bit of "width" for aa\n    float cross = min(abs(P.x), abs(P.y)) - size / 100.0;  // bit of "width" for aa\n    // Result is union of masked shapes\n    return min(max(X, diamond), max(cross, square));\n}\n#endif\n\n#ifdef USE_CIRCLE\n// circle\nfloat marker(vec2 P, float size)\n{\n    return length(P) - size/2.0;\n}\n#endif\n\n#ifdef USE_SQUARE\n// square\nfloat marker(vec2 P, float size)\n{\n    return max(abs(P.x), abs(P.y)) - size/2.0;\n}\n#endif\n\n#ifdef USE_DIAMOND\n// diamond\nfloat marker(vec2 P, float size)\n{\n    float x = SQRT_2 / 2.0 * (P.x * 1.5 - P.y);\n    float y = SQRT_2 / 2.0 * (P.x * 1.5 + P.y);\n    float r1 = max(abs(x), abs(y)) - size / (2.0 * SQRT_2);\n    return r1 / SQRT_2;\n}\n#endif\n\n#ifdef USE_HEX\n// hex\nfloat marker(vec2 P, float size)\n{\n    vec2 q = abs(P);\n    return max(q.y * 0.57735 + q.x - 1.0 * size/2.0, q.y - 0.866 * size/2.0);\n}\n#endif\n\n#ifdef USE_STAR\n// star\n// https://iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm\nfloat marker(vec2 P, float size)\n{\n    float bn = mod(atan(P.x, -P.y), 2.0*IN_ANGLE) - IN_ANGLE;\n    P = length(P)*vec2(cos(bn), abs(sin(bn)));\n    P -= size*vec2(COS_A, SIN_A)/2.;\n    P += vec2(COS_B, SIN_B)*clamp(-(P.x*COS_B + P.y*SIN_B), 0.0, size*SIN_A/SIN_B/2.);\n\n    return length(P)*sign(P.x);\n}\n#endif\n\n#ifdef USE_TRIANGLE\n// triangle\nfloat marker(vec2 P, float size)\n{\n    P.y -= size * 0.3;\n    float x = SQRT_2 / 2.0 * (P.x * 1.7 - P.y);\n    float y = SQRT_2 / 2.0 * (P.x * 1.7 + P.y);\n    float r1 = max(abs(x), abs(y)) - size / 1.6;\n    float r2 = P.y;\n    return max(r1 / SQRT_2, r2);  // Intersect diamond with rectangle\n}\n#endif\n\n#ifdef USE_INVERTED_TRIANGLE\n// inverted_triangle\nfloat marker(vec2 P, float size)\n{\n    P.y += size * 0.3;\n    float x = SQRT_2 / 2.0 * (P.x * 1.7 - P.y);\n    float y = SQRT_2 / 2.0 * (P.x * 1.7 + P.y);\n    float r1 = max(abs(x), abs(y)) - size / 1.6;\n    float r2 = - P.y;\n    return max(r1 / SQRT_2, r2);  // Intersect diamond with rectangle\n}\n#endif\n\n#ifdef USE_CROSS\n// cross\nfloat marker(vec2 P, float size)\n{\n    float square = max(abs(P.x), abs(P.y)) - size / 2.5;   // 2.5 is a tweak\n    float cross = min(abs(P.x), abs(P.y)) - size / 100.0;  // bit of "width" for aa\n    return max(square, cross);\n}\n#endif\n\n#ifdef USE_CIRCLE_CROSS\n// circle_cross\nfloat marker(vec2 P, float size)\n{\n    // Define quadrants\n    float qs = size / 2.0;  // quadrant size\n    float s1 = max(abs(P.x - qs), abs(P.y - qs)) - qs;\n    float s2 = max(abs(P.x + qs), abs(P.y - qs)) - qs;\n    float s3 = max(abs(P.x - qs), abs(P.y + qs)) - qs;\n    float s4 = max(abs(P.x + qs), abs(P.y + qs)) - qs;\n    // Intersect main shape with quadrants (to form cross)\n    float circle = length(P) - size/2.0;\n    float c1 = max(circle, s1);\n    float c2 = max(circle, s2);\n    float c3 = max(circle, s3);\n    float c4 = max(circle, s4);\n    // Union\n    return min(min(min(c1, c2), c3), c4);\n}\n#endif\n\n#ifdef USE_SQUARE_CROSS\n// square_cross\nfloat marker(vec2 P, float size)\n{\n    // Define quadrants\n    float qs = size / 2.0;  // quadrant size\n    float s1 = max(abs(P.x - qs), abs(P.y - qs)) - qs;\n    float s2 = max(abs(P.x + qs), abs(P.y - qs)) - qs;\n    float s3 = max(abs(P.x - qs), abs(P.y + qs)) - qs;\n    float s4 = max(abs(P.x + qs), abs(P.y + qs)) - qs;\n    // Intersect main shape with quadrants (to form cross)\n    float square = max(abs(P.x), abs(P.y)) - size/2.0;\n    float c1 = max(square, s1);\n    float c2 = max(square, s2);\n    float c3 = max(square, s3);\n    float c4 = max(square, s4);\n    // Union\n    return min(min(min(c1, c2), c3), c4);\n}\n#endif\n\n#ifdef USE_DIAMOND_CROSS\n// diamond_cross\nfloat marker(vec2 P, float size)\n{\n    // Define quadrants\n    float qs = size / 2.0;  // quadrant size\n    float s1 = max(abs(P.x - qs), abs(P.y - qs)) - qs;\n    float s2 = max(abs(P.x + qs), abs(P.y - qs)) - qs;\n    float s3 = max(abs(P.x - qs), abs(P.y + qs)) - qs;\n    float s4 = max(abs(P.x + qs), abs(P.y + qs)) - qs;\n    // Intersect main shape with quadrants (to form cross)\n    float x = SQRT_2 / 2.0 * (P.x * 1.5 - P.y);\n    float y = SQRT_2 / 2.0 * (P.x * 1.5 + P.y);\n    float diamond = max(abs(x), abs(y)) - size / (2.0 * SQRT_2);\n    diamond /= SQRT_2;\n    float c1 = max(diamond, s1);\n    float c2 = max(diamond, s2);\n    float c3 = max(diamond, s3);\n    float c4 = max(diamond, s4);\n    // Union\n    return min(min(min(c1, c2), c3), c4);\n}\n#endif\n\n#ifdef USE_X\n// x\nfloat marker(vec2 P, float size)\n{\n    float circle = length(P) - size / 1.6;\n    float X = min(abs(P.x - P.y), abs(P.x + P.y)) - size / 100.0;  // bit of "width" for aa\n    return max(circle, X);\n}\n#endif\n\n#ifdef USE_CIRCLE_X\n// circle_x\nfloat marker(vec2 P, float size)\n{\n    float x = P.x - P.y;\n    float y = P.x + P.y;\n    // Define quadrants\n    float qs = size / 2.0;  // quadrant size\n    float s1 = max(abs(x - qs), abs(y - qs)) - qs;\n    float s2 = max(abs(x + qs), abs(y - qs)) - qs;\n    float s3 = max(abs(x - qs), abs(y + qs)) - qs;\n    float s4 = max(abs(x + qs), abs(y + qs)) - qs;\n    // Intersect main shape with quadrants (to form cross)\n    float circle = length(P) - size/2.0;\n    float c1 = max(circle, s1);\n    float c2 = max(circle, s2);\n    float c3 = max(circle, s3);\n    float c4 = max(circle, s4);\n    // Union\n    float almost = min(min(min(c1, c2), c3), c4);\n    // In this case, the X is also outside of the main shape\n    float Xmask = length(P) - size / 1.6;  // a circle\n    float X = min(abs(P.x - P.y), abs(P.x + P.y)) - size / 100.0;  // bit of "width" for aa\n    return min(max(X, Xmask), almost);\n}\n#endif\n\n#ifdef USE_SQUARE_X\n// square_x\nfloat marker(vec2 P, float size)\n{\n    float x = P.x - P.y;\n    float y = P.x + P.y;\n    // Define quadrants\n    float qs = size / 2.0;  // quadrant size\n    float s1 = max(abs(x - qs), abs(y - qs)) - qs;\n    float s2 = max(abs(x + qs), abs(y - qs)) - qs;\n    float s3 = max(abs(x - qs), abs(y + qs)) - qs;\n    float s4 = max(abs(x + qs), abs(y + qs)) - qs;\n    // Intersect main shape with quadrants (to form cross)\n    float square = max(abs(P.x), abs(P.y)) - size/2.0;\n    float c1 = max(square, s1);\n    float c2 = max(square, s2);\n    float c3 = max(square, s3);\n    float c4 = max(square, s4);\n    // Union\n    return min(min(min(c1, c2), c3), c4);\n}\n#endif\n\nvec4 outline(float distance, float linewidth, float antialias, vec4 fg_color, vec4 bg_color)\n{\n    vec4 frag_color;\n    float t = linewidth/2.0 - antialias;\n    float signed_distance = distance;\n    float border_distance = abs(signed_distance) - t;\n    float alpha = border_distance/antialias;\n    alpha = exp(-alpha*alpha);\n\n    // If fg alpha is zero, it probably means no outline. To avoid a dark outline\n    // shining through due to aa, we set the fg color to the bg color. Avoid if (i.e. branching).\n    float select = float(bool(fg_color.a));\n    fg_color.rgb = select * fg_color.rgb + (1.0  - select) * bg_color.rgb;\n    // Similarly, if we want a transparent bg\n    select = float(bool(bg_color.a));\n    bg_color.rgb = select * bg_color.rgb + (1.0  - select) * fg_color.rgb;\n\n    if( border_distance < 0.0)\n        frag_color = fg_color;\n    else if( signed_distance < 0.0 ) {\n        frag_color = mix(bg_color, fg_color, sqrt(alpha));\n    } else {\n        if( abs(signed_distance) < (linewidth/2.0 + antialias) ) {\n            frag_color = vec4(fg_color.rgb, fg_color.a * alpha);\n        } else {\n            discard;\n        }\n    }\n    return frag_color;\n}\n\nvoid main()\n{\n    vec2 P = gl_PointCoord.xy - vec2(0.5, 0.5);\n    P = vec2(v_rotation.x*P.x - v_rotation.y*P.y,\n             v_rotation.y*P.x + v_rotation.x*P.y);\n    float point_size = SQRT_2*v_size  + 2.0 * (v_linewidth + 1.5*u_antialias);\n    float distance = marker(P*point_size, v_size);\n    gl_FragColor = outline(distance, v_linewidth, u_antialias, v_fg_color, v_bg_color);\n}\n'},function(t,e,i,s,n){s();const o=t(287);class r extends o.EllipseOvalView{}i.EllipseView=r,r.__name__="EllipseView";class a extends o.EllipseOval{constructor(t){super(t)}static init_Ellipse(){this.prototype.default_view=r}}i.Ellipse=a,a.__name__="Ellipse",a.init_Ellipse()},function(t,e,i,s,n){s();const o=t(1),r=t(288),a=o.__importStar(t(107)),l=t(24),c=t(59);class h extends r.CenterRotatableView{_map_data(){"data"==this.model.properties.width.units?this.sw=this.sdist(this.renderer.xscale,this._x,this.width,"center"):this.sw=l.to_screen(this.width),"data"==this.model.properties.height.units?this.sh=this.sdist(this.renderer.yscale,this._y,this.height,"center"):this.sh=l.to_screen(this.height)}_render(t,e,i){const{sx:s,sy:n,sw:o,sh:r,angle:a}=null!=i?i:this;for(const l of e){const e=s[l],i=n[l],c=o[l],h=r[l],_=a.get(l);isNaN(e+i+c+h+_)||(t.beginPath(),t.ellipse(e,i,c/2,h/2,_,0,2*Math.PI),this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,l),t.fill()),this.visuals.hatch.doit&&(this.visuals.hatch.set_vectorize(t,l),t.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,l),t.stroke()))}}_hit_point(t){let e,i,s,n,o,r,l,h,_;const{sx:d,sy:u}=t,p=this.renderer.xscale.invert(d),m=this.renderer.yscale.invert(u);"data"==this.model.properties.width.units?(e=p-this.max_width,i=p+this.max_width):(r=d-this.max_width,l=d+this.max_width,[e,i]=this.renderer.xscale.r_invert(r,l)),"data"==this.model.properties.height.units?(s=m-this.max_height,n=m+this.max_height):(h=u-this.max_height,_=u+this.max_height,[s,n]=this.renderer.yscale.r_invert(h,_));const g=this.index.indices({x0:e,x1:i,y0:s,y1:n}),f=[];for(const c of g)o=a.point_in_ellipse(d,u,this.angle.get(c),this.sh[c]/2,this.sw[c]/2,this.sx[c],this.sy[c]),o&&f.push(c);return new c.Selection({indices:f})}draw_legend_for_index(t,{x0:e,y0:i,x1:s,y1:n},o){const r=o+1,a=new Array(r);a[o]=(e+s)/2;const l=new Array(r);l[o]=(i+n)/2;const c=this.sw[o]/this.sh[o],h=.8*Math.min(Math.abs(s-e),Math.abs(n-i)),_=new Array(r),d=new Array(r);c>1?(_[o]=h,d[o]=h/c):(_[o]=h*c,d[o]=h),this._render(t,[o],{sx:a,sy:l,sw:_,sh:d,_angle:[0]})}}i.EllipseOvalView=h,h.__name__="EllipseOvalView";class _ extends r.CenterRotatable{constructor(t){super(t)}}i.EllipseOval=_,_.__name__="EllipseOval"},function(t,e,i,s,n){s();const o=t(1),r=t(64),a=t(48),l=o.__importStar(t(18));class c extends r.XYGlyphView{get max_w2(){return"data"==this.model.properties.width.units?this.max_width/2:0}get max_h2(){return"data"==this.model.properties.height.units?this.max_height/2:0}_bounds({x0:t,x1:e,y0:i,y1:s}){const{max_w2:n,max_h2:o}=this;return{x0:t-n,x1:e+n,y0:i-o,y1:s+o}}}i.CenterRotatableView=c,c.__name__="CenterRotatableView";class h extends r.XYGlyph{constructor(t){super(t)}static init_CenterRotatable(){this.mixins([a.LineVector,a.FillVector,a.HatchVector]),this.define((({})=>({angle:[l.AngleSpec,0],width:[l.DistanceSpec,{field:"width"}],height:[l.DistanceSpec,{field:"height"}]})))}}i.CenterRotatable=h,h.__name__="CenterRotatable",h.init_CenterRotatable()},function(t,e,i,s,n){s();const o=t(1),r=t(290),a=t(24),l=o.__importStar(t(18));class c extends r.BoxView{scenterxy(t){return[(this.sleft[t]+this.sright[t])/2,this.sy[t]]}_lrtb(t){const e=this._left[t],i=this._right[t],s=this._y[t],n=this.height.get(t)/2;return[Math.min(e,i),Math.max(e,i),s+n,s-n]}_map_data(){this.sy=this.renderer.yscale.v_compute(this._y),this.sh=this.sdist(this.renderer.yscale,this._y,this.height,"center"),this.sleft=this.renderer.xscale.v_compute(this._left),this.sright=this.renderer.xscale.v_compute(this._right);const t=this.sy.length;this.stop=new a.ScreenArray(t),this.sbottom=new a.ScreenArray(t);for(let e=0;e<t;e++)this.stop[e]=this.sy[e]-this.sh[e]/2,this.sbottom[e]=this.sy[e]+this.sh[e]/2;this._clamp_viewport()}}i.HBarView=c,c.__name__="HBarView";class h extends r.Box{constructor(t){super(t)}static init_HBar(){this.prototype.default_view=c,this.define((({})=>({left:[l.XCoordinateSpec,{value:0}],y:[l.YCoordinateSpec,{field:"y"}],height:[l.NumberSpec,{value:1}],right:[l.XCoordinateSpec,{field:"right"}]})))}}i.HBar=h,h.__name__="HBar",h.init_HBar()},function(t,e,i,s,n){s();const o=t(48),r=t(98),a=t(106),l=t(59);class c extends r.GlyphView{get_anchor_point(t,e,i){const s=Math.min(this.sleft[e],this.sright[e]),n=Math.max(this.sright[e],this.sleft[e]),o=Math.min(this.stop[e],this.sbottom[e]),r=Math.max(this.sbottom[e],this.stop[e]);switch(t){case"top_left":return{x:s,y:o};case"top":case"top_center":return{x:(s+n)/2,y:o};case"top_right":return{x:n,y:o};case"bottom_left":return{x:s,y:r};case"bottom":case"bottom_center":return{x:(s+n)/2,y:r};case"bottom_right":return{x:n,y:r};case"left":case"center_left":return{x:s,y:(o+r)/2};case"center":case"center_center":return{x:(s+n)/2,y:(o+r)/2};case"right":case"center_right":return{x:n,y:(o+r)/2}}}_index_data(t){const{min:e,max:i}=Math,{data_size:s}=this;for(let n=0;n<s;n++){const[s,o,r,a]=this._lrtb(n);isNaN(s+o+r+a)||!isFinite(s+o+r+a)?t.add_empty():t.add(e(s,o),e(r,a),i(o,s),i(r,a))}}_render(t,e,i){const{sleft:s,sright:n,stop:o,sbottom:r}=null!=i?i:this;for(const l of e){const e=s[l],i=o[l],c=n[l],h=r[l];function a(){t.beginPath(),t.rect(e,i,c-e,h-i)}isNaN(e+i+c+h)||(this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,l),a(),t.fill()),this.visuals.hatch.doit&&(this.visuals.hatch.set_vectorize(t,l),a(),t.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,l),a(),t.stroke()))}}_clamp_viewport(){const t=this.renderer.plot_view.frame.bbox.h_range,e=this.renderer.plot_view.frame.bbox.v_range,i=this.stop.length;for(let s=0;s<i;s++)this.stop[s]=Math.max(this.stop[s],e.start),this.sbottom[s]=Math.min(this.sbottom[s],e.end),this.sleft[s]=Math.max(this.sleft[s],t.start),this.sright[s]=Math.min(this.sright[s],t.end)}_hit_rect(t){return this._hit_rect_against_index(t)}_hit_point(t){const{sx:e,sy:i}=t,s=this.renderer.xscale.invert(e),n=this.renderer.yscale.invert(i),o=[...this.index.indices({x0:s,y0:n,x1:s,y1:n})];return new l.Selection({indices:o})}_hit_span(t){const{sx:e,sy:i}=t;let s;if("v"==t.direction){const t=this.renderer.yscale.invert(i),e=this.renderer.plot_view.frame.bbox.h_range,[n,o]=this.renderer.xscale.r_invert(e.start,e.end);s=[...this.index.indices({x0:n,y0:t,x1:o,y1:t})]}else{const t=this.renderer.xscale.invert(e),i=this.renderer.plot_view.frame.bbox.v_range,[n,o]=this.renderer.yscale.r_invert(i.start,i.end);s=[...this.index.indices({x0:t,y0:n,x1:t,y1:o})]}return new l.Selection({indices:s})}draw_legend_for_index(t,e,i){a.generic_area_vector_legend(this.visuals,t,e,i)}}i.BoxView=c,c.__name__="BoxView";class h extends r.Glyph{constructor(t){super(t)}static init_Box(){this.mixins([o.LineVector,o.FillVector,o.HatchVector])}}i.Box=h,h.__name__="Box",h.init_Box()},function(t,e,i,s,n){s();const o=t(1),r=t(98),a=o.__importStar(t(107)),l=o.__importStar(t(18)),c=t(48),h=t(20),_=t(65),d=t(106),u=t(59);class p extends r.GlyphView{scenterxy(t){return[this.sx[t],this.sy[t]]}_set_data(){const{orientation:t,size:e,aspect_scale:i}=this.model,{q:s,r:n}=this,o=this.q.length;this._x=new Float64Array(o),this._y=new Float64Array(o);const{_x:r,_y:a}=this,l=Math.sqrt(3);if("pointytop"==t)for(let c=0;c<o;c++){const t=s.get(c),o=n.get(c)/2;r[c]=e*l*(t+o)/i,a[c]=-3*e*o}else for(let c=0;c<o;c++){const t=s.get(c)/2,o=n.get(c);r[c]=3*e*t,a[c]=-e*l*(o+t)*i}}_project_data(){_.inplace.project_xy(this._x,this._y)}_index_data(t){let e=this.model.size,i=Math.sqrt(3)*e/2;"flattop"==this.model.orientation?([i,e]=[e,i],e*=this.model.aspect_scale):i/=this.model.aspect_scale;const{data_size:s}=this;for(let n=0;n<s;n++){const s=this._x[n],o=this._y[n];isNaN(s+o)||!isFinite(s+o)?t.add_empty():t.add(s-i,o-e,s+i,o+e)}}map_data(){[this.sx,this.sy]=this.renderer.coordinates.map_to_screen(this._x,this._y),[this.svx,this.svy]=this._get_unscaled_vertices()}_get_unscaled_vertices(){const t=this.model.size,e=this.model.aspect_scale;if("pointytop"==this.model.orientation){const i=this.renderer.yscale,s=this.renderer.xscale,n=Math.abs(i.compute(0)-i.compute(t)),o=Math.sqrt(3)/2*Math.abs(s.compute(0)-s.compute(t))/e,r=n/2;return[[0,-o,-o,0,o,o],[n,r,-r,-n,-r,r]]}{const i=this.renderer.xscale,s=this.renderer.yscale,n=Math.abs(i.compute(0)-i.compute(t)),o=Math.sqrt(3)/2*Math.abs(s.compute(0)-s.compute(t))*e,r=n/2;return[[n,r,-r,-n,-r,r],[0,-o,-o,0,o,o]]}}_render(t,e,i){const{sx:s,sy:n,svx:o,svy:r,scale:a}=null!=i?i:this;for(const l of e){const e=s[l],i=n[l],c=a.get(l);if(!isNaN(e+i+c)){t.translate(e,i),t.beginPath();for(let e=0;e<6;e++)t.lineTo(o[e]*c,r[e]*c);t.closePath(),t.translate(-e,-i),this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,l),t.fill()),this.visuals.hatch.doit&&(this.visuals.hatch.set_vectorize(t,l),t.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,l),t.stroke())}}}_hit_point(t){const{sx:e,sy:i}=t,s=this.renderer.xscale.invert(e),n=this.renderer.yscale.invert(i),o=this.index.indices({x0:s,y0:n,x1:s,y1:n}),r=[];for(const l of o)a.point_in_poly(e-this.sx[l],i-this.sy[l],this.svx,this.svy)&&r.push(l);return new u.Selection({indices:r})}_hit_span(t){const{sx:e,sy:i}=t;let s;if("v"==t.direction){const t=this.renderer.yscale.invert(i),e=this.renderer.plot_view.frame.bbox.h_range,[n,o]=this.renderer.xscale.r_invert(e.start,e.end);s=[...this.index.indices({x0:n,y0:t,x1:o,y1:t})]}else{const t=this.renderer.xscale.invert(e),i=this.renderer.plot_view.frame.bbox.v_range,[n,o]=this.renderer.yscale.r_invert(i.start,i.end);s=[...this.index.indices({x0:t,y0:n,x1:t,y1:o})]}return new u.Selection({indices:s})}_hit_rect(t){const{sx0:e,sx1:i,sy0:s,sy1:n}=t,[o,r]=this.renderer.xscale.r_invert(e,i),[a,l]=this.renderer.yscale.r_invert(s,n),c=[...this.index.indices({x0:o,x1:r,y0:a,y1:l})];return new u.Selection({indices:c})}draw_legend_for_index(t,e,i){d.generic_area_vector_legend(this.visuals,t,e,i)}}i.HexTileView=p,p.__name__="HexTileView";class m extends r.Glyph{constructor(t){super(t)}static init_HexTile(){this.prototype.default_view=p,this.mixins([c.LineVector,c.FillVector,c.HatchVector]),this.define((({Number:t})=>({r:[l.NumberSpec,{field:"r"}],q:[l.NumberSpec,{field:"q"}],scale:[l.NumberSpec,1],size:[t,1],aspect_scale:[t,1],orientation:[h.HexTileOrientation,"pointytop"]}))),this.override({line_color:null})}}i.HexTile=m,m.__name__="HexTile",m.init_HexTile()},function(t,e,i,s,n){s();const o=t(293),r=t(203),a=t(214);class l extends o.ImageBaseView{connect_signals(){super.connect_signals(),this.connect(this.model.color_mapper.change,(()=>this._update_image()))}_update_image(){null!=this.image_data&&(this._set_data(null),this.renderer.request_render())}_flat_img_to_buf8(t){return this.model.color_mapper.rgba_mapper.v_compute(t)}}i.ImageView=l,l.__name__="ImageView";class c extends o.ImageBase{constructor(t){super(t)}static init_Image(){this.prototype.default_view=l,this.define((({Ref:t})=>({color_mapper:[t(r.ColorMapper),()=>new a.LinearColorMapper({palette:["#000000","#252525","#525252","#737373","#969696","#bdbdbd","#d9d9d9","#f0f0f0","#ffffff"]})]})))}}i.Image=c,c.__name__="Image",c.init_Image()},function(t,e,i,s,n){s();const o=t(1),r=t(64),a=t(24),l=o.__importStar(t(18)),c=t(59),h=t(9),_=t(29),d=t(11);class u extends r.XYGlyphView{connect_signals(){super.connect_signals(),this.connect(this.model.properties.global_alpha.change,(()=>this.renderer.request_render()))}_render(t,e,i){const{image_data:s,sx:n,sy:o,sw:r,sh:a}=null!=i?i:this,l=t.getImageSmoothingEnabled();t.setImageSmoothingEnabled(!1),t.globalAlpha=this.model.global_alpha;for(const c of e){const e=s[c],i=n[c],l=o[c],h=r[c],_=a[c];if(null==e||isNaN(i+l+h+_))continue;const d=l;t.translate(0,d),t.scale(1,-1),t.translate(0,-d),t.drawImage(e,0|i,0|l,h,_),t.translate(0,d),t.scale(1,-1),t.translate(0,-d)}t.setImageSmoothingEnabled(l)}_set_data(t){this._set_width_heigh_data();for(let e=0,i=this.image.length;e<i;e++){if(null!=t&&t.indexOf(e)<0)continue;const i=this.image.get(e);let s;_.is_NDArray(i)?(d.assert(2==i.dimension,"expected a 2D array"),s=i,this._height[e]=i.shape[0],this._width[e]=i.shape[1]):(s=h.concat(i),this._height[e]=i.length,this._width[e]=i[0].length);const n=this._flat_img_to_buf8(s);this._set_image_data_from_buffer(e,n)}}_index_data(t){const{data_size:e}=this;for(let i=0;i<e;i++){const[e,s,n,o]=this._lrtb(i);isNaN(e+s+n+o)||!isFinite(e+s+n+o)?t.add_empty():t.add(e,o,s,n)}}_lrtb(t){const e=this.dw.get(t),i=this.dh.get(t),s=this.renderer.xscale.source_range,n=this._x[t],o=s.is_reversed?n-e:n+e,r=this.renderer.yscale.source_range,a=this._y[t],l=r.is_reversed?a-i:a+i,[c,h]=n<o?[n,o]:[o,n],[_,d]=a<l?[a,l]:[l,a];return[c,h,d,_]}_set_width_heigh_data(){null!=this.image_data&&this.image_data.length==this.image.length||(this.image_data=new Array(this.image.length)),null!=this._width&&this._width.length==this.image.length||(this._width=new Uint32Array(this.image.length)),null!=this._height&&this._height.length==this.image.length||(this._height=new Uint32Array(this.image.length))}_get_or_create_canvas(t){const e=this.image_data[t];if(null!=e&&e.width==this._width[t]&&e.height==this._height[t])return e;{const e=document.createElement("canvas");return e.width=this._width[t],e.height=this._height[t],e}}_set_image_data_from_buffer(t,e){const i=this._get_or_create_canvas(t),s=i.getContext("2d"),n=s.getImageData(0,0,this._width[t],this._height[t]);n.data.set(e),s.putImageData(n,0,0),this.image_data[t]=i}_map_data(){"data"==this.model.properties.dw.units?this.sw=this.sdist(this.renderer.xscale,this._x,this.dw,"edge",this.model.dilate):this.sw=a.to_screen(this.dw),"data"==this.model.properties.dh.units?this.sh=this.sdist(this.renderer.yscale,this._y,this.dh,"edge",this.model.dilate):this.sh=a.to_screen(this.dh)}_image_index(t,e,i){const[s,n,o,r]=this._lrtb(t),a=this._width[t],l=this._height[t],c=(n-s)/a,h=(o-r)/l;let _=Math.floor((e-s)/c),d=Math.floor((i-r)/h);return this.renderer.xscale.source_range.is_reversed&&(_=a-_-1),this.renderer.yscale.source_range.is_reversed&&(d=l-d-1),{index:t,dim1:_,dim2:d,flat_index:d*a+_}}_hit_point(t){const{sx:e,sy:i}=t,s=this.renderer.xscale.invert(e),n=this.renderer.yscale.invert(i),o=this.index.indices({x0:s,x1:s,y0:n,y1:n}),r=new c.Selection;for(const a of o)e!=1/0&&i!=1/0&&r.image_indices.push(this._image_index(a,s,n));return r}}i.ImageBaseView=u,u.__name__="ImageBaseView";class p extends r.XYGlyph{constructor(t){super(t)}static init_ImageBase(){this.define((({Boolean:t,Alpha:e})=>({image:[l.NDArraySpec,{field:"image"}],dw:[l.DistanceSpec,{field:"dw"}],dh:[l.DistanceSpec,{field:"dh"}],dilate:[t,!1],global_alpha:[e,1]})))}}i.ImageBase=p,p.__name__="ImageBase",p.init_ImageBase()},function(t,e,i,s,n){s();const o=t(293),r=t(8);class a extends o.ImageBaseView{_flat_img_to_buf8(t){let e;return e=r.isArray(t)?new Uint32Array(t):t,new Uint8ClampedArray(e.buffer)}}i.ImageRGBAView=a,a.__name__="ImageRGBAView";class l extends o.ImageBase{constructor(t){super(t)}static init_ImageRGBA(){this.prototype.default_view=a}}i.ImageRGBA=l,l.__name__="ImageRGBA",l.init_ImageRGBA()},function(t,e,i,s,n){s();const o=t(1),r=t(64),a=t(24),l=t(20),c=o.__importStar(t(18)),h=t(12),_=t(296);class d extends r.XYGlyphView{constructor(){super(...arguments),this._images_rendered=!1,this._set_data_iteration=0}connect_signals(){super.connect_signals(),this.connect(this.model.properties.global_alpha.change,(()=>this.renderer.request_render()))}_index_data(t){const{data_size:e}=this;for(let i=0;i<e;i++)t.add_empty()}_set_data(){this._set_data_iteration++;const t=this.url.length;this.image=new Array(t);const{retry_attempts:e,retry_timeout:i}=this.model,{_set_data_iteration:s}=this;for(let a=0;a<t;a++){const t=this.url.get(a);t&&new _.ImageLoader(t,{loaded:t=>{this._set_data_iteration==s&&(this.image[a]=t,this.renderer.request_render())},attempts:e+1,timeout:i})}const n="data"==this.model.properties.w.units,o="data"==this.model.properties.h.units,r=this._x.length,l=new a.ScreenArray(n?2*r:r),c=new a.ScreenArray(o?2*r:r),{anchor:d}=this.model;function u(t,e){switch(d){case"top_left":case"bottom_left":case"left":case"center_left":return[t,t+e];case"top":case"top_center":case"bottom":case"bottom_center":case"center":case"center_center":return[t-e/2,t+e/2];case"top_right":case"bottom_right":case"right":case"center_right":return[t-e,t]}}function p(t,e){switch(d){case"top_left":case"top":case"top_center":case"top_right":return[t,t-e];case"bottom_left":case"bottom":case"bottom_center":case"bottom_right":return[t+e,t];case"left":case"center_left":case"center":case"center_center":case"right":case"center_right":return[t+e/2,t-e/2]}}if(n)for(let a=0;a<r;a++)[l[a],l[r+a]]=u(this._x[a],this.w.get(a));else l.set(this._x,0);if(o)for(let a=0;a<r;a++)[c[a],c[r+a]]=p(this._y[a],this.h.get(a));else c.set(this._y,0);const[m,g]=h.minmax(l),[f,b]=h.minmax(c);this._bounds_rect={x0:m,x1:g,y0:f,y1:b}}has_finished(){return super.has_finished()&&1==this._images_rendered}_map_data(){"data"==this.model.properties.w.units?this.sw=this.sdist(this.renderer.xscale,this._x,this.w,"edge",this.model.dilate):this.sw=a.to_screen(this.w),"data"==this.model.properties.h.units?this.sh=this.sdist(this.renderer.yscale,this._y,this.h,"edge",this.model.dilate):this.sh=a.to_screen(this.h)}_render(t,e,i){const{image:s,sx:n,sy:o,sw:r,sh:a,angle:l}=null!=i?i:this,{frame:c}=this.renderer.plot_view;t.rect(c.bbox.left+1,c.bbox.top+1,c.bbox.width-2,c.bbox.height-2),t.clip();let h=!0;for(const _ of e){if(isNaN(n[_]+o[_]+l.get(_)))continue;const e=s[_];null!=e?this._render_image(t,_,e,n,o,r,a,l):h=!1}h&&!this._images_rendered&&(this._images_rendered=!0,this.notify_finished())}_final_sx_sy(t,e,i,s,n){switch(t){case"top_left":return[e,i];case"top":case"top_center":return[e-s/2,i];case"top_right":return[e-s,i];case"right":case"center_right":return[e-s,i-n/2];case"bottom_right":return[e-s,i-n];case"bottom":case"bottom_center":return[e-s/2,i-n];case"bottom_left":return[e,i-n];case"left":case"center_left":return[e,i-n/2];case"center":case"center_center":return[e-s/2,i-n/2]}}_render_image(t,e,i,s,n,o,r,a){isNaN(o[e])&&(o[e]=i.width),isNaN(r[e])&&(r[e]=i.height);const l=o[e],c=r[e],{anchor:h}=this.model,[_,d]=this._final_sx_sy(h,s[e],n[e],l,c),u=a.get(e);t.save(),t.globalAlpha=this.model.global_alpha;const p=l/2,m=c/2;u?(t.translate(_,d),t.translate(p,m),t.rotate(u),t.translate(-p,-m),t.drawImage(i,0,0,l,c),t.translate(p,m),t.rotate(-u),t.translate(-p,-m),t.translate(-_,-d)):t.drawImage(i,_,d,l,c),t.restore()}bounds(){return this._bounds_rect}}i.ImageURLView=d,d.__name__="ImageURLView";class u extends r.XYGlyph{constructor(t){super(t)}static init_ImageURL(){this.prototype.default_view=d,this.define((({Boolean:t,Int:e,Alpha:i})=>({url:[c.StringSpec,{field:"url"}],anchor:[l.Anchor,"top_left"],global_alpha:[i,1],angle:[c.AngleSpec,0],w:[c.NullDistanceSpec,null],h:[c.NullDistanceSpec,null],dilate:[t,!1],retry_attempts:[e,0],retry_timeout:[e,0]})))}}i.ImageURL=u,u.__name__="ImageURL",u.init_ImageURL()},function(t,e,i,s,n){s();const o=t(19);class r{constructor(t,e={}){this._image=new Image,this._finished=!1;const{attempts:i=1,timeout:s=1}=e;this.promise=new Promise(((n,r)=>{this._image.crossOrigin="anonymous";let a=0;this._image.onerror=()=>{if(++a==i){const s=`unable to load ${t} image after ${i} attempts`;if(o.logger.warn(s),null==this._image.crossOrigin)return void(null!=e.failed&&e.failed());o.logger.warn(`attempting to load ${t} without a cross origin policy`),this._image.crossOrigin=null,a=0}setTimeout((()=>this._image.src=t),s)},this._image.onload=()=>{this._finished=!0,null!=e.loaded&&e.loaded(this._image),n(this._image)},this._image.src=t}))}get finished(){return this._finished}get image(){if(this._finished)return this._image;throw new Error("not loaded yet")}}i.ImageLoader=r,r.__name__="ImageLoader"},function(t,e,i,s,n){s();const o=t(1),r=t(101),a=t(98),l=t(106),c=t(12),h=t(12),_=t(48),d=o.__importStar(t(107)),u=o.__importStar(t(18)),p=t(59),m=t(11);class g extends a.GlyphView{_project_data(){}_index_data(t){const{min:e,max:i}=Math,{data_size:s}=this;for(let n=0;n<s;n++){const s=this._xs[n],o=this._ys[n];if(0==s.length||0==o.length){t.add_empty();continue}let r=1/0,a=-1/0,l=1/0,h=-1/0;for(let t=0,n=s.length;t<n;t++){const n=s[t][0],_=o[t][0];if(0!=n.length&&0!=_.length){const[t,s]=c.minmax(n),[o,d]=c.minmax(_);r=e(r,t),a=i(a,s),l=e(l,o),h=i(h,d)}}isFinite(r+a+l+h)?t.add(r,l,a,h):t.add_empty()}this._hole_index=this._index_hole_data()}_index_hole_data(){const{min:t,max:e}=Math,{data_size:i}=this,s=new r.SpatialIndex(i);for(let n=0;n<i;n++){const i=this._xs[n],o=this._ys[n];if(0==i.length||0==o.length){s.add_empty();continue}let r=1/0,a=-1/0,l=1/0,h=-1/0;for(let s=0,n=i.length;s<n;s++){const n=i[s],_=o[s];if(n.length>1&&_.length>1)for(let i=1,s=n.length;i<s;i++){const[s,o]=c.minmax(n[i]),[d,u]=c.minmax(_[i]);r=t(r,s),a=e(a,o),l=t(l,d),h=e(h,u)}}isFinite(r+a+l+h)?s.add(r,l,a,h):s.add_empty()}return s.finish(),s}_mask_data(){const{x_range:t,y_range:e}=this.renderer.plot_view.frame;return this.index.indices({x0:t.min,x1:t.max,y0:e.min,y1:e.max})}_inner_loop(t,e,i){t.beginPath();for(let s=0,n=e.length;s<n;s++)for(let o=0,r=e[s].length;o<r;o++){const n=e[s][o],r=i[s][o];for(let e=0,i=n.length;e<i;e++)0!=e?t.lineTo(n[e],r[e]):t.moveTo(n[e],r[e]);t.closePath()}}_render(t,e,i){if(this.visuals.fill.doit||this.visuals.line.doit){const{sxs:s,sys:n}=null!=i?i:this;for(const i of e){const e=s[i],o=n[i];this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,i),this._inner_loop(t,e,o),t.fill("evenodd")),this.visuals.hatch.doit&&(this.visuals.hatch.set_vectorize(t,i),this._inner_loop(t,e,o),t.fill("evenodd")),this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,i),this._inner_loop(t,e,o),t.stroke())}}}_hit_rect(t){const{sx0:e,sx1:i,sy0:s,sy1:n}=t,o=[e,i,i,e],r=[s,s,n,n],[a,l]=this.renderer.xscale.r_invert(e,i),[c,h]=this.renderer.yscale.r_invert(s,n),_=this.index.indices({x0:a,x1:l,y0:c,y1:h}),u=[];for(const p of _){const t=this.sxs[p],e=this.sys[p];let i=!0;for(let s=0,n=t.length;s<n;s++){for(let n=0,a=t[s][0].length;n<a;n++){const a=t[s][0][n],l=e[s][0][n];if(!d.point_in_poly(a,l,o,r)){i=!1;break}}if(!i)break}i&&u.push(p)}return new p.Selection({indices:u})}_hit_point(t){const{sx:e,sy:i}=t,s=this.renderer.xscale.invert(e),n=this.renderer.yscale.invert(i),o=this.index.indices({x0:s,y0:n,x1:s,y1:n}),r=this._hole_index.indices({x0:s,y0:n,x1:s,y1:n}),a=[];for(const l of o){const t=this.sxs[l],s=this.sys[l];for(let n=0,o=t.length;n<o;n++){const o=t[n].length;if(d.point_in_poly(e,i,t[n][0],s[n][0]))if(1==o)a.push(l);else if(r.get(l)){if(o>1){let r=!1;for(let a=1;a<o;a++){const o=t[n][a],l=s[n][a];if(d.point_in_poly(e,i,o,l)){r=!0;break}}r||a.push(l)}}else a.push(l)}}return new p.Selection({indices:a})}_get_snap_coord(t){return h.sum(t)/t.length}scenterxy(t,e,i){if(1==this.sxs[t].length)return[this._get_snap_coord(this.sxs[t][0][0]),this._get_snap_coord(this.sys[t][0][0])];{const s=this.sxs[t],n=this.sys[t];for(let t=0,o=s.length;t<o;t++)if(d.point_in_poly(e,i,s[t][0],n[t][0]))return[this._get_snap_coord(s[t][0]),this._get_snap_coord(n[t][0])]}m.unreachable()}map_data(){const t=this._xs.length;this.sxs=new Array(t),this.sys=new Array(t);for(let e=0;e<t;e++){const t=this._xs[e].length;this.sxs[e]=new Array(t),this.sys[e]=new Array(t);for(let i=0;i<t;i++){const t=this._xs[e][i].length;this.sxs[e][i]=new Array(t),this.sys[e][i]=new Array(t);for(let s=0;s<t;s++){const[t,n]=this.renderer.coordinates.map_to_screen(this._xs[e][i][s],this._ys[e][i][s]);this.sxs[e][i][s]=t,this.sys[e][i][s]=n}}}}draw_legend_for_index(t,e,i){l.generic_area_vector_legend(this.visuals,t,e,i)}}i.MultiPolygonsView=g,g.__name__="MultiPolygonsView";class f extends a.Glyph{constructor(t){super(t)}static init_MultiPolygons(){this.prototype.default_view=g,this.define((({})=>({xs:[u.XCoordinateSeqSeqSeqSpec,{field:"xs"}],ys:[u.YCoordinateSeqSeqSeqSpec,{field:"ys"}]}))),this.mixins([_.LineVector,_.FillVector,_.HatchVector])}}i.MultiPolygons=f,f.__name__="MultiPolygons",f.init_MultiPolygons()},function(t,e,i,s,n){s();const o=t(287),r=t(12);class a extends o.EllipseOvalView{_map_data(){super._map_data(),r.mul(this.sw,.75)}}i.OvalView=a,a.__name__="OvalView";class l extends o.EllipseOval{constructor(t){super(t)}static init_Oval(){this.prototype.default_view=a}}i.Oval=l,l.__name__="Oval",l.init_Oval()},function(t,e,i,s,n){s();const o=t(1),r=t(290),a=o.__importStar(t(18));class l extends r.BoxView{scenterxy(t){return[this.sleft[t]/2+this.sright[t]/2,this.stop[t]/2+this.sbottom[t]/2]}_lrtb(t){return[this._left[t],this._right[t],this._top[t],this._bottom[t]]}}i.QuadView=l,l.__name__="QuadView";class c extends r.Box{constructor(t){super(t)}static init_Quad(){this.prototype.default_view=l,this.define((({})=>({right:[a.XCoordinateSpec,{field:"right"}],bottom:[a.YCoordinateSpec,{field:"bottom"}],left:[a.XCoordinateSpec,{field:"left"}],top:[a.YCoordinateSpec,{field:"top"}]})))}}i.Quad=c,c.__name__="Quad",c.init_Quad()},function(t,e,i,s,n){s();const o=t(1),r=t(48),a=t(65),l=t(98),c=t(106),h=o.__importStar(t(18));function _(t,e,i){if(e==(t+i)/2)return[t,i];{const s=(t-e)/(t-2*e+i),n=t*(1-s)**2+2*e*(1-s)*s+i*s**2;return[Math.min(t,i,n),Math.max(t,i,n)]}}class d extends l.GlyphView{_project_data(){a.inplace.project_xy(this._x0,this._y0),a.inplace.project_xy(this._x1,this._y1)}_index_data(t){const{_x0:e,_x1:i,_y0:s,_y1:n,_cx:o,_cy:r,data_size:a}=this;for(let l=0;l<a;l++){const a=e[l],c=i[l],h=s[l],d=n[l],u=o[l],p=r[l];if(isNaN(a+c+h+d+u+p))t.add_empty();else{const[e,i]=_(a,u,c),[s,n]=_(h,p,d);t.add(e,s,i,n)}}}_render(t,e,i){if(this.visuals.line.doit){const{sx0:s,sy0:n,sx1:o,sy1:r,scx:a,scy:l}=null!=i?i:this;for(const i of e){const e=s[i],c=n[i],h=o[i],_=r[i],d=a[i],u=l[i];isNaN(e+c+h+_+d+u)||(t.beginPath(),t.moveTo(e,c),t.quadraticCurveTo(d,u,h,_),this.visuals.line.set_vectorize(t,i),t.stroke())}}}draw_legend_for_index(t,e,i){c.generic_line_vector_legend(this.visuals,t,e,i)}scenterxy(){throw new Error(`${this}.scenterxy() is not implemented`)}}i.QuadraticView=d,d.__name__="QuadraticView";class u extends l.Glyph{constructor(t){super(t)}static init_Quadratic(){this.prototype.default_view=d,this.define((({})=>({x0:[h.XCoordinateSpec,{field:"x0"}],y0:[h.YCoordinateSpec,{field:"y0"}],x1:[h.XCoordinateSpec,{field:"x1"}],y1:[h.YCoordinateSpec,{field:"y1"}],cx:[h.XCoordinateSpec,{field:"cx"}],cy:[h.YCoordinateSpec,{field:"cy"}]}))),this.mixins(r.LineVector)}}i.Quadratic=u,u.__name__="Quadratic",u.init_Quadratic()},function(t,e,i,s,n){s();const o=t(1),r=t(64),a=t(106),l=t(48),c=t(24),h=o.__importStar(t(18));class _ extends r.XYGlyphView{_map_data(){"data"==this.model.properties.length.units?this.slength=this.sdist(this.renderer.xscale,this._x,this.length):this.slength=c.to_screen(this.length);const{width:t,height:e}=this.renderer.plot_view.frame.bbox,i=2*(t+e),{slength:s}=this;for(let n=0,o=s.length;n<o;n++)0==s[n]&&(s[n]=i)}_render(t,e,i){const{sx:s,sy:n,slength:o,angle:r}=null!=i?i:this;if(this.visuals.line.doit)for(const a of e){const e=s[a],i=n[a],l=r.get(a),c=o[a];isNaN(e+i+l+c)||(t.translate(e,i),t.rotate(l),t.beginPath(),t.moveTo(0,0),t.lineTo(c,0),this.visuals.line.set_vectorize(t,a),t.stroke(),t.rotate(-l),t.translate(-e,-i))}}draw_legend_for_index(t,e,i){a.generic_line_vector_legend(this.visuals,t,e,i)}}i.RayView=_,_.__name__="RayView";class d extends r.XYGlyph{constructor(t){super(t)}static init_Ray(){this.prototype.default_view=_,this.mixins(l.LineVector),this.define((({})=>({length:[h.DistanceSpec,0],angle:[h.AngleSpec,0]})))}}i.Ray=d,d.__name__="Ray",d.init_Ray()},function(t,e,i,s,n){s();const o=t(288),r=t(106),a=t(24),l=t(12),c=t(59);class h extends o.CenterRotatableView{_map_data(){if("data"==this.model.properties.width.units)[this.sw,this.sx0]=this._map_dist_corner_for_data_side_length(this._x,this.width,this.renderer.xscale);else{this.sw=a.to_screen(this.width);const t=this.sx.length;this.sx0=new a.ScreenArray(t);for(let e=0;e<t;e++)this.sx0[e]=this.sx[e]-this.sw[e]/2}if("data"==this.model.properties.height.units)[this.sh,this.sy1]=this._map_dist_corner_for_data_side_length(this._y,this.height,this.renderer.yscale);else{this.sh=a.to_screen(this.height);const t=this.sy.length;this.sy1=new a.ScreenArray(t);for(let e=0;e<t;e++)this.sy1[e]=this.sy[e]-this.sh[e]/2}const t=this.sw.length;this.ssemi_diag=new a.ScreenArray(t);for(let e=0;e<t;e++)this.ssemi_diag[e]=Math.sqrt(this.sw[e]/2*this.sw[e]/2+this.sh[e]/2*this.sh[e]/2)}_render(t,e,i){const{sx:s,sy:n,sx0:o,sy1:r,sw:a,sh:l,angle:c}=null!=i?i:this;for(const h of e){const e=s[h],i=n[h],_=o[h],d=r[h],u=a[h],p=l[h],m=c.get(h);isNaN(e+i+_+d+u+p+m)||0!=u&&0!=p&&(t.beginPath(),m?(t.translate(e,i),t.rotate(m),t.rect(-u/2,-p/2,u,p),t.rotate(-m),t.translate(-e,-i)):t.rect(_,d,u,p),this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,h),t.fill()),this.visuals.hatch.doit&&(this.visuals.hatch.set_vectorize(t,h),t.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,h),t.stroke()))}}_hit_rect(t){return this._hit_rect_against_index(t)}_hit_point(t){let{sx:e,sy:i}=t;const s=this.renderer.xscale.invert(e),n=this.renderer.yscale.invert(i),o=this.sx0.length,r=new a.ScreenArray(o);for(let a=0;a<o;a++)r[a]=this.sx0[a]+this.sw[a]/2;const h=new a.ScreenArray(o);for(let a=0;a<o;a++)h[a]=this.sy1[a]+this.sh[a]/2;const _=l.max(this._ddist(0,r,this.ssemi_diag)),d=l.max(this._ddist(1,h,this.ssemi_diag)),u=s-_,p=s+_,m=n-d,g=n+d;let f,b;const v=[];for(const a of this.index.indices({x0:u,x1:p,y0:m,y1:g})){const t=this.angle.get(a);if(t){const s=Math.sin(-t),n=Math.cos(-t),o=n*(e-this.sx[a])-s*(i-this.sy[a])+this.sx[a],r=s*(e-this.sx[a])+n*(i-this.sy[a])+this.sy[a];e=o,i=r,f=Math.abs(this.sx[a]-e)<=this.sw[a]/2,b=Math.abs(this.sy[a]-i)<=this.sh[a]/2}else{const t=e-this.sx0[a],s=i-this.sy1[a];f=0<=t&&t<=this.sw[a],b=0<=s&&s<=this.sh[a]}f&&b&&v.push(a)}return new c.Selection({indices:v})}_map_dist_corner_for_data_side_length(t,e,i){const s=t.length,n=new Float64Array(s),o=new Float64Array(s);for(let h=0;h<s;h++){const i=t[h],s=e.get(h)/2;n[h]=i-s,o[h]=i+s}const r=i.v_compute(n),a=i.v_compute(o),l=this.sdist(i,n,e,"edge",this.model.dilate);let c=r;for(let h=0;h<s;h++){const t=r[h],e=a[h];if(!isNaN(t+e)&&t!=e){c=t<e?r:a;break}}return[l,c]}_ddist(t,e,i){const s=a.infer_type(e,i),n=0==t?this.renderer.xscale:this.renderer.yscale,o=e,r=o.length,l=new s(r);for(let a=0;a<r;a++)l[a]=o[a]+i[a];const c=n.v_invert(o),h=n.v_invert(l),_=c.length,d=new s(_);for(let a=0;a<_;a++)d[a]=Math.abs(h[a]-c[a]);return d}draw_legend_for_index(t,e,i){r.generic_area_vector_legend(this.visuals,t,e,i)}}i.RectView=h,h.__name__="RectView";class _ extends o.CenterRotatable{constructor(t){super(t)}static init_Rect(){this.prototype.default_view=h,this.define((({Boolean:t})=>({dilate:[t,!1]})))}}i.Rect=_,_.__name__="Rect",_.init_Rect()},function(t,e,i,s,n){s();const o=t(1),r=t(304),a=t(305),l=t(283),c=o.__importStar(t(18));class h extends r.MarkerView{_init_webgl(){const{webgl:t}=this.renderer.plot_view.canvas_view;if(null!=t){const e=new Set(this.marker);if(1==e.size){const[i]=[...e];if(l.MarkerGL.is_supported(i)){const{glglyph:e}=this;if(null==e||e.marker_type!=i)return void(this.glglyph=new l.MarkerGL(t.gl,this,i))}}}delete this.glglyph}_set_data(t){super._set_data(t),this._init_webgl()}_render(t,e,i){const{sx:s,sy:n,size:o,angle:r,marker:l}=null!=i?i:this;for(const c of e){const e=s[c],i=n[c],h=o.get(c),_=r.get(c),d=l.get(c);if(isNaN(e+i+h+_)||null==d)continue;const u=h/2;t.beginPath(),t.translate(e,i),_&&t.rotate(_),a.marker_funcs[d](t,c,u,this.visuals),_&&t.rotate(-_),t.translate(-e,-i)}}draw_legend_for_index(t,{x0:e,x1:i,y0:s,y1:n},o){const r=o+1,a=this.marker.get(o),l=Object.assign(Object.assign({},this._get_legend_args({x0:e,x1:i,y0:s,y1:n},o)),{marker:new c.UniformScalar(a,r)});this._render(t,[o],l)}}i.ScatterView=h,h.__name__="ScatterView";class _ extends r.Marker{constructor(t){super(t)}static init_Scatter(){this.prototype.default_view=h,this.define((()=>({marker:[c.MarkerSpec,{value:"circle"}]})))}}i.Scatter=_,_.__name__="Scatter",_.init_Scatter()},function(t,e,i,s,n){s();const o=t(1),r=t(64),a=t(48),l=o.__importStar(t(107)),c=o.__importStar(t(18)),h=t(9),_=t(59);class d extends r.XYGlyphView{_render(t,e,i){const{sx:s,sy:n,size:o,angle:r}=null!=i?i:this;for(const a of e){const e=s[a],i=n[a],l=o.get(a),c=r.get(a);if(isNaN(e+i+l+c))continue;const h=l/2;t.beginPath(),t.translate(e,i),c&&t.rotate(c),this._render_one(t,a,h,this.visuals),c&&t.rotate(-c),t.translate(-e,-i)}}_mask_data(){const{x_target:t,y_target:e}=this.renderer.plot_view.frame,i=t.widen(this.max_size).map((t=>this.renderer.xscale.invert(t))),s=e.widen(this.max_size).map((t=>this.renderer.yscale.invert(t)));return this.index.indices({x0:i.start,x1:i.end,y0:s.start,y1:s.end})}_hit_point(t){const{sx:e,sy:i}=t,{max_size:s}=this,{hit_dilation:n}=this.model,o=e-s*n,r=e+s*n,[a,l]=this.renderer.xscale.r_invert(o,r),c=i-s*n,h=i+s*n,[d,u]=this.renderer.yscale.r_invert(c,h),p=this.index.indices({x0:a,x1:l,y0:d,y1:u}),m=[];for(const _ of p){const t=this.size.get(_)/2*n;Math.abs(this.sx[_]-e)<=t&&Math.abs(this.sy[_]-i)<=t&&m.push(_)}return new _.Selection({indices:m})}_hit_span(t){const{sx:e,sy:i}=t,s=this.bounds(),n=this.max_size/2;let o,r,a,l;if("h"==t.direction){a=s.y0,l=s.y1;const t=e-n,i=e+n;[o,r]=this.renderer.xscale.r_invert(t,i)}else{o=s.x0,r=s.x1;const t=i-n,e=i+n;[a,l]=this.renderer.yscale.r_invert(t,e)}const c=[...this.index.indices({x0:o,x1:r,y0:a,y1:l})];return new _.Selection({indices:c})}_hit_rect(t){const{sx0:e,sx1:i,sy0:s,sy1:n}=t,[o,r]=this.renderer.xscale.r_invert(e,i),[a,l]=this.renderer.yscale.r_invert(s,n),c=[...this.index.indices({x0:o,x1:r,y0:a,y1:l})];return new _.Selection({indices:c})}_hit_poly(t){const{sx:e,sy:i}=t,s=h.range(0,this.sx.length),n=[];for(let o=0,r=s.length;o<r;o++){const t=s[o];l.point_in_poly(this.sx[o],this.sy[o],e,i)&&n.push(t)}return new _.Selection({indices:n})}_get_legend_args({x0:t,x1:e,y0:i,y1:s},n){const o=n+1,r=new Array(o),a=new Array(o);r[n]=(t+e)/2,a[n]=(i+s)/2;const l=.4*Math.min(Math.abs(e-t),Math.abs(s-i));return{sx:r,sy:a,size:new c.UniformScalar(l,o),angle:new c.UniformScalar(0,o)}}draw_legend_for_index(t,{x0:e,x1:i,y0:s,y1:n},o){const r=this._get_legend_args({x0:e,x1:i,y0:s,y1:n},o);this._render(t,[o],r)}}i.MarkerView=d,d.__name__="MarkerView";class u extends r.XYGlyph{constructor(t){super(t)}static init_Marker(){this.mixins([a.LineVector,a.FillVector,a.HatchVector]),this.define((({Number:t})=>({size:[c.ScreenDistanceSpec,{value:4}],angle:[c.AngleSpec,0],hit_dilation:[t,1]})))}}i.Marker=u,u.__name__="Marker",u.init_Marker()},function(t,e,i,s,n){s();const o=Math.sqrt(3),r=Math.sqrt(5),a=(r+1)/4,l=Math.sqrt((5-r)/8),c=(r-1)/4,h=Math.sqrt((5+r)/8);function _(t,e){t.rotate(Math.PI/4),u(t,e),t.rotate(-Math.PI/4)}function d(t,e){const i=e*o,s=i/3;t.moveTo(-i/2,-s),t.lineTo(0,0),t.lineTo(i/2,-s),t.lineTo(0,0),t.lineTo(0,e)}function u(t,e){t.moveTo(0,e),t.lineTo(0,-e),t.moveTo(-e,0),t.lineTo(e,0)}function p(t,e){t.moveTo(0,e),t.lineTo(e/1.5,0),t.lineTo(0,-e),t.lineTo(-e/1.5,0),t.closePath()}function m(t,e){const i=e*o,s=i/3;t.moveTo(-e,s),t.lineTo(e,s),t.lineTo(0,s-i),t.closePath()}function g(t,e,i,s){t.arc(0,0,i,0,2*Math.PI,!1),s.fill.doit&&(s.fill.set_vectorize(t,e),t.fill()),s.hatch.doit&&(s.hatch.set_vectorize(t,e),t.fill()),s.line.doit&&(s.line.set_vectorize(t,e),t.stroke())}function f(t,e,i,s){p(t,i),s.fill.doit&&(s.fill.set_vectorize(t,e),t.fill()),s.hatch.doit&&(s.hatch.set_vectorize(t,e),t.fill()),s.line.doit&&(s.line.set_vectorize(t,e),t.stroke())}function b(t,e,i,s){!function(t,e){t.beginPath(),t.arc(0,0,e/4,0,2*Math.PI,!1),t.closePath()}(t,i),s.line.set_vectorize(t,e),t.fillStyle=t.strokeStyle,t.fill()}function v(t,e,i,s){!function(t,e){const i=e/2,s=o*i;t.moveTo(e,0),t.lineTo(i,-s),t.lineTo(-i,-s),t.lineTo(-e,0),t.lineTo(-i,s),t.lineTo(i,s),t.closePath()}(t,i),s.fill.doit&&(s.fill.set_vectorize(t,e),t.fill()),s.hatch.doit&&(s.hatch.set_vectorize(t,e),t.fill()),s.line.doit&&(s.line.set_vectorize(t,e),t.stroke())}function y(t,e,i,s){const n=2*i;t.rect(-i,-i,n,n),s.fill.doit&&(s.fill.set_vectorize(t,e),t.fill()),s.hatch.doit&&(s.hatch.set_vectorize(t,e),t.fill()),s.line.doit&&(s.line.set_vectorize(t,e),t.stroke())}function x(t,e,i,s){!function(t,e){const i=Math.sqrt(5-2*r)*e;t.moveTo(0,-e),t.lineTo(i*c,i*h-e),t.lineTo(i*(1+c),i*h-e),t.lineTo(i*(1+c-a),i*(h+l)-e),t.lineTo(i*(1+2*c-a),i*(2*h+l)-e),t.lineTo(0,2*i*h-e),t.lineTo(-i*(1+2*c-a),i*(2*h+l)-e),t.lineTo(-i*(1+c-a),i*(h+l)-e),t.lineTo(-i*(1+c),i*h-e),t.lineTo(-i*c,i*h-e),t.closePath()}(t,i),s.fill.doit&&(s.fill.set_vectorize(t,e),t.fill()),s.hatch.doit&&(s.hatch.set_vectorize(t,e),t.fill()),s.line.doit&&(s.line.set_vectorize(t,e),t.stroke())}function w(t,e,i,s){m(t,i),s.fill.doit&&(s.fill.set_vectorize(t,e),t.fill()),s.hatch.doit&&(s.hatch.set_vectorize(t,e),t.fill()),s.line.doit&&(s.line.set_vectorize(t,e),t.stroke())}i.marker_funcs={asterisk:function(t,e,i,s){u(t,i),_(t,i),s.line.doit&&(s.line.set_vectorize(t,e),t.stroke())},circle:g,circle_cross:function(t,e,i,s){t.arc(0,0,i,0,2*Math.PI,!1),s.fill.doit&&(s.fill.set_vectorize(t,e),t.fill()),s.hatch.doit&&(s.hatch.set_vectorize(t,e),t.fill()),s.line.doit&&(s.line.set_vectorize(t,e),u(t,i),t.stroke())},circle_dot:function(t,e,i,s){g(t,e,i,s),b(t,e,i,s)},circle_y:function(t,e,i,s){t.arc(0,0,i,0,2*Math.PI,!1),s.fill.doit&&(s.fill.set_vectorize(t,e),t.fill()),s.hatch.doit&&(s.hatch.set_vectorize(t,e),t.fill()),s.line.doit&&(s.line.set_vectorize(t,e),d(t,i),t.stroke())},circle_x:function(t,e,i,s){t.arc(0,0,i,0,2*Math.PI,!1),s.fill.doit&&(s.fill.set_vectorize(t,e),t.fill()),s.hatch.doit&&(s.hatch.set_vectorize(t,e),t.fill()),s.line.doit&&(s.line.set_vectorize(t,e),_(t,i),t.stroke())},cross:function(t,e,i,s){u(t,i),s.line.doit&&(s.line.set_vectorize(t,e),t.stroke())},diamond:f,diamond_dot:function(t,e,i,s){f(t,e,i,s),b(t,e,i,s)},diamond_cross:function(t,e,i,s){p(t,i),s.fill.doit&&(s.fill.set_vectorize(t,e),t.fill()),s.hatch.doit&&(s.hatch.set_vectorize(t,e),t.fill()),s.line.doit&&(s.line.set_vectorize(t,e),t.moveTo(0,i),t.lineTo(0,-i),t.moveTo(-i/1.5,0),t.lineTo(i/1.5,0),t.stroke())},dot:b,hex:v,hex_dot:function(t,e,i,s){v(t,e,i,s),b(t,e,i,s)},inverted_triangle:function(t,e,i,s){t.rotate(Math.PI),m(t,i),t.rotate(-Math.PI),s.fill.doit&&(s.fill.set_vectorize(t,e),t.fill()),s.hatch.doit&&(s.hatch.set_vectorize(t,e),t.fill()),s.line.doit&&(s.line.set_vectorize(t,e),t.stroke())},plus:function(t,e,i,s){const n=3*i/8,o=[n,n,i,i,n,n,-n,-n,-i,-i,-n,-n],r=[i,n,n,-n,-n,-i,-i,-n,-n,n,n,i];t.beginPath();for(let a=0;a<12;a++)t.lineTo(o[a],r[a]);t.closePath(),s.fill.doit&&(s.fill.set_vectorize(t,e),t.fill()),s.hatch.doit&&(s.hatch.set_vectorize(t,e),t.fill()),s.line.doit&&(s.line.set_vectorize(t,e),t.stroke())},square:y,square_cross:function(t,e,i,s){const n=2*i;t.rect(-i,-i,n,n),s.fill.doit&&(s.fill.set_vectorize(t,e),t.fill()),s.hatch.doit&&(s.hatch.set_vectorize(t,e),t.fill()),s.line.doit&&(s.line.set_vectorize(t,e),u(t,i),t.stroke())},square_dot:function(t,e,i,s){y(t,e,i,s),b(t,e,i,s)},square_pin:function(t,e,i,s){const n=3*i/8;t.moveTo(-i,-i),t.quadraticCurveTo(0,-n,i,-i),t.quadraticCurveTo(n,0,i,i),t.quadraticCurveTo(0,n,-i,i),t.quadraticCurveTo(-n,0,-i,-i),t.closePath(),s.fill.doit&&(s.fill.set_vectorize(t,e),t.fill()),s.hatch.doit&&(s.hatch.set_vectorize(t,e),t.fill()),s.line.doit&&(s.line.set_vectorize(t,e),t.stroke())},square_x:function(t,e,i,s){const n=2*i;t.rect(-i,-i,n,n),s.fill.doit&&(s.fill.set_vectorize(t,e),t.fill()),s.hatch.doit&&(s.hatch.set_vectorize(t,e),t.fill()),s.line.doit&&(s.line.set_vectorize(t,e),t.moveTo(-i,i),t.lineTo(i,-i),t.moveTo(-i,-i),t.lineTo(i,i),t.stroke())},star:x,star_dot:function(t,e,i,s){x(t,e,i,s),b(t,e,i,s)},triangle:w,triangle_dot:function(t,e,i,s){w(t,e,i,s),b(t,e,i,s)},triangle_pin:function(t,e,i,s){const n=i*o,r=n/3,a=3*r/8;t.moveTo(-i,r),t.quadraticCurveTo(0,a,i,r),t.quadraticCurveTo(o*a/2,a/2,0,r-n),t.quadraticCurveTo(-o*a/2,a/2,-i,r),t.closePath(),s.fill.doit&&(s.fill.set_vectorize(t,e),t.fill()),s.hatch.doit&&(s.hatch.set_vectorize(t,e),t.fill()),s.line.doit&&(s.line.set_vectorize(t,e),t.stroke())},dash:function(t,e,i,s){!function(t,e){t.moveTo(-e,0),t.lineTo(e,0)}(t,i),s.line.doit&&(s.line.set_vectorize(t,e),t.stroke())},x:function(t,e,i,s){_(t,i),s.line.doit&&(s.line.set_vectorize(t,e),t.stroke())},y:function(t,e,i,s){d(t,i),s.line.doit&&(s.line.set_vectorize(t,e),t.stroke())}}},function(t,e,i,s,n){s();const o=t(1),r=o.__importStar(t(107)),a=o.__importStar(t(18)),l=t(48),c=t(65),h=t(98),_=t(106),d=t(59);class u extends h.GlyphView{_project_data(){c.inplace.project_xy(this._x0,this._y0),c.inplace.project_xy(this._x1,this._y1)}_index_data(t){const{min:e,max:i}=Math,{_x0:s,_x1:n,_y0:o,_y1:r,data_size:a}=this;for(let l=0;l<a;l++){const a=s[l],c=n[l],h=o[l],_=r[l];isNaN(a+c+h+_)?t.add_empty():t.add(e(a,c),e(h,_),i(a,c),i(h,_))}}_render(t,e,i){if(this.visuals.line.doit){const{sx0:s,sy0:n,sx1:o,sy1:r}=null!=i?i:this;for(const i of e){const e=s[i],a=n[i],l=o[i],c=r[i];isNaN(e+a+l+c)||(t.beginPath(),t.moveTo(e,a),t.lineTo(l,c),this.visuals.line.set_vectorize(t,i),t.stroke())}}}_hit_point(t){const{sx:e,sy:i}=t,s={x:e,y:i},[n,o]=this.renderer.xscale.r_invert(e-2,e+2),[a,l]=this.renderer.yscale.r_invert(i-2,i+2),c=this.index.indices({x0:n,y0:a,x1:o,y1:l}),h=[];for(const _ of c){const t=Math.max(2,this.line_width.get(_)/2)**2,e={x:this.sx0[_],y:this.sy0[_]},i={x:this.sx1[_],y:this.sy1[_]};r.dist_to_segment_squared(s,e,i)<t&&h.push(_)}return new d.Selection({indices:h})}_hit_span(t){const[e,i]=this.renderer.plot_view.frame.bbox.ranges,{sx:s,sy:n}=t;let o,r,a;"v"==t.direction?(a=this.renderer.yscale.invert(n),[o,r]=[this._y0,this._y1]):(a=this.renderer.xscale.invert(s),[o,r]=[this._x0,this._x1]);const l=[],[c,h]=this.renderer.xscale.r_invert(e.start,e.end),[_,u]=this.renderer.yscale.r_invert(i.start,i.end),p=this.index.indices({x0:c,y0:_,x1:h,y1:u});for(const d of p){(o[d]<=a&&a<=r[d]||r[d]<=a&&a<=o[d])&&l.push(d);const e=1.5+this.line_width.get(d)/2;o[d]==r[d]&&("h"==t.direction?Math.abs(this.sx0[d]-s)<=e&&l.push(d):Math.abs(this.sy0[d]-n)<=e&&l.push(d))}return new d.Selection({indices:l})}scenterxy(t){return[this.sx0[t]/2+this.sx1[t]/2,this.sy0[t]/2+this.sy1[t]/2]}draw_legend_for_index(t,e,i){_.generic_line_vector_legend(this.visuals,t,e,i)}}i.SegmentView=u,u.__name__="SegmentView";class p extends h.Glyph{constructor(t){super(t)}static init_Segment(){this.prototype.default_view=u,this.define((({})=>({x0:[a.XCoordinateSpec,{field:"x0"}],y0:[a.YCoordinateSpec,{field:"y0"}],x1:[a.XCoordinateSpec,{field:"x1"}],y1:[a.YCoordinateSpec,{field:"y1"}]}))),this.mixins(l.LineVector)}}i.Segment=p,p.__name__="Segment",p.init_Segment()},function(t,e,i,s,n){s();const o=t(1),r=t(64),a=o.__importStar(t(48)),l=t(308);class c extends r.XYGlyphView{_set_data(){const{tension:t,closed:e}=this.model;[this._xt,this._yt]=l.catmullrom_spline(this._x,this._y,20,t,e)}_map_data(){const{x_scale:t,y_scale:e}=this.renderer.coordinates;this.sxt=t.v_compute(this._xt),this.syt=e.v_compute(this._yt)}_render(t,e,i){const{sxt:s,syt:n}=null!=i?i:this;this.visuals.line.set_value(t);const o=s.length;for(let r=0;r<o;r++)0!=r?isNaN(s[r])||isNaN(n[r])?(t.stroke(),t.beginPath()):t.lineTo(s[r],n[r]):(t.beginPath(),t.moveTo(s[r],n[r]));t.stroke()}}i.SplineView=c,c.__name__="SplineView";class h extends r.XYGlyph{constructor(t){super(t)}static init_Spline(){this.prototype.default_view=c,this.mixins(a.LineScalar),this.define((({Boolean:t,Number:e})=>({tension:[e,.5],closed:[t,!1]})))}}i.Spline=h,h.__name__="Spline",h.init_Spline()},function(t,e,i,s,n){s();const o=t(24),r=t(11);i.catmullrom_spline=function(t,e,i=10,s=.5,n=!1){r.assert(t.length==e.length);const a=t.length,l=n?a+1:a,c=o.infer_type(t,e),h=new c(l+2),_=new c(l+2);h.set(t,1),_.set(e,1),n?(h[0]=t[a-1],_[0]=e[a-1],h[l]=t[0],_[l]=e[0],h[l+1]=t[1],_[l+1]=e[1]):(h[0]=t[0],_[0]=e[0],h[l+1]=t[a-1],_[l+1]=e[a-1]);const d=new c(4*(i+1));for(let o=0,r=0;o<=i;o++){const t=o/i,e=t**2,s=t*e;d[r++]=2*s-3*e+1,d[r++]=-2*s+3*e,d[r++]=s-2*e+t,d[r++]=s-e}const u=new c((l-1)*(i+1)),p=new c((l-1)*(i+1));for(let o=1,r=0;o<l;o++){const t=(h[o+1]-h[o-1])*s,e=(_[o+1]-_[o-1])*s,n=(h[o+2]-h[o])*s,a=(_[o+2]-_[o])*s;for(let s=0;s<=4*i;r++){const i=d[s++],l=d[s++],c=d[s++],m=d[s++];u[r]=i*h[o]+l*h[o+1]+c*t+m*n,p[r]=i*_[o]+l*_[o+1]+c*e+m*a}}return[u,p]}},function(t,e,i,s,n){s();const o=t(1),r=t(64),a=t(106),l=o.__importStar(t(48)),c=t(20);class h extends r.XYGlyphView{_render(t,e,i){const{sx:s,sy:n}=null!=i?i:this;let o=!1,r=null;this.visuals.line.set_value(t);const a=e.length;if(!(a<2)){t.beginPath(),t.moveTo(s[0],n[0]);for(const i of e){let e,a,l,c;switch(this.model.mode){case"before":[e,l]=[s[i-1],n[i]],[a,c]=[s[i],n[i]];break;case"after":[e,l]=[s[i],n[i-1]],[a,c]=[s[i],n[i]];break;case"center":{const t=(s[i-1]+s[i])/2;[e,l]=[t,n[i-1]],[a,c]=[t,n[i]];break}default:throw new Error("unexpected")}if(o){if(!isFinite(s[i]+n[i])){t.stroke(),t.beginPath(),o=!1,r=i;continue}null!=r&&i-r>1&&(t.stroke(),o=!1)}o?(t.lineTo(e,l),t.lineTo(a,c)):(t.beginPath(),t.moveTo(s[i],n[i]),o=!0),r=i}t.lineTo(s[a-1],n[a-1]),t.stroke()}}draw_legend_for_index(t,e,i){a.generic_line_scalar_legend(this.visuals,t,e)}}i.StepView=h,h.__name__="StepView";class _ extends r.XYGlyph{constructor(t){super(t)}static init_Step(){this.prototype.default_view=h,this.mixins(l.LineScalar),this.define((()=>({mode:[c.StepMode,"before"]})))}}i.Step=_,_.__name__="Step",_.init_Step()},function(t,e,i,s,n){s();const o=t(1),r=t(64),a=t(48),l=o.__importStar(t(107)),c=o.__importStar(t(18)),h=t(143),_=t(11),d=t(59);class u extends r.XYGlyphView{_rotate_point(t,e,i,s,n){return[(t-i)*Math.cos(n)-(e-s)*Math.sin(n)+i,(t-i)*Math.sin(n)+(e-s)*Math.cos(n)+s]}_text_bounds(t,e,i,s){return[[t,t+i,t+i,t,t],[e,e,e-s,e-s,e]]}_render(t,e,i){const{sx:s,sy:n,x_offset:o,y_offset:r,angle:a,text:l}=null!=i?i:this;this._sys=[],this._sxs=[];for(const c of e){const e=this._sxs[c]=[],i=this._sys[c]=[],_=s[c],d=n[c],u=o.get(c),p=r.get(c),m=a.get(c),g=l.get(c);if(!isNaN(_+d+u+p+m)&&null!=g&&this.visuals.text.doit){const s=`${g}`;t.save(),t.translate(_+u,d+p),t.rotate(m),this.visuals.text.set_vectorize(t,c);const n=this.visuals.text.font_value(c),{height:o}=h.font_metrics(n),r=this.text_line_height.get(c)*o;if(-1==s.indexOf("\n")){t.fillText(s,0,0);const n=_+u,o=d+p,a=t.measureText(s).width,[l,c]=this._text_bounds(n,o,a,r);e.push(l),i.push(c)}else{const n=s.split("\n"),o=r*n.length,a=this.text_baseline.get(c);let l;switch(a){case"top":l=0;break;case"middle":l=-o/2+r/2;break;case"bottom":l=-o+r;break;default:l=0,console.warn(`'${a}' baseline not supported with multi line text`)}for(const s of n){t.fillText(s,0,l);const n=_+u,o=l+d+p,a=t.measureText(s).width,[c,h]=this._text_bounds(n,o,a,r);e.push(c),i.push(h),l+=r}}t.restore()}}}_hit_point(t){const{sx:e,sy:i}=t,s=[];for(let n=0;n<this._sxs.length;n++){const t=this._sxs[n],o=this._sys[n],r=t.length;for(let a=0,c=r;a<c;a++){const[c,h]=this._rotate_point(e,i,t[r-1][0],o[r-1][0],-this.angle.get(n));l.point_in_poly(c,h,t[a],o[a])&&s.push(n)}}return new d.Selection({indices:s})}scenterxy(t){const e=this._sxs[t],i=this._sys[t];_.assert(0!=e.length&&0!=i.length);const s=e[0][0],n=i[0][0],o=(e[0][2]+s)/2,r=(i[0][2]+n)/2,[a,l]=this._rotate_point(o,r,s,n,this.angle.get(t));return[a,l]}}i.TextView=u,u.__name__="TextView";class p extends r.XYGlyph{constructor(t){super(t)}static init_Text(){this.prototype.default_view=u,this.mixins(a.TextVector),this.define((({})=>({text:[c.NullStringSpec,{field:"text"}],angle:[c.AngleSpec,0],x_offset:[c.NumberSpec,0],y_offset:[c.NumberSpec,0]})))}}i.Text=p,p.__name__="Text",p.init_Text()},function(t,e,i,s,n){s();const o=t(1),r=t(290),a=t(24),l=o.__importStar(t(18));class c extends r.BoxView{scenterxy(t){return[this.sx[t],(this.stop[t]+this.sbottom[t])/2]}_lrtb(t){const e=this.width.get(t)/2,i=this._x[t],s=this._top[t],n=this._bottom[t];return[i-e,i+e,Math.max(s,n),Math.min(s,n)]}_map_data(){this.sx=this.renderer.xscale.v_compute(this._x),this.sw=this.sdist(this.renderer.xscale,this._x,this.width,"center"),this.stop=this.renderer.yscale.v_compute(this._top),this.sbottom=this.renderer.yscale.v_compute(this._bottom);const t=this.sx.length;this.sleft=new a.ScreenArray(t),this.sright=new a.ScreenArray(t);for(let e=0;e<t;e++)this.sleft[e]=this.sx[e]-this.sw[e]/2,this.sright[e]=this.sx[e]+this.sw[e]/2;this._clamp_viewport()}}i.VBarView=c,c.__name__="VBarView";class h extends r.Box{constructor(t){super(t)}static init_VBar(){this.prototype.default_view=c,this.define((({})=>({x:[l.XCoordinateSpec,{field:"x"}],bottom:[l.YCoordinateSpec,{value:0}],width:[l.NumberSpec,{value:1}],top:[l.YCoordinateSpec,{field:"top"}]})))}}i.VBar=h,h.__name__="VBar",h.init_VBar()},function(t,e,i,s,n){s();const o=t(1),r=t(64),a=t(106),l=t(48),c=t(24),h=t(20),_=o.__importStar(t(18)),d=t(10),u=t(59);class p extends r.XYGlyphView{_map_data(){"data"==this.model.properties.radius.units?this.sradius=this.sdist(this.renderer.xscale,this._x,this.radius):this.sradius=c.to_screen(this.radius)}_render(t,e,i){const{sx:s,sy:n,sradius:o,start_angle:r,end_angle:a}=null!=i?i:this,l="anticlock"==this.model.direction;for(const c of e){const e=s[c],i=n[c],h=o[c],_=r.get(c),d=a.get(c);isNaN(e+i+h+_+d)||(t.beginPath(),t.arc(e,i,h,_,d,l),t.lineTo(e,i),t.closePath(),this.visuals.fill.doit&&(this.visuals.fill.set_vectorize(t,c),t.fill()),this.visuals.hatch.doit&&(this.visuals.hatch.set_vectorize(t,c),t.fill()),this.visuals.line.doit&&(this.visuals.line.set_vectorize(t,c),t.stroke()))}}_hit_point(t){let e,i,s,n,o,r,a,l,c;const{sx:h,sy:_}=t,p=this.renderer.xscale.invert(h),m=this.renderer.yscale.invert(_),g=2*this.max_radius;"data"===this.model.properties.radius.units?(r=p-g,a=p+g,l=m-g,c=m+g):(i=h-g,s=h+g,[r,a]=this.renderer.xscale.r_invert(i,s),n=_-g,o=_+g,[l,c]=this.renderer.yscale.r_invert(n,o));const f=[];for(const d of this.index.indices({x0:r,x1:a,y0:l,y1:c})){const t=this.sradius[d]**2;[i,s]=this.renderer.xscale.r_compute(p,this._x[d]),[n,o]=this.renderer.yscale.r_compute(m,this._y[d]),e=(i-s)**2+(n-o)**2,e<=t&&f.push(d)}const b="anticlock"==this.model.direction,v=[];for(const u of f){const t=Math.atan2(_-this.sy[u],h-this.sx[u]);d.angle_between(-t,-this.start_angle.get(u),-this.end_angle.get(u),b)&&v.push(u)}return new u.Selection({indices:v})}draw_legend_for_index(t,e,i){a.generic_area_vector_legend(this.visuals,t,e,i)}scenterxy(t){const e=this.sradius[t]/2,i=(this.start_angle.get(t)+this.end_angle.get(t))/2;return[this.sx[t]+e*Math.cos(i),this.sy[t]+e*Math.sin(i)]}}i.WedgeView=p,p.__name__="WedgeView";class m extends r.XYGlyph{constructor(t){super(t)}static init_Wedge(){this.prototype.default_view=p,this.mixins([l.LineVector,l.FillVector,l.HatchVector]),this.define((({})=>({direction:[h.Direction,"anticlock"],radius:[_.DistanceSpec,{field:"radius"}],start_angle:[_.AngleSpec,{field:"start_angle"}],end_angle:[_.AngleSpec,{field:"end_angle"}]})))}}i.Wedge=m,m.__name__="Wedge",m.init_Wedge()},function(t,e,i,s,n){s();const o=t(1);o.__exportStar(t(126),i),o.__exportStar(t(125),i),o.__exportStar(t(314),i)},function(t,e,i,s,n){s();const o=t(125);class r extends o.LayoutProvider{constructor(t){super(t)}static init_StaticLayoutProvider(){this.define((({Number:t,Tuple:e,Dict:i})=>({graph_layout:[i(e(t,t)),{}]})))}get_node_coordinates(t){var e;const i=null!==(e=t.data.index)&&void 0!==e?e:[],s=i.length,n=new Float64Array(s),o=new Float64Array(s);for(let r=0;r<s;r++){const t=this.graph_layout[i[r]],[e,s]=null!=t?t:[NaN,NaN];n[r]=e,o[r]=s}return[n,o]}get_edge_coordinates(t){var e,i;const s=null!==(e=t.data.start)&&void 0!==e?e:[],n=null!==(i=t.data.end)&&void 0!==i?i:[],o=Math.min(s.length,n.length),r=[],a=[],l=null!=t.data.xs&&null!=t.data.ys;for(let c=0;c<o;c++){const e=null!=this.graph_layout[s[c]]&&null!=this.graph_layout[n[c]];if(l&&e)r.push(t.data.xs[c]),a.push(t.data.ys[c]);else{let t,i;e?(t=this.graph_layout[s[c]],i=this.graph_layout[n[c]]):(t=[NaN,NaN],i=[NaN,NaN]),r.push([t[0],i[0]]),a.push([t[1],i[1]])}}return[r,a]}}i.StaticLayoutProvider=r,r.__name__="StaticLayoutProvider",r.init_StaticLayoutProvider()},function(t,e,i,s,n){s(),n("Grid",t(316).Grid)},function(t,e,i,s,n){s();const o=t(1),r=t(162),a=t(164),l=t(165),c=o.__importStar(t(48)),h=t(8);class _ extends a.GuideRendererView{_render(){const t=this.layer.ctx;t.save(),this._draw_regions(t),this._draw_minor_grids(t),this._draw_grids(t),t.restore()}connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>this.request_render()))}_draw_regions(t){if(!this.visuals.band_fill.doit&&!this.visuals.band_hatch.doit)return;const[e,i]=this.grid_coords("major",!1);for(let s=0;s<e.length-1;s++){if(s%2!=1)continue;const[n,o]=this.coordinates.map_to_screen(e[s],i[s]),[r,a]=this.coordinates.map_to_screen(e[s+1],i[s+1]);t.beginPath(),t.rect(n[0],o[0],r[1]-n[0],a[1]-o[0]),this.visuals.band_fill.doit&&(this.visuals.band_fill.set_value(t),t.fill()),this.visuals.band_hatch.doit&&(this.visuals.band_hatch.set_value(t),t.fill())}}_draw_grids(t){if(!this.visuals.grid_line.doit)return;const[e,i]=this.grid_coords("major");this._draw_grid_helper(t,this.visuals.grid_line,e,i)}_draw_minor_grids(t){if(!this.visuals.minor_grid_line.doit)return;const[e,i]=this.grid_coords("minor");this._draw_grid_helper(t,this.visuals.minor_grid_line,e,i)}_draw_grid_helper(t,e,i,s){e.set_value(t),t.beginPath();for(let n=0;n<i.length;n++){const[e,o]=this.coordinates.map_to_screen(i[n],s[n]);t.moveTo(Math.round(e[0]),Math.round(o[0]));for(let i=1;i<e.length;i++)t.lineTo(Math.round(e[i]),Math.round(o[i]))}t.stroke()}ranges(){const t=this.model.dimension,e=(t+1)%2,{ranges:i}=this.coordinates;return[i[t],i[e]]}computed_bounds(){const[t]=this.ranges(),e=this.model.bounds,i=[t.min,t.max];let s,n;if(h.isArray(e))s=Math.min(e[0],e[1]),n=Math.max(e[0],e[1]),s<i[0]&&(s=i[0]),n>i[1]&&(n=i[1]);else{[s,n]=i;for(const t of this.plot_view.axis_views)t.dimension==this.model.dimension&&t.model.x_range_name==this.model.x_range_name&&t.model.y_range_name==this.model.y_range_name&&([s,n]=t.computed_bounds)}return[s,n]}grid_coords(t,e=!0){const i=this.model.dimension,s=(i+1)%2,[n,o]=this.ranges();let[r,a]=this.computed_bounds();[r,a]=[Math.min(r,a),Math.max(r,a)];const l=[[],[]],c=this.model.get_ticker();if(null==c)return l;const h=c.get_ticks(r,a,n,o.min)[t],_=n.min,d=n.max,u=o.min,p=o.max;e||(h[0]!=_&&h.splice(0,0,_),h[h.length-1]!=d&&h.push(d));for(let m=0;m<h.length;m++){if((h[m]==_||h[m]==d)&&e)continue;const t=[],n=[],o=2;for(let e=0;e<o;e++){const i=u+(p-u)/(o-1)*e;t.push(h[m]),n.push(i)}l[i].push(t),l[s].push(n)}return l}}i.GridView=_,_.__name__="GridView";class d extends a.GuideRenderer{constructor(t){super(t)}static init_Grid(){this.prototype.default_view=_,this.mixins([["grid_",c.Line],["minor_grid_",c.Line],["band_",c.Fill],["band_",c.Hatch]]),this.define((({Number:t,Auto:e,Enum:i,Ref:s,Tuple:n,Or:o,Nullable:a})=>({bounds:[o(n(t,t),e),"auto"],dimension:[i(0,1),0],axis:[a(s(r.Axis)),null],ticker:[a(s(l.Ticker)),null]}))),this.override({level:"underlay",band_fill_color:null,band_fill_alpha:0,grid_line_color:"#e5e5e5",minor_grid_line_color:null})}get_ticker(){return null!=this.ticker?this.ticker:null!=this.axis?this.axis.ticker:null}}i.Grid=d,d.__name__="Grid",d.init_Grid()},function(t,e,i,s,n){s(),n("Box",t(318).Box),n("Column",t(320).Column),n("GridBox",t(321).GridBox),n("HTMLBox",t(322).HTMLBox),n("LayoutDOM",t(319).LayoutDOM),n("Panel",t(323).Panel),n("Row",t(324).Row),n("Spacer",t(325).Spacer),n("Tabs",t(326).Tabs),n("WidgetBox",t(329).WidgetBox)},function(t,e,i,s,n){s();const o=t(319);class r extends o.LayoutDOMView{connect_signals(){super.connect_signals(),this.connect(this.model.properties.children.change,(()=>this.rebuild()))}get child_models(){return this.model.children}}i.BoxView=r,r.__name__="BoxView";class a extends o.LayoutDOM{constructor(t){super(t)}static init_Box(){this.define((({Number:t,Array:e,Ref:i})=>({children:[e(i(o.LayoutDOM)),[]],spacing:[t,0]})))}}i.Box=a,a.__name__="Box",a.init_Box()},function(t,e,i,s,n){s();const o=t(53),r=t(20),a=t(43),l=t(19),c=t(8),h=t(22),_=t(122),d=t(240),u=t(221),p=t(44),m=t(249);class g extends d.DOMView{constructor(){super(...arguments),this._idle_notified=!1,this._offset_parent=null,this._viewport={}}initialize(){super.initialize(),this.el.style.position=this.is_root?"relative":"absolute",this._child_views=new Map}async lazy_initialize(){await super.lazy_initialize(),await this.build_child_views()}remove(){for(const t of this.child_views)t.remove();this._child_views.clear(),super.remove()}connect_signals(){super.connect_signals(),this.is_root&&(this._on_resize=()=>this.resize_layout(),window.addEventListener("resize",this._on_resize),this._parent_observer=setInterval((()=>{const t=this.el.offsetParent;this._offset_parent!=t&&(this._offset_parent=t,null!=t&&(this.compute_viewport(),this.invalidate_layout()))}),250));const t=this.model.properties;this.on_change([t.width,t.height,t.min_width,t.min_height,t.max_width,t.max_height,t.margin,t.width_policy,t.height_policy,t.sizing_mode,t.aspect_ratio,t.visible],(()=>this.invalidate_layout())),this.on_change([t.background,t.css_classes],(()=>this.invalidate_render()))}disconnect_signals(){null!=this._parent_observer&&clearTimeout(this._parent_observer),null!=this._on_resize&&window.removeEventListener("resize",this._on_resize),super.disconnect_signals()}css_classes(){return super.css_classes().concat(this.model.css_classes)}get child_views(){return this.child_models.map((t=>this._child_views.get(t)))}async build_child_views(){await _.build_views(this._child_views,this.child_models,{parent:this})}render(){super.render(),a.empty(this.el);const{background:t}=this.model;this.el.style.backgroundColor=null!=t?h.color2css(t):"",a.classes(this.el).clear().add(...this.css_classes());for(const e of this.child_views)this.el.appendChild(e.el),e.render()}update_layout(){for(const t of this.child_views)t.update_layout();this._update_layout()}update_position(){this.el.style.display=this.model.visible?"block":"none";const t=this.is_root?this.layout.sizing.margin:void 0;a.position(this.el,this.layout.bbox,t);for(const e of this.child_views)e.update_position()}after_layout(){for(const t of this.child_views)t.after_layout();this._has_finished=!0}compute_viewport(){this._viewport=this._viewport_size()}renderTo(t){t.appendChild(this.el),this._offset_parent=this.el.offsetParent,this.compute_viewport(),this.build()}build(){return this.assert_root(),this.render(),this.update_layout(),this.compute_layout(),this}async rebuild(){await this.build_child_views(),this.invalidate_render()}compute_layout(){const t=Date.now();this.layout.compute(this._viewport),this.update_position(),this.after_layout(),l.logger.debug(`layout computed in ${Date.now()-t} ms`),this.notify_finished()}resize_layout(){this.root.compute_viewport(),this.root.compute_layout()}invalidate_layout(){this.root.update_layout(),this.root.compute_layout()}invalidate_render(){this.render(),this.invalidate_layout()}has_finished(){if(!super.has_finished())return!1;for(const t of this.child_views)if(!t.has_finished())return!1;return!0}notify_finished(){this.is_root?!this._idle_notified&&this.has_finished()&&null!=this.model.document&&(this._idle_notified=!0,this.model.document.notify_idle(this.model)):this.root.notify_finished()}_width_policy(){return null!=this.model.width?"fixed":"fit"}_height_policy(){return null!=this.model.height?"fixed":"fit"}box_sizing(){let{width_policy:t,height_policy:e,aspect_ratio:i}=this.model;"auto"==t&&(t=this._width_policy()),"auto"==e&&(e=this._height_policy());const{sizing_mode:s}=this.model;if(null!=s)if("fixed"==s)t=e="fixed";else if("stretch_both"==s)t=e="max";else if("stretch_width"==s)t="max";else if("stretch_height"==s)e="max";else switch(null==i&&(i="auto"),s){case"scale_width":t="max",e="min";break;case"scale_height":t="min",e="max";break;case"scale_both":t="max",e="max"}const n={width_policy:t,height_policy:e},{min_width:o,min_height:r}=this.model;null!=o&&(n.min_width=o),null!=r&&(n.min_height=r);const{width:a,height:l}=this.model;null!=a&&(n.width=a),null!=l&&(n.height=l);const{max_width:h,max_height:_}=this.model;null!=h&&(n.max_width=h),null!=_&&(n.max_height=_),"auto"==i&&null!=a&&null!=l?n.aspect=a/l:c.isNumber(i)&&(n.aspect=i);const{margin:d}=this.model;if(null!=d)if(c.isNumber(d))n.margin={top:d,right:d,bottom:d,left:d};else if(2==d.length){const[t,e]=d;n.margin={top:t,right:e,bottom:t,left:e}}else{const[t,e,i,s]=d;n.margin={top:t,right:e,bottom:i,left:s}}n.visible=this.model.visible;const{align:u}=this.model;return c.isArray(u)?[n.halign,n.valign]=u:n.halign=n.valign=u,n}_viewport_size(){return a.undisplayed(this.el,(()=>{let t=this.el;for(;t=t.parentElement;){if(t.classList.contains(p.root))continue;if(t==document.body){const{margin:{left:t,right:e,top:i,bottom:s}}=a.extents(document.body);return{width:Math.ceil(document.documentElement.clientWidth-t-e),height:Math.ceil(document.documentElement.clientHeight-i-s)}}const{padding:{left:e,right:i,top:s,bottom:n}}=a.extents(t),{width:o,height:r}=t.getBoundingClientRect();let l=0;for(const _ of t.children){const{height:t}=_.getBoundingClientRect(),{margin:{top:e,bottom:i}}=a.extents(_);l+=t+e+i}const c=Math.ceil(o-e-i),h=Math.ceil(r-s-n-l);if(c>0||h>0)return{width:c>0?c:void 0,height:h>0?h:void 0}}return{}}))}export(t,e=!0){const i="png"==t?"canvas":"svg",s=new m.CanvasLayer(i,e),{width:n,height:o}=this.layout.bbox;s.resize(n,o);for(const r of this.child_views){const i=r.export(t,e),{x:n,y:o}=r.layout.bbox;s.ctx.drawImage(i.canvas,n,o)}return s}serializable_state(){return Object.assign(Object.assign({},super.serializable_state()),{bbox:this.layout.bbox.box,children:this.child_views.map((t=>t.serializable_state()))})}}i.LayoutDOMView=g,g.__name__="LayoutDOMView";class f extends o.Model{constructor(t){super(t)}static init_LayoutDOM(){this.define((t=>{const{Boolean:e,Number:i,String:s,Auto:n,Color:o,Array:a,Tuple:l,Or:c,Null:h,Nullable:_}=t,d=l(i,i),p=l(i,i,i,i);return{width:[_(i),null],height:[_(i),null],min_width:[_(i),null],min_height:[_(i),null],max_width:[_(i),null],max_height:[_(i),null],margin:[_(c(i,d,p)),[0,0,0,0]],width_policy:[c(u.SizingPolicy,n),"auto"],height_policy:[c(u.SizingPolicy,n),"auto"],aspect_ratio:[c(i,n,h),null],sizing_mode:[_(r.SizingMode),null],visible:[e,!0],disabled:[e,!1],align:[c(r.Align,l(r.Align,r.Align)),"start"],background:[_(o),null],css_classes:[a(s),[]]}}))}}i.LayoutDOM=f,f.__name__="LayoutDOM",f.init_LayoutDOM()},function(t,e,i,s,n){s();const o=t(318),r=t(223);class a extends o.BoxView{_update_layout(){const t=this.child_views.map((t=>t.layout));this.layout=new r.Column(t),this.layout.rows=this.model.rows,this.layout.spacing=[this.model.spacing,0],this.layout.set_sizing(this.box_sizing())}}i.ColumnView=a,a.__name__="ColumnView";class l extends o.Box{constructor(t){super(t)}static init_Column(){this.prototype.default_view=a,this.define((({Any:t})=>({rows:[t,"auto"]})))}}i.Column=l,l.__name__="Column",l.init_Column()},function(t,e,i,s,n){s();const o=t(319),r=t(223);class a extends o.LayoutDOMView{connect_signals(){super.connect_signals();const{children:t,rows:e,cols:i,spacing:s}=this.model.properties;this.on_change([t,e,i,s],(()=>this.rebuild()))}get child_models(){return this.model.children.map((([t])=>t))}_update_layout(){this.layout=new r.Grid,this.layout.rows=this.model.rows,this.layout.cols=this.model.cols,this.layout.spacing=this.model.spacing;for(const[t,e,i,s,n]of this.model.children){const o=this._child_views.get(t);this.layout.items.push({layout:o.layout,row:e,col:i,row_span:s,col_span:n})}this.layout.set_sizing(this.box_sizing())}}i.GridBoxView=a,a.__name__="GridBoxView";class l extends o.LayoutDOM{constructor(t){super(t)}static init_GridBox(){this.prototype.default_view=a,this.define((({Any:t,Int:e,Number:i,Tuple:s,Array:n,Ref:r,Or:a,Opt:l})=>({children:[n(s(r(o.LayoutDOM),e,e,l(e),l(e))),[]],rows:[t,"auto"],cols:[t,"auto"],spacing:[a(i,s(i,i)),0]})))}}i.GridBox=l,l.__name__="GridBox",l.init_GridBox()},function(t,e,i,s,n){s();const o=t(319),r=t(221);class a extends o.LayoutDOMView{get child_models(){return[]}_update_layout(){this.layout=new r.ContentBox(this.el),this.layout.set_sizing(this.box_sizing())}}i.HTMLBoxView=a,a.__name__="HTMLBoxView";class l extends o.LayoutDOM{constructor(t){super(t)}}i.HTMLBox=l,l.__name__="HTMLBox"},function(t,e,i,s,n){s();const o=t(53),r=t(319);class a extends o.Model{constructor(t){super(t)}static init_Panel(){this.define((({Boolean:t,String:e,Ref:i})=>({title:[e,""],child:[i(r.LayoutDOM)],closable:[t,!1]})))}}i.Panel=a,a.__name__="Panel",a.init_Panel()},function(t,e,i,s,n){s();const o=t(318),r=t(223);class a extends o.BoxView{_update_layout(){const t=this.child_views.map((t=>t.layout));this.layout=new r.Row(t),this.layout.cols=this.model.cols,this.layout.spacing=[0,this.model.spacing],this.layout.set_sizing(this.box_sizing())}}i.RowView=a,a.__name__="RowView";class l extends o.Box{constructor(t){super(t)}static init_Row(){this.prototype.default_view=a,this.define((({Any:t})=>({cols:[t,"auto"]})))}}i.Row=l,l.__name__="Row",l.init_Row()},function(t,e,i,s,n){s();const o=t(319),r=t(221);class a extends o.LayoutDOMView{get child_models(){return[]}_update_layout(){this.layout=new r.LayoutItem,this.layout.set_sizing(this.box_sizing())}}i.SpacerView=a,a.__name__="SpacerView";class l extends o.LayoutDOM{constructor(t){super(t)}static init_Spacer(){this.prototype.default_view=a}}i.Spacer=l,l.__name__="Spacer",l.init_Spacer()},function(t,e,i,s,n){s();const o=t(1),r=t(221),a=t(43),l=t(9),c=t(20),h=t(319),_=t(323),d=o.__importStar(t(327)),u=d,p=o.__importStar(t(328)),m=p,g=o.__importStar(t(243)),f=g;class b extends h.LayoutDOMView{connect_signals(){super.connect_signals(),this.connect(this.model.properties.tabs.change,(()=>this.rebuild())),this.connect(this.model.properties.active.change,(()=>this.on_active_change()))}styles(){return[...super.styles(),p.default,g.default,d.default]}get child_models(){return this.model.tabs.map((t=>t.child))}_update_layout(){const t=this.model.tabs_location,e="above"==t||"below"==t,{scroll_el:i,headers_el:s}=this;this.header=new class extends r.ContentBox{_measure(t){const n=a.size(i),o=a.children(s).slice(0,3).map((t=>a.size(t))),{width:r,height:c}=super._measure(t);if(e){const e=n.width+l.sum(o.map((t=>t.width)));return{width:t.width!=1/0?t.width:e,height:c}}{const e=n.height+l.sum(o.map((t=>t.height)));return{width:r,height:t.height!=1/0?t.height:e}}}}(this.header_el),e?this.header.set_sizing({width_policy:"fit",height_policy:"fixed"}):this.header.set_sizing({width_policy:"fixed",height_policy:"fit"});let n=1,o=1;switch(t){case"above":n-=1;break;case"below":n+=1;break;case"left":o-=1;break;case"right":o+=1}const c={layout:this.header,row:n,col:o},h=this.child_views.map((t=>({layout:t.layout,row:1,col:1})));this.layout=new r.Grid([c,...h]),this.layout.set_sizing(this.box_sizing())}update_position(){super.update_position(),this.header_el.style.position="absolute",a.position(this.header_el,this.header.bbox);const t=this.model.tabs_location,e="above"==t||"below"==t,i=a.size(this.scroll_el),s=a.scroll_size(this.headers_el);if(e){const{width:t}=this.header.bbox;s.width>t?(this.wrapper_el.style.maxWidth=t-i.width+"px",a.display(this.scroll_el)):(this.wrapper_el.style.maxWidth="",a.undisplay(this.scroll_el))}else{const{height:t}=this.header.bbox;s.height>t?(this.wrapper_el.style.maxHeight=t-i.height+"px",a.display(this.scroll_el)):(this.wrapper_el.style.maxHeight="",a.undisplay(this.scroll_el))}const{child_views:n}=this;for(const r of n)a.hide(r.el);const o=n[this.model.active];null!=o&&a.show(o.el)}render(){super.render();const{active:t}=this.model,e=this.model.tabs_location,i="above"==e||"below"==e,s=this.model.tabs.map(((e,i)=>{const s=a.div({class:[u.tab,i==t?u.active:null]},e.title);if(s.addEventListener("click",(t=>{t.target==t.currentTarget&&this.change_active(i)})),e.closable){const t=a.div({class:u.close});t.addEventListener("click",(t=>{if(t.target==t.currentTarget){this.model.tabs=l.remove_at(this.model.tabs,i);const t=this.model.tabs.length;this.model.active>t-1&&(this.model.active=t-1)}})),s.appendChild(t)}return s}));this.headers_el=a.div({class:[u.headers]},s),this.wrapper_el=a.div({class:u.headers_wrapper},this.headers_el);const n=a.div({class:[m.btn,m.btn_default],disabled:""},a.div({class:[f.caret,u.left]})),o=a.div({class:[m.btn,m.btn_default]},a.div({class:[f.caret,u.right]}));let r=0;const c=t=>()=>{const e=this.model.tabs.length;r="left"==t?Math.max(r-1,0):Math.min(r+1,e-1),0==r?n.setAttribute("disabled",""):n.removeAttribute("disabled"),r==e-1?o.setAttribute("disabled",""):o.removeAttribute("disabled");const s=a.children(this.headers_el).slice(0,r).map((t=>t.getBoundingClientRect()));if(i){const t=-l.sum(s.map((t=>t.width)));this.headers_el.style.left=`${t}px`}else{const t=-l.sum(s.map((t=>t.height)));this.headers_el.style.top=`${t}px`}};n.addEventListener("click",c("left")),o.addEventListener("click",c("right")),this.scroll_el=a.div({class:m.btn_group},n,o),this.header_el=a.div({class:[u.tabs_header,u[e]]},this.scroll_el,this.wrapper_el),this.el.appendChild(this.header_el)}change_active(t){t!=this.model.active&&(this.model.active=t)}on_active_change(){const t=this.model.active,e=a.children(this.headers_el);for(const s of e)s.classList.remove(u.active);e[t].classList.add(u.active);const{child_views:i}=this;for(const s of i)a.hide(s.el);a.show(i[t].el)}}i.TabsView=b,b.__name__="TabsView";class v extends h.LayoutDOM{constructor(t){super(t)}static init_Tabs(){this.prototype.default_view=b,this.define((({Int:t,Array:e,Ref:i})=>({tabs:[e(i(_.Panel)),[]],tabs_location:[c.Location,"above"],active:[t,0]})))}}i.Tabs=v,v.__name__="Tabs",v.init_Tabs()},function(t,e,i,s,n){s(),i.root="bk-root",i.tabs_header="bk-tabs-header",i.btn_group="bk-btn-group",i.btn="bk-btn",i.headers_wrapper="bk-headers-wrapper",i.above="bk-above",i.right="bk-right",i.below="bk-below",i.left="bk-left",i.headers="bk-headers",i.tab="bk-tab",i.active="bk-active",i.close="bk-close",i.default='.bk-root .bk-tabs-header{display:flex;display:-webkit-flex;flex-wrap:nowrap;-webkit-flex-wrap:nowrap;align-items:center;-webkit-align-items:center;overflow:hidden;user-select:none;-ms-user-select:none;-moz-user-select:none;-webkit-user-select:none;}.bk-root .bk-tabs-header .bk-btn-group{height:auto;margin-right:5px;}.bk-root .bk-tabs-header .bk-btn-group > .bk-btn{flex-grow:0;-webkit-flex-grow:0;height:auto;padding:4px 4px;}.bk-root .bk-tabs-header .bk-headers-wrapper{flex-grow:1;-webkit-flex-grow:1;overflow:hidden;color:#666666;}.bk-root .bk-tabs-header.bk-above .bk-headers-wrapper{border-bottom:1px solid #e6e6e6;}.bk-root .bk-tabs-header.bk-right .bk-headers-wrapper{border-left:1px solid #e6e6e6;}.bk-root .bk-tabs-header.bk-below .bk-headers-wrapper{border-top:1px solid #e6e6e6;}.bk-root .bk-tabs-header.bk-left .bk-headers-wrapper{border-right:1px solid #e6e6e6;}.bk-root .bk-tabs-header.bk-above,.bk-root .bk-tabs-header.bk-below{flex-direction:row;-webkit-flex-direction:row;}.bk-root .bk-tabs-header.bk-above .bk-headers,.bk-root .bk-tabs-header.bk-below .bk-headers{flex-direction:row;-webkit-flex-direction:row;}.bk-root .bk-tabs-header.bk-left,.bk-root .bk-tabs-header.bk-right{flex-direction:column;-webkit-flex-direction:column;}.bk-root .bk-tabs-header.bk-left .bk-headers,.bk-root .bk-tabs-header.bk-right .bk-headers{flex-direction:column;-webkit-flex-direction:column;}.bk-root .bk-tabs-header .bk-headers{position:relative;display:flex;display:-webkit-flex;flex-wrap:nowrap;-webkit-flex-wrap:nowrap;align-items:center;-webkit-align-items:center;}.bk-root .bk-tabs-header .bk-tab{padding:4px 8px;border:solid transparent;white-space:nowrap;cursor:pointer;}.bk-root .bk-tabs-header .bk-tab:hover{background-color:#f2f2f2;}.bk-root .bk-tabs-header .bk-tab.bk-active{color:#4d4d4d;background-color:white;border-color:#e6e6e6;}.bk-root .bk-tabs-header .bk-tab .bk-close{margin-left:10px;}.bk-root .bk-tabs-header.bk-above .bk-tab{border-width:3px 1px 0px 1px;border-radius:4px 4px 0 0;}.bk-root .bk-tabs-header.bk-right .bk-tab{border-width:1px 3px 1px 0px;border-radius:0 4px 4px 0;}.bk-root .bk-tabs-header.bk-below .bk-tab{border-width:0px 1px 3px 1px;border-radius:0 0 4px 4px;}.bk-root .bk-tabs-header.bk-left .bk-tab{border-width:1px 0px 1px 3px;border-radius:4px 0 0 4px;}.bk-root .bk-close{display:inline-block;width:10px;height:10px;vertical-align:middle;background-image:url(\'data:image/svg+xml;utf8,      <svg viewPort="0 0 10 10" version="1.1" xmlns="http://www.w3.org/2000/svg">        <line x1="1" y1="9" x2="9" y2="1" stroke="gray" stroke-width="2"/>        <line x1="1" y1="1" x2="9" y2="9" stroke="gray" stroke-width="2"/>      </svg>\');}.bk-root .bk-close:hover{background-image:url(\'data:image/svg+xml;utf8,      <svg viewPort="0 0 10 10" version="1.1" xmlns="http://www.w3.org/2000/svg">        <line x1="1" y1="9" x2="9" y2="1" stroke="red" stroke-width="2"/>        <line x1="1" y1="1" x2="9" y2="9" stroke="red" stroke-width="2"/>      </svg>\');}'},function(t,e,i,s,n){s(),i.root="bk-root",i.btn="bk-btn",i.active="bk-active",i.btn_default="bk-btn-default",i.btn_primary="bk-btn-primary",i.btn_success="bk-btn-success",i.btn_warning="bk-btn-warning",i.btn_danger="bk-btn-danger",i.btn_light="bk-btn-light",i.btn_group="bk-btn-group",i.dropdown_toggle="bk-dropdown-toggle",i.default=".bk-root .bk-btn{height:100%;display:inline-block;text-align:center;vertical-align:middle;white-space:nowrap;cursor:pointer;padding:6px 12px;font-size:12px;border:1px solid transparent;border-radius:4px;outline:0;user-select:none;-ms-user-select:none;-moz-user-select:none;-webkit-user-select:none;}.bk-root .bk-btn:hover,.bk-root .bk-btn:focus{text-decoration:none;}.bk-root .bk-btn:active,.bk-root .bk-btn.bk-active{background-image:none;box-shadow:inset 0 3px 5px rgba(0, 0, 0, 0.125);}.bk-root .bk-btn[disabled]{cursor:not-allowed;pointer-events:none;opacity:0.65;box-shadow:none;}.bk-root .bk-btn-default{color:#333;background-color:#fff;border-color:#ccc;}.bk-root .bk-btn-default:hover{background-color:#f5f5f5;border-color:#b8b8b8;}.bk-root .bk-btn-default.bk-active{background-color:#ebebeb;border-color:#adadad;}.bk-root .bk-btn-default[disabled],.bk-root .bk-btn-default[disabled]:hover,.bk-root .bk-btn-default[disabled]:focus,.bk-root .bk-btn-default[disabled]:active,.bk-root .bk-btn-default[disabled].bk-active{background-color:#e6e6e6;border-color:#ccc;}.bk-root .bk-btn-primary{color:#fff;background-color:#428bca;border-color:#357ebd;}.bk-root .bk-btn-primary:hover{background-color:#3681c1;border-color:#2c699e;}.bk-root .bk-btn-primary.bk-active{background-color:#3276b1;border-color:#285e8e;}.bk-root .bk-btn-primary[disabled],.bk-root .bk-btn-primary[disabled]:hover,.bk-root .bk-btn-primary[disabled]:focus,.bk-root .bk-btn-primary[disabled]:active,.bk-root .bk-btn-primary[disabled].bk-active{background-color:#506f89;border-color:#357ebd;}.bk-root .bk-btn-success{color:#fff;background-color:#5cb85c;border-color:#4cae4c;}.bk-root .bk-btn-success:hover{background-color:#4eb24e;border-color:#409240;}.bk-root .bk-btn-success.bk-active{background-color:#47a447;border-color:#398439;}.bk-root .bk-btn-success[disabled],.bk-root .bk-btn-success[disabled]:hover,.bk-root .bk-btn-success[disabled]:focus,.bk-root .bk-btn-success[disabled]:active,.bk-root .bk-btn-success[disabled].bk-active{background-color:#667b66;border-color:#4cae4c;}.bk-root .bk-btn-warning{color:#fff;background-color:#f0ad4e;border-color:#eea236;}.bk-root .bk-btn-warning:hover{background-color:#eea43b;border-color:#e89014;}.bk-root .bk-btn-warning.bk-active{background-color:#ed9c28;border-color:#d58512;}.bk-root .bk-btn-warning[disabled],.bk-root .bk-btn-warning[disabled]:hover,.bk-root .bk-btn-warning[disabled]:focus,.bk-root .bk-btn-warning[disabled]:active,.bk-root .bk-btn-warning[disabled].bk-active{background-color:#c89143;border-color:#eea236;}.bk-root .bk-btn-danger{color:#fff;background-color:#d9534f;border-color:#d43f3a;}.bk-root .bk-btn-danger:hover{background-color:#d5433e;border-color:#bd2d29;}.bk-root .bk-btn-danger.bk-active{background-color:#d2322d;border-color:#ac2925;}.bk-root .bk-btn-danger[disabled],.bk-root .bk-btn-danger[disabled]:hover,.bk-root .bk-btn-danger[disabled]:focus,.bk-root .bk-btn-danger[disabled]:active,.bk-root .bk-btn-danger[disabled].bk-active{background-color:#a55350;border-color:#d43f3a;}.bk-root .bk-btn-light{color:#333;background-color:#fff;border-color:#ccc;border-color:transparent;}.bk-root .bk-btn-light:hover{background-color:#f5f5f5;border-color:#b8b8b8;}.bk-root .bk-btn-light.bk-active{background-color:#ebebeb;border-color:#adadad;}.bk-root .bk-btn-light[disabled],.bk-root .bk-btn-light[disabled]:hover,.bk-root .bk-btn-light[disabled]:focus,.bk-root .bk-btn-light[disabled]:active,.bk-root .bk-btn-light[disabled].bk-active{background-color:#e6e6e6;border-color:#ccc;}.bk-root .bk-btn-group{height:100%;display:flex;display:-webkit-flex;flex-wrap:nowrap;-webkit-flex-wrap:nowrap;align-items:center;-webkit-align-items:center;flex-direction:row;-webkit-flex-direction:row;}.bk-root .bk-btn-group > .bk-btn{flex-grow:1;-webkit-flex-grow:1;}.bk-root .bk-btn-group > .bk-btn + .bk-btn{margin-left:-1px;}.bk-root .bk-btn-group > .bk-btn:first-child:not(:last-child){border-bottom-right-radius:0;border-top-right-radius:0;}.bk-root .bk-btn-group > .bk-btn:not(:first-child):last-child{border-bottom-left-radius:0;border-top-left-radius:0;}.bk-root .bk-btn-group > .bk-btn:not(:first-child):not(:last-child){border-radius:0;}.bk-root .bk-btn-group .bk-dropdown-toggle{flex:0 0 0;-webkit-flex:0 0 0;padding:6px 6px;}"},function(t,e,i,s,n){s();const o=t(320);class r extends o.ColumnView{}i.WidgetBoxView=r,r.__name__="WidgetBoxView";class a extends o.Column{constructor(t){super(t)}static init_WidgetBox(){this.prototype.default_view=r}}i.WidgetBox=a,a.__name__="WidgetBox",a.init_WidgetBox()},function(t,e,i,s,n){s(),n("MapOptions",t(331).MapOptions),n("GMapOptions",t(331).GMapOptions),n("GMapPlot",t(331).GMapPlot),n("Plot",t(332).Plot)},function(t,e,i,s,n){s();const o=t(332),r=t(53),a=t(156),l=t(337);n("GMapPlotView",l.GMapPlotView);class c extends r.Model{constructor(t){super(t)}static init_MapOptions(){this.define((({Int:t,Number:e})=>({lat:[e],lng:[e],zoom:[t,12]})))}}i.MapOptions=c,c.__name__="MapOptions",c.init_MapOptions();class h extends c{constructor(t){super(t)}static init_GMapOptions(){this.define((({Boolean:t,Int:e,String:i})=>({map_type:[i,"roadmap"],scale_control:[t,!1],styles:[i],tilt:[e,45]})))}}i.GMapOptions=h,h.__name__="GMapOptions",h.init_GMapOptions();class _ extends o.Plot{constructor(t){super(t),this.use_map=!0}static init_GMapPlot(){this.prototype.default_view=l.GMapPlotView,this.define((({String:t,Ref:e})=>({map_options:[e(h)],api_key:[t],api_version:[t,"3.43"]}))),this.override({x_range:()=>new a.Range1d,y_range:()=>new a.Range1d})}}i.GMapPlot=_,_.__name__="GMapPlot",_.init_GMapPlot()},function(t,e,i,s,n){s();const o=t(1),r=o.__importStar(t(48)),a=o.__importStar(t(18)),l=t(15),c=t(20),h=t(9),_=t(13),d=t(8),u=t(319),p=t(163),m=t(316),g=t(40),f=t(138),b=t(218),v=t(235),y=t(105),x=t(146),w=t(130),A=t(41),k=t(62),S=t(61),T=t(159),C=t(333);n("PlotView",C.PlotView);class M extends u.LayoutDOM{constructor(t){super(t),this.use_map=!1}static init_Plot(){this.prototype.default_view=C.PlotView,this.mixins([["outline_",r.Line],["background_",r.Fill],["border_",r.Fill]]),this.define((({Boolean:t,Number:e,String:i,Array:s,Dict:n,Or:o,Ref:r,Null:l,Nullable:h})=>({toolbar:[r(v.Toolbar),()=>new v.Toolbar],toolbar_location:[h(c.Location),"right"],toolbar_sticky:[t,!0],plot_width:[a.Alias("width")],plot_height:[a.Alias("height")],frame_width:[h(e),null],frame_height:[h(e),null],title:[o(r(f.Title),i,l),()=>new f.Title({text:""})],title_location:[h(c.Location),"above"],above:[s(o(r(g.Annotation),r(p.Axis))),[]],below:[s(o(r(g.Annotation),r(p.Axis))),[]],left:[s(o(r(g.Annotation),r(p.Axis))),[]],right:[s(o(r(g.Annotation),r(p.Axis))),[]],center:[s(o(r(g.Annotation),r(m.Grid))),[]],renderers:[s(r(A.Renderer)),[]],x_range:[r(y.Range),()=>new T.DataRange1d],extra_x_ranges:[n(r(y.Range)),{}],y_range:[r(y.Range),()=>new T.DataRange1d],extra_y_ranges:[n(r(y.Range)),{}],x_scale:[r(x.Scale),()=>new b.LinearScale],y_scale:[r(x.Scale),()=>new b.LinearScale],lod_factor:[e,10],lod_interval:[e,300],lod_threshold:[h(e),2e3],lod_timeout:[e,500],hidpi:[t,!0],output_backend:[c.OutputBackend,"canvas"],min_border:[h(e),5],min_border_top:[h(e),null],min_border_left:[h(e),null],min_border_bottom:[h(e),null],min_border_right:[h(e),null],inner_width:[e,0],inner_height:[e,0],outer_width:[e,0],outer_height:[e,0],match_aspect:[t,!1],aspect_scale:[e,1],reset_policy:[c.ResetPolicy,"standard"]}))),this.override({width:600,height:600,outline_line_color:"#e5e5e5",border_fill_color:"#ffffff",background_fill_color:"#ffffff"})}_doc_attached(){super._doc_attached(),this._push_changes([[this.properties.inner_height,null,this.inner_height],[this.properties.inner_width,null,this.inner_width]])}initialize(){super.initialize(),this.reset=new l.Signal0(this,"reset");for(const t of _.values(this.extra_x_ranges).concat(this.x_range)){let e=t.plots;d.isArray(e)&&(e=e.concat(this),t.setv({plots:e},{silent:!0}))}for(const t of _.values(this.extra_y_ranges).concat(this.y_range)){let e=t.plots;d.isArray(e)&&(e=e.concat(this),t.setv({plots:e},{silent:!0}))}}add_layout(t,e="center"){const i=this.properties[e].get_value();this.setv({[e]:[...i,t]})}remove_layout(t){const e=e=>{h.remove_by(e,(e=>e==t))};e(this.left),e(this.right),e(this.above),e(this.below),e(this.center)}get data_renderers(){return this.renderers.filter((t=>t instanceof k.DataRenderer))}add_renderers(...t){this.renderers=this.renderers.concat(t)}add_glyph(t,e=new w.ColumnDataSource,i={}){const s=new S.GlyphRenderer(Object.assign(Object.assign({},i),{data_source:e,glyph:t}));return this.add_renderers(s),s}add_tools(...t){this.toolbar.tools=this.toolbar.tools.concat(t)}get panels(){return[...this.side_panels,...this.center]}get side_panels(){const{above:t,below:e,left:i,right:s}=this;return h.concat([t,e,i,s])}}i.Plot=M,M.__name__="Plot",M.init_Plot()},function(t,e,i,s,n){s();const o=t(1),r=t(144),a=t(262),l=t(319),c=t(40),h=t(138),_=t(163),d=t(234),u=t(264),p=t(122),m=t(45),g=t(19),f=t(334),b=t(8),v=t(9),y=t(249),x=t(222),w=t(225),A=t(223),k=t(140),S=t(99),T=t(335),C=t(336),M=t(28);class E extends l.LayoutDOMView{constructor(){super(...arguments),this._outer_bbox=new S.BBox,this._inner_bbox=new S.BBox,this._needs_paint=!0,this._needs_layout=!1,this._invalidated_painters=new Set,this._invalidate_all=!0}get canvas(){return this.canvas_view}get state(){return this._state_manager}set invalidate_dataranges(t){this._range_manager.invalidate_dataranges=t}renderer_view(t){const e=this.renderer_views.get(t);if(null==e)for(const[,i]of this.renderer_views){const e=i.renderer_view(t);if(null!=e)return e}return e}get is_paused(){return null!=this._is_paused&&0!==this._is_paused}get child_models(){return[]}pause(){null==this._is_paused?this._is_paused=1:this._is_paused+=1}unpause(t=!1){if(null==this._is_paused)throw new Error("wasn't paused");this._is_paused-=1,0!=this._is_paused||t||this.request_paint("everything")}request_render(){this.request_paint("everything")}request_paint(t){this.invalidate_painters(t),this.schedule_paint()}invalidate_painters(t){if("everything"==t)this._invalidate_all=!0;else if(b.isArray(t))for(const e of t)this._invalidated_painters.add(e);else this._invalidated_painters.add(t)}schedule_paint(){if(!this.is_paused){const t=this.throttled_paint();this._ready=this._ready.then((()=>t))}}request_layout(){this._needs_layout=!0,this.request_paint("everything")}reset(){"standard"==this.model.reset_policy&&(this.state.clear(),this.reset_range(),this.reset_selection()),this.model.trigger_event(new u.Reset)}remove(){p.remove_views(this.renderer_views),p.remove_views(this.tool_views),this.canvas_view.remove(),super.remove()}render(){super.render(),this.el.appendChild(this.canvas_view.el),this.canvas_view.render()}initialize(){this.pause(),super.initialize(),this.lod_started=!1,this.visuals=new m.Visuals(this),this._initial_state={selection:new Map,dimensions:{width:0,height:0}},this.visibility_callbacks=[],this.renderer_views=new Map,this.tool_views=new Map,this.frame=new r.CartesianFrame(this.model.x_scale,this.model.y_scale,this.model.x_range,this.model.y_range,this.model.extra_x_ranges,this.model.extra_y_ranges),this._range_manager=new T.RangeManager(this),this._state_manager=new C.StateManager(this,this._initial_state),this.throttled_paint=f.throttle((()=>this.repaint()),1e3/60);const{title_location:t,title:e}=this.model;null!=t&&null!=e&&(this._title=e instanceof h.Title?e:new h.Title({text:e}));const{toolbar_location:i,toolbar:s}=this.model;null!=i&&null!=s&&(this._toolbar=new d.ToolbarPanel({toolbar:s}),s.toolbar_location=i)}async lazy_initialize(){await super.lazy_initialize();const{hidpi:t,output_backend:e}=this.model,i=new a.Canvas({hidpi:t,output_backend:e});this.canvas_view=await p.build_view(i,{parent:this}),this.canvas_view.plot_views=[this],await this.build_renderer_views(),await this.build_tool_views(),this._range_manager.update_dataranges(),this.unpause(!0),g.logger.debug("PlotView initialized")}_width_policy(){return null==this.model.frame_width?super._width_policy():"min"}_height_policy(){return null==this.model.frame_height?super._height_policy():"min"}_update_layout(){var t,e,i,s,n;this.layout=new w.BorderLayout,this.layout.set_sizing(this.box_sizing());const o=v.copy(this.model.above),r=v.copy(this.model.below),a=v.copy(this.model.left),l=v.copy(this.model.right),_=t=>{switch(t){case"above":return o;case"below":return r;case"left":return a;case"right":return l}},{title_location:u,title:p}=this.model;null!=u&&null!=p&&_(u).push(this._title);const{toolbar_location:m,toolbar:g}=this.model;if(null!=m&&null!=g){const t=_(m);let e=!0;if(this.model.toolbar_sticky)for(let i=0;i<t.length;i++){const s=t[i];if(s instanceof h.Title){t[i]="above"==m||"below"==m?[s,this._toolbar]:[this._toolbar,s],e=!1;break}}e&&t.push(this._toolbar)}const f=(t,e)=>{var i;const s=this.renderer_view(e);return s.panel=new k.Panel(t),null===(i=s.update_layout)||void 0===i||i.call(s),s.layout},y=(t,e)=>{const i="above"==t||"below"==t,s=[];for(const n of e)if(b.isArray(n)){const e=n.map((e=>{const s=f(t,e);if(e instanceof d.ToolbarPanel){const t=i?"width_policy":"height_policy";s.set_sizing(Object.assign(Object.assign({},s.sizing),{[t]:"min"}))}return s}));let o;i?(o=new A.Row(e),o.set_sizing({width_policy:"max",height_policy:"min"})):(o=new A.Column(e),o.set_sizing({width_policy:"min",height_policy:"max"})),o.absolute=!0,s.push(o)}else s.push(f(t,n));return s},S=null!==(t=this.model.min_border)&&void 0!==t?t:0;this.layout.min_border={left:null!==(e=this.model.min_border_left)&&void 0!==e?e:S,top:null!==(i=this.model.min_border_top)&&void 0!==i?i:S,right:null!==(s=this.model.min_border_right)&&void 0!==s?s:S,bottom:null!==(n=this.model.min_border_bottom)&&void 0!==n?n:S};const T=new x.NodeLayout,C=new x.VStack,M=new x.VStack,E=new x.HStack,z=new x.HStack;T.absolute=!0,C.absolute=!0,M.absolute=!0,E.absolute=!0,z.absolute=!0,T.children=this.model.center.filter((t=>t instanceof c.Annotation)).map((t=>{var e;const i=this.renderer_view(t);return null===(e=i.update_layout)||void 0===e||e.call(i),i.layout})).filter((t=>null!=t));const{frame_width:R,frame_height:B}=this.model;T.set_sizing(Object.assign(Object.assign({},null!=R?{width_policy:"fixed",width:R}:{width_policy:"fit"}),null!=B?{height_policy:"fixed",height:B}:{height_policy:"fit"})),T.on_resize((t=>this.frame.set_geometry(t))),C.children=v.reversed(y("above",o)),M.children=y("below",r),E.children=v.reversed(y("left",a)),z.children=y("right",l),C.set_sizing({width_policy:"fit",height_policy:"min"}),M.set_sizing({width_policy:"fit",height_policy:"min"}),E.set_sizing({width_policy:"min",height_policy:"fit"}),z.set_sizing({width_policy:"min",height_policy:"fit"}),this.layout.center_panel=T,this.layout.top_panel=C,this.layout.bottom_panel=M,this.layout.left_panel=E,this.layout.right_panel=z}get axis_views(){const t=[];for(const[,e]of this.renderer_views)e instanceof _.AxisView&&t.push(e);return t}set_toolbar_visibility(t){for(const e of this.visibility_callbacks)e(t)}update_range(t,e){this.pause(),this._range_manager.update(t,e),this.unpause()}reset_range(){this.update_range(null)}get_selection(){const t=new Map;for(const e of this.model.data_renderers){const{selected:i}=e.selection_manager.source;t.set(e,i)}return t}update_selection(t){for(const e of this.model.data_renderers){const i=e.selection_manager.source;if(null!=t){const s=t.get(e);null!=s&&i.selected.update(s,!0)}else i.selection_manager.clear()}}reset_selection(){this.update_selection(null)}_invalidate_layout(){(()=>{var t;for(const e of this.model.side_panels){const i=this.renderer_views.get(e);if(null===(t=i.layout)||void 0===t?void 0:t.has_size_changed())return this.invalidate_painters(i),!0}return!1})()&&this.root.compute_layout()}get_renderer_views(){return this.computed_renderers.map((t=>this.renderer_views.get(t)))}*_compute_renderers(){const{above:t,below:e,left:i,right:s,center:n,renderers:o}=this.model;yield*o,yield*t,yield*e,yield*i,yield*s,yield*n,null!=this._title&&(yield this._title),null!=this._toolbar&&(yield this._toolbar);for(const r of this.model.toolbar.tools)null!=r.overlay&&(yield r.overlay),yield*r.synthetic_renderers}async build_renderer_views(){this.computed_renderers=[...this._compute_renderers()],await p.build_views(this.renderer_views,this.computed_renderers,{parent:this})}async build_tool_views(){const t=this.model.toolbar.tools;(await p.build_views(this.tool_views,t,{parent:this})).map((t=>this.canvas_view.ui_event_bus.register_tool(t)))}connect_signals(){super.connect_signals();const{x_ranges:t,y_ranges:e}=this.frame;for(const[,l]of t)this.connect(l.change,(()=>{this._needs_layout=!0,this.request_paint("everything")}));for(const[,l]of e)this.connect(l.change,(()=>{this._needs_layout=!0,this.request_paint("everything")}));const{above:i,below:s,left:n,right:o,center:r,renderers:a}=this.model.properties;this.on_change([i,s,n,o,r,a],(async()=>await this.build_renderer_views())),this.connect(this.model.toolbar.properties.tools.change,(async()=>{await this.build_renderer_views(),await this.build_tool_views()})),this.connect(this.model.change,(()=>this.request_paint("everything"))),this.connect(this.model.reset,(()=>this.reset()))}has_finished(){if(!super.has_finished())return!1;if(this.model.visible)for(const[,t]of this.renderer_views)if(!t.has_finished())return!1;return!0}after_layout(){var t;super.after_layout();for(const[,i]of this.renderer_views)i instanceof c.AnnotationView&&(null===(t=i.after_layout)||void 0===t||t.call(i));if(this._needs_layout=!1,this.model.setv({inner_width:Math.round(this.frame.bbox.width),inner_height:Math.round(this.frame.bbox.height),outer_width:Math.round(this.layout.bbox.width),outer_height:Math.round(this.layout.bbox.height)},{no_change:!0}),!1!==this.model.match_aspect&&(this.pause(),this._range_manager.update_dataranges(),this.unpause(!0)),!this._outer_bbox.equals(this.layout.bbox)){const{width:t,height:e}=this.layout.bbox;this.canvas_view.resize(t,e),this._outer_bbox=this.layout.bbox,this._invalidate_all=!0,this._needs_paint=!0}const{inner_bbox:e}=this.layout;this._inner_bbox.equals(e)||(this._inner_bbox=e,this._needs_paint=!0),this._needs_paint&&this.paint()}repaint(){this._needs_layout&&this._invalidate_layout(),this.paint()}paint(){var t;if(this.is_paused||!this.model.visible)return;g.logger.trace(`PlotView.paint() for ${this.model.id}`);const{document:e}=this.model;if(null!=e){const t=e.interactive_duration();t>=0&&t<this.model.lod_interval?setTimeout((()=>{e.interactive_duration()>this.model.lod_timeout&&e.interactive_stop(),this.request_paint("everything")}),this.model.lod_timeout):e.interactive_stop()}this._range_manager.invalidate_dataranges&&(this._range_manager.update_dataranges(),this._invalidate_layout());let i=!1,s=!1;if(this._invalidate_all)i=!0,s=!0;else for(const a of this._invalidated_painters){const{level:t}=a.model;if("overlay"!=t?i=!0:s=!0,i&&s)break}this._invalidated_painters.clear(),this._invalidate_all=!1;const n=[this.frame.bbox.left,this.frame.bbox.top,this.frame.bbox.width,this.frame.bbox.height],{primary:o,overlays:r}=this.canvas_view;i&&(o.prepare(),this.canvas_view.prepare_webgl(n),this._map_hook(o.ctx,n),this._paint_empty(o.ctx,n),this._paint_outline(o.ctx,n),this._paint_levels(o.ctx,"image",n,!0),this._paint_levels(o.ctx,"underlay",n,!0),this._paint_levels(o.ctx,"glyph",n,!0),this._paint_levels(o.ctx,"guide",n,!1),this._paint_levels(o.ctx,"annotation",n,!1),o.finish()),(s||M.settings.wireframe)&&(r.prepare(),this._paint_levels(r.ctx,"overlay",n,!1),M.settings.wireframe&&this._paint_layout(r.ctx,this.layout),r.finish()),null==this._initial_state.range&&(this._initial_state.range=null!==(t=this._range_manager.compute_initial())&&void 0!==t?t:void 0),this._needs_paint=!1}_paint_levels(t,e,i,s){for(const n of this.computed_renderers){if(n.level!=e)continue;const o=this.renderer_views.get(n);t.save(),(s||o.needs_clip)&&(t.beginPath(),t.rect(...i),t.clip()),o.render(),t.restore(),o.has_webgl&&o.needs_webgl_blit&&this.canvas_view.blit_webgl(t)}}_paint_layout(t,e){const{x:i,y:s,width:n,height:o}=e.bbox;t.strokeStyle="blue",t.strokeRect(i,s,n,o);for(const r of e)t.save(),e.absolute||t.translate(i,s),this._paint_layout(t,r),t.restore()}_map_hook(t,e){}_paint_empty(t,e){const[i,s,n,o]=[0,0,this.layout.bbox.width,this.layout.bbox.height],[r,a,l,c]=e;this.visuals.border_fill.doit&&(this.visuals.border_fill.set_value(t),t.fillRect(i,s,n,o),t.clearRect(r,a,l,c)),this.visuals.background_fill.doit&&(this.visuals.background_fill.set_value(t),t.fillRect(r,a,l,c))}_paint_outline(t,e){if(this.visuals.outline_line.doit){t.save(),this.visuals.outline_line.set_value(t);let[i,s,n,o]=e;i+n==this.layout.bbox.width&&(n-=1),s+o==this.layout.bbox.height&&(o-=1),t.strokeRect(i,s,n,o),t.restore()}}to_blob(){return this.canvas_view.to_blob()}export(t,e=!0){const i="png"==t?"canvas":"svg",s=new y.CanvasLayer(i,e),{width:n,height:o}=this.layout.bbox;s.resize(n,o);const{canvas:r}=this.canvas_view.compose();return s.ctx.drawImage(r,0,0),s}serializable_state(){const t=super.serializable_state(),{children:e}=t,i=o.__rest(t,["children"]),s=this.get_renderer_views().map((t=>t.serializable_state())).filter((t=>null!=t.bbox));return Object.assign(Object.assign({},i),{children:[...null!=e?e:[],...s]})}}i.PlotView=E,E.__name__="PlotView"},function(t,e,i,s,n){s(),i.throttle=function(t,e){let i=null,s=0,n=!1;return function(){return new Promise(((o,r)=>{const a=function(){s=Date.now(),i=null,n=!1;try{t(),o()}catch(t){r(t)}},l=Date.now(),c=e-(l-s);c<=0&&!n?(null!=i&&clearTimeout(i),n=!0,requestAnimationFrame(a)):i||n?o():i=setTimeout((()=>requestAnimationFrame(a)),c)}))}}},function(t,e,i,s,n){s();const o=t(159),r=t(19);class a{constructor(t){this.parent=t,this.invalidate_dataranges=!0}get frame(){return this.parent.frame}update(t,e){const{x_ranges:i,y_ranges:s}=this.frame;if(null==t){for(const[,t]of i)t.reset();for(const[,t]of s)t.reset();this.update_dataranges()}else{const n=[];for(const[e,s]of i)n.push([s,t.xrs.get(e)]);for(const[e,i]of s)n.push([i,t.yrs.get(e)]);(null==e?void 0:e.scrolling)&&this._update_ranges_together(n),this._update_ranges_individually(n,e)}}reset(){this.update(null)}update_dataranges(){const t=new Map,e=new Map;let i=!1;for(const[,r]of this.frame.x_ranges)r instanceof o.DataRange1d&&"log"==r.scale_hint&&(i=!0);for(const[,r]of this.frame.y_ranges)r instanceof o.DataRange1d&&"log"==r.scale_hint&&(i=!0);for(const o of this.parent.model.data_renderers){const s=this.parent.renderer_view(o);if(null==s)continue;const n=s.glyph_view.bounds();if(null!=n&&t.set(o,n),i){const t=s.glyph_view.log_bounds();null!=t&&e.set(o,t)}}let s=!1,n=!1;const{width:a,height:l}=this.frame.bbox;let c;!1!==this.parent.model.match_aspect&&0!=a&&0!=l&&(c=1/this.parent.model.aspect_scale*(a/l));for(const[,r]of this.frame.x_ranges){if(r instanceof o.DataRange1d){const i="log"==r.scale_hint?e:t;r.update(i,0,this.parent.model,c),r.follow&&(s=!0)}null!=r.bounds&&(n=!0)}for(const[,r]of this.frame.y_ranges){if(r instanceof o.DataRange1d){const i="log"==r.scale_hint?e:t;r.update(i,1,this.parent.model,c),r.follow&&(s=!0)}null!=r.bounds&&(n=!0)}if(s&&n){r.logger.warn("Follow enabled so bounds are unset.");for(const[,t]of this.frame.x_ranges)t.bounds=null;for(const[,t]of this.frame.y_ranges)t.bounds=null}this.invalidate_dataranges=!1}compute_initial(){let t=!0;const{x_ranges:e,y_ranges:i}=this.frame,s=new Map,n=new Map;for(const[o,r]of e){const{start:e,end:i}=r;if(null==e||null==i||isNaN(e+i)){t=!1;break}s.set(o,{start:e,end:i})}if(t)for(const[o,r]of i){const{start:e,end:i}=r;if(null==e||null==i||isNaN(e+i)){t=!1;break}n.set(o,{start:e,end:i})}return t?{xrs:s,yrs:n}:(r.logger.warn("could not set initial ranges"),null)}_update_ranges_together(t){let e=1;for(const[i,s]of t)e=Math.min(e,this._get_weight_to_constrain_interval(i,s));if(e<1)for(const[i,s]of t)s.start=e*s.start+(1-e)*i.start,s.end=e*s.end+(1-e)*i.end}_update_ranges_individually(t,e){const i=!!(null==e?void 0:e.panning),s=!!(null==e?void 0:e.scrolling);let n=!1;for(const[o,r]of t){if(!s){const t=this._get_weight_to_constrain_interval(o,r);t<1&&(r.start=t*r.start+(1-t)*o.start,r.end=t*r.end+(1-t)*o.end)}if(null!=o.bounds&&"auto"!=o.bounds){const[t,e]=o.bounds,a=Math.abs(r.end-r.start);o.is_reversed?(null!=t&&t>=r.end&&(n=!0,r.end=t,(i||s)&&(r.start=t+a)),null!=e&&e<=r.start&&(n=!0,r.start=e,(i||s)&&(r.end=e-a))):(null!=t&&t>=r.start&&(n=!0,r.start=t,(i||s)&&(r.end=t+a)),null!=e&&e<=r.end&&(n=!0,r.end=e,(i||s)&&(r.start=e-a)))}}if(!(s&&n&&(null==e?void 0:e.maintain_focus)))for(const[o,r]of t)o.have_updated_interactively=!0,o.start==r.start&&o.end==r.end||o.setv(r)}_get_weight_to_constrain_interval(t,e){const{min_interval:i}=t;let{max_interval:s}=t;if(null!=t.bounds&&"auto"!=t.bounds){const[e,i]=t.bounds;if(null!=e&&null!=i){const t=Math.abs(i-e);s=null!=s?Math.min(s,t):t}}let n=1;if(null!=i||null!=s){const o=Math.abs(t.end-t.start),r=Math.abs(e.end-e.start);null!=i&&i>0&&r<i&&(n=(o-i)/(o-r)),null!=s&&s>0&&r>s&&(n=(s-o)/(r-o)),n=Math.max(0,Math.min(1,n))}return n}}i.RangeManager=a,a.__name__="RangeManager"},function(t,e,i,s,n){s();const o=t(15);class r{constructor(t,e){this.parent=t,this.initial_state=e,this.changed=new o.Signal0(this.parent,"state_changed"),this.history=[],this.index=-1}_do_state_change(t){const e=null!=this.history[t]?this.history[t].state:this.initial_state;null!=e.range&&this.parent.update_range(e.range),null!=e.selection&&this.parent.update_selection(e.selection)}push(t,e){const{history:i,index:s}=this,n=null!=i[s]?i[s].state:{},o=Object.assign(Object.assign(Object.assign({},this.initial_state),n),e);this.history=this.history.slice(0,this.index+1),this.history.push({type:t,state:o}),this.index=this.history.length-1,this.changed.emit()}clear(){this.history=[],this.index=-1,this.changed.emit()}undo(){this.can_undo&&(this.index-=1,this._do_state_change(this.index),this.changed.emit())}redo(){this.can_redo&&(this.index+=1,this._do_state_change(this.index),this.changed.emit())}get can_undo(){return this.index>=0}get can_redo(){return this.index<this.history.length-1}}i.StateManager=r,r.__name__="StateManager"},function(t,e,i,s,n){s();const o=t(19),r=t(15),a=t(43),l=t(65),c=t(22),h=t(333),_=new r.Signal0({},"gmaps_ready");class d extends h.PlotView{initialize(){this.pause(),super.initialize(),this._tiles_loaded=!1,this.zoom_count=0;const{zoom:t,lat:e,lng:i}=this.model.map_options;if(this.initial_zoom=t,this.initial_lat=e,this.initial_lng=i,!this.model.api_key){const t="https://developers.google.com/maps/documentation/javascript/get-api-key";o.logger.error(`api_key is required. See ${t} for more information on how to obtain your own.`)}if("undefined"==typeof google||null==google.maps){if(void 0===window._bokeh_gmaps_callback){const{api_key:t,api_version:e}=this.model;!function(t,e){window._bokeh_gmaps_callback=()=>_.emit();const i=encodeURIComponent,s=document.createElement("script");s.type="text/javascript",s.src=`https://maps.googleapis.com/maps/api/js?v=${i(e)}&key=${i(t)}&callback=_bokeh_gmaps_callback`,document.body.appendChild(s)}(t,e)}_.connect((()=>this.request_paint("everything")))}this.unpause()}remove(){a.remove(this.map_el),super.remove()}update_range(t,e){var i,s;if(null==t)this.map.setCenter({lat:this.initial_lat,lng:this.initial_lng}),this.map.setOptions({zoom:this.initial_zoom}),super.update_range(null,e);else if(null!=t.sdx||null!=t.sdy)this.map.panBy(null!==(i=t.sdx)&&void 0!==i?i:0,null!==(s=t.sdy)&&void 0!==s?s:0),super.update_range(t,e);else if(null!=t.factor){if(10!==this.zoom_count)return void(this.zoom_count+=1);this.zoom_count=0,this.pause(),super.update_range(t,e);const i=t.factor<0?-1:1,s=this.map.getZoom(),n=s+i;if(n>=2){this.map.setZoom(n);const[t,e,,]=this._get_projected_bounds();e-t<0&&this.map.setZoom(s)}this.unpause()}this._set_bokeh_ranges()}_build_map(){const{maps:t}=google;this.map_types={satellite:t.MapTypeId.SATELLITE,terrain:t.MapTypeId.TERRAIN,roadmap:t.MapTypeId.ROADMAP,hybrid:t.MapTypeId.HYBRID};const e=this.model.map_options,i={center:new t.LatLng(e.lat,e.lng),zoom:e.zoom,disableDefaultUI:!0,mapTypeId:this.map_types[e.map_type],scaleControl:e.scale_control,tilt:e.tilt};null!=e.styles&&(i.styles=JSON.parse(e.styles)),this.map_el=a.div({style:{position:"absolute"}}),this.canvas_view.add_underlay(this.map_el),this.map=new t.Map(this.map_el,i),t.event.addListener(this.map,"idle",(()=>this._set_bokeh_ranges())),t.event.addListener(this.map,"bounds_changed",(()=>this._set_bokeh_ranges())),t.event.addListenerOnce(this.map,"tilesloaded",(()=>this._render_finished())),this.connect(this.model.properties.map_options.change,(()=>this._update_options())),this.connect(this.model.map_options.properties.styles.change,(()=>this._update_styles())),this.connect(this.model.map_options.properties.lat.change,(()=>this._update_center("lat"))),this.connect(this.model.map_options.properties.lng.change,(()=>this._update_center("lng"))),this.connect(this.model.map_options.properties.zoom.change,(()=>this._update_zoom())),this.connect(this.model.map_options.properties.map_type.change,(()=>this._update_map_type())),this.connect(this.model.map_options.properties.scale_control.change,(()=>this._update_scale_control())),this.connect(this.model.map_options.properties.tilt.change,(()=>this._update_tilt()))}_render_finished(){this._tiles_loaded=!0,this.notify_finished()}has_finished(){return super.has_finished()&&!0===this._tiles_loaded}_get_latlon_bounds(){const t=this.map.getBounds(),e=t.getNorthEast(),i=t.getSouthWest();return[i.lng(),e.lng(),i.lat(),e.lat()]}_get_projected_bounds(){const[t,e,i,s]=this._get_latlon_bounds(),[n,o]=l.wgs84_mercator.compute(t,i),[r,a]=l.wgs84_mercator.compute(e,s);return[n,r,o,a]}_set_bokeh_ranges(){const[t,e,i,s]=this._get_projected_bounds();this.frame.x_range.setv({start:t,end:e}),this.frame.y_range.setv({start:i,end:s})}_update_center(t){const e=this.map.getCenter().toJSON();e[t]=this.model.map_options[t],this.map.setCenter(e),this._set_bokeh_ranges()}_update_map_type(){this.map.setOptions({mapTypeId:this.map_types[this.model.map_options.map_type]})}_update_scale_control(){this.map.setOptions({scaleControl:this.model.map_options.scale_control})}_update_tilt(){this.map.setOptions({tilt:this.model.map_options.tilt})}_update_options(){this._update_styles(),this._update_center("lat"),this._update_center("lng"),this._update_zoom(),this._update_map_type()}_update_styles(){this.map.setOptions({styles:JSON.parse(this.model.map_options.styles)})}_update_zoom(){this.map.setOptions({zoom:this.model.map_options.zoom}),this._set_bokeh_ranges()}_map_hook(t,e){if(null==this.map&&"undefined"!=typeof google&&null!=google.maps&&this._build_map(),null!=this.map_el){const[t,i,s,n]=e;this.map_el.style.top=`${i}px`,this.map_el.style.left=`${t}px`,this.map_el.style.width=`${s}px`,this.map_el.style.height=`${n}px`}}_paint_empty(t,e){const i=this.layout.bbox.width,s=this.layout.bbox.height,[n,o,r,a]=e;t.clearRect(0,0,i,s),t.beginPath(),t.moveTo(0,0),t.lineTo(0,s),t.lineTo(i,s),t.lineTo(i,0),t.lineTo(0,0),t.moveTo(n,o),t.lineTo(n+r,o),t.lineTo(n+r,o+a),t.lineTo(n,o+a),t.lineTo(n,o),t.closePath(),null!=this.model.border_fill_color&&(t.fillStyle=c.color2css(this.model.border_fill_color),t.fill())}}i.GMapPlotView=d,d.__name__="GMapPlotView"},function(t,e,i,s,n){s(),t(1).__exportStar(t(169),i)},function(t,e,i,s,n){s(),n("GlyphRenderer",t(61).GlyphRenderer),n("GraphRenderer",t(123).GraphRenderer),n("GuideRenderer",t(164).GuideRenderer),n("Renderer",t(41).Renderer)},function(t,e,i,s,n){s(),t(1).__exportStar(t(129),i),n("Selection",t(59).Selection)},function(t,e,i,s,n){s(),n("ServerSentDataSource",t(342).ServerSentDataSource),n("AjaxDataSource",t(344).AjaxDataSource),n("ColumnDataSource",t(130).ColumnDataSource),n("ColumnarDataSource",t(57).ColumnarDataSource),n("CDSView",t(120).CDSView),n("DataSource",t(58).DataSource),n("GeoJSONDataSource",t(345).GeoJSONDataSource),n("WebDataSource",t(343).WebDataSource)},function(t,e,i,s,n){s();const o=t(343);class r extends o.WebDataSource{constructor(t){super(t),this.initialized=!1}setup(){this.initialized||(this.initialized=!0,new EventSource(this.data_url).onmessage=t=>{var e;this.load_data(JSON.parse(t.data),this.mode,null!==(e=this.max_size)&&void 0!==e?e:void 0)})}}i.ServerSentDataSource=r,r.__name__="ServerSentDataSource"},function(t,e,i,s,n){s();const o=t(130),r=t(20);class a extends o.ColumnDataSource{constructor(t){super(t)}get_column(t){const e=this.data[t];return null!=e?e:[]}get_length(){var t;return null!==(t=super.get_length())&&void 0!==t?t:0}initialize(){super.initialize(),this.setup()}load_data(t,e,i){const{adapter:s}=this;let n;switch(n=null!=s?s.execute(this,{response:t}):t,e){case"replace":this.data=n;break;case"append":{const t=this.data;for(const e of this.columns()){const s=Array.from(t[e]),o=Array.from(n[e]),r=s.concat(o);n[e]=null!=i?r.slice(-i):r}this.data=n;break}}}static init_WebDataSource(){this.define((({Any:t,Int:e,String:i,Nullable:s})=>({max_size:[s(e),null],mode:[r.UpdateMode,"replace"],adapter:[s(t),null],data_url:[i]})))}}i.WebDataSource=a,a.__name__="WebDataSource",a.init_WebDataSource()},function(t,e,i,s,n){s();const o=t(343),r=t(20),a=t(19),l=t(13);class c extends o.WebDataSource{constructor(t){super(t),this.interval=null,this.initialized=!1}static init_AjaxDataSource(){this.define((({Boolean:t,Int:e,String:i,Dict:s,Nullable:n})=>({polling_interval:[n(e),null],content_type:[i,"application/json"],http_headers:[s(i),{}],method:[r.HTTPMethod,"POST"],if_modified:[t,!1]})))}destroy(){null!=this.interval&&clearInterval(this.interval),super.destroy()}setup(){if(!this.initialized&&(this.initialized=!0,this.get_data(this.mode),null!=this.polling_interval)){const t=()=>this.get_data(this.mode,this.max_size,this.if_modified);this.interval=setInterval(t,this.polling_interval)}}get_data(t,e=null,i=!1){const s=this.prepare_request();s.addEventListener("load",(()=>this.do_load(s,t,null!=e?e:void 0))),s.addEventListener("error",(()=>this.do_error(s))),s.send()}prepare_request(){const t=new XMLHttpRequest;t.open(this.method,this.data_url,!0),t.withCredentials=!1,t.setRequestHeader("Content-Type",this.content_type);const e=this.http_headers;for(const[i,s]of l.entries(e))t.setRequestHeader(i,s);return t}do_load(t,e,i){if(200===t.status){const s=JSON.parse(t.responseText);this.load_data(s,e,i)}}do_error(t){a.logger.error(`Failed to fetch JSON from ${this.data_url} with code ${t.status}`)}}i.AjaxDataSource=c,c.__name__="AjaxDataSource",c.init_AjaxDataSource()},function(t,e,i,s,n){s();const o=t(57),r=t(19),a=t(9),l=t(13);function c(t){return null!=t?t:NaN}const{hasOwnProperty:h}=Object.prototype;class _ extends o.ColumnarDataSource{constructor(t){super(t)}static init_GeoJSONDataSource(){this.define((({String:t})=>({geojson:[t]}))),this.internal((({Dict:t,Arrayable:e})=>({data:[t(e),{}]})))}initialize(){super.initialize(),this._update_data()}connect_signals(){super.connect_signals(),this.connect(this.properties.geojson.change,(()=>this._update_data()))}_update_data(){this.data=this.geojson_to_column_data()}_get_new_list_array(t){return a.range(0,t).map((t=>[]))}_get_new_nan_array(t){return a.range(0,t).map((t=>NaN))}_add_properties(t,e,i,s){var n;const o=null!==(n=t.properties)&&void 0!==n?n:{};for(const[r,a]of l.entries(o))h.call(e,r)||(e[r]=this._get_new_nan_array(s)),e[r][i]=c(a)}_add_geometry(t,e,i){function s(t,e){return t.concat([[NaN,NaN,NaN]]).concat(e)}switch(t.type){case"Point":{const[s,n,o]=t.coordinates;e.x[i]=s,e.y[i]=n,e.z[i]=c(o);break}case"LineString":{const{coordinates:s}=t;for(let t=0;t<s.length;t++){const[n,o,r]=s[t];e.xs[i][t]=n,e.ys[i][t]=o,e.zs[i][t]=c(r)}break}case"Polygon":{t.coordinates.length>1&&r.logger.warn("Bokeh does not support Polygons with holes in, only exterior ring used.");const s=t.coordinates[0];for(let t=0;t<s.length;t++){const[n,o,r]=s[t];e.xs[i][t]=n,e.ys[i][t]=o,e.zs[i][t]=c(r)}break}case"MultiPoint":r.logger.warn("MultiPoint not supported in Bokeh");break;case"MultiLineString":{const n=t.coordinates.reduce(s);for(let t=0;t<n.length;t++){const[s,o,r]=n[t];e.xs[i][t]=s,e.ys[i][t]=o,e.zs[i][t]=c(r)}break}case"MultiPolygon":{const n=[];for(const e of t.coordinates)e.length>1&&r.logger.warn("Bokeh does not support Polygons with holes in, only exterior ring used."),n.push(e[0]);const o=n.reduce(s);for(let t=0;t<o.length;t++){const[s,n,r]=o[t];e.xs[i][t]=s,e.ys[i][t]=n,e.zs[i][t]=c(r)}break}default:throw new Error(`Invalid GeoJSON geometry type: ${t.type}`)}}geojson_to_column_data(){const t=JSON.parse(this.geojson);let e;switch(t.type){case"GeometryCollection":if(null==t.geometries)throw new Error("No geometries found in GeometryCollection");if(0===t.geometries.length)throw new Error("geojson.geometries must have one or more items");e=t.geometries;break;case"FeatureCollection":if(null==t.features)throw new Error("No features found in FeaturesCollection");if(0==t.features.length)throw new Error("geojson.features must have one or more items");e=t.features;break;default:throw new Error("Bokeh only supports type GeometryCollection and FeatureCollection at top level")}let i=0;for(const o of e){const t="Feature"===o.type?o.geometry:o;"GeometryCollection"==t.type?i+=t.geometries.length:i+=1}const s={x:this._get_new_nan_array(i),y:this._get_new_nan_array(i),z:this._get_new_nan_array(i),xs:this._get_new_list_array(i),ys:this._get_new_list_array(i),zs:this._get_new_list_array(i)};let n=0;for(const o of e){const t="Feature"==o.type?o.geometry:o;if("GeometryCollection"==t.type)for(const e of t.geometries)this._add_geometry(e,s,n),"Feature"===o.type&&this._add_properties(o,s,n,i),n+=1;else this._add_geometry(t,s,n),"Feature"===o.type&&this._add_properties(o,s,n,i),n+=1}return s}}i.GeoJSONDataSource=_,_.__name__="GeoJSONDataSource",_.init_GeoJSONDataSource()},function(t,e,i,s,n){s(),n("BBoxTileSource",t(347).BBoxTileSource),n("MercatorTileSource",t(348).MercatorTileSource),n("QUADKEYTileSource",t(351).QUADKEYTileSource),n("TileRenderer",t(352).TileRenderer),n("TileSource",t(349).TileSource),n("TMSTileSource",t(355).TMSTileSource),n("WMTSTileSource",t(353).WMTSTileSource)},function(t,e,i,s,n){s();const o=t(348);class r extends o.MercatorTileSource{constructor(t){super(t)}static init_BBoxTileSource(){this.define((({Boolean:t})=>({use_latlon:[t,!1]})))}get_image_url(t,e,i){const s=this.string_lookup_replace(this.url,this.extra_url_vars);let n,o,r,a;return this.use_latlon?[o,a,n,r]=this.get_tile_geographic_bounds(t,e,i):[o,a,n,r]=this.get_tile_meter_bounds(t,e,i),s.replace("{XMIN}",o.toString()).replace("{YMIN}",a.toString()).replace("{XMAX}",n.toString()).replace("{YMAX}",r.toString())}}i.BBoxTileSource=r,r.__name__="BBoxTileSource",r.init_BBoxTileSource()},function(t,e,i,s,n){s();const o=t(349),r=t(9),a=t(350);class l extends o.TileSource{constructor(t){super(t)}static init_MercatorTileSource(){this.define((({Boolean:t})=>({snap_to_zoom:[t,!1],wrap_around:[t,!0]}))),this.override({x_origin_offset:20037508.34,y_origin_offset:20037508.34,initial_resolution:156543.03392804097})}initialize(){super.initialize(),this._resolutions=r.range(this.min_zoom,this.max_zoom+1).map((t=>this.get_resolution(t)))}_computed_initial_resolution(){return null!=this.initial_resolution?this.initial_resolution:2*Math.PI*6378137/this.tile_size}is_valid_tile(t,e,i){return!(!this.wrap_around&&(t<0||t>=2**i))&&!(e<0||e>=2**i)}parent_by_tile_xyz(t,e,i){const s=this.tile_xyz_to_quadkey(t,e,i),n=s.substring(0,s.length-1);return this.quadkey_to_tile_xyz(n)}get_resolution(t){return this._computed_initial_resolution()/2**t}get_resolution_by_extent(t,e,i){return[(t[2]-t[0])/i,(t[3]-t[1])/e]}get_level_by_extent(t,e,i){const s=(t[2]-t[0])/i,n=(t[3]-t[1])/e,o=Math.max(s,n);let r=0;for(const a of this._resolutions){if(o>a){if(0==r)return 0;if(r>0)return r-1}r+=1}return r-1}get_closest_level_by_extent(t,e,i){const s=(t[2]-t[0])/i,n=(t[3]-t[1])/e,o=Math.max(s,n),r=this._resolutions.reduce((function(t,e){return Math.abs(e-o)<Math.abs(t-o)?e:t}));return this._resolutions.indexOf(r)}snap_to_zoom_level(t,e,i,s){const[n,o,r,a]=t,l=this._resolutions[s];let c=i*l,h=e*l;if(!this.snap_to_zoom){const t=(r-n)/c,e=(a-o)/h;t>e?(c=r-n,h*=t):(c*=e,h=a-o)}const _=(c-(r-n))/2,d=(h-(a-o))/2;return[n-_,o-d,r+_,a+d]}tms_to_wmts(t,e,i){return[t,2**i-1-e,i]}wmts_to_tms(t,e,i){return[t,2**i-1-e,i]}pixels_to_meters(t,e,i){const s=this.get_resolution(i);return[t*s-this.x_origin_offset,e*s-this.y_origin_offset]}meters_to_pixels(t,e,i){const s=this.get_resolution(i);return[(t+this.x_origin_offset)/s,(e+this.y_origin_offset)/s]}pixels_to_tile(t,e){let i=Math.ceil(t/this.tile_size);return i=0===i?i:i-1,[i,Math.max(Math.ceil(e/this.tile_size)-1,0)]}pixels_to_raster(t,e,i){return[t,(this.tile_size<<i)-e]}meters_to_tile(t,e,i){const[s,n]=this.meters_to_pixels(t,e,i);return this.pixels_to_tile(s,n)}get_tile_meter_bounds(t,e,i){const[s,n]=this.pixels_to_meters(t*this.tile_size,e*this.tile_size,i),[o,r]=this.pixels_to_meters((t+1)*this.tile_size,(e+1)*this.tile_size,i);return[s,n,o,r]}get_tile_geographic_bounds(t,e,i){const s=this.get_tile_meter_bounds(t,e,i),[n,o,r,l]=a.meters_extent_to_geographic(s);return[n,o,r,l]}get_tiles_by_extent(t,e,i=1){const[s,n,o,r]=t;let[a,l]=this.meters_to_tile(s,n,e),[c,h]=this.meters_to_tile(o,r,e);a-=i,l-=i,c+=i,h+=i;const _=[];for(let d=h;d>=l;d--)for(let t=a;t<=c;t++)this.is_valid_tile(t,d,e)&&_.push([t,d,e,this.get_tile_meter_bounds(t,d,e)]);return this.sort_tiles_from_center(_,[a,l,c,h]),_}quadkey_to_tile_xyz(t){let e=0,i=0;const s=t.length;for(let n=s;n>0;n--){const o=1<<n-1;switch(t.charAt(s-n)){case"0":continue;case"1":e|=o;break;case"2":i|=o;break;case"3":e|=o,i|=o;break;default:throw new TypeError(`Invalid Quadkey: ${t}`)}}return[e,i,s]}tile_xyz_to_quadkey(t,e,i){let s="";for(let n=i;n>0;n--){const i=1<<n-1;let o=0;0!=(t&i)&&(o+=1),0!=(e&i)&&(o+=2),s+=o.toString()}return s}children_by_tile_xyz(t,e,i){const s=this.tile_xyz_to_quadkey(t,e,i),n=[];for(let o=0;o<=3;o++){const[t,e,i]=this.quadkey_to_tile_xyz(s+o.toString()),r=this.get_tile_meter_bounds(t,e,i);n.push([t,e,i,r])}return n}get_closest_parent_by_tile_xyz(t,e,i){const s=this.calculate_world_x_by_tile_xyz(t,e,i);[t,e,i]=this.normalize_xyz(t,e,i);let n=this.tile_xyz_to_quadkey(t,e,i);for(;n.length>0;)if(n=n.substring(0,n.length-1),[t,e,i]=this.quadkey_to_tile_xyz(n),[t,e,i]=this.denormalize_xyz(t,e,i,s),this.tiles.has(this.tile_xyz_to_key(t,e,i)))return[t,e,i];return[0,0,0]}normalize_xyz(t,e,i){if(this.wrap_around){const s=2**i;return[(t%s+s)%s,e,i]}return[t,e,i]}denormalize_xyz(t,e,i,s){return[t+s*2**i,e,i]}denormalize_meters(t,e,i,s){return[t+2*s*Math.PI*6378137,e]}calculate_world_x_by_tile_xyz(t,e,i){return Math.floor(t/2**i)}}i.MercatorTileSource=l,l.__name__="MercatorTileSource",l.init_MercatorTileSource()},function(t,e,i,s,n){s();const o=t(53),r=t(13);class a extends o.Model{constructor(t){super(t)}static init_TileSource(){this.define((({Number:t,String:e,Dict:i,Nullable:s})=>({url:[e,""],tile_size:[t,256],max_zoom:[t,30],min_zoom:[t,0],extra_url_vars:[i(e),{}],attribution:[e,""],x_origin_offset:[t],y_origin_offset:[t],initial_resolution:[s(t),null]})))}initialize(){super.initialize(),this.tiles=new Map,this._normalize_case()}connect_signals(){super.connect_signals(),this.connect(this.change,(()=>this._clear_cache()))}string_lookup_replace(t,e){let i=t;for(const[s,n]of r.entries(e))i=i.replace(`{${s}}`,n);return i}_normalize_case(){const t=this.url.replace("{x}","{X}").replace("{y}","{Y}").replace("{z}","{Z}").replace("{q}","{Q}").replace("{xmin}","{XMIN}").replace("{ymin}","{YMIN}").replace("{xmax}","{XMAX}").replace("{ymax}","{YMAX}");this.url=t}_clear_cache(){this.tiles=new Map}tile_xyz_to_key(t,e,i){return`${t}:${e}:${i}`}key_to_tile_xyz(t){const[e,i,s]=t.split(":").map((t=>parseInt(t)));return[e,i,s]}sort_tiles_from_center(t,e){const[i,s,n,o]=e,r=(n-i)/2+i,a=(o-s)/2+s;t.sort((function(t,e){return Math.sqrt((r-t[0])**2+(a-t[1])**2)-Math.sqrt((r-e[0])**2+(a-e[1])**2)}))}get_image_url(t,e,i){return this.string_lookup_replace(this.url,this.extra_url_vars).replace("{X}",t.toString()).replace("{Y}",e.toString()).replace("{Z}",i.toString())}}i.TileSource=a,a.__name__="TileSource",a.init_TileSource()},function(t,e,i,s,n){s();const o=t(65);function r(t,e){return o.wgs84_mercator.compute(t,e)}function a(t,e){return o.wgs84_mercator.invert(t,e)}i.geographic_to_meters=r,i.meters_to_geographic=a,i.geographic_extent_to_meters=function(t){const[e,i,s,n]=t,[o,a]=r(e,i),[l,c]=r(s,n);return[o,a,l,c]},i.meters_extent_to_geographic=function(t){const[e,i,s,n]=t,[o,r]=a(e,i),[l,c]=a(s,n);return[o,r,l,c]}},function(t,e,i,s,n){s();const o=t(348);class r extends o.MercatorTileSource{constructor(t){super(t)}get_image_url(t,e,i){const s=this.string_lookup_replace(this.url,this.extra_url_vars),[n,o,r]=this.tms_to_wmts(t,e,i),a=this.tile_xyz_to_quadkey(n,o,r);return s.replace("{Q}",a)}}i.QUADKEYTileSource=r,r.__name__="QUADKEYTileSource"},function(t,e,i,s,n){s();const o=t(1),r=t(349),a=t(353),l=t(41),c=t(156),h=t(43),_=t(296),d=t(9),u=t(8),p=o.__importStar(t(354));class m extends l.RendererView{initialize(){this._tiles=[],super.initialize()}connect_signals(){super.connect_signals(),this.connect(this.model.change,(()=>this.request_render())),this.connect(this.model.tile_source.change,(()=>this.request_render()))}styles(){return[...super.styles(),p.default]}get_extent(){return[this.x_range.start,this.y_range.start,this.x_range.end,this.y_range.end]}get map_plot(){return this.plot_model}get map_canvas(){return this.layer.ctx}get map_frame(){return this.plot_view.frame}get x_range(){return this.map_plot.x_range}get y_range(){return this.map_plot.y_range}_set_data(){this.extent=this.get_extent(),this._last_height=void 0,this._last_width=void 0}_update_attribution(){null!=this.attribution_el&&h.removeElement(this.attribution_el);const{attribution:t}=this.model.tile_source;if(u.isString(t)&&t.length>0){const{layout:e,frame:i}=this.plot_view,s=e.bbox.width-i.bbox.right,n=e.bbox.height-i.bbox.bottom,o=i.bbox.width;this.attribution_el=h.div({class:p.tile_attribution,style:{position:"absolute",right:`${s}px`,bottom:`${n}px`,"max-width":o-4+"px",padding:"2px","background-color":"rgba(255,255,255,0.5)","font-size":"9px","line-height":"1.05","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}}),this.plot_view.canvas_view.add_event(this.attribution_el),this.attribution_el.innerHTML=t,this.attribution_el.title=this.attribution_el.textContent.replace(/\s*\n\s*/g," ")}}_map_data(){this.initial_extent=this.get_extent();const t=this.model.tile_source.get_level_by_extent(this.initial_extent,this.map_frame.bbox.height,this.map_frame.bbox.width),e=this.model.tile_source.snap_to_zoom_level(this.initial_extent,this.map_frame.bbox.height,this.map_frame.bbox.width,t);this.x_range.start=e[0],this.y_range.start=e[1],this.x_range.end=e[2],this.y_range.end=e[3],this.x_range instanceof c.Range1d&&(this.x_range.reset_start=e[0],this.x_range.reset_end=e[2]),this.y_range instanceof c.Range1d&&(this.y_range.reset_start=e[1],this.y_range.reset_end=e[3]),this._update_attribution()}_create_tile(t,e,i,s,n=!1){const[o,r,a]=this.model.tile_source.normalize_xyz(t,e,i),l={img:void 0,tile_coords:[t,e,i],normalized_coords:[o,r,a],quadkey:this.model.tile_source.tile_xyz_to_quadkey(t,e,i),cache_key:this.model.tile_source.tile_xyz_to_key(t,e,i),bounds:s,loaded:!1,finished:!1,x_coord:s[0],y_coord:s[3]},c=this.model.tile_source.get_image_url(o,r,a);new _.ImageLoader(c,{loaded:t=>{Object.assign(l,{img:t,loaded:!0}),n?(l.finished=!0,this.notify_finished()):this.request_render()},failed(){l.finished=!0}}),this.model.tile_source.tiles.set(l.cache_key,l),this._tiles.push(l)}_enforce_aspect_ratio(){if(this._last_height!==this.map_frame.bbox.height||this._last_width!==this.map_frame.bbox.width){const t=this.get_extent(),e=this.model.tile_source.get_level_by_extent(t,this.map_frame.bbox.height,this.map_frame.bbox.width),i=this.model.tile_source.snap_to_zoom_level(t,this.map_frame.bbox.height,this.map_frame.bbox.width,e);this.x_range.setv({start:i[0],end:i[2]}),this.y_range.setv({start:i[1],end:i[3]}),this.extent=i,this._last_height=this.map_frame.bbox.height,this._last_width=this.map_frame.bbox.width}}has_finished(){if(!super.has_finished())return!1;if(0===this._tiles.length)return!1;for(const t of this._tiles)if(!t.finished)return!1;return!0}_render(){null==this.map_initialized&&(this._set_data(),this._map_data(),this.map_initialized=!0),this._enforce_aspect_ratio(),this._update(),null!=this.prefetch_timer&&clearTimeout(this.prefetch_timer),this.prefetch_timer=setTimeout(this._prefetch_tiles.bind(this),500),this.has_finished()&&this.notify_finished()}_draw_tile(t){const e=this.model.tile_source.tiles.get(t);if(null!=e&&e.loaded){const[[t],[i]]=this.coordinates.map_to_screen([e.bounds[0]],[e.bounds[3]]),[[s],[n]]=this.coordinates.map_to_screen([e.bounds[2]],[e.bounds[1]]),o=s-t,r=n-i,a=t,l=i,c=this.map_canvas.getImageSmoothingEnabled();this.map_canvas.setImageSmoothingEnabled(this.model.smoothing),this.map_canvas.drawImage(e.img,a,l,o,r),this.map_canvas.setImageSmoothingEnabled(c),e.finished=!0}}_set_rect(){const t=this.plot_model.outline_line_width,e=this.map_frame.bbox.left+t/2,i=this.map_frame.bbox.top+t/2,s=this.map_frame.bbox.width-t,n=this.map_frame.bbox.height-t;this.map_canvas.rect(e,i,s,n),this.map_canvas.clip()}_render_tiles(t){this.map_canvas.save(),this._set_rect(),this.map_canvas.globalAlpha=this.model.alpha;for(const e of t)this._draw_tile(e);this.map_canvas.restore()}_prefetch_tiles(){const{tile_source:t}=this.model,e=this.get_extent(),i=this.map_frame.bbox.height,s=this.map_frame.bbox.width,n=this.model.tile_source.get_level_by_extent(e,i,s),o=this.model.tile_source.get_tiles_by_extent(e,n);for(let r=0,a=Math.min(10,o.length);r<a;r++){const[e,i,s]=o[r],n=this.model.tile_source.children_by_tile_xyz(e,i,s);for(const o of n){const[e,i,s,n]=o;t.tiles.has(t.tile_xyz_to_key(e,i,s))||this._create_tile(e,i,s,n,!0)}}}_fetch_tiles(t){for(const e of t){const[t,i,s,n]=e;this._create_tile(t,i,s,n)}}_update(){const{tile_source:t}=this.model,{min_zoom:e}=t,{max_zoom:i}=t;let s=this.get_extent();const n=this.extent[2]-this.extent[0]<s[2]-s[0],o=this.map_frame.bbox.height,r=this.map_frame.bbox.width;let a=t.get_level_by_extent(s,o,r),l=!1;a<e?(s=this.extent,a=e,l=!0):a>i&&(s=this.extent,a=i,l=!0),l&&(this.x_range.setv({start:s[0],end:s[2]}),this.y_range.setv({start:s[1],end:s[3]})),this.extent=s;const c=t.get_tiles_by_extent(s,a),h=[],_=[],u=[],p=[];for(const m of c){const[e,i,s]=m,o=t.tile_xyz_to_key(e,i,s),r=t.tiles.get(o);if(null!=r&&r.loaded)_.push(o);else if(this.model.render_parents){const[o,r,a]=t.get_closest_parent_by_tile_xyz(e,i,s),l=t.tile_xyz_to_key(o,r,a),c=t.tiles.get(l);if(null!=c&&c.loaded&&!d.includes(u,l)&&u.push(l),n){const n=t.children_by_tile_xyz(e,i,s);for(const[e,i,s]of n){const n=t.tile_xyz_to_key(e,i,s);t.tiles.has(n)&&p.push(n)}}}null==r&&h.push(m)}this._render_tiles(u),this._render_tiles(p),this._render_tiles(_),null!=this.render_timer&&clearTimeout(this.render_timer),this.render_timer=setTimeout((()=>this._fetch_tiles(h)),65)}}i.TileRendererView=m,m.__name__="TileRendererView";class g extends l.Renderer{constructor(t){super(t)}static init_TileRenderer(){this.prototype.default_view=m,this.define((({Boolean:t,Number:e,Ref:i})=>({alpha:[e,1],smoothing:[t,!0],tile_source:[i(r.TileSource),()=>new a.WMTSTileSource],render_parents:[t,!0]}))),this.override({level:"image"})}}i.TileRenderer=g,g.__name__="TileRenderer",g.init_TileRenderer()},function(t,e,i,s,n){s();const o=t(348);class r extends o.MercatorTileSource{constructor(t){super(t)}get_image_url(t,e,i){const s=this.string_lookup_replace(this.url,this.extra_url_vars),[n,o,r]=this.tms_to_wmts(t,e,i);return s.replace("{X}",n.toString()).replace("{Y}",o.toString()).replace("{Z}",r.toString())}}i.WMTSTileSource=r,r.__name__="WMTSTileSource"},function(t,e,i,s,n){s(),i.root="bk-root",i.tile_attribution="bk-tile-attribution",i.default=".bk-root .bk-tile-attribution a{color:black;}"},function(t,e,i,s,n){s();const o=t(348);class r extends o.MercatorTileSource{constructor(t){super(t)}get_image_url(t,e,i){return this.string_lookup_replace(this.url,this.extra_url_vars).replace("{X}",t.toString()).replace("{Y}",e.toString()).replace("{Z}",i.toString())}}i.TMSTileSource=r,r.__name__="TMSTileSource"},function(t,e,i,s,n){s(),n("CanvasTexture",t(357).CanvasTexture),n("ImageURLTexture",t(359).ImageURLTexture),n("Texture",t(358).Texture)},function(t,e,i,s,n){s();const o=t(358),r=t(34);class a extends o.Texture{constructor(t){super(t)}static init_CanvasTexture(){this.define((({String:t})=>({code:[t]})))}get func(){const t=r.use_strict(this.code);return new Function("ctx","color","scale","weight",t)}get_pattern(t,e,i){const s=document.createElement("canvas");s.width=e,s.height=e;const n=s.getContext("2d");return this.func.call(this,n,t,e,i),s}}i.CanvasTexture=a,a.__name__="CanvasTexture",a.init_CanvasTexture()},function(t,e,i,s,n){s();const o=t(53),r=t(20);class a extends o.Model{constructor(t){super(t)}static init_Texture(){this.define((()=>({repetition:[r.TextureRepetition,"repeat"]})))}}i.Texture=a,a.__name__="Texture",a.init_Texture()},function(t,e,i,s,n){s();const o=t(358),r=t(296);class a extends o.Texture{constructor(t){super(t)}static init_ImageURLTexture(){this.define((({String:t})=>({url:[t]})))}initialize(){super.initialize(),this._loader=new r.ImageLoader(this.url)}get_pattern(t,e,i){const{_loader:s}=this;return this._loader.finished?s.image:s.promise}}i.ImageURLTexture=a,a.__name__="ImageURLTexture",a.init_ImageURLTexture()},function(t,e,i,s,n){s(),n("ActionTool",t(251).ActionTool),n("CustomAction",t(361).CustomAction),n("HelpTool",t(252).HelpTool),n("RedoTool",t(362).RedoTool),n("ResetTool",t(363).ResetTool),n("SaveTool",t(364).SaveTool),n("UndoTool",t(365).UndoTool),n("ZoomInTool",t(366).ZoomInTool),n("ZoomOutTool",t(369).ZoomOutTool),n("ButtonTool",t(238).ButtonTool),n("EditTool",t(370).EditTool),n("BoxEditTool",t(371).BoxEditTool),n("FreehandDrawTool",t(372).FreehandDrawTool),n("PointDrawTool",t(373).PointDrawTool),n("PolyDrawTool",t(374).PolyDrawTool),n("PolyTool",t(375).PolyTool),n("PolyEditTool",t(376).PolyEditTool),n("BoxSelectTool",t(377).BoxSelectTool),n("BoxZoomTool",t(379).BoxZoomTool),n("GestureTool",t(237).GestureTool),n("LassoSelectTool",t(380).LassoSelectTool),n("LineEditTool",t(382).LineEditTool),n("PanTool",t(384).PanTool),n("PolySelectTool",t(381).PolySelectTool),n("RangeTool",t(385).RangeTool),n("SelectTool",t(378).SelectTool),n("TapTool",t(386).TapTool),n("WheelPanTool",t(387).WheelPanTool),n("WheelZoomTool",t(388).WheelZoomTool),n("CrosshairTool",t(389).CrosshairTool),n("CustomJSHover",t(390).CustomJSHover),n("HoverTool",t(391).HoverTool),n("InspectTool",t(247).InspectTool),n("Tool",t(236).Tool),n("ToolProxy",t(392).ToolProxy),n("Toolbar",t(235).Toolbar),n("ToolbarBase",t(248).ToolbarBase),n("ProxyToolbar",t(393).ProxyToolbar),n("ToolbarBox",t(393).ToolbarBox)},function(t,e,i,s,n){s();const o=t(251);class r extends o.ActionToolButtonView{css_classes(){return super.css_classes().concat("bk-toolbar-button-custom-action")}}i.CustomActionButtonView=r,r.__name__="CustomActionButtonView";class a extends o.ActionToolView{doit(){var t;null===(t=this.model.callback)||void 0===t||t.execute(this.model)}}i.CustomActionView=a,a.__name__="CustomActionView";class l extends o.ActionTool{constructor(t){super(t),this.tool_name="Custom Action",this.button_view=r}static init_CustomAction(){this.prototype.default_view=a,this.define((({Any:t,String:e,Nullable:i})=>({callback:[i(t)],icon:[e]}))),this.override({description:"Perform a Custom Action"})}}i.CustomAction=l,l.__name__="CustomAction",l.init_CustomAction()},function(t,e,i,s,n){s();const o=t(251),r=t(242);class a extends o.ActionToolView{connect_signals(){super.connect_signals(),this.connect(this.plot_view.state.changed,(()=>this.model.disabled=!this.plot_view.state.can_redo))}doit(){this.plot_view.state.redo()}}i.RedoToolView=a,a.__name__="RedoToolView";class l extends o.ActionTool{constructor(t){super(t),this.tool_name="Redo",this.icon=r.tool_icon_redo}static init_RedoTool(){this.prototype.default_view=a,this.override({disabled:!0}),this.register_alias("redo",(()=>new l))}}i.RedoTool=l,l.__name__="RedoTool",l.init_RedoTool()},function(t,e,i,s,n){s();const o=t(251),r=t(242);class a extends o.ActionToolView{doit(){this.plot_view.reset()}}i.ResetToolView=a,a.__name__="ResetToolView";class l extends o.ActionTool{constructor(t){super(t),this.tool_name="Reset",this.icon=r.tool_icon_reset}static init_ResetTool(){this.prototype.default_view=a,this.register_alias("reset",(()=>new l))}}i.ResetTool=l,l.__name__="ResetTool",l.init_ResetTool()},function(t,e,i,s,n){s();const o=t(251),r=t(242);class a extends o.ActionToolView{async copy(){const t=await this.plot_view.to_blob(),e=new ClipboardItem({[t.type]:t});await navigator.clipboard.write([e])}async save(t){const e=await this.plot_view.to_blob(),i=document.createElement("a");i.href=URL.createObjectURL(e),i.download=t,i.target="_blank",i.dispatchEvent(new MouseEvent("click"))}doit(t="save"){switch(t){case"save":this.save("bokeh_plot");break;case"copy":this.copy()}}}i.SaveToolView=a,a.__name__="SaveToolView";class l extends o.ActionTool{constructor(t){super(t),this.tool_name="Save",this.icon=r.tool_icon_save}static init_SaveTool(){this.prototype.default_view=a,this.register_alias("save",(()=>new l))}get menu(){return[{icon:"bk-tool-icon-copy-to-clipboard",tooltip:"Copy image to clipboard",if:()=>"undefined"!=typeof ClipboardItem,handler:()=>{this.do.emit("copy")}}]}}i.SaveTool=l,l.__name__="SaveTool",l.init_SaveTool()},function(t,e,i,s,n){s();const o=t(251),r=t(242);class a extends o.ActionToolView{connect_signals(){super.connect_signals(),this.connect(this.plot_view.state.changed,(()=>this.model.disabled=!this.plot_view.state.can_undo))}doit(){this.plot_view.state.undo()}}i.UndoToolView=a,a.__name__="UndoToolView";class l extends o.ActionTool{constructor(t){super(t),this.tool_name="Undo",this.icon=r.tool_icon_undo}static init_UndoTool(){this.prototype.default_view=a,this.override({disabled:!0}),this.register_alias("undo",(()=>new l))}}i.UndoTool=l,l.__name__="UndoTool",l.init_UndoTool()},function(t,e,i,s,n){s();const o=t(367),r=t(242);class a extends o.ZoomBaseToolView{}i.ZoomInToolView=a,a.__name__="ZoomInToolView";class l extends o.ZoomBaseTool{constructor(t){super(t),this.sign=1,this.tool_name="Zoom In",this.icon=r.tool_icon_zoom_in}static init_ZoomInTool(){this.prototype.default_view=a,this.register_alias("zoom_in",(()=>new l({dimensions:"both"}))),this.register_alias("xzoom_in",(()=>new l({dimensions:"width"}))),this.register_alias("yzoom_in",(()=>new l({dimensions:"height"})))}}i.ZoomInTool=l,l.__name__="ZoomInTool",l.init_ZoomInTool()},function(t,e,i,s,n){s();const o=t(251),r=t(20),a=t(368);class l extends o.ActionToolView{doit(){var t;const e=this.plot_view.frame,i=this.model.dimensions,s="width"==i||"both"==i,n="height"==i||"both"==i,o=a.scale_range(e,this.model.sign*this.model.factor,s,n);this.plot_view.state.push("zoom_out",{range:o}),this.plot_view.update_range(o,{scrolling:!0}),null===(t=this.model.document)||void 0===t||t.interactive_start(this.plot_model)}}i.ZoomBaseToolView=l,l.__name__="ZoomBaseToolView";class c extends o.ActionTool{constructor(t){super(t)}static init_ZoomBaseTool(){this.define((({Percent:t})=>({factor:[t,.1],dimensions:[r.Dimensions,"both"]})))}get tooltip(){return this._get_dim_tooltip(this.dimensions)}}i.ZoomBaseTool=c,c.__name__="ZoomBaseTool",c.init_ZoomBaseTool()},function(t,e,i,s,n){s();const o=t(10);function r(t,e,i){const[s,n]=[t.start,t.end],o=null!=i?i:(n+s)/2;return[s-(s-o)*e,n-(n-o)*e]}function a(t,[e,i]){const s=new Map;for(const[n,o]of t){const[t,r]=o.r_invert(e,i);s.set(n,{start:t,end:r})}return s}i.scale_highlow=r,i.get_info=a,i.scale_range=function(t,e,i=!0,s=!0,n){e=o.clamp(e,-.9,.9);const l=i?e:0,[c,h]=r(t.bbox.h_range,l,null!=n?n.x:void 0),_=a(t.x_scales,[c,h]),d=s?e:0,[u,p]=r(t.bbox.v_range,d,null!=n?n.y:void 0);return{xrs:_,yrs:a(t.y_scales,[u,p]),factor:e}}},function(t,e,i,s,n){s();const o=t(367),r=t(242);class a extends o.ZoomBaseToolView{}i.ZoomOutToolView=a,a.__name__="ZoomOutToolView";class l extends o.ZoomBaseTool{constructor(t){super(t),this.sign=-1,this.tool_name="Zoom Out",this.icon=r.tool_icon_zoom_out}static init_ZoomOutTool(){this.prototype.default_view=a,this.register_alias("zoom_out",(()=>new l({dimensions:"both"}))),this.register_alias("xzoom_out",(()=>new l({dimensions:"width"}))),this.register_alias("yzoom_out",(()=>new l({dimensions:"height"})))}}i.ZoomOutTool=l,l.__name__="ZoomOutTool",l.init_ZoomOutTool()},function(t,e,i,s,n){s();const o=t(9),r=t(8),a=t(11),l=t(61),c=t(237);class h extends c.GestureToolView{constructor(){super(...arguments),this._mouse_in_frame=!0}_select_mode(t){const{shiftKey:e,ctrlKey:i}=t;return e||i?e&&!i?"append":!e&&i?"intersect":e&&i?"subtract":void a.unreachable():"replace"}_move_enter(t){this._mouse_in_frame=!0}_move_exit(t){this._mouse_in_frame=!1}_map_drag(t,e,i){if(!this.plot_view.frame.bbox.contains(t,e))return null;const s=this.plot_view.renderer_view(i);return null==s?null:[s.coordinates.x_scale.invert(t),s.coordinates.y_scale.invert(e)]}_delete_selected(t){const e=t.data_source,i=e.selected.indices;i.sort();for(const s of e.columns()){const t=e.get_array(s);for(let e=0;e<i.length;e++){const s=i[e];t.splice(s-e,1)}}this._emit_cds_changes(e)}_pop_glyphs(t,e){const i=t.columns();if(e&&i.length)for(const s of i){let i=t.get_array(s);const n=i.length-e+1;n<1||(r.isArray(i)||(i=Array.from(i),t.data[s]=i),i.splice(0,n))}}_emit_cds_changes(t,e=!0,i=!0,s=!0){i&&t.selection_manager.clear(),e&&t.change.emit(),s&&(t.data=t.data,t.properties.data.change.emit())}_drag_points(t,e,i="both"){if(null==this._basepoint)return;const[s,n]=this._basepoint;for(const o of e){const e=this._map_drag(s,n,o),r=this._map_drag(t.sx,t.sy,o);if(null==r||null==e)continue;const[a,l]=r,[c,h]=e,[_,d]=[a-c,l-h],u=o.glyph,p=o.data_source,[m,g]=[u.x.field,u.y.field];for(const t of p.selected.indices)!m||"width"!=i&&"both"!=i||(p.data[m][t]+=_),!g||"height"!=i&&"both"!=i||(p.data[g][t]+=d);p.change.emit()}this._basepoint=[t.sx,t.sy]}_pad_empty_columns(t,e){for(const i of t.columns())o.includes(e,i)||t.get_array(i).push(this.model.empty_value)}_select_event(t,e,i){const s=this.plot_view.frame,{sx:n,sy:o}=t;if(!s.bbox.contains(n,o))return[];const r={type:"point",sx:n,sy:o},a=[];for(const l of i){const t=l.get_selection_manager(),i=l.data_source,s=this.plot_view.renderer_view(l);null!=s&&(t.select([s],r,!0,e)&&a.push(l),i.properties.selected.change.emit())}return a}}i.EditToolView=h,h.__name__="EditToolView";class _ extends c.GestureTool{constructor(t){super(t)}static init_EditTool(){this.define((({Unknown:t,String:e,Array:i,Ref:s,Nullable:n})=>({custom_icon:[n(e),null],empty_value:[t],renderers:[i(s(l.GlyphRenderer)),[]]})))}get computed_icon(){var t;return null!==(t=this.custom_icon)&&void 0!==t?t:this.icon}}i.EditTool=_,_.__name__="EditTool",_.init_EditTool()},function(t,e,i,s,n){s();const o=t(43),r=t(20),a=t(370),l=t(242);class c extends a.EditToolView{_tap(t){null==this._draw_basepoint&&null==this._basepoint&&this._select_event(t,this._select_mode(t),this.model.renderers)}_keyup(t){if(this.model.active&&this._mouse_in_frame)for(const e of this.model.renderers)t.keyCode===o.Keys.Backspace?this._delete_selected(e):t.keyCode==o.Keys.Esc&&e.data_source.selection_manager.clear()}_set_extent([t,e],[i,s],n,o=!1){const r=this.model.renderers[0],a=this.plot_view.renderer_view(r);if(null==a)return;const l=r.glyph,c=r.data_source,[h,_]=a.coordinates.x_scale.r_invert(t,e),[d,u]=a.coordinates.y_scale.r_invert(i,s),[p,m]=[(h+_)/2,(d+u)/2],[g,f]=[_-h,u-d],[b,v]=[l.x.field,l.y.field],[y,x]=[l.width.field,l.height.field];if(n)this._pop_glyphs(c,this.model.num_objects),b&&c.get_array(b).push(p),v&&c.get_array(v).push(m),y&&c.get_array(y).push(g),x&&c.get_array(x).push(f),this._pad_empty_columns(c,[b,v,y,x]);else{const t=c.data[b].length-1;b&&(c.data[b][t]=p),v&&(c.data[v][t]=m),y&&(c.data[y][t]=g),x&&(c.data[x][t]=f)}this._emit_cds_changes(c,!0,!1,o)}_update_box(t,e=!1,i=!1){if(null==this._draw_basepoint)return;const s=[t.sx,t.sy],n=this.plot_view.frame,o=this.model.dimensions,r=this.model._get_dim_limits(this._draw_basepoint,s,n,o);if(null!=r){const[t,s]=r;this._set_extent(t,s,e,i)}}_doubletap(t){this.model.active&&(null!=this._draw_basepoint?(this._update_box(t,!1,!0),this._draw_basepoint=null):(this._draw_basepoint=[t.sx,t.sy],this._select_event(t,"append",this.model.renderers),this._update_box(t,!0,!1)))}_move(t){this._update_box(t,!1,!1)}_pan_start(t){if(t.shiftKey){if(null!=this._draw_basepoint)return;this._draw_basepoint=[t.sx,t.sy],this._update_box(t,!0,!1)}else{if(null!=this._basepoint)return;this._select_event(t,"append",this.model.renderers),this._basepoint=[t.sx,t.sy]}}_pan(t,e=!1,i=!1){if(t.shiftKey){if(null==this._draw_basepoint)return;this._update_box(t,e,i)}else{if(null==this._basepoint)return;this._drag_points(t,this.model.renderers)}}_pan_end(t){if(this._pan(t,!1,!0),t.shiftKey)this._draw_basepoint=null;else{this._basepoint=null;for(const t of this.model.renderers)this._emit_cds_changes(t.data_source,!1,!0,!0)}}}i.BoxEditToolView=c,c.__name__="BoxEditToolView";class h extends a.EditTool{constructor(t){super(t),this.tool_name="Box Edit Tool",this.icon=l.tool_icon_box_edit,this.event_type=["tap","pan","move"],this.default_order=1}static init_BoxEditTool(){this.prototype.default_view=c,this.define((({Int:t})=>({dimensions:[r.Dimensions,"both"],num_objects:[t,0]})))}}i.BoxEditTool=h,h.__name__="BoxEditTool",h.init_BoxEditTool()},function(t,e,i,s,n){s();const o=t(43),r=t(8),a=t(370),l=t(242);class c extends a.EditToolView{_draw(t,e,i=!1){if(!this.model.active)return;const s=this.model.renderers[0],n=this._map_drag(t.sx,t.sy,s);if(null==n)return;const[o,a]=n,l=s.data_source,c=s.glyph,[h,_]=[c.xs.field,c.ys.field];if("new"==e)this._pop_glyphs(l,this.model.num_objects),h&&l.get_array(h).push([o]),_&&l.get_array(_).push([a]),this._pad_empty_columns(l,[h,_]);else if("add"==e){if(h){const t=l.data[h].length-1;let e=l.get_array(h)[t];r.isArray(e)||(e=Array.from(e),l.data[h][t]=e),e.push(o)}if(_){const t=l.data[_].length-1;let e=l.get_array(_)[t];r.isArray(e)||(e=Array.from(e),l.data[_][t]=e),e.push(a)}}this._emit_cds_changes(l,!0,!0,i)}_pan_start(t){this._draw(t,"new")}_pan(t){this._draw(t,"add")}_pan_end(t){this._draw(t,"add",!0)}_tap(t){this._select_event(t,this._select_mode(t),this.model.renderers)}_keyup(t){if(this.model.active&&this._mouse_in_frame)for(const e of this.model.renderers)t.keyCode===o.Keys.Esc?e.data_source.selection_manager.clear():t.keyCode===o.Keys.Backspace&&this._delete_selected(e)}}i.FreehandDrawToolView=c,c.__name__="FreehandDrawToolView";class h extends a.EditTool{constructor(t){super(t),this.tool_name="Freehand Draw Tool",this.icon=l.tool_icon_freehand_draw,this.event_type=["pan","tap"],this.default_order=3}static init_FreehandDrawTool(){this.prototype.default_view=c,this.define((({Int:t})=>({num_objects:[t,0]}))),this.register_alias("freehand_draw",(()=>new h))}}i.FreehandDrawTool=h,h.__name__="FreehandDrawTool",h.init_FreehandDrawTool()},function(t,e,i,s,n){s();const o=t(43),r=t(370),a=t(242);class l extends r.EditToolView{_tap(t){if(this._select_event(t,this._select_mode(t),this.model.renderers).length||!this.model.add)return;const e=this.model.renderers[0],i=this._map_drag(t.sx,t.sy,e);if(null==i)return;const s=e.glyph,n=e.data_source,[o,r]=[s.x.field,s.y.field],[a,l]=i;this._pop_glyphs(n,this.model.num_objects),o&&n.get_array(o).push(a),r&&n.get_array(r).push(l),this._pad_empty_columns(n,[o,r]),n.change.emit(),n.data=n.data,n.properties.data.change.emit()}_keyup(t){if(this.model.active&&this._mouse_in_frame)for(const e of this.model.renderers)t.keyCode===o.Keys.Backspace?this._delete_selected(e):t.keyCode==o.Keys.Esc&&e.data_source.selection_manager.clear()}_pan_start(t){this.model.drag&&(this._select_event(t,"append",this.model.renderers),this._basepoint=[t.sx,t.sy])}_pan(t){this.model.drag&&null!=this._basepoint&&this._drag_points(t,this.model.renderers)}_pan_end(t){if(this.model.drag){this._pan(t);for(const t of this.model.renderers)this._emit_cds_changes(t.data_source,!1,!0,!0);this._basepoint=null}}}i.PointDrawToolView=l,l.__name__="PointDrawToolView";class c extends r.EditTool{constructor(t){super(t),this.tool_name="Point Draw Tool",this.icon=a.tool_icon_point_draw,this.event_type=["tap","pan","move"],this.default_order=2}static init_PointDrawTool(){this.prototype.default_view=l,this.define((({Boolean:t,Int:e})=>({add:[t,!0],drag:[t,!0],num_objects:[e,0]})))}}i.PointDrawTool=c,c.__name__="PointDrawTool",c.init_PointDrawTool()},function(t,e,i,s,n){s();const o=t(43),r=t(8),a=t(375),l=t(242);class c extends a.PolyToolView{constructor(){super(...arguments),this._drawing=!1,this._initialized=!1}_tap(t){this._drawing?this._draw(t,"add",!0):this._select_event(t,this._select_mode(t),this.model.renderers)}_draw(t,e,i=!1){const s=this.model.renderers[0],n=this._map_drag(t.sx,t.sy,s);if(this._initialized||this.activate(),null==n)return;const[o,a]=this._snap_to_vertex(t,...n),l=s.data_source,c=s.glyph,[h,_]=[c.xs.field,c.ys.field];if("new"==e)this._pop_glyphs(l,this.model.num_objects),h&&l.get_array(h).push([o,o]),_&&l.get_array(_).push([a,a]),this._pad_empty_columns(l,[h,_]);else if("edit"==e){if(h){const t=l.data[h][l.data[h].length-1];t[t.length-1]=o}if(_){const t=l.data[_][l.data[_].length-1];t[t.length-1]=a}}else if("add"==e){if(h){const t=l.data[h].length-1;let e=l.get_array(h)[t];const i=e[e.length-1];e[e.length-1]=o,r.isArray(e)||(e=Array.from(e),l.data[h][t]=e),e.push(i)}if(_){const t=l.data[_].length-1;let e=l.get_array(_)[t];const i=e[e.length-1];e[e.length-1]=a,r.isArray(e)||(e=Array.from(e),l.data[_][t]=e),e.push(i)}}this._emit_cds_changes(l,!0,!1,i)}_show_vertices(){if(!this.model.active)return;const t=[],e=[];for(let i=0;i<this.model.renderers.length;i++){const s=this.model.renderers[i],n=s.data_source,o=s.glyph,[r,a]=[o.xs.field,o.ys.field];if(r)for(const e of n.get_array(r))t.push(...e);if(a)for(const t of n.get_array(a))e.push(...t);this._drawing&&i==this.model.renderers.length-1&&(t.splice(t.length-1,1),e.splice(e.length-1,1))}this._set_vertices(t,e)}_doubletap(t){this.model.active&&(this._drawing?(this._drawing=!1,this._draw(t,"edit",!0)):(this._drawing=!0,this._draw(t,"new",!0)))}_move(t){this._drawing&&this._draw(t,"edit")}_remove(){const t=this.model.renderers[0],e=t.data_source,i=t.glyph,[s,n]=[i.xs.field,i.ys.field];if(s){const t=e.data[s].length-1,i=e.get_array(s)[t];i.splice(i.length-1,1)}if(n){const t=e.data[n].length-1,i=e.get_array(n)[t];i.splice(i.length-1,1)}this._emit_cds_changes(e)}_keyup(t){if(this.model.active&&this._mouse_in_frame)for(const e of this.model.renderers)t.keyCode===o.Keys.Backspace?this._delete_selected(e):t.keyCode==o.Keys.Esc&&(this._drawing&&(this._remove(),this._drawing=!1),e.data_source.selection_manager.clear())}_pan_start(t){this.model.drag&&(this._select_event(t,"append",this.model.renderers),this._basepoint=[t.sx,t.sy])}_pan(t){if(null==this._basepoint||!this.model.drag)return;const[e,i]=this._basepoint;for(const s of this.model.renderers){const n=this._map_drag(e,i,s),o=this._map_drag(t.sx,t.sy,s);if(null==o||null==n)continue;const r=s.data_source,a=s.glyph,[l,c]=[a.xs.field,a.ys.field];if(!l&&!c)continue;const[h,_]=o,[d,u]=n,[p,m]=[h-d,_-u];for(const t of r.selected.indices){let e,i,s;l&&(i=r.data[l][t]),c?(s=r.data[c][t],e=s.length):e=i.length;for(let t=0;t<e;t++)i&&(i[t]+=p),s&&(s[t]+=m)}r.change.emit()}this._basepoint=[t.sx,t.sy]}_pan_end(t){if(this.model.drag){this._pan(t);for(const t of this.model.renderers)this._emit_cds_changes(t.data_source);this._basepoint=null}}activate(){if(this.model.vertex_renderer&&this.model.active){if(this._show_vertices(),!this._initialized)for(const t of this.model.renderers){const e=t.data_source;e.connect(e.properties.data.change,(()=>this._show_vertices()))}this._initialized=!0}}deactivate(){this._drawing&&(this._remove(),this._drawing=!1),this.model.vertex_renderer&&this._hide_vertices()}}i.PolyDrawToolView=c,c.__name__="PolyDrawToolView";class h extends a.PolyTool{constructor(t){super(t),this.tool_name="Polygon Draw Tool",this.icon=l.tool_icon_poly_draw,this.event_type=["pan","tap","move"],this.default_order=3}static init_PolyDrawTool(){this.prototype.default_view=c,this.define((({Boolean:t,Int:e})=>({drag:[t,!0],num_objects:[e,0]})))}}i.PolyDrawTool=h,h.__name__="PolyDrawTool",h.init_PolyDrawTool()},function(t,e,i,s,n){s();const o=t(8),r=t(370);class a extends r.EditToolView{_set_vertices(t,e){const i=this.model.vertex_renderer.glyph,s=this.model.vertex_renderer.data_source,[n,r]=[i.x.field,i.y.field];n&&(o.isArray(t)?s.data[n]=t:i.x={value:t}),r&&(o.isArray(e)?s.data[r]=e:i.y={value:e}),this._emit_cds_changes(s,!0,!0,!1)}_hide_vertices(){this._set_vertices([],[])}_snap_to_vertex(t,e,i){if(this.model.vertex_renderer){const s=this._select_event(t,"replace",[this.model.vertex_renderer]),n=this.model.vertex_renderer.data_source,o=this.model.vertex_renderer.glyph,[r,a]=[o.x.field,o.y.field];if(s.length){const t=n.selected.indices[0];r&&(e=n.data[r][t]),a&&(i=n.data[a][t]),n.selection_manager.clear()}}return[e,i]}}i.PolyToolView=a,a.__name__="PolyToolView";class l extends r.EditTool{constructor(t){super(t)}static init_PolyTool(){this.define((({AnyRef:t})=>({vertex_renderer:[t()]})))}}i.PolyTool=l,l.__name__="PolyTool",l.init_PolyTool()},function(t,e,i,s,n){s();const o=t(43),r=t(8),a=t(375),l=t(242);class c extends a.PolyToolView{constructor(){super(...arguments),this._drawing=!1,this._cur_index=null}_doubletap(t){if(!this.model.active)return;const e=this._map_drag(t.sx,t.sy,this.model.vertex_renderer);if(null==e)return;const[i,s]=e,n=this._select_event(t,"replace",[this.model.vertex_renderer]),o=this.model.vertex_renderer.data_source,r=this.model.vertex_renderer.glyph,[a,l]=[r.x.field,r.y.field];if(n.length&&null!=this._selected_renderer){const t=o.selected.indices[0];this._drawing?(this._drawing=!1,o.selection_manager.clear()):(o.selected.indices=[t+1],a&&o.get_array(a).splice(t+1,0,i),l&&o.get_array(l).splice(t+1,0,s),this._drawing=!0),o.change.emit(),this._emit_cds_changes(this._selected_renderer.data_source)}else this._show_vertices(t)}_show_vertices(t){if(!this.model.active)return;const e=this.model.renderers[0],i=()=>this._update_vertices(e),s=null==e?void 0:e.data_source,n=this._select_event(t,"replace",this.model.renderers);if(!n.length)return this._set_vertices([],[]),this._selected_renderer=null,this._drawing=!1,this._cur_index=null,void(null!=s&&s.disconnect(s.properties.data.change,i));null!=s&&s.connect(s.properties.data.change,i),this._cur_index=n[0].data_source.selected.indices[0],this._update_vertices(n[0])}_update_vertices(t){const e=t.glyph,i=t.data_source,s=this._cur_index,[n,o]=[e.xs.field,e.ys.field];if(this._drawing)return;if(null==s&&(n||o))return;let a,l;n&&null!=s?(a=i.data[n][s],r.isArray(a)||(i.data[n][s]=a=Array.from(a))):a=e.xs.value,o&&null!=s?(l=i.data[o][s],r.isArray(l)||(i.data[o][s]=l=Array.from(l))):l=e.ys.value,this._selected_renderer=t,this._set_vertices(a,l)}_move(t){if(this._drawing&&null!=this._selected_renderer){const e=this.model.vertex_renderer,i=e.data_source,s=e.glyph,n=this._map_drag(t.sx,t.sy,e);if(null==n)return;let[o,r]=n;const a=i.selected.indices;[o,r]=this._snap_to_vertex(t,o,r),i.selected.indices=a;const[l,c]=[s.x.field,s.y.field],h=a[0];l&&(i.data[l][h]=o),c&&(i.data[c][h]=r),i.change.emit(),this._selected_renderer.data_source.change.emit()}}_tap(t){const e=this.model.vertex_renderer,i=this._map_drag(t.sx,t.sy,e);if(null==i)return;if(this._drawing&&this._selected_renderer){let[s,n]=i;const o=e.data_source,r=e.glyph,[a,l]=[r.x.field,r.y.field],c=o.selected.indices;[s,n]=this._snap_to_vertex(t,s,n);const h=c[0];if(o.selected.indices=[h+1],a){const t=o.get_array(a),e=t[h];t[h]=s,t.splice(h+1,0,e)}if(l){const t=o.get_array(l),e=t[h];t[h]=n,t.splice(h+1,0,e)}return o.change.emit(),void this._emit_cds_changes(this._selected_renderer.data_source,!0,!1,!0)}const s=this._select_mode(t);this._select_event(t,s,[e]),this._select_event(t,s,this.model.renderers)}_remove_vertex(){if(!this._drawing||!this._selected_renderer)return;const t=this.model.vertex_renderer,e=t.data_source,i=t.glyph,s=e.selected.indices[0],[n,o]=[i.x.field,i.y.field];n&&e.get_array(n).splice(s,1),o&&e.get_array(o).splice(s,1),e.change.emit(),this._emit_cds_changes(this._selected_renderer.data_source)}_pan_start(t){this._select_event(t,"append",[this.model.vertex_renderer]),this._basepoint=[t.sx,t.sy]}_pan(t){null!=this._basepoint&&(this._drag_points(t,[this.model.vertex_renderer]),this._selected_renderer&&this._selected_renderer.data_source.change.emit())}_pan_end(t){null!=this._basepoint&&(this._drag_points(t,[this.model.vertex_renderer]),this._emit_cds_changes(this.model.vertex_renderer.data_source,!1,!0,!0),this._selected_renderer&&this._emit_cds_changes(this._selected_renderer.data_source),this._basepoint=null)}_keyup(t){if(!this.model.active||!this._mouse_in_frame)return;let e;e=this._selected_renderer?[this.model.vertex_renderer]:this.model.renderers;for(const i of e)t.keyCode===o.Keys.Backspace?(this._delete_selected(i),this._selected_renderer&&this._emit_cds_changes(this._selected_renderer.data_source)):t.keyCode==o.Keys.Esc&&(this._drawing?(this._remove_vertex(),this._drawing=!1):this._selected_renderer&&this._hide_vertices(),i.data_source.selection_manager.clear())}deactivate(){this._selected_renderer&&(this._drawing&&(this._remove_vertex(),this._drawing=!1),this._hide_vertices())}}i.PolyEditToolView=c,c.__name__="PolyEditToolView";class h extends a.PolyTool{constructor(t){super(t),this.tool_name="Poly Edit Tool",this.icon=l.tool_icon_poly_edit,this.event_type=["tap","pan","move"],this.default_order=4}static init_PolyEditTool(){this.prototype.default_view=c}}i.PolyEditTool=h,h.__name__="PolyEditTool",h.init_PolyEditTool()},function(t,e,i,s,n){s();const o=t(378),r=t(136),a=t(20),l=t(242);class c extends o.SelectToolView{_compute_limits(t){const e=this.plot_view.frame,i=this.model.dimensions;let s=this._base_point;if("center"==this.model.origin){const[e,i]=s,[n,o]=t;s=[e-(n-e),i-(o-i)]}return this.model._get_dim_limits(s,t,e,i)}_pan_start(t){const{sx:e,sy:i}=t;this._base_point=[e,i]}_pan(t){const{sx:e,sy:i}=t,s=[e,i],[n,o]=this._compute_limits(s);this.model.overlay.update({left:n[0],right:n[1],top:o[0],bottom:o[1]}),this.model.select_every_mousemove&&this._do_select(n,o,!1,this._select_mode(t))}_pan_end(t){const{sx:e,sy:i}=t,s=[e,i],[n,o]=this._compute_limits(s);this._do_select(n,o,!0,this._select_mode(t)),this.model.overlay.update({left:null,right:null,top:null,bottom:null}),this._base_point=null,this.plot_view.state.push("box_select",{selection:this.plot_view.get_selection()})}_do_select([t,e],[i,s],n,o="replace"){const r={type:"rect",sx0:t,sx1:e,sy0:i,sy1:s};this._select(r,n,o)}}i.BoxSelectToolView=c,c.__name__="BoxSelectToolView";const h=()=>new r.BoxAnnotation({level:"overlay",top_units:"screen",left_units:"screen",bottom_units:"screen",right_units:"screen",fill_color:"lightgrey",fill_alpha:.5,line_color:"black",line_alpha:1,line_width:2,line_dash:[4,4]});class _ extends o.SelectTool{constructor(t){super(t),this.tool_name="Box Select",this.icon=l.tool_icon_box_select,this.event_type="pan",this.default_order=30}static init_BoxSelectTool(){this.prototype.default_view=c,this.define((({Boolean:t,Ref:e})=>({dimensions:[a.Dimensions,"both"],select_every_mousemove:[t,!1],overlay:[e(r.BoxAnnotation),h],origin:[a.BoxOrigin,"corner"]}))),this.register_alias("box_select",(()=>new _)),this.register_alias("xbox_select",(()=>new _({dimensions:"width"}))),this.register_alias("ybox_select",(()=>new _({dimensions:"height"})))}get tooltip(){return this._get_dim_tooltip(this.dimensions)}}i.BoxSelectTool=_,_.__name__="BoxSelectTool",_.init_BoxSelectTool()},function(t,e,i,s,n){s();const o=t(237),r=t(61),a=t(123),l=t(62),c=t(161),h=t(20),_=t(43),d=t(264),u=t(15),p=t(11);class m extends o.GestureToolView{connect_signals(){super.connect_signals(),this.model.clear.connect((()=>this._clear()))}get computed_renderers(){const{renderers:t,names:e}=this.model,i=this.plot_model.data_renderers;return c.compute_renderers(t,i,e)}_computed_renderers_by_data_source(){var t;const e=new Map;for(const i of this.computed_renderers){let s;if(i instanceof r.GlyphRenderer)s=i.data_source;else{if(!(i instanceof a.GraphRenderer))continue;s=i.node_renderer.data_source}const n=null!==(t=e.get(s))&&void 0!==t?t:[];e.set(s,[...n,i])}return e}_select_mode(t){const{shiftKey:e,ctrlKey:i}=t;return e||i?e&&!i?"append":!e&&i?"intersect":e&&i?"subtract":void p.unreachable():this.model.mode}_keyup(t){t.keyCode==_.Keys.Esc&&this._clear()}_clear(){for(const e of this.computed_renderers)e.get_selection_manager().clear();const t=this.computed_renderers.map((t=>this.plot_view.renderer_view(t)));this.plot_view.request_paint(t)}_select(t,e,i){const s=this._computed_renderers_by_data_source();for(const[,n]of s){const s=n[0].get_selection_manager(),o=[];for(const t of n){const e=this.plot_view.renderer_view(t);null!=e&&o.push(e)}s.select(o,t,e,i)}null!=this.model.callback&&this._emit_callback(t),this._emit_selection_event(t,e)}_emit_selection_event(t,e=!0){const{x_scale:i,y_scale:s}=this.plot_view.frame;let n;switch(t.type){case"point":{const{sx:e,sy:o}=t,r=i.invert(e),a=s.invert(o);n=Object.assign(Object.assign({},t),{x:r,y:a});break}case"span":{const{sx:e,sy:o}=t,r=i.invert(e),a=s.invert(o);n=Object.assign(Object.assign({},t),{x:r,y:a});break}case"rect":{const{sx0:e,sx1:o,sy0:r,sy1:a}=t,[l,c]=i.r_invert(e,o),[h,_]=s.r_invert(r,a);n=Object.assign(Object.assign({},t),{x0:l,y0:h,x1:c,y1:_});break}case"poly":{const{sx:e,sy:o}=t,r=i.v_invert(e),a=s.v_invert(o);n=Object.assign(Object.assign({},t),{x:r,y:a});break}}this.plot_model.trigger_event(new d.SelectionGeometry(n,e))}}i.SelectToolView=m,m.__name__="SelectToolView";class g extends o.GestureTool{constructor(t){super(t)}initialize(){super.initialize(),this.clear=new u.Signal0(this,"clear")}static init_SelectTool(){this.define((({String:t,Array:e,Ref:i,Or:s,Auto:n})=>({renderers:[s(e(i(l.DataRenderer)),n),"auto"],names:[e(t),[]],mode:[h.SelectionMode,"replace"]})))}get menu(){return[{icon:"bk-tool-icon-replace-mode",tooltip:"Replace the current selection",active:()=>"replace"==this.mode,handler:()=>{this.mode="replace",this.active=!0}},{icon:"bk-tool-icon-append-mode",tooltip:"Append to the current selection (Shift)",active:()=>"append"==this.mode,handler:()=>{this.mode="append",this.active=!0}},{icon:"bk-tool-icon-intersect-mode",tooltip:"Intersect with the current selection (Ctrl)",active:()=>"intersect"==this.mode,handler:()=>{this.mode="intersect",this.active=!0}},{icon:"bk-tool-icon-subtract-mode",tooltip:"Subtract from the current selection (Shift+Ctrl)",active:()=>"subtract"==this.mode,handler:()=>{this.mode="subtract",this.active=!0}},null,{icon:"bk-tool-icon-clear-selection",tooltip:"Clear the current selection (Esc)",handler:()=>{this.clear.emit()}}]}}i.SelectTool=g,g.__name__="SelectTool",g.init_SelectTool()},function(t,e,i,s,n){s();const o=t(237),r=t(136),a=t(20),l=t(242);class c extends o.GestureToolView{_match_aspect(t,e,i){const s=i.bbox.aspect,n=i.bbox.h_range.end,o=i.bbox.h_range.start,r=i.bbox.v_range.end,a=i.bbox.v_range.start;let l=Math.abs(t[0]-e[0]),c=Math.abs(t[1]-e[1]);const h=0==c?0:l/c,[_]=h>=s?[1,h/s]:[s/h,1];let d,u,p,m;return t[0]<=e[0]?(d=t[0],u=t[0]+l*_,u>n&&(u=n)):(u=t[0],d=t[0]-l*_,d<o&&(d=o)),l=Math.abs(u-d),t[1]<=e[1]?(m=t[1],p=t[1]+l/s,p>r&&(p=r)):(p=t[1],m=t[1]-l/s,m<a&&(m=a)),c=Math.abs(p-m),t[0]<=e[0]?u=t[0]+s*c:d=t[0]-s*c,[[d,u],[m,p]]}_compute_limits(t){const e=this.plot_view.frame,i=this.model.dimensions;let s,n,o=this._base_point;if("center"==this.model.origin){const[e,i]=o,[s,n]=t;o=[e-(s-e),i-(n-i)]}return this.model.match_aspect&&"both"==i?[s,n]=this._match_aspect(o,t,e):[s,n]=this.model._get_dim_limits(o,t,e,i),[s,n]}_pan_start(t){this._base_point=[t.sx,t.sy]}_pan(t){const e=[t.sx,t.sy],[i,s]=this._compute_limits(e);this.model.overlay.update({left:i[0],right:i[1],top:s[0],bottom:s[1]})}_pan_end(t){const e=[t.sx,t.sy],[i,s]=this._compute_limits(e);this._update(i,s),this.model.overlay.update({left:null,right:null,top:null,bottom:null}),this._base_point=null}_update([t,e],[i,s]){if(Math.abs(e-t)<=5||Math.abs(s-i)<=5)return;const{x_scales:n,y_scales:o}=this.plot_view.frame,r=new Map;for(const[c,h]of n){const[i,s]=h.r_invert(t,e);r.set(c,{start:i,end:s})}const a=new Map;for(const[c,h]of o){const[t,e]=h.r_invert(i,s);a.set(c,{start:t,end:e})}const l={xrs:r,yrs:a};this.plot_view.state.push("box_zoom",{range:l}),this.plot_view.update_range(l)}}i.BoxZoomToolView=c,c.__name__="BoxZoomToolView";const h=()=>new r.BoxAnnotation({level:"overlay",top_units:"screen",left_units:"screen",bottom_units:"screen",right_units:"screen",fill_color:"lightgrey",fill_alpha:.5,line_color:"black",line_alpha:1,line_width:2,line_dash:[4,4]});class _ extends o.GestureTool{constructor(t){super(t),this.tool_name="Box Zoom",this.icon=l.tool_icon_box_zoom,this.event_type="pan",this.default_order=20}static init_BoxZoomTool(){this.prototype.default_view=c,this.define((({Boolean:t,Ref:e})=>({dimensions:[a.Dimensions,"both"],overlay:[e(r.BoxAnnotation),h],match_aspect:[t,!1],origin:[a.BoxOrigin,"corner"]}))),this.register_alias("box_zoom",(()=>new _({dimensions:"both"}))),this.register_alias("xbox_zoom",(()=>new _({dimensions:"width"}))),this.register_alias("ybox_zoom",(()=>new _({dimensions:"height"})))}get tooltip(){return this._get_dim_tooltip(this.dimensions)}}i.BoxZoomTool=_,_.__name__="BoxZoomTool",_.init_BoxZoomTool()},function(t,e,i,s,n){s();const o=t(378),r=t(231),a=t(381),l=t(43),c=t(242);class h extends o.SelectToolView{constructor(){super(...arguments),this.sxs=[],this.sys=[]}connect_signals(){super.connect_signals(),this.connect(this.model.properties.active.change,(()=>this._active_change()))}_active_change(){this.model.active||this._clear_overlay()}_keyup(t){t.keyCode==l.Keys.Enter&&this._clear_overlay()}_pan_start(t){this.sxs=[],this.sys=[];const{sx:e,sy:i}=t;this._append_overlay(e,i)}_pan(t){const[e,i]=this.plot_view.frame.bbox.clip(t.sx,t.sy);this._append_overlay(e,i),this.model.select_every_mousemove&&this._do_select(this.sxs,this.sys,!1,this._select_mode(t))}_pan_end(t){const{sxs:e,sys:i}=this;this._clear_overlay(),this._do_select(e,i,!0,this._select_mode(t)),this.plot_view.state.push("lasso_select",{selection:this.plot_view.get_selection()})}_append_overlay(t,e){const{sxs:i,sys:s}=this;i.push(t),s.push(e),this.model.overlay.update({xs:i,ys:s})}_clear_overlay(){this.sxs=[],this.sys=[],this.model.overlay.update({xs:this.sxs,ys:this.sys})}_do_select(t,e,i,s){const n={type:"poly",sx:t,sy:e};this._select(n,i,s)}}i.LassoSelectToolView=h,h.__name__="LassoSelectToolView";class _ extends o.SelectTool{constructor(t){super(t),this.tool_name="Lasso Select",this.icon=c.tool_icon_lasso_select,this.event_type="pan",this.default_order=12}static init_LassoSelectTool(){this.prototype.default_view=h,this.define((({Boolean:t,Ref:e})=>({select_every_mousemove:[t,!0],overlay:[e(r.PolyAnnotation),a.DEFAULT_POLY_OVERLAY]}))),this.register_alias("lasso_select",(()=>new _))}}i.LassoSelectTool=_,_.__name__="LassoSelectTool",_.init_LassoSelectTool()},function(t,e,i,s,n){s();const o=t(378),r=t(231),a=t(43),l=t(9),c=t(242);class h extends o.SelectToolView{initialize(){super.initialize(),this.data={sx:[],sy:[]}}connect_signals(){super.connect_signals(),this.connect(this.model.properties.active.change,(()=>this._active_change()))}_active_change(){this.model.active||this._clear_data()}_keyup(t){t.keyCode==a.Keys.Enter&&this._clear_data()}_doubletap(t){this._do_select(this.data.sx,this.data.sy,!0,this._select_mode(t)),this.plot_view.state.push("poly_select",{selection:this.plot_view.get_selection()}),this._clear_data()}_clear_data(){this.data={sx:[],sy:[]},this.model.overlay.update({xs:[],ys:[]})}_tap(t){const{sx:e,sy:i}=t;this.plot_view.frame.bbox.contains(e,i)&&(this.data.sx.push(e),this.data.sy.push(i),this.model.overlay.update({xs:l.copy(this.data.sx),ys:l.copy(this.data.sy)}))}_do_select(t,e,i,s){const n={type:"poly",sx:t,sy:e};this._select(n,i,s)}}i.PolySelectToolView=h,h.__name__="PolySelectToolView",i.DEFAULT_POLY_OVERLAY=()=>new r.PolyAnnotation({level:"overlay",xs_units:"screen",ys_units:"screen",fill_color:"lightgrey",fill_alpha:.5,line_color:"black",line_alpha:1,line_width:2,line_dash:[4,4]});class _ extends o.SelectTool{constructor(t){super(t),this.tool_name="Poly Select",this.icon=c.tool_icon_polygon_select,this.event_type="tap",this.default_order=11}static init_PolySelectTool(){this.prototype.default_view=h,this.define((({Ref:t})=>({overlay:[t(r.PolyAnnotation),i.DEFAULT_POLY_OVERLAY]}))),this.register_alias("poly_select",(()=>new _))}}i.PolySelectTool=_,_.__name__="PolySelectTool",_.init_PolySelectTool()},function(t,e,i,s,n){s();const o=t(20),r=t(383),a=t(242);class l extends r.LineToolView{constructor(){super(...arguments),this._drawing=!1}_doubletap(t){if(!this.model.active)return;const e=this.model.renderers;for(const i of e)1==this._select_event(t,"replace",[i]).length&&(this._selected_renderer=i);this._show_intersections(),this._update_line_cds()}_show_intersections(){if(!this.model.active)return;if(null==this._selected_renderer)return;if(!this.model.renderers.length)return this._set_intersection([],[]),this._selected_renderer=null,void(this._drawing=!1);const t=this._selected_renderer.data_source,e=this._selected_renderer.glyph,[i,s]=[e.x.field,e.y.field],n=t.get_array(i),o=t.get_array(s);this._set_intersection(n,o)}_tap(t){const e=this.model.intersection_renderer;if(null==this._map_drag(t.sx,t.sy,e))return;if(this._drawing&&this._selected_renderer){const i=this._select_mode(t);if(0==this._select_event(t,i,[e]).length)return}const i=this._select_mode(t);this._select_event(t,i,[e]),this._select_event(t,i,this.model.renderers)}_update_line_cds(){if(null==this._selected_renderer)return;const t=this.model.intersection_renderer.glyph,e=this.model.intersection_renderer.data_source,[i,s]=[t.x.field,t.y.field];if(i&&s){const t=e.data[i],n=e.data[s];this._selected_renderer.data_source.data[i]=t,this._selected_renderer.data_source.data[s]=n}this._emit_cds_changes(this._selected_renderer.data_source,!0,!0,!1)}_pan_start(t){this._select_event(t,"append",[this.model.intersection_renderer]),this._basepoint=[t.sx,t.sy]}_pan(t){null!=this._basepoint&&(this._drag_points(t,[this.model.intersection_renderer],this.model.dimensions),this._selected_renderer&&this._selected_renderer.data_source.change.emit())}_pan_end(t){null!=this._basepoint&&(this._drag_points(t,[this.model.intersection_renderer]),this._emit_cds_changes(this.model.intersection_renderer.data_source,!1,!0,!0),this._selected_renderer&&this._emit_cds_changes(this._selected_renderer.data_source),this._basepoint=null)}activate(){this._drawing=!0}deactivate(){this._selected_renderer&&(this._drawing&&(this._drawing=!1),this._hide_intersections())}}i.LineEditToolView=l,l.__name__="LineEditToolView";class c extends r.LineTool{constructor(t){super(t),this.tool_name="Line Edit Tool",this.icon=a.tool_icon_line_edit,this.event_type=["tap","pan","move"],this.default_order=4}static init_LineEditTool(){this.prototype.default_view=l,this.define((()=>({dimensions:[o.Dimensions,"both"]})))}get tooltip(){return this._get_dim_tooltip(this.dimensions)}}i.LineEditTool=c,c.__name__="LineEditTool",c.init_LineEditTool()},function(t,e,i,s,n){s();const o=t(8),r=t(370);class a extends r.EditToolView{_set_intersection(t,e){const i=this.model.intersection_renderer.glyph,s=this.model.intersection_renderer.data_source,[n,r]=[i.x.field,i.y.field];n&&(o.isArray(t)?s.data[n]=t:i.x={value:t}),r&&(o.isArray(e)?s.data[r]=e:i.y={value:e}),this._emit_cds_changes(s,!0,!0,!1)}_hide_intersections(){this._set_intersection([],[])}}i.LineToolView=a,a.__name__="LineToolView";class l extends r.EditTool{constructor(t){super(t)}static init_LineTool(){this.define((({AnyRef:t})=>({intersection_renderer:[t()]})))}}i.LineTool=l,l.__name__="LineTool",l.init_LineTool()},function(t,e,i,s,n){s();const o=t(1),r=t(237),a=t(20),l=o.__importStar(t(242));function c(t,e,i){const s=new Map;for(const[n,o]of t){const[t,r]=o.r_invert(e,i);s.set(n,{start:t,end:r})}return s}i.update_ranges=c;class h extends r.GestureToolView{_pan_start(t){var e;this.last_dx=0,this.last_dy=0;const{sx:i,sy:s}=t,n=this.plot_view.frame.bbox;if(!n.contains(i,s)){const t=n.h_range,e=n.v_range;(i<t.start||i>t.end)&&(this.v_axis_only=!0),(s<e.start||s>e.end)&&(this.h_axis_only=!0)}null===(e=this.model.document)||void 0===e||e.interactive_start(this.plot_model)}_pan(t){var e;this._update(t.deltaX,t.deltaY),null===(e=this.model.document)||void 0===e||e.interactive_start(this.plot_model)}_pan_end(t){this.h_axis_only=!1,this.v_axis_only=!1,null!=this.pan_info&&this.plot_view.state.push("pan",{range:this.pan_info})}_update(t,e){const i=this.plot_view.frame,s=t-this.last_dx,n=e-this.last_dy,o=i.bbox.h_range,r=o.start-s,a=o.end-s,l=i.bbox.v_range,h=l.start-n,_=l.end-n,d=this.model.dimensions;let u,p,m,g,f,b;"width"!=d&&"both"!=d||this.v_axis_only?(u=o.start,p=o.end,m=0):(u=r,p=a,m=-s),"height"!=d&&"both"!=d||this.h_axis_only?(g=l.start,f=l.end,b=0):(g=h,f=_,b=-n),this.last_dx=t,this.last_dy=e;const{x_scales:v,y_scales:y}=i,x=c(v,u,p),w=c(y,g,f);this.pan_info={xrs:x,yrs:w,sdx:m,sdy:b},this.plot_view.update_range(this.pan_info,{panning:!0})}}i.PanToolView=h,h.__name__="PanToolView";class _ extends r.GestureTool{constructor(t){super(t),this.tool_name="Pan",this.event_type="pan",this.default_order=10}static init_PanTool(){this.prototype.default_view=h,this.define((()=>({dimensions:[a.Dimensions,"both",{on_update(t,e){switch(t){case"both":e.icon=l.tool_icon_pan;break;case"width":e.icon=l.tool_icon_xpan;break;case"height":e.icon=l.tool_icon_ypan}}}]}))),this.register_alias("pan",(()=>new _({dimensions:"both"}))),this.register_alias("xpan",(()=>new _({dimensions:"width"}))),this.register_alias("ypan",(()=>new _({dimensions:"height"})))}get tooltip(){return this._get_dim_tooltip(this.dimensions)}}i.PanTool=_,_.__name__="PanTool",_.init_PanTool()},function(t,e,i,s,n){s();const o=t(136),r=t(156),a=t(19),l=t(237),c=t(242);function h(t){switch(t){case 1:return 2;case 2:return 1;case 4:return 5;case 5:return 4;default:return t}}function _(t,e,i,s){if(null==e)return!1;const n=i.compute(e);return Math.abs(t-n)<s}function d(t,e,i,s,n){let o=!0;if(null!=n.left&&null!=n.right){const e=i.invert(t);(e<n.left||e>n.right)&&(o=!1)}if(null!=n.bottom&&null!=n.top){const t=s.invert(e);(t<n.bottom||t>n.top)&&(o=!1)}return o}function u(t,e,i){let s=0;return t>=i.start&&t<=i.end&&(s+=1),e>=i.start&&e<=i.end&&(s+=1),s}function p(t,e,i,s){const n=e.compute(t),o=e.invert(n+i);return o>=s.start&&o<=s.end?o:t}function m(t,e,i){return t>e.start?(e.end=t,i):(e.end=e.start,e.start=t,h(i))}function g(t,e,i){return t<e.end?(e.start=t,i):(e.start=e.end,e.end=t,h(i))}function f(t,e,i,s){const[n,o]=e.r_compute(t.start,t.end),[r,a]=e.r_invert(n+i,o+i),l=u(t.start,t.end,s);u(r,a,s)>=l&&(t.start=r,t.end=a)}i.flip_side=h,i.is_near=_,i.is_inside=d,i.sides_inside=u,i.compute_value=p,i.update_range_end_side=m,i.update_range_start_side=g,i.update_range=f;class b extends l.GestureToolView{initialize(){super.initialize(),this.side=0,this.model.update_overlay_from_ranges()}connect_signals(){super.connect_signals(),null!=this.model.x_range&&this.connect(this.model.x_range.change,(()=>this.model.update_overlay_from_ranges())),null!=this.model.y_range&&this.connect(this.model.y_range.change,(()=>this.model.update_overlay_from_ranges()))}_pan_start(t){this.last_dx=0,this.last_dy=0;const e=this.model.x_range,i=this.model.y_range,{frame:s}=this.plot_view,n=s.x_scale,r=s.y_scale,a=this.model.overlay,{left:l,right:c,top:h,bottom:u}=a,p=this.model.overlay.line_width+o.EDGE_TOLERANCE;null!=e&&this.model.x_interaction&&(_(t.sx,l,n,p)?this.side=1:_(t.sx,c,n,p)?this.side=2:d(t.sx,t.sy,n,r,a)&&(this.side=3)),null!=i&&this.model.y_interaction&&(0==this.side&&_(t.sy,u,r,p)&&(this.side=4),0==this.side&&_(t.sy,h,r,p)?this.side=5:d(t.sx,t.sy,n,r,this.model.overlay)&&(3==this.side?this.side=7:this.side=6))}_pan(t){const e=this.plot_view.frame,i=t.deltaX-this.last_dx,s=t.deltaY-this.last_dy,n=this.model.x_range,o=this.model.y_range,r=e.x_scale,a=e.y_scale;if(null!=n)if(3==this.side||7==this.side)f(n,r,i,e.x_range);else if(1==this.side){const t=p(n.start,r,i,e.x_range);this.side=g(t,n,this.side)}else if(2==this.side){const t=p(n.end,r,i,e.x_range);this.side=m(t,n,this.side)}if(null!=o)if(6==this.side||7==this.side)f(o,a,s,e.y_range);else if(4==this.side){const t=p(o.start,a,s,e.y_range);this.side=g(t,o,this.side)}else if(5==this.side){const t=p(o.end,a,s,e.y_range);this.side=m(t,o,this.side)}this.last_dx=t.deltaX,this.last_dy=t.deltaY}_pan_end(t){this.side=0}}i.RangeToolView=b,b.__name__="RangeToolView";const v=()=>new o.BoxAnnotation({level:"overlay",fill_color:"lightgrey",fill_alpha:.5,line_color:"black",line_alpha:1,line_width:.5,line_dash:[2,2]});class y extends l.GestureTool{constructor(t){super(t),this.tool_name="Range Tool",this.icon=c.tool_icon_range,this.event_type="pan",this.default_order=1}static init_RangeTool(){this.prototype.default_view=b,this.define((({Boolean:t,Ref:e,Nullable:i})=>({x_range:[i(e(r.Range1d)),null],x_interaction:[t,!0],y_range:[i(e(r.Range1d)),null],y_interaction:[t,!0],overlay:[e(o.BoxAnnotation),v]})))}initialize(){super.initialize(),this.overlay.in_cursor="grab",this.overlay.ew_cursor=null!=this.x_range&&this.x_interaction?"ew-resize":null,this.overlay.ns_cursor=null!=this.y_range&&this.y_interaction?"ns-resize":null}update_overlay_from_ranges(){null==this.x_range&&null==this.y_range&&(this.overlay.left=null,this.overlay.right=null,this.overlay.bottom=null,this.overlay.top=null,a.logger.warn("RangeTool not configured with any Ranges.")),null==this.x_range?(this.overlay.left=null,this.overlay.right=null):(this.overlay.left=this.x_range.start,this.overlay.right=this.x_range.end),null==this.y_range?(this.overlay.bottom=null,this.overlay.top=null):(this.overlay.bottom=this.y_range.start,this.overlay.top=this.y_range.end)}}i.RangeTool=y,y.__name__="RangeTool",y.init_RangeTool()},function(t,e,i,s,n){s();const o=t(378),r=t(20),a=t(242);class l extends o.SelectToolView{_tap(t){"tap"==this.model.gesture&&this._handle_tap(t)}_doubletap(t){"doubletap"==this.model.gesture&&this._handle_tap(t)}_handle_tap(t){const{sx:e,sy:i}=t,s={type:"point",sx:e,sy:i};this._select(s,!0,this._select_mode(t))}_select(t,e,i){const{callback:s}=this.model;if("select"==this.model.behavior){const n=this._computed_renderers_by_data_source();for(const[,o]of n){const n=o[0].get_selection_manager(),r=o.map((t=>this.plot_view.renderer_view(t))).filter((t=>null!=t));if(n.select(r,t,e,i)&&null!=s){const e=r[0].coordinates.x_scale.invert(t.sx),i=r[0].coordinates.y_scale.invert(t.sy),o={geometries:Object.assign(Object.assign({},t),{x:e,y:i}),source:n.source};s.execute(this.model,o)}}this._emit_selection_event(t),this.plot_view.state.push("tap",{selection:this.plot_view.get_selection()})}else for(const n of this.computed_renderers){const e=this.plot_view.renderer_view(n);if(null==e)continue;const i=n.get_selection_manager();if(i.inspect(e,t)&&null!=s){const n=e.coordinates.x_scale.invert(t.sx),o=e.coordinates.y_scale.invert(t.sy),r={geometries:Object.assign(Object.assign({},t),{x:n,y:o}),source:i.source};s.execute(this.model,r)}}}}i.TapToolView=l,l.__name__="TapToolView";class c extends o.SelectTool{constructor(t){super(t),this.tool_name="Tap",this.icon=a.tool_icon_tap_select,this.event_type="tap",this.default_order=10}static init_TapTool(){this.prototype.default_view=l,this.define((({Any:t,Enum:e,Nullable:i})=>({behavior:[r.TapBehavior,"select"],gesture:[e("tap","doubletap"),"tap"],callback:[i(t)]}))),this.register_alias("click",(()=>new c({behavior:"inspect"}))),this.register_alias("tap",(()=>new c)),this.register_alias("doubletap",(()=>new c({gesture:"doubletap"})))}}i.TapTool=c,c.__name__="TapTool",c.init_TapTool()},function(t,e,i,s,n){s();const o=t(237),r=t(20),a=t(242),l=t(384);class c extends o.GestureToolView{_scroll(t){let e=this.model.speed*t.delta;e>.9?e=.9:e<-.9&&(e=-.9),this._update_ranges(e)}_update_ranges(t){var e;const{frame:i}=this.plot_view,s=i.bbox.h_range,n=i.bbox.v_range,[o,r]=[s.start,s.end],[a,c]=[n.start,n.end];let h,_,d,u;switch(this.model.dimension){case"height":{const e=Math.abs(c-a);h=o,_=r,d=a-e*t,u=c-e*t;break}case"width":{const e=Math.abs(r-o);h=o-e*t,_=r-e*t,d=a,u=c;break}}const{x_scales:p,y_scales:m}=i,g={xrs:l.update_ranges(p,h,_),yrs:l.update_ranges(m,d,u),factor:t};this.plot_view.state.push("wheel_pan",{range:g}),this.plot_view.update_range(g,{scrolling:!0}),null===(e=this.model.document)||void 0===e||e.interactive_start(this.plot_model)}}i.WheelPanToolView=c,c.__name__="WheelPanToolView";class h extends o.GestureTool{constructor(t){super(t),this.tool_name="Wheel Pan",this.icon=a.tool_icon_wheel_pan,this.event_type="scroll",this.default_order=12}static init_WheelPanTool(){this.prototype.default_view=c,this.define((()=>({dimension:[r.Dimension,"width"]}))),this.internal((({Number:t})=>({speed:[t,.001]}))),this.register_alias("xwheel_pan",(()=>new h({dimension:"width"}))),this.register_alias("ywheel_pan",(()=>new h({dimension:"height"})))}get tooltip(){return this._get_dim_tooltip(this.dimension)}}i.WheelPanTool=h,h.__name__="WheelPanTool",h.init_WheelPanTool()},function(t,e,i,s,n){s();const o=t(237),r=t(368),a=t(20),l=t(27),c=t(242);class h extends o.GestureToolView{_pinch(t){const{sx:e,sy:i,scale:s,ctrlKey:n,shiftKey:o}=t;let r;r=s>=1?20*(s-1):-20/s,this._scroll({type:"wheel",sx:e,sy:i,delta:r,ctrlKey:n,shiftKey:o})}_scroll(t){var e;const{frame:i}=this.plot_view,s=i.bbox.h_range,n=i.bbox.v_range,{sx:o,sy:a}=t,l=this.model.dimensions,c=("width"==l||"both"==l)&&s.start<o&&o<s.end,h=("height"==l||"both"==l)&&n.start<a&&a<n.end;if(!(c&&h||this.model.zoom_on_axis))return;const _=this.model.speed*t.delta,d=r.scale_range(i,_,c,h,{x:o,y:a});this.plot_view.state.push("wheel_zoom",{range:d});const{maintain_focus:u}=this.model;this.plot_view.update_range(d,{scrolling:!0,maintain_focus:u}),null===(e=this.model.document)||void 0===e||e.interactive_start(this.plot_model)}}i.WheelZoomToolView=h,h.__name__="WheelZoomToolView";class _ extends o.GestureTool{constructor(t){super(t),this.tool_name="Wheel Zoom",this.icon=c.tool_icon_wheel_zoom,this.event_type=l.is_mobile?"pinch":"scroll",this.default_order=10}static init_WheelZoomTool(){this.prototype.default_view=h,this.define((({Boolean:t,Number:e})=>({dimensions:[a.Dimensions,"both"],maintain_focus:[t,!0],zoom_on_axis:[t,!0],speed:[e,1/600]}))),this.register_alias("wheel_zoom",(()=>new _({dimensions:"both"}))),this.register_alias("xwheel_zoom",(()=>new _({dimensions:"width"}))),this.register_alias("ywheel_zoom",(()=>new _({dimensions:"height"})))}get tooltip(){return this._get_dim_tooltip(this.dimensions)}}i.WheelZoomTool=_,_.__name__="WheelZoomTool",_.init_WheelZoomTool()},function(t,e,i,s,n){s();const o=t(247),r=t(233),a=t(20),l=t(13),c=t(242);class h extends o.InspectToolView{_move(t){if(!this.model.active)return;const{sx:e,sy:i}=t;this.plot_view.frame.bbox.contains(e,i)?this._update_spans(e,i):this._update_spans(null,null)}_move_exit(t){this._update_spans(null,null)}_update_spans(t,e){const i=this.model.dimensions;"width"!=i&&"both"!=i||(this.model.spans.width.location=e),"height"!=i&&"both"!=i||(this.model.spans.height.location=t)}}i.CrosshairToolView=h,h.__name__="CrosshairToolView";class _ extends o.InspectTool{constructor(t){super(t),this.tool_name="Crosshair",this.icon=c.tool_icon_crosshair}static init_CrosshairTool(){function t(t,e){return new r.Span({for_hover:!0,dimension:e,location_units:"screen",level:"overlay",line_color:t.line_color,line_width:t.line_width,line_alpha:t.line_alpha})}this.prototype.default_view=h,this.define((({Alpha:t,Number:e,Color:i})=>({dimensions:[a.Dimensions,"both"],line_color:[i,"black"],line_width:[e,1],line_alpha:[t,1]}))),this.internal((({Struct:e,Ref:i})=>({spans:[e({width:i(r.Span),height:i(r.Span)}),e=>({width:t(e,"width"),height:t(e,"height")})]}))),this.register_alias("crosshair",(()=>new _))}get tooltip(){return this._get_dim_tooltip(this.dimensions)}get synthetic_renderers(){return l.values(this.spans)}}i.CrosshairTool=_,_.__name__="CrosshairTool",_.init_CrosshairTool()},function(t,e,i,s,n){s();const o=t(53),r=t(13),a=t(34);class l extends o.Model{constructor(t){super(t)}static init_CustomJSHover(){this.define((({Unknown:t,String:e,Dict:i})=>({args:[i(t),{}],code:[e,""]})))}get values(){return r.values(this.args)}_make_code(t,e,i,s){return new Function(...r.keys(this.args),t,e,i,a.use_strict(s))}format(t,e,i){return this._make_code("value","format","special_vars",this.code)(...this.values,t,e,i)}}i.CustomJSHover=l,l.__name__="CustomJSHover",l.init_CustomJSHover()},function(t,e,i,s,n){s();const o=t(1),r=t(247),a=t(390),l=t(254),c=t(61),h=t(123),_=t(62),d=t(63),u=t(127),p=o.__importStar(t(107)),m=t(182),g=t(43),f=t(22),b=t(13),v=t(245),y=t(8),x=t(122),w=t(20),A=t(242),k=t(15),S=t(161),T=o.__importStar(t(255));function C(t,e,i,s,n,o){const r={x:n[t],y:o[t]},a={x:n[t+1],y:o[t+1]};let l,c;if("span"==e.type)"h"==e.direction?(l=Math.abs(r.x-i),c=Math.abs(a.x-i)):(l=Math.abs(r.y-s),c=Math.abs(a.y-s));else{const t={x:i,y:s};l=p.dist_2_pts(r,t),c=p.dist_2_pts(a,t)}return l<c?[[r.x,r.y],t]:[[a.x,a.y],t+1]}function M(t,e,i){return[[t[i],e[i]],i]}i._nearest_line_hit=C,i._line_hit=M;class E extends r.InspectToolView{initialize(){super.initialize(),this._ttmodels=new Map,this._ttviews=new Map}async lazy_initialize(){await super.lazy_initialize(),await this._update_ttmodels()}remove(){x.remove_views(this._ttviews),super.remove()}connect_signals(){super.connect_signals();const t=this.plot_model.properties.renderers,{renderers:e,tooltips:i}=this.model.properties;this.on_change(i,(()=>delete this._template_el)),this.on_change([t,e,i],(async()=>await this._update_ttmodels()))}async _update_ttmodels(){const{_ttmodels:t,computed_renderers:e}=this;t.clear();const{tooltips:i}=this.model;if(null!=i)for(const r of this.computed_renderers){const e=new l.Tooltip({custom:y.isString(i)||y.isFunction(i),attachment:this.model.attachment,show_arrow:this.model.show_arrow});r instanceof c.GlyphRenderer?t.set(r,e):r instanceof h.GraphRenderer&&(t.set(r.node_renderer,e),t.set(r.edge_renderer,e))}const s=await x.build_views(this._ttviews,[...t.values()],{parent:this.plot_view});for(const r of s)r.render();const n=[...function*(){for(const t of e)t instanceof c.GlyphRenderer?yield t:t instanceof h.GraphRenderer&&(yield t.node_renderer,yield t.edge_renderer)}()],o=this._slots.get(this._update);if(null!=o){const t=new Set(n.map((t=>t.data_source)));k.Signal.disconnect_receiver(this,o,t)}for(const r of n)this.connect(r.data_source.inspect,this._update)}get computed_renderers(){const{renderers:t,names:e}=this.model,i=this.plot_model.data_renderers;return S.compute_renderers(t,i,e)}get ttmodels(){return this._ttmodels}_clear(){this._inspect(1/0,1/0);for(const[,t]of this.ttmodels)t.clear()}_move(t){if(!this.model.active)return;const{sx:e,sy:i}=t;this.plot_view.frame.bbox.contains(e,i)?this._inspect(e,i):this._clear()}_move_exit(){this._clear()}_inspect(t,e){let i;i="mouse"==this.model.mode?{type:"point",sx:t,sy:e}:{type:"span",direction:"vline"==this.model.mode?"h":"v",sx:t,sy:e};for(const s of this.computed_renderers){const t=s.get_selection_manager(),e=this.plot_view.renderer_view(s);null!=e&&t.inspect(e,i)}this._emit_callback(i)}_update([t,{geometry:e}]){var i,s;if(!this.model.active)return;if("point"!=e.type&&"span"!=e.type)return;if(!(t instanceof c.GlyphRenderer))return;if("ignore"==this.model.muted_policy&&t.muted)return;const n=this.ttmodels.get(t);if(null==n)return;const o=t.get_selection_manager();let r=o.inspectors.get(t);if(r=t.view.convert_selection_to_subset(r),r.is_empty())return void n.clear();const a=o.source,l=this.plot_view.renderer_view(t);if(null==l)return;const{sx:h,sy:_}=e,p=l.coordinates.x_scale,m=l.coordinates.y_scale,f=p.invert(h),v=m.invert(_),{glyph:y}=l,x=[];if(y instanceof d.LineView)for(const c of r.line_indices){let i,s,n=y._x[c+1],o=y._y[c+1],l=c;switch(this.model.line_policy){case"interp":[n,o]=y.get_interpolation_hit(c,e),i=p.compute(n),s=m.compute(o);break;case"prev":[[i,s],l]=M(y.sx,y.sy,c);break;case"next":[[i,s],l]=M(y.sx,y.sy,c+1);break;case"nearest":[[i,s],l]=C(c,e,h,_,y.sx,y.sy),n=y._x[l],o=y._y[l];break;default:[i,s]=[h,_]}const d={index:l,x:f,y:v,sx:h,sy:_,data_x:n,data_y:o,rx:i,ry:s,indices:r.line_indices,name:t.name};x.push([i,s,this._render_tooltips(a,l,d)])}for(const c of r.image_indices){const e={index:c.index,x:f,y:v,sx:h,sy:_,name:t.name},i=this._render_tooltips(a,c,e);x.push([h,_,i])}for(const d of r.indices)if(y instanceof u.MultiLineView&&!b.isEmpty(r.multiline_indices))for(const i of r.multiline_indices[d.toString()]){let s,n,o,l=y._xs.get(d)[i],u=y._ys.get(d)[i],g=i;switch(this.model.line_policy){case"interp":[l,u]=y.get_interpolation_hit(d,i,e),s=p.compute(l),n=m.compute(u);break;case"prev":[[s,n],g]=M(y.sxs.get(d),y.sys.get(d),i);break;case"next":[[s,n],g]=M(y.sxs.get(d),y.sys.get(d),i+1);break;case"nearest":[[s,n],g]=C(i,e,h,_,y.sxs.get(d),y.sys.get(d)),l=y._xs.get(d)[g],u=y._ys.get(d)[g];break;default:throw new Error("shouldn't have happened")}o=t instanceof c.GlyphRenderer?t.view.convert_indices_from_subset([d])[0]:d;const b={index:o,x:f,y:v,sx:h,sy:_,data_x:l,data_y:u,segment_index:g,indices:r.multiline_indices,name:t.name};x.push([s,n,this._render_tooltips(a,o,b)])}else{const e=null===(i=y._x)||void 0===i?void 0:i[d],n=null===(s=y._y)||void 0===s?void 0:s[d];let o,l,u;if("snap_to_data"==this.model.point_policy){let t=y.get_anchor_point(this.model.anchor,d,[h,_]);if(null==t&&(t=y.get_anchor_point("center",d,[h,_]),null==t))continue;o=t.x,l=t.y}else[o,l]=[h,_];u=t instanceof c.GlyphRenderer?t.view.convert_indices_from_subset([d])[0]:d;const p={index:u,x:f,y:v,sx:h,sy:_,data_x:e,data_y:n,indices:r.indices,name:t.name};x.push([o,l,this._render_tooltips(a,u,p)])}if(0==x.length)n.clear();else{const{content:t}=n;g.empty(n.content);for(const[,,s]of x)null!=s&&t.appendChild(s);const[e,i]=x[x.length-1];n.setv({position:[e,i]},{check_eq:!1})}}_emit_callback(t){const{callback:e}=this.model;if(null!=e)for(const i of this.computed_renderers){if(!(i instanceof c.GlyphRenderer))continue;const s=this.plot_view.renderer_view(i);if(null==s)continue;const{x_scale:n,y_scale:o}=s.coordinates,r=n.invert(t.sx),a=o.invert(t.sy),l=i.data_source.inspected;e.execute(this.model,{geometry:Object.assign({x:r,y:a},t),renderer:i,index:l})}}_create_template(t){const e=g.div({style:{display:"table",borderSpacing:"2px"}});for(const[i]of t){const t=g.div({style:{display:"table-row"}});e.appendChild(t);const s=g.div({style:{display:"table-cell"},class:T.tooltip_row_label},0!=i.length?`${i}: `:"");t.appendChild(s);const n=g.span();n.dataset.value="";const o=g.span({class:T.tooltip_color_block}," ");o.dataset.swatch="",g.undisplay(o);const r=g.div({style:{display:"table-cell"},class:T.tooltip_row_value},n,o);t.appendChild(r)}return e}_render_template(t,e,i,s,n){const o=t.cloneNode(!0),r=o.querySelectorAll("[data-value]"),a=o.querySelectorAll("[data-swatch]"),l=/\$color(\[.*\])?:(\w*)/,c=/\$swatch:(\w*)/;for(const[[,h],_]of v.enumerate(e)){const t=h.match(c),e=h.match(l);if(null!=t||null!=e){if(null!=t){const[,e]=t,n=i.get_column(e);if(null==n)r[_].textContent=`${e} unknown`;else{const t=y.isNumber(s)?n[s]:null;null!=t&&(a[_].style.backgroundColor=f.color2css(t),g.display(a[_]))}}if(null!=e){const[,t="",n]=e,o=i.get_column(n);if(null==o){r[_].textContent=`${n} unknown`;continue}const l=t.indexOf("hex")>=0,c=t.indexOf("swatch")>=0,h=y.isNumber(s)?o[s]:null;if(null==h){r[_].textContent="(null)";continue}r[_].textContent=l?f.color2hex(h):f.color2css(h),c&&(a[_].style.backgroundColor=f.color2css(h),g.display(a[_]))}}else{const t=m.replace_placeholders(h.replace("$~","$data_"),i,s,this.model.formatters,n);if(y.isString(t))r[_].textContent=t;else for(const e of t)r[_].appendChild(e)}}return o}_render_tooltips(t,e,i){var s;const{tooltips:n}=this.model;if(y.isString(n)){const s=m.replace_placeholders({html:n},t,e,this.model.formatters,i);return g.div({},s)}if(y.isFunction(n))return n(t,i);if(null!=n){const o=null!==(s=this._template_el)&&void 0!==s?s:this._template_el=this._create_template(n);return this._render_template(o,n,t,e,i)}return null}}i.HoverToolView=E,E.__name__="HoverToolView";class z extends r.InspectTool{constructor(t){super(t),this.tool_name="Hover",this.icon=A.tool_icon_hover}static init_HoverTool(){this.prototype.default_view=E,this.define((({Any:t,Boolean:e,String:i,Array:s,Tuple:n,Dict:o,Or:r,Ref:l,Function:c,Auto:h,Nullable:d})=>({tooltips:[d(r(i,s(n(i,i)),c())),[["index","$index"],["data (x, y)","($x, $y)"],["screen (x, y)","($sx, $sy)"]]],formatters:[o(r(l(a.CustomJSHover),m.FormatterType)),{}],renderers:[r(s(l(_.DataRenderer)),h),"auto"],names:[s(i),[]],mode:[w.HoverMode,"mouse"],muted_policy:[w.MutedPolicy,"show"],point_policy:[w.PointPolicy,"snap_to_data"],line_policy:[w.LinePolicy,"nearest"],show_arrow:[e,!0],anchor:[w.Anchor,"center"],attachment:[w.TooltipAttachment,"horizontal"],callback:[d(t)]}))),this.register_alias("hover",(()=>new z))}}i.HoverTool=z,z.__name__="HoverTool",z.init_HoverTool()},function(t,e,i,s,n){s();const o=t(15),r=t(53),a=t(238),l=t(247),c=t(245);class h extends r.Model{constructor(t){super(t)}static init_ToolProxy(){this.define((({Boolean:t,Array:e,Ref:i})=>({tools:[e(i(a.ButtonTool)),[]],active:[t,!1],disabled:[t,!1]})))}get button_view(){return this.tools[0].button_view}get event_type(){return this.tools[0].event_type}get tooltip(){return this.tools[0].tooltip}get tool_name(){return this.tools[0].tool_name}get icon(){return this.tools[0].computed_icon}get computed_icon(){return this.icon}get toggleable(){const t=this.tools[0];return t instanceof l.InspectTool&&t.toggleable}initialize(){super.initialize(),this.do=new o.Signal0(this,"do")}connect_signals(){super.connect_signals(),this.connect(this.do,(()=>this.doit())),this.connect(this.properties.active.change,(()=>this.set_active()));for(const t of this.tools)this.connect(t.properties.active.change,(()=>{this.active=t.active}))}doit(){for(const t of this.tools)t.do.emit()}set_active(){for(const t of this.tools)t.active=this.active}get menu(){const{menu:t}=this.tools[0];if(null==t)return null;const e=[];for(const[i,s]of c.enumerate(t))if(null==i)e.push(null);else{const t=()=>{var t,e;for(const i of this.tools)null===(e=null===(t=i.menu)||void 0===t?void 0:t[s])||void 0===e||e.handler()};e.push(Object.assign(Object.assign({},i),{handler:t}))}return e}}i.ToolProxy=h,h.__name__="ToolProxy",h.init_ToolProxy()},function(t,e,i,s,n){s();const o=t(20),r=t(9),a=t(13),l=t(248),c=t(235),h=t(392),_=t(319),d=t(221);class u extends l.ToolbarBase{constructor(t){super(t)}static init_ProxyToolbar(){this.define((({Array:t,Ref:e})=>({toolbars:[t(e(c.Toolbar)),[]]})))}initialize(){super.initialize(),this._merge_tools()}_merge_tools(){this._proxied_tools=[];const t={},e={},i={},s=[],n=[];for(const a of this.help)r.includes(n,a.redirect)||(s.push(a),n.push(a.redirect));this._proxied_tools.push(...s),this.help=s;for(const[r,l]of a.entries(this.gestures)){r in i||(i[r]={});for(const t of l.tools)t.type in i[r]||(i[r][t.type]=[]),i[r][t.type].push(t)}for(const r of this.inspectors)r.type in t||(t[r.type]=[]),t[r.type].push(r);for(const r of this.actions)r.type in e||(e[r.type]=[]),e[r.type].push(r);const o=(t,e=!1)=>{const i=new h.ToolProxy({tools:t,active:e});return this._proxied_tools.push(i),i};for(const r of a.keys(i)){const t=this.gestures[r];t.tools=[];for(const e of a.keys(i[r])){const s=i[r][e];if(s.length>0)if("multi"==r)for(const e of s){const i=o([e]);t.tools.push(i),this.connect(i.properties.active.change,(()=>this._active_change(i)))}else{const e=o(s);t.tools.push(e),this.connect(e.properties.active.change,(()=>this._active_change(e)))}}}this.actions=[];for(const[r,l]of a.entries(e))if("CustomAction"==r)for(const t of l)this.actions.push(o([t]));else l.length>0&&this.actions.push(o(l));this.inspectors=[];for(const r of a.values(t))r.length>0&&this.inspectors.push(o(r,!0));for(const[l,c]of a.entries(this.gestures))0!=c.tools.length&&(c.tools=r.sort_by(c.tools,(t=>t.default_order)),"pinch"!=l&&"scroll"!=l&&"multi"!=l&&(c.tools[0].active=!0))}}i.ProxyToolbar=u,u.__name__="ProxyToolbar",u.init_ProxyToolbar();class p extends _.LayoutDOMView{initialize(){this.model.toolbar.toolbar_location=this.model.toolbar_location,super.initialize()}get child_models(){return[this.model.toolbar]}_update_layout(){this.layout=new d.ContentBox(this.child_views[0].el);const{toolbar:t}=this.model;t.horizontal?this.layout.set_sizing({width_policy:"fit",min_width:100,height_policy:"fixed"}):this.layout.set_sizing({width_policy:"fixed",height_policy:"fit",min_height:100})}}i.ToolbarBoxView=p,p.__name__="ToolbarBoxView";class m extends _.LayoutDOM{constructor(t){super(t)}static init_ToolbarBox(){this.prototype.default_view=p,this.define((({Ref:t})=>({toolbar:[t(l.ToolbarBase)],toolbar_location:[o.Location,"right"]})))}}i.ToolbarBox=m,m.__name__="ToolbarBox",m.init_ToolbarBox()},function(t,e,i,s,n){s();const o=t(1),r=t(53),a=o.__importStar(t(21)),l=t(8),c=t(13);i.resolve_defs=function(t,e){var i,s,n,o;function h(t){return null!=t.module?`${t.module}.${t.name}`:t.name}function _(t){if(l.isString(t))switch(t){case"Any":return a.Any;case"Unknown":return a.Unknown;case"Boolean":return a.Boolean;case"Number":return a.Number;case"Int":return a.Int;case"String":return a.String;case"Null":return a.Null}else switch(t[0]){case"Nullable":{const[,e]=t;return a.Nullable(_(e))}case"Or":{const[,...e]=t;return a.Or(...e.map(_))}case"Tuple":{const[,e,...i]=t;return a.Tuple(_(e),...i.map(_))}case"Array":{const[,e]=t;return a.Array(_(e))}case"Struct":{const[,...e]=t,i=e.map((([t,e])=>[t,_(e)]));return a.Struct(c.to_object(i))}case"Dict":{const[,e]=t;return a.Dict(_(e))}case"Map":{const[,e,i]=t;return a.Map(_(e),_(i))}case"Enum":{const[,...e]=t;return a.Enum(...e)}case"Ref":{const[,i]=t,s=e.get(h(i));if(null!=s)return a.Ref(s);throw new Error(`${h(i)} wasn't defined before referencing it`)}case"AnyRef":return a.AnyRef()}}for(const a of t){const t=(()=>{if(null==a.extends)return r.Model;{const t=e.get(h(a.extends));if(null!=t)return t;throw new Error(`base model ${h(a.extends)} of ${h(a)} is not defined`)}})(),l=((o=class extends t{}).__name__=a.name,o.__module__=a.module,o);for(const e of null!==(i=a.properties)&&void 0!==i?i:[]){const t=_(null!==(s=e.kind)&&void 0!==s?s:"Unknown");l.define({[e.name]:[t,e.default]})}for(const e of null!==(n=a.overrides)&&void 0!==n?n:[])l.override({[e.name]:e.default});e.register(l)}}},function(t,e,i,s,n){s();const o=t(5),r=t(240),a=t(122),l=t(43),c=t(396);i.index={},i.add_document_standalone=async function(t,e,s=[],n=!1){const h=new Map;async function _(n){let o;const _=t.roots().indexOf(n),d=s[_];null!=d?o=d:e.classList.contains(c.BOKEH_ROOT)?o=e:(o=l.div({class:c.BOKEH_ROOT}),e.appendChild(o));const u=await a.build_view(n,{parent:null});return u instanceof r.DOMView&&u.renderTo(o),h.set(n,u),i.index[n.id]=u,u}for(const i of t.roots())await _(i);return n&&(window.document.title=t.title()),t.on_change((t=>{t instanceof o.RootAddedEvent?_(t.model):t instanceof o.RootRemovedEvent?function(t){const e=h.get(t);null!=e&&(e.remove(),h.delete(t),delete i.index[t.id])}(t.model):n&&t instanceof o.TitleChangedEvent&&(window.document.title=t.title)})),[...h.values()]}},function(t,e,i,s,n){s();const o=t(43),r=t(44);function a(t){let e=document.getElementById(t);if(null==e)throw new Error(`Error rendering Bokeh model: could not find #${t} HTML tag`);if(!document.body.contains(e))throw new Error(`Error rendering Bokeh model: element #${t} must be under <body>`);if("SCRIPT"==e.tagName){const t=o.div({class:i.BOKEH_ROOT});o.replaceWith(e,t),e=t}return e}i.BOKEH_ROOT=r.root,i._resolve_element=function(t){const{elementid:e}=t;return null!=e?a(e):document.body},i._resolve_root_elements=function(t){const e=[];if(null!=t.root_ids&&null!=t.roots)for(const i of t.root_ids)e.push(a(t.roots[i]));return e}},function(t,e,i,s,n){s();const o=t(398),r=t(19),a=t(395);i._get_ws_url=function(t,e){let i,s="ws:";return"https:"==window.location.protocol&&(s="wss:"),null!=e?(i=document.createElement("a"),i.href=e):i=window.location,null!=t?"/"==t&&(t=""):t=i.pathname.replace(/\/+$/,""),s+"//"+i.host+t+"/ws"};const l={};i.add_document_from_session=async function(t,e,i,s=[],n=!1){const c=window.location.search.substr(1);let h;try{h=await function(t,e,i){const s=o.parse_token(e).session_id;t in l||(l[t]={});const n=l[t];return s in n||(n[s]=o.pull_session(t,e,i)),n[s]}(t,e,c)}catch(t){const i=o.parse_token(e).session_id;throw r.logger.error(`Failed to load Bokeh session ${i}: ${t}`),t}return a.add_document_standalone(h.document,i,s,n)}},function(t,e,i,s,n){s();const o=t(19),r=t(5),a=t(399),l=t(400),c=t(401);i.DEFAULT_SERVER_WEBSOCKET_URL="ws://localhost:5006/ws",i.DEFAULT_TOKEN="eyJzZXNzaW9uX2lkIjogImRlZmF1bHQifQ";let h=0;function _(t){let e=t.split(".")[0];const i=e.length%4;return 0!=i&&(e+="=".repeat(4-i)),JSON.parse(atob(e.replace(/_/g,"/").replace(/-/g,"+")))}i.parse_token=_;class d{constructor(t=i.DEFAULT_SERVER_WEBSOCKET_URL,e=i.DEFAULT_TOKEN,s=null){this.url=t,this.token=e,this.args_string=s,this._number=h++,this.socket=null,this.session=null,this.closed_permanently=!1,this._current_handler=null,this._pending_replies=new Map,this._pending_messages=[],this._receiver=new l.Receiver,this.id=_(e).session_id.split(".")[0],o.logger.debug(`Creating websocket ${this._number} to '${this.url}' session '${this.id}'`)}async connect(){if(this.closed_permanently)throw new Error("Cannot connect() a closed ClientConnection");if(null!=this.socket)throw new Error("Already connected");this._current_handler=null,this._pending_replies.clear(),this._pending_messages=[];try{let t=`${this.url}`;return null!=this.args_string&&this.args_string.length>0&&(t+=`?${this.args_string}`),this.socket=new WebSocket(t,["bokeh",this.token]),new Promise(((t,e)=>{this.socket.binaryType="arraybuffer",this.socket.onopen=()=>this._on_open(t,e),this.socket.onmessage=t=>this._on_message(t),this.socket.onclose=t=>this._on_close(t,e),this.socket.onerror=()=>this._on_error(e)}))}catch(t){throw o.logger.error(`websocket creation failed to url: ${this.url}`),o.logger.error(` - ${t}`),t}}close(){this.closed_permanently||(o.logger.debug(`Permanently closing websocket connection ${this._number}`),this.closed_permanently=!0,null!=this.socket&&this.socket.close(1e3,`close method called on ClientConnection ${this._number}`),this.session._connection_closed())}_schedule_reconnect(t){setTimeout((()=>{this.closed_permanently||o.logger.info(`Websocket connection ${this._number} disconnected, will not attempt to reconnect`)}),t)}send(t){if(null==this.socket)throw new Error(`not connected so cannot send ${t}`);t.send(this.socket)}async send_with_reply(t){const e=await new Promise(((e,i)=>{this._pending_replies.set(t.msgid(),{resolve:e,reject:i}),this.send(t)}));if("ERROR"===e.msgtype())throw new Error(`Error reply ${e.content.text}`);return e}async _pull_doc_json(){const t=a.Message.create("PULL-DOC-REQ",{}),e=await this.send_with_reply(t);if(!("doc"in e.content))throw new Error("No 'doc' field in PULL-DOC-REPLY");return e.content.doc}async _repull_session_doc(t,e){var i;o.logger.debug(this.session?"Repulling session":"Pulling session for first time");try{const i=await this._pull_doc_json();if(null==this.session)if(this.closed_permanently)o.logger.debug("Got new document after connection was already closed"),e(new Error("The connection has been closed"));else{const e=r.Document.from_json(i),s=r.Document._compute_patch_since_json(i,e);if(s.events.length>0){o.logger.debug(`Sending ${s.events.length} changes from model construction back to server`);const t=a.Message.create("PATCH-DOC",{},s);this.send(t)}this.session=new c.ClientSession(this,e,this.id);for(const t of this._pending_messages)this.session.handle(t);this._pending_messages=[],o.logger.debug("Created a new session from new pulled doc"),t(this.session)}else this.session.document.replace_with_json(i),o.logger.debug("Updated existing session with new pulled doc")}catch(t){null===(i=console.trace)||void 0===i||i.call(console,t),o.logger.error(`Failed to repull session ${t}`),e(t instanceof Error?t:`${t}`)}}_on_open(t,e){o.logger.info(`Websocket connection ${this._number} is now open`),this._current_handler=i=>{this._awaiting_ack_handler(i,t,e)}}_on_message(t){null==this._current_handler&&o.logger.error("Got a message with no current handler set");try{this._receiver.consume(t.data)}catch(t){this._close_bad_protocol(`${t}`)}const e=this._receiver.message;if(null!=e){const t=e.problem();null!=t&&this._close_bad_protocol(t),this._current_handler(e)}}_on_close(t,e){o.logger.info(`Lost websocket ${this._number} connection, ${t.code} (${t.reason})`),this.socket=null,this._pending_replies.forEach((t=>t.reject("Disconnected"))),this._pending_replies.clear(),this.closed_permanently||this._schedule_reconnect(2e3),e(new Error(`Lost websocket connection, ${t.code} (${t.reason})`))}_on_error(t){o.logger.debug(`Websocket error on socket ${this._number}`);const e="Could not open websocket";o.logger.error(`Failed to connect to Bokeh server: ${e}`),t(new Error(e))}_close_bad_protocol(t){o.logger.error(`Closing connection: ${t}`),null!=this.socket&&this.socket.close(1002,t)}_awaiting_ack_handler(t,e,i){"ACK"===t.msgtype()?(this._current_handler=t=>this._steady_state_handler(t),this._repull_session_doc(e,i)):this._close_bad_protocol("First message was not an ACK")}_steady_state_handler(t){const e=t.reqid(),i=this._pending_replies.get(e);i?(this._pending_replies.delete(e),i.resolve(t)):this.session?this.session.handle(t):"PATCH-DOC"!=t.msgtype()&&this._pending_messages.push(t)}}i.ClientConnection=d,d.__name__="ClientConnection",i.pull_session=function(t,e,i){return new d(t,e,i).connect()}},function(t,e,i,s,n){s();const o=t(34);class r{constructor(t,e,i){this.header=t,this.metadata=e,this.content=i,this.buffers=new Map}static assemble(t,e,i){const s=JSON.parse(t),n=JSON.parse(e),o=JSON.parse(i);return new r(s,n,o)}assemble_buffer(t,e){const i=null!=this.header.num_buffers?this.header.num_buffers:0;if(i<=this.buffers.size)throw new Error(`too many buffers received, expecting ${i}`);const{id:s}=JSON.parse(t);this.buffers.set(s,e)}static create(t,e,i={}){const s=r.create_header(t);return new r(s,e,i)}static create_header(t){return{msgid:o.uniqueId(),msgtype:t}}complete(){return null!=this.header&&null!=this.metadata&&null!=this.content&&(null==this.header.num_buffers||this.buffers.size==this.header.num_buffers)}send(t){if((null!=this.header.num_buffers?this.header.num_buffers:0)>0)throw new Error("BokehJS only supports receiving buffers, not sending");const e=JSON.stringify(this.header),i=JSON.stringify(this.metadata),s=JSON.stringify(this.content);t.send(e),t.send(i),t.send(s)}msgid(){return this.header.msgid}msgtype(){return this.header.msgtype}reqid(){return this.header.reqid}problem(){return"msgid"in this.header?"msgtype"in this.header?null:"No msgtype in header":"No msgid in header"}}i.Message=r,r.__name__="Message"},function(t,e,i,s,n){s();const o=t(399),r=t(8);class a{constructor(){this.message=null,this._partial=null,this._fragments=[],this._buf_header=null,this._current_consumer=this._HEADER}consume(t){this._current_consumer(t)}_HEADER(t){this._assume_text(t),this.message=null,this._partial=null,this._fragments=[t],this._buf_header=null,this._current_consumer=this._METADATA}_METADATA(t){this._assume_text(t),this._fragments.push(t),this._current_consumer=this._CONTENT}_CONTENT(t){this._assume_text(t),this._fragments.push(t);const[e,i,s]=this._fragments.slice(0,3);this._partial=o.Message.assemble(e,i,s),this._check_complete()}_BUFFER_HEADER(t){this._assume_text(t),this._buf_header=t,this._current_consumer=this._BUFFER_PAYLOAD}_BUFFER_PAYLOAD(t){this._assume_binary(t),this._partial.assemble_buffer(this._buf_header,t),this._check_complete()}_assume_text(t){if(!r.isString(t))throw new Error("Expected text fragment but received binary fragment")}_assume_binary(t){if(!(t instanceof ArrayBuffer))throw new Error("Expected binary fragment but received text fragment")}_check_complete(){this._partial.complete()?(this.message=this._partial,this._current_consumer=this._HEADER):this._current_consumer=this._BUFFER_HEADER}}i.Receiver=a,a.__name__="Receiver"},function(t,e,i,s,n){s();const o=t(5),r=t(399),a=t(19);class l{constructor(t,e,i){this._connection=t,this.document=e,this.id=i,this._document_listener=t=>{this._document_changed(t)},this.document.on_change(this._document_listener,!0)}handle(t){const e=t.msgtype();"PATCH-DOC"===e?this._handle_patch(t):"OK"===e?this._handle_ok(t):"ERROR"===e?this._handle_error(t):a.logger.debug(`Doing nothing with message ${t.msgtype()}`)}close(){this._connection.close()}_connection_closed(){this.document.remove_on_change(this._document_listener)}async request_server_info(){const t=r.Message.create("SERVER-INFO-REQ",{});return(await this._connection.send_with_reply(t)).content}async force_roundtrip(){await this.request_server_info()}_document_changed(t){if(t.setter_id===this.id)return;const e=t instanceof o.DocumentEventBatch?t.events:[t],i=this.document.create_json_patch(e),s=r.Message.create("PATCH-DOC",{},i);this._connection.send(s)}_handle_patch(t){this.document.apply_json_patch(t.content,t.buffers,this.id)}_handle_ok(t){a.logger.trace(`Unhandled OK reply to ${t.reqid()}`)}_handle_error(t){a.logger.error(`Unhandled ERROR reply to ${t.reqid()}: ${t.content.text}`)}}i.ClientSession=l,l.__name__="ClientSession"},function(t,e,i,s,n){s();const o=t(1),r=t(5),a=t(400),l=t(19),c=t(43),h=t(13),_=t(395),d=t(396),u=o.__importDefault(t(44)),p=o.__importDefault(t(253)),m=o.__importDefault(t(403));function g(t,e){e.buffers.length>0?t.consume(e.buffers[0].buffer):t.consume(e.content.data);const i=t.message;null!=i&&this.apply_json_patch(i.content,i.buffers)}function f(t,e){if("undefined"!=typeof Jupyter&&null!=Jupyter.notebook.kernel){l.logger.info(`Registering Jupyter comms for target ${t}`);const i=Jupyter.notebook.kernel.comm_manager;try{i.register_target(t,(i=>{l.logger.info(`Registering Jupyter comms for target ${t}`);const s=new a.Receiver;i.on_msg(g.bind(e,s))}))}catch(t){l.logger.warn(`Jupyter comms failed to register. push_notebook() will not function. (exception reported: ${t})`)}}else if(e.roots()[0].id in i.kernels){l.logger.info(`Registering JupyterLab comms for target ${t}`);const s=i.kernels[e.roots()[0].id];try{s.registerCommTarget(t,(i=>{l.logger.info(`Registering JupyterLab comms for target ${t}`);const s=new a.Receiver;i.onMsg=g.bind(e,s)}))}catch(t){l.logger.warn(`Jupyter comms failed to register. push_notebook() will not function. (exception reported: ${t})`)}}else if("undefined"!=typeof google&&null!=google.colab.kernel){l.logger.info(`Registering Google Colab comms for target ${t}`);const i=google.colab.kernel.comms;try{i.registerTarget(t,(async i=>{var s,n,r;l.logger.info(`Registering Google Colab comms for target ${t}`);const c=new a.Receiver;try{for(var h,_=o.__asyncValues(i.messages);!(h=await _.next()).done;){const t=h.value,i={data:t.data},s=[];for(const e of null!==(r=t.buffers)&&void 0!==r?r:[])s.push(new DataView(e));const n={content:i,buffers:s};g.bind(e)(c,n)}}catch(t){s={error:t}}finally{try{h&&!h.done&&(n=_.return)&&await n.call(_)}finally{if(s)throw s.error}}}))}catch(t){l.logger.warn(`Google Colab comms failed to register. push_notebook() will not function. (exception reported: ${t})`)}}else console.warn("Jupyter notebooks comms not available. push_notebook() will not function. If running JupyterLab ensure the latest @bokeh/jupyter_bokeh extension is installed. In an exported notebook this warning is expected.")}c.stylesheet.append(u.default),c.stylesheet.append(p.default),c.stylesheet.append(m.default),i.kernels={},i.embed_items_notebook=function(t,e){if(1!=h.size(t))throw new Error("embed_items_notebook expects exactly one document in docs_json");const i=r.Document.from_json(h.values(t)[0]);for(const s of e){null!=s.notebook_comms_target&&f(s.notebook_comms_target,i);const t=d._resolve_element(s),e=d._resolve_root_elements(s);_.add_document_standalone(i,t,e)}}},function(t,e,i,s,n){s(),i.root="bk-root",i.tooltip="bk-tooltip",i.default=".rendered_html .bk-root .bk-tooltip table,.rendered_html .bk-root .bk-tooltip tr,.rendered_html .bk-root .bk-tooltip th,.rendered_html .bk-root .bk-tooltip td{border:none;padding:1px;}"},function(t,e,i,s,n){s();const o=t(1);o.__exportStar(t(399),i),o.__exportStar(t(400),i)},function(t,e,i,s,n){function o(){const t=document.getElementsByTagName("body")[0],e=document.getElementsByClassName("bokeh-test-div");1==e.length&&(t.removeChild(e[0]),delete e[0]);const i=document.createElement("div");i.classList.add("bokeh-test-div"),i.style.display="none",t.insertBefore(i,t.firstChild)}s(),i.results={},i.init=function(){o()},i.record0=function(t,e){i.results[t]=e},i.record=function(t,e){i.results[t]=e,o()},i.count=function(t){null==i.results[t]&&(i.results[t]=0),i.results[t]+=1,o()}},function(t,e,i,s,n){s(),i.safely=function(t,e=!1){try{return t()}catch(t){if(function(t){const e=document.createElement("div");e.style.backgroundColor="#f2dede",e.style.border="1px solid #a94442",e.style.borderRadius="4px",e.style.display="inline-block",e.style.fontFamily="sans-serif",e.style.marginTop="5px",e.style.minWidth="200px",e.style.padding="5px 5px 5px 10px",e.classList.add("bokeh-error-box-into-flames");const i=document.createElement("span");i.style.backgroundColor="#a94442",i.style.borderRadius="0px 4px 0px 0px",i.style.color="white",i.style.cursor="pointer",i.style.cssFloat="right",i.style.fontSize="0.8em",i.style.margin="-6px -6px 0px 0px",i.style.padding="2px 5px 4px 5px",i.title="close",i.setAttribute("aria-label","close"),i.appendChild(document.createTextNode("x")),i.addEventListener("click",(()=>o.removeChild(e)));const s=document.createElement("h3");s.style.color="#a94442",s.style.margin="8px 0px 0px 0px",s.style.padding="0px",s.appendChild(document.createTextNode("Bokeh Error"));const n=document.createElement("pre");n.style.whiteSpace="unset",n.style.overflowX="auto",n.appendChild(document.createTextNode(t)),e.appendChild(i),e.appendChild(s),e.appendChild(n);const o=document.getElementsByTagName("body")[0];o.insertBefore(e,o.firstChild)}(t instanceof Error&&t.stack?t.stack:`${t}`),e)return;throw t}}}],0,{main:0,tslib:1,index:2,version:3,"embed/index":4,"document/index":5,"document/document":6,base:7,"core/util/types":8,"core/util/array":9,"core/util/math":10,"core/util/assert":11,"core/util/arrayable":12,"core/util/object":13,"core/has_props":14,"core/signaling":15,"core/util/defer":16,"core/util/refs":17,"core/properties":18,"core/logging":19,"core/enums":20,"core/kinds":21,"core/util/color":22,"core/util/svg_colors":23,"core/types":24,"core/util/bitset":25,"core/util/eq":26,"core/util/platform":27,"core/settings":28,"core/util/ndarray":29,"core/serializer":30,"core/util/serialization":31,"core/util/buffer":32,"core/uniforms":33,"core/util/string":34,"document/events":35,"core/util/pretty":36,"core/util/cloneable":37,"models/index":38,"models/annotations/index":39,"models/annotations/annotation":40,"models/renderers/renderer":41,"core/view":42,"core/dom":43,"styles/root.css":44,"core/visuals/index":45,"core/visuals/line":46,"core/visuals/visual":47,"core/property_mixins":48,"core/visuals/fill":49,"core/visuals/text":50,"core/visuals/hatch":51,"core/visuals/patterns":52,model:53,"models/canvas/coordinates":54,"models/annotations/arrow":55,"models/annotations/data_annotation":56,"models/sources/columnar_data_source":57,"models/sources/data_source":58,"models/selections/selection":59,"core/selection_manager":60,"models/renderers/glyph_renderer":61,"models/renderers/data_renderer":62,"models/glyphs/line":63,"models/glyphs/xy_glyph":64,"core/util/projections":65,"models/glyphs/glyph":98,"core/util/bbox":99,"core/util/ragged_array":100,"core/util/spatial":101,"models/ranges/factor_range":104,"models/ranges/range":105,"models/glyphs/utils":106,"core/hittest":107,"models/glyphs/webgl/line":108,"models/glyphs/webgl/utils/index":109,"models/glyphs/webgl/utils/program":110,"models/glyphs/webgl/utils/buffer":111,"models/glyphs/webgl/utils/texture":112,"models/glyphs/webgl/base":113,"models/glyphs/webgl/line.vert":114,"models/glyphs/webgl/line.frag":115,"models/glyphs/patch":116,"models/glyphs/harea":117,"models/glyphs/area":118,"models/glyphs/varea":119,"models/sources/cds_view":120,"models/filters/filter":121,"core/build_views":122,"models/renderers/graph_renderer":123,"models/expressions/expression":124,"models/graphs/layout_provider":125,"models/graphs/graph_hit_test_policy":126,"models/glyphs/multi_line":127,"models/glyphs/patches":128,"models/selections/interaction_policy":129,"models/sources/column_data_source":130,"core/util/typed_array":131,"core/util/set":132,"models/annotations/arrow_head":133,"models/annotations/band":134,"models/annotations/upper_lower":135,"models/annotations/box_annotation":136,"models/annotations/color_bar":137,"models/annotations/title":138,"models/annotations/text_annotation":139,"core/layout/side_panel":140,"core/layout/types":141,"core/layout/layoutable":142,"core/util/text":143,"models/canvas/cartesian_frame":144,"models/scales/categorical_scale":145,"models/scales/scale":146,"models/transforms/index":147,"models/transforms/customjs_transform":148,"models/transforms/transform":149,"models/transforms/dodge":150,"models/transforms/range_transform":151,"models/transforms/interpolator":152,"models/transforms/jitter":153,"models/transforms/linear_interpolator":154,"models/transforms/step_interpolator":155,"models/ranges/range1d":156,"models/scales/log_scale":157,"models/scales/continuous_scale":158,"models/ranges/data_range1d":159,"models/ranges/data_range":160,"models/util":161,"models/axes/index":162,"models/axes/axis":163,"models/renderers/guide_renderer":164,"models/tickers/ticker":165,"models/formatters/tick_formatter":166,"core/graphics":167,"core/util/affine":168,"models/policies/labeling":169,"models/axes/categorical_axis":170,"models/tickers/categorical_ticker":171,"models/formatters/categorical_tick_formatter":172,"models/axes/continuous_axis":173,"models/axes/datetime_axis":174,"models/axes/linear_axis":175,"models/formatters/basic_tick_formatter":176,"models/tickers/basic_ticker":177,"models/tickers/adaptive_ticker":178,"models/tickers/continuous_ticker":179,"models/formatters/datetime_tick_formatter":180,"core/util/templating":182,"models/tickers/datetime_ticker":185,"models/tickers/composite_ticker":186,"models/tickers/days_ticker":187,"models/tickers/single_interval_ticker":188,"models/tickers/util":189,"models/tickers/months_ticker":190,"models/tickers/years_ticker":191,"models/axes/log_axis":192,"models/formatters/log_tick_formatter":193,"models/tickers/log_ticker":194,"models/axes/mercator_axis":195,"models/formatters/mercator_tick_formatter":196,"models/tickers/mercator_ticker":197,"models/tickers/index":198,"models/tickers/fixed_ticker":199,"models/tickers/binned_ticker":200,"models/mappers/scanning_color_mapper":201,"models/mappers/continuous_color_mapper":202,"models/mappers/color_mapper":203,"models/mappers/mapper":204,"models/formatters/index":205,"models/formatters/func_tick_formatter":206,"models/formatters/numeral_tick_formatter":207,"models/formatters/printf_tick_formatter":208,"models/mappers/index":209,"models/mappers/categorical_color_mapper":210,"models/mappers/categorical_mapper":211,"models/mappers/categorical_marker_mapper":212,"models/mappers/categorical_pattern_mapper":213,"models/mappers/linear_color_mapper":214,"models/mappers/log_color_mapper":215,"models/mappers/eqhist_color_mapper":216,"models/scales/index":217,"models/scales/linear_scale":218,"models/scales/linear_interpolation_scale":219,"models/ranges/index":220,"core/layout/index":221,"core/layout/alignments":222,"core/layout/grid":223,"core/layout/html":224,"core/layout/border":225,"models/annotations/label":226,"models/annotations/label_set":227,"models/annotations/legend":228,"models/annotations/legend_item":229,"core/vectorization":230,"models/annotations/poly_annotation":231,"models/annotations/slope":232,"models/annotations/span":233,"models/annotations/toolbar_panel":234,"models/tools/toolbar":235,"models/tools/tool":236,"models/tools/gestures/gesture_tool":237,"models/tools/button_tool":238,"core/dom_view":240,"styles/toolbar.css":241,"styles/icons.css":242,"styles/menus.css":243,"core/util/menus":244,"core/util/iterator":245,"models/tools/on_off_button":246,"models/tools/inspectors/inspect_tool":247,"models/tools/toolbar_base":248,"core/util/canvas":249,"core/util/svg":250,"models/tools/actions/action_tool":251,"models/tools/actions/help_tool":252,"styles/logo.css":253,"models/annotations/tooltip":254,"styles/tooltips.css":255,"models/annotations/whisker":256,"models/callbacks/index":257,"models/callbacks/customjs":258,"models/callbacks/callback":259,"models/callbacks/open_url":260,"models/canvas/index":261,"models/canvas/canvas":262,"core/ui_events":263,"core/bokeh_events":264,"core/util/wheel":265,"models/expressions/index":266,"models/expressions/customjs_expr":267,"models/expressions/stack":268,"models/expressions/cumsum":269,"models/expressions/minimum":270,"models/expressions/maximum":271,"models/filters/index":272,"models/filters/boolean_filter":273,"models/filters/customjs_filter":274,"models/filters/group_filter":275,"models/filters/index_filter":276,"models/glyphs/index":277,"models/glyphs/annular_wedge":278,"models/glyphs/annulus":279,"models/glyphs/arc":280,"models/glyphs/bezier":281,"models/glyphs/circle":282,"models/glyphs/webgl/markers":283,"models/glyphs/webgl/markers.vert":284,"models/glyphs/webgl/markers.frag":285,"models/glyphs/ellipse":286,"models/glyphs/ellipse_oval":287,"models/glyphs/center_rotatable":288,"models/glyphs/hbar":289,"models/glyphs/box":290,"models/glyphs/hex_tile":291,"models/glyphs/image":292,"models/glyphs/image_base":293,"models/glyphs/image_rgba":294,"models/glyphs/image_url":295,"core/util/image":296,"models/glyphs/multi_polygons":297,"models/glyphs/oval":298,"models/glyphs/quad":299,"models/glyphs/quadratic":300,"models/glyphs/ray":301,"models/glyphs/rect":302,"models/glyphs/scatter":303,"models/glyphs/marker":304,"models/glyphs/defs":305,"models/glyphs/segment":306,"models/glyphs/spline":307,"core/util/interpolation":308,"models/glyphs/step":309,"models/glyphs/text":310,"models/glyphs/vbar":311,"models/glyphs/wedge":312,"models/graphs/index":313,"models/graphs/static_layout_provider":314,"models/grids/index":315,"models/grids/grid":316,"models/layouts/index":317,"models/layouts/box":318,"models/layouts/layout_dom":319,"models/layouts/column":320,"models/layouts/grid_box":321,"models/layouts/html_box":322,"models/layouts/panel":323,"models/layouts/row":324,"models/layouts/spacer":325,"models/layouts/tabs":326,"styles/tabs.css":327,"styles/buttons.css":328,"models/layouts/widget_box":329,"models/plots/index":330,"models/plots/gmap_plot":331,"models/plots/plot":332,"models/plots/plot_canvas":333,"core/util/throttle":334,"models/plots/range_manager":335,"models/plots/state_manager":336,"models/plots/gmap_plot_canvas":337,"models/policies/index":338,"models/renderers/index":339,"models/selections/index":340,"models/sources/index":341,"models/sources/server_sent_data_source":342,"models/sources/web_data_source":343,"models/sources/ajax_data_source":344,"models/sources/geojson_data_source":345,"models/tiles/index":346,"models/tiles/bbox_tile_source":347,"models/tiles/mercator_tile_source":348,"models/tiles/tile_source":349,"models/tiles/tile_utils":350,"models/tiles/quadkey_tile_source":351,"models/tiles/tile_renderer":352,"models/tiles/wmts_tile_source":353,"styles/tiles.css":354,"models/tiles/tms_tile_source":355,"models/textures/index":356,"models/textures/canvas_texture":357,"models/textures/texture":358,"models/textures/image_url_texture":359,"models/tools/index":360,"models/tools/actions/custom_action":361,"models/tools/actions/redo_tool":362,"models/tools/actions/reset_tool":363,"models/tools/actions/save_tool":364,"models/tools/actions/undo_tool":365,"models/tools/actions/zoom_in_tool":366,"models/tools/actions/zoom_base_tool":367,"core/util/zoom":368,"models/tools/actions/zoom_out_tool":369,"models/tools/edit/edit_tool":370,"models/tools/edit/box_edit_tool":371,"models/tools/edit/freehand_draw_tool":372,"models/tools/edit/point_draw_tool":373,"models/tools/edit/poly_draw_tool":374,"models/tools/edit/poly_tool":375,"models/tools/edit/poly_edit_tool":376,"models/tools/gestures/box_select_tool":377,"models/tools/gestures/select_tool":378,"models/tools/gestures/box_zoom_tool":379,"models/tools/gestures/lasso_select_tool":380,"models/tools/gestures/poly_select_tool":381,"models/tools/edit/line_edit_tool":382,"models/tools/edit/line_tool":383,"models/tools/gestures/pan_tool":384,"models/tools/gestures/range_tool":385,"models/tools/gestures/tap_tool":386,"models/tools/gestures/wheel_pan_tool":387,"models/tools/gestures/wheel_zoom_tool":388,"models/tools/inspectors/crosshair_tool":389,"models/tools/inspectors/customjs_hover":390,"models/tools/inspectors/hover_tool":391,"models/tools/tool_proxy":392,"models/tools/toolbar_box":393,"document/defs":394,"embed/standalone":395,"embed/dom":396,"embed/server":397,"client/connection":398,"protocol/message":399,"protocol/receiver":400,"client/session":401,"embed/notebook":402,"styles/notebook.css":403,"protocol/index":404,testing:405,safely:406},{})}));